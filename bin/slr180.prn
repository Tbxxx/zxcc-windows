SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1


                         C      
                         C      	include	slr180.001
                         C      	title	SLR Fast Z80 Assembler
                         C      	name	('SLR180')
                         C      
                         C      ; DASMed version of the SLR180.COM assembler
                         C      ; By W. Cirsovius
                         C      
  0000'                  C      	aseg
                         C      	org	0100h
                         C      
  0000                   C      NO	equ	0
  FFFF                   C      YES	equ	NOT NO
                         C      
  0000                   C      FALSE	equ	NO
  FFFF                   C      TRUE	equ	YES
                         C      
  FFFF                   C      @RUN@	equ	TRUE		;; If we bypass mystery code
                         C      ;;@RUN@	equ	FALSE		;; If we run mystery code
                         C      
  0000                   C      OS	equ	0000h
  0005                   C      BDOS	equ	0005h
  005C                   C      FCB	equ	005ch
  0080                   C      CCP	equ	0080h
  0100                   C      TPA	equ	0100h
                         C      
  0001                   C      .conin	equ	  1
  0002                   C      .conout	equ	  2
  0005                   C      .lstout	equ	  5
  0006                   C      .dircon	equ	  6
  000A                   C      .rdcon	equ	 10
  000B                   C      .consta	equ	 11
  000C                   C      .vers	equ	 12
  000E                   C      .setdsk	equ	 14
  000F                   C      .open	equ	 15
  0010                   C      .close	equ	 16
  0013                   C      .delete	equ	 19
  0014                   C      .rdseq	equ	 20
  0015                   C      .wrseq	equ	 21
  0016                   C      .make	equ	 22
  0019                   C      .retdsk	equ	 25
  001A                   C      .setdma	equ	 26
  0020                   C      .usrcod	equ	 32
  002C                   C      .mulsec	equ	 44
  0066                   C      .rdstmp	equ	102
  0069                   C      .getTOD	equ	105
  006C                   C      .prgret	equ	108
                         C      ;
  0093                   C      .DetCon	equ	147		; MP/M detache functions
  009F                   C      .DetLst	equ	159
                         C      
  FFFF                   C      _get	equ	-1
                         C      
  00FF                   C      OSerr	equ	255
                         C      
  0030                   C      CPM3	equ	30h
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-1


                         C      
  0000                   C      _CPM	equ	0
  0001                   C      _CPM_	equ	1
  0002                   C      _MPM	equ	2
                         C      
  0006                   C      _MPMoff	equ	6		; MP/M file offset
                         C      
  0022                   C      _MBP	equ	0022h		; ZCPR message pointer
  0006                   C      _MEP	equ	    6		; Pointer to error message
                         C      
  0000                   C      _NOER@	equ	0		; CP/M+ normal return
  FF00                   C      _ERR@	equ	0ff00h		; CP/M+ error return
                         C      
  0008                   C      @SEC@	equ	8		; Default sector count
                         C      
  0021                   C      FCBlen	equ	33
  0024                   C      FCBlenr	equ	FCBlen+3
  0001                   C      @drv	equ	1
  0008                   C      @nam	equ	8
  0003                   C      @ext	equ	3
                         C      
  000C                   C      _EXT	equ	12
  0020                   C      _CR	equ	32
                         C      
  0018                   C      C$AStmp	equ	24		; Create/access time stamp
  001C                   C      UpStmp	equ	28		; Update time stamp
                         C      
  0004                   C      TODlen	equ	  4		; Short form
  0010                   C      $TODlen	equ	 16		; Long form
  0080                   C      RecLng	equ	128
  0080                   C      CmdLen	equ	128
                         C      
  0000                   C      null	equ	00h
  0009                   C      tab	equ	09h
  000A                   C      lf	equ	0ah
  000C                   C      ff	equ	0ch
  000D                   C      cr	equ	0dh
  001A                   C      eof	equ	1ah
  001B                   C      esc	equ	1bh
  007F                   C      del	equ	7fh
  FFFF                   C      eot	equ	-1
                         C      
  0000                   C      _FULL	equ	0
  0001                   C      _PASS	equ	1
  0002                   C      _SYM	equ	2
  0003                   C      _CROSS	equ	3
  0004                   C      _UNDEF	equ	4
  0005                   C      _NOUPP	equ	5
  0006                   C      _HEX	equ	6
  0007                   C      _REL	equ	7
                         C      
  000A                   C      @C.P@	equ	(1 SHL _CROSS) + (1 SHL _PASS)
  0009                   C      @C.F@	equ	(1 SHL _CROSS) + (1 SHL _FULL)
  0003                   C      @P.F@	equ	(1 SHL _PASS)  + (1 SHL _FULL)
  0090                   C      @R.U@	equ	(1 SHL _REL)   + (1 SHL _UNDEF)
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-2


  0030                   C      _JR.NC	equ	030h
  00C3                   C      _JP	equ	0c3h
  00C7                   C      _RST.0	equ	0c7h
  00C9                   C      _RET	equ	0c9h
  00CD                   C      _CALL	equ	0cdh
                         C      
  00DD                   C      _IXprfx	equ	0ddh
  00FD                   C      _IYprfx	equ	0fdh
                         C      
  0100                   C      PC.ABS	equ	0100h
  0000                   C      PC.REL	equ	0000h
                         C      
  0007                   C      ColMask	equ	00000111b
  0007                   C      RecMask	equ	00000111b
  000F                   C      LoMask	equ	00001111b
  0080                   C      MSB	equ	10000000b
  007F                   C      NoMSB	equ	01111111b
  00FF                   C      ALL	equ	11111111b
                         C      
  0007                   C      @MSB	equ	7
                         C      
  0008                   C      ColTab	equ	8
                         C      
  0014                   C      MinWid	equ	20		; Min terminal width requested
  0050                   C      MaxWid	equ	80		; Max terminal width
                         C      
                         C      ;
                         C      ; Macro for serial number
                         C      ;
  0100                   C      serial:
  0100    46 2A 4B 53    C      	db	'F*KSLR'
  0104    4C 52          C      
                         C      
                         C      _GO	macro
                         C      	nop
                         C      	endm
                         C      
                         C      ;
                         C      ; Macro for CmpToken
                         C      ;
                         C      ld.bc	macro	v1,v2
                         C      	ld	bc,v1*256+v2
                         C      	endm
                         C      ;
                         C      ; Macro for _rPage_
                         C      ;
                         C      ld.hl	macro	v1,v2
                         C      	ld	hl,v1*256+v2
                         C      	endm
                         C      
                         C      
                         C      val.adr	macro	val,adr
                         C      	db	val
                         C      	dw	adr
                         C      	endm
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-3


  0000                   C      l0000	equ	00h
  0001                   C      l0001	equ	01h
  0002                   C      l0002	equ	02h
  0003                   C      l0003	equ	03h
  0004                   C      l0004	equ	04h
  0005                   C      l0005	equ	05h
  0006                   C      l0006	equ	06h
  0007                   C      l0007	equ	07h
  0008                   C      l0008	equ	08h
  0009                   C      l0009	equ	09h
  000A                   C      l000a	equ	0ah
  000B                   C      l000b	equ	0bh
  000C                   C      l000c	equ	0ch
  000D                   C      l000d	equ	0dh
  000E                   C      l000e	equ	0eh
  000F                   C      l000f	equ	0fh
  0011                   C      l0011	equ	11h
  0013                   C      l0013	equ	13h
  0014                   C      l0014	equ	14h
  0015                   C      l0015	equ	15h
  0016                   C      l0016	equ	16h
  0017                   C      l0017	equ	17h
  001C                   C      l001c	equ	1ch
  001E                   C      l001e	equ	1eh
  0020                   C      l0020	equ	20h
  0027                   C      l0027	equ	27h
  002B                   C      l002b	equ	2bh
  002D                   C      l002d	equ	2dh
  002F                   C      l002f	equ	2fh
  0032                   C      l0032	equ	32h
  0037                   C      l0037	equ	37h
  003F                   C      l003f	equ	3fh
  0040                   C      l0040	equ	40h
  0043                   C      l0043	equ	43h
  0044                   C      l0044	equ	44h
  0045                   C      l0045	equ	45h
  0047                   C      l0047	equ	47h
  004C                   C      l004c	equ	4ch
  0050                   C      l0050	equ	50h
  0076                   C      l0076	equ	76h
  0077                   C      l0077	equ	77h
  007F                   C      l007f	equ	7fh
  00B2                   C      l00b2	equ	0b2h
  00C2                   C      l00c2	equ	0c2h
  00D9                   C      l00d9	equ	0d9h
  00F3                   C      l00f3	equ	0f3h
  00FB                   C      l00fb	equ	0fbh
                         C      
  0100                   C      l0100	equ	0100h
  0200                   C      l0200	equ	0200h
  0500                   C      l0500	equ	0500h
                         C      
  8E1E                   C      l8e1e	equ	8e1eh
                         C      
  94B0                   C      l94b0	equ	94b0h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-4


  AF5F                   C      laf5f	equ	0af5fh
  B73E                   C      lb73e	equ	0b73eh
  C34C                   C      lc34c	equ	0c34ch
  DD1E                   C      ldd1e	equ	0dd1eh
  EB23                   C      leb23	equ	0eb23h
  EF51                   C      lef51	equ	0ef51h
  F105                   C      lf105	equ	0f105h
  F403                   C      lf403	equ	0f403h
  F71E                   C      lf71e	equ	0f71eh
  FA1E                   C      lfa1e	equ	0fa1eh
  FB00                   C      lfb00	equ	0fb00h
  FC18                   C      lfc18	equ	0fc18h
  FE93                   C      lfe93	equ	0fe93h
  FF00                   C      lff00	equ	0ff00h
  FFF2                   C      lfff2	equ	0fff2h
  FFF8                   C      lfff8	equ	0fff8h
  FFFD                   C      lfffd	equ	0fffdh
  FFFF                   C      lffff	equ	0ffffh
                         C      
                         C      IF	@RUN@
  0106    C3 246F        C      	jp	MAIN_
                         C      ELSE
                         C      	jp	MAIN
                         C      ENDIF	; @RUN@
                         C      
  0109                   C      Z3ENV:
  0109    5A 33 45 4E    C      	db	'Z3ENV'
  010D    56             C      
  010E    01             C      	db	1
  010F                   C      ZENV:
  010F    0000           C      	dw	0
                         C      ;
  0111    0131           C      	dw	131h		;; RELEASE 1.31
                         C      ;
                         C      ; Copied to _CON.COL_
                         C      ;
  0113                   C      $CON.COL$:
  0113    00             C      	db	0		; Current console width
  0114    50             C      	db	80		; Page width
  0115    3C             C      	db	60		; Page length
  0116    C0             C      	db	11000000b	; Special bits
  0117                   C      $FOUR$:
  0117    FF             C      	db	YES		; NO is list up to four bytes
  0118    00             C      	db	NO		; NO is no list of false conds.
  0119    00             C      	db	NO		; NO is no FF at start of list
  011A    02             C      	db	2		; Macro list option
  011B    00             C      	db	NO		; NO is generate 6 REL-bytes
  011C    00             C      	db	NO		; NO is INTEL address mode
                         C      ;
                         C      ; ->>>>> DONE
                         C      ;
  011D                   C      $SUPPR$:
  011D    00             C      	db	NO		; YES Suppress PAGE, TITLE
  011E                   C      $EI$:
  011E    00             C      	db	NO		; NO is no interrupt fix
  011F                   C      $FF.SUM$:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-5


  011F    FF             C      	db	YES		; YES if FF before summary
  0120                   C      $FF.EOL$:
  0120    FF             C      	db	YES		; YES if FF at end of pass
  0121                   C      $TOD.ENA$:
  0121    FF             C      	db	YES		; YES is TOD enable
  0122                   C      $TOD.LOAD$:
  0122    00             C      	db	NO		; NO is load TOD from data
  0123                   C      $TOD.DATA$:
  0123    0010           C      	dw	0010h		; Execution address or data
  0125                   C      $TOD.FORM$:
  0125    00             C      	db	NO		; NO is short format
  0126                   C      $MULS$:
  0126    FF             C      	db	YES		; NO is one sector
  0127                   C      $LIN.NR$:
  0127    00             C      	db	NO		; YES use # instead of line#
  0128                   C      $PR.LINNR$:
  0128    FF             C      	db	YES		; YES prints line# first
  0129                   C      $NUMER$:
  0129    64             C      	db	100		; Error count for abort
  012A                   C      $CONPAG$:
  012A    18             C      	db	24		; Console page length
  012B                   C      $HEXOUT$:
  012B    20             C      	db	32		; Bytes in HEX line
  012C                   C      $CLOSE$:
  012C    00             C      	db	NO		; YES is Close and ReOpen
  012D                   C      $LABEL$:
  012D    FF             C      	db	YES		; YES is label in 1st column
  012E                   C      $COND$:
  012E    00             C      	db	NO		; YES for bit 0 check only
  012F                   C      $NO.IF1$:
  012F    FF             C      	db	YES		; YES ignore IF errs in pass 1
  0130                   C      $IF.SPC$:
  0130    FF             C      	db	YES		; YES ignore IF spaces
  0131                   C      $FILL.0$:
  0131    00             C      	db	NO		; NO fills unused space with 0
  0132                   C      $EMP.CHN$:
  0132    00             C      	db	NO		; YES forces empty ext chain
  0133                   C      $ASEG$:
  0133    00             C      	db	NO		; YES default ASEG to 0000H
  0134                   C      $ORG.ABS$:
  0134    00             C      	db	NO		; YES is offset in ABS
  0135                   C      $COMM.0$:
  0135    00             C      	db	NO		; YES COMMON back to 0000H
  0136                   C      $TMP.DRV$:
  0136    00             C      	db	0		; Temporary drive (0 is curent)
  0137                   C      @SYSUSR@:
  0137    00             C      	db	0		; Alternate system user
  0138                   C      $ERASE$:
  0138    00             C      	db	NO		; YES is erase $$$.SUB on end
  0139                   C      $MS.DOS$:
  0139    00             C      	db	NO		; YES is MS DOS emulator in use
  013A                   C      $TAB.STR$:
  013A    00             C      	db	NO		; YES is allow tabs in strings
  013B                   C      $NEST$:
  013B    00             C      	db	NO		; YES is print nesting level
  013C                   C      $EIGHT$:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-6


  013C    FF             C      	db	YES		; NO is eight bits, else seven
  013D                   C      $$180:
  013D    4D 41 43       C      	db	'MAC'		; Source file extension
  0140                   C      $$REL:
  0140    52 45 4C       C      	db	'REL'		; Rel file extension
  0143                   C      $$COM:
  0143    43 4F 4D       C      	db	'COM'		; Abs binary file extension
  0146                   C      $$HEX:
  0146    48 45 58       C      	db	'HEX'		; INTEL hex file extension
  0149                   C      $$LST:
  0149    4C 53 54       C      	db	'LST'		; List file extension
  014C                   C      $$$$1:
  014C    24 24 31       C      	db	'$$1'		; Temp file extension
  014F                   C      $$SUB:
  014F    53 55 42       C      	db	'SUB'		; /I file extension
  0152                   C      $$MAC:
  0152    4C 49 42       C      	db	'LIB'		; MACLIB extension
  0155                   C      $LEAD$:
  0155    1B 51          C      	db	esc,'Q'		; Leader string to printer
  0157                   C      	ds	6,eot
  015D                   C      $TRAIL$:
  015D    1B 4E          C      	db	esc,'N'		; Trailer string to printer
  015F                   C      	ds	6,eot
                         C      ;
  0165    43 6F 70 79    C      	db	'Copyright (c) 1985-86 by SLR Systems, Butler PA'
  0169    72 69 67 68    C      
  016D    74 20 28 63    C      
  0171    29 20 31 39    C      
  0175    38 35 2D 38    C      
  0179    36 20 62 79    C      
  017D    20 53 4C 52    C      
  0181    20 53 79 73    C      
  0185    74 65 6D 73    C      
  0189    2C 20 42 75    C      
  018D    74 6C 65 72    C      
  0191    20 50 41       C      
  0194                   C      l01a7:
  0194    0D 45 78 74    C      	db	13,'Extra Operand'
  0198    72 61 20 4F    C      
  019C    70 65 72 61    C      
  01A0    6E 64          C      
  01A2                   C      l01b5:
  01A2    FF             C      	db	-1
  01A3                   C      @ZERR:
  01A3    03E3           C      	dw	@SERR		; Pointer to error
  01A5                   C      l01b8:
  01A5    04D4           C      	dw	l04e7		; Err  0
  01A7    0194           C      	dw	l01a7		; Err  1
  01A9    037A           C      	dw	l038d		; Err  2
  01AB    038D           C      	dw	l03a0		; Err  3
  01AD    039D           C      	dw	l03b0		; Err  4
  01AF    03AD           C      	dw	l03c0		; Err  5
  01B1                   C      l01c4:
  01B1    03B8           C      	dw	l03cb		; Err  6
  01B3    03C9           C      	dw	l03dc		; Err  7
  01B5    04E1           C      	dw	l04f4		; Err  8
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-7


  01B7    04F3           C      	dw	l0506		; Err  9
  01B9    04F3           C      	dw	l0506		; Err 10
  01BB    0508           C      	dw	l051b		; Err 11 --
  01BD    0519           C      	dw	l052c		; Err 12
  01BF    0532           C      	dw	l0545		; Err 13
  01C1    0543           C      	dw	l0556		; Err 14
  01C3    0552           C      	dw	l0565		; Err 15
  01C5    0561           C      	dw	l0574		; Err 16
  01C7    0572           C      	dw	l0585		; Err 17
  01C9    057F           C      	dw	l0592		; Err 18
  01CB    058D           C      	dw	l05a0		; Err 19
  01CD    0598           C      	dw	l05ab		; Err 20 --
  01CF                   C      l01e2:
  01CF    0598           C      	dw	l05ab		; Err 21
  01D1    05A6           C      	dw	l05b9		; Err 22
  01D3    05B4           C      	dw	l05c7		; Err 23
  01D5    05C3           C      	dw	l05d6		; Err 24
  01D7    05D1           C      	dw	l05e4		; Err 25 --
  01D9    05DE           C      	dw	l05f1		; Err 26
  01DB    05EB           C      	dw	l05fe		; Err 27 --
  01DD    05FA           C      	dw	l060d		; Err 28
  01DF    0608           C      	dw	l061b		; Err 29
  01E1    062A           C      	dw	l063d		; Err 30
  01E3    0646           C      	dw	l0659		; Err 31
  01E5    0652           C      	dw	l0665		; Err 32
  01E7    065D           C      	dw	l0670		; Err 33
  01E9    0000 0000      C      	dw	0,0
                         C      ;
                         C      ; Control table **MUST** start at page boundary due to indexing
                         C      ;
  01ED                   C      CtrlArr:
                         C      ;
                         C      ; ASCII control
                         C      ;
  01ED    9B 51 51 51    C      	db	09bh,051h,051h,051h	; 00 .. 03
  01F1    51 51 51 51    C      	db	051h,051h,051h,051h	; 04 .. 07
  01F5    51 9C 9D 9D    C      	db	051h,09ch,09dh,09dh	; 08 .. 0B
  01F9    9D 9B 51 51    C      	db	09dh,09bh,051h,051h	; 0C .. 0F
  01FD    51 51 51 51    C      	db	051h,051h,051h,051h	; 10 .. 13
  0201    51 51 51 51    C      	db	051h,051h,051h,051h	; 14 .. 17
  0205    51 51 A0 51    C      	db	051h,051h,0a0h,051h	; 18 .. 1B
  0209    51 51 51 51    C      	db	051h,051h,051h,051h	; 1C .. 1F
                         C      ;
                         C      ; ASCII printable
                         C      ;
  020D    9C 33 9F 34    C      	db	09ch,033h,09fh,034h	;  !"#
  0211    58 57 3F 9E    C      	db	058h,057h,03fh,09eh	; $%&'
  0215    55 52 3C 3A    C      	db	055h,052h,03ch,03ah	; ()*+
  0219    50 3B 5A 3D    C      	db	050h,03bh,05ah,03dh	; ,-./
  021D    5C 5D 5E 5F    C      	db	05ch,05dh,05eh,05fh	; 0123
  0221    60 61 62 63    C      	db	060h,061h,062h,063h	; 4567
  0225    64 65 32 9D    C      	db	064h,065h,032h,09dh	; 89:;
  0229    53 49 54 59    C      	db	053h,049h,054h,059h	; <=>?
  022D    5B 66 67 68    C      	db	05bh,066h,067h,068h	; @ABC
  0231    69 6A 6B 6C    C      	db	069h,06ah,06bh,06ch	; DEFG
  0235    6D 6E 6F 70    C      	db	06dh,06eh,06fh,070h	; HIJK
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-8


  0239    71 72 73 74    C      	db	071h,072h,073h,074h	; LMNO
  023D    75 76 77 78    C      	db	075h,076h,077h,078h	; PQRS
  0241    79 7A 7B 7C    C      	db	079h,07ah,07bh,07ch	; TUVW
  0245    7D 7E 7F 55    C      	db	07dh,07eh,07fh,055h	; XYZ[
  0249    51 52 A1 9A    C      	db	051h,052h,0a1h,09ah	; \]^_
  024D    51             C      	db	051h			; `
                         C      ;
                         C      ; Set to default or 80h..99h on conversion request
                         C      ;
  024E    66 67 68 69    C      	db	066h,067h,068h,069h	; abcd
  0252    6A 6B 6C 6D    C      	db	06ah,06bh,06ch,06dh	; efgh
  0256    6E 6F 70 71    C      	db	06eh,06fh,070h,071h	; ijkl
  025A    72 73 74 75    C      	db	072h,073h,074h,075h	; mnop
  025E    76 77 78 79    C      	db	076h,077h,078h,079h	; qrst
  0262    7A 7B 7C 7D    C      	db	07ah,07bh,07ch,07dh	; uvwx
  0266    7E 7F 55 40    C      	db	07eh,07fh,055h,040h	; yz{|
  026A    52 44 9B       C      	db	052h,044h,09bh		; }~<DEL>
                         C      ;
                         C      ; ASCII source line
                         C      ;
  026D                   C      $SRCline$:
  026D                   C      	ds	RecLng
                         C      ;
                         C      ; Control table **MUST** start at page boundary due to indexing
                         C      ; Processes prefixed tokens
                         C      ;
  02ED                   C      l0300:
  02ED                   C      TokenTab:
  02ED    0FF3           C      	dw	@OPER.1		; 53 : <
  02EF    100D           C      	dw	@OPER.2		; 54 : >
  02F1    1021           C      	dw	@PAREN		; 55 : (, [, {
  02F3    0D76           C      	dw	@STRG.1		; 56 : " (mapped)
  02F5    1EB8           C      	dw	@LABEL		; 57 : %
  02F7    1E74           C      	dw	@PC.REF		; 58 : $
  02F9    1EB8           C      	dw	@LABEL		; 59 : ?
  02FB    1F07           C      	dw	@PS.OP		; 5A : .
  02FD    1EB8           C      	dw	@LABEL		; 5B : @
  02FF    0EC3           C      	dw	@ZERO		; 5C : 0
  0301    0ECF           C      	dw	@NUMB		; 5D : 1
  0303    0ECF           C      	dw	@NUMB		; 5E : 2
  0305    0ECF           C      	dw	@NUMB		; 5F : 3
  0307    0ECF           C      	dw	@NUMB		; 60 : 4
  0309    0ECF           C      	dw	@NUMB		; 61 : 5
  030B    0ECF           C      	dw	@NUMB		; 62 : 6
  030D    0ECF           C      	dw	@NUMB		; 63 : 7
  030F    0ECF           C      	dw	@NUMB		; 64 : 8
  0311    0ECF           C      	dw	@NUMB		; 65 : 9
  0313    1752           C      	dw	@LET.A		; 66 : A
  0315    1799           C      	dw	@LET.B		; 67 : B
  0317    17B9           C      	dw	@LET.C		; 68 : C
  0319    1862           C      	dw	@LET.D		; 69 : D
  031B    18DC           C      	dw	@LET.E		; 6A : E
  031D    1EB8           C      	dw	@LABEL		; 6B : F
  031F    1988           C      	dw	@LET.G		; 6C : G
  0321    19A4           C      	dw	@LET.H		; 6D : H
  0323    19FA           C      	dw	@LET.I		; 6E : I
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-9


  0325    1ACE           C      	dw	@LET.J		; 6F : J
  0327    1EB8           C      	dw	@LABEL		; 70 : K
  0329    1ADD           C      	dw	@LET.L		; 71 : L
  032B    1B41           C      	dw	@LET.M		; 72 : M
  032D    1BD2           C      	dw	@LET.N		; 73 : N
  032F    1C1C           C      	dw	@LET.O		; 74 : O
  0331    1C80           C      	dw	@LET.P		; 75 : P
  0333    1EB8           C      	dw	@LABEL		; 76 : Q
  0335    1CE0           C      	dw	@LET.R		; 77 : R
  0337    1D92           C      	dw	@LET.S		; 78 : S
  0339    1DFA           C      	dw	@LET.T		; 79 : T
  033B    1EB8           C      	dw	@LABEL		; 7A : U
  033D    1E2A           C      	dw	@LET.V		; 7B : V
  033F    1EB8           C      	dw	@LABEL		; 7C : W
  0341    1E2F           C      	dw	@LET.X		; 7D : X
  0343    1EB8           C      	dw	@LABEL		; 7E : Y
  0345    1E48           C      	dw	@LET.Z		; 7F : Z
  0347    1EB8           C      	dw	@LABEL		; 80 : a
  0349                   C      $END.PASS:
  0349    45 6E 64 20    C      	db	'End of file Pass '
  034D    6F 66 20 66    C      
  0351    69 6C 65 20    C      
  0355    50 61 73 73    C      
  0359    20             C      
  035A                   C      $PASS:
  035A    31 0D 0A FF    C      	db	'1',cr,lf,eot
                         C      ;
                         C      ; Opcode execution table - indexed by type of op code
                         C      ;
  035E                   C      OpExTab:
  035E    2AA0           C      	dw	jp.ind.r	;  0	Special code
  0360    2AA6           C      	dw	l2b01		;  1	One byte opcode
  0362    2AAA           C      	dw	l2b05		;  2	Two byte opcode
  0364    2AAF           C      	dw	l2b0a		;  3	CALL
  0366    2AD2           C      	dw	l2b2d		;  4	Shift codes
  0368    2AF7           C      	dw	l2b52		;  5	Math codes 8 and 16 bit
  036A    2B63           C      	dw	l2bbe		;  6	Math codes 8 and 16 bit
  036C    2BA1           C      	dw	l2bfc		;  7	Math and logical codes
  036E    2BA5           C      	dw	l2c00		;  8	Bit codes
  0370    2BD5           C      	dw	l2c30		;  9	DEC and INC codes
  0372    2C03           C      	dw	l2c5e		; 10	JP
  0374    2C33           C      	dw	l2c8e		; 11	POP and PUSH code
  0376    2C4F           C      	dw	l2caa		; 12	Set variable TRUE
  0378    2C57           C      	dw	l2cb2		; 13	Set variable FALSE
  037A                   C      l038d:
  037A    12 50 72 65    C      	db	18,'Previously Defined'
  037E    76 69 6F 75    C      
  0382    73 6C 79 20    C      
  0386    44 65 66 69    C      
  038A    6E 65 64       C      
  038D                   C      l03a0:
  038D    0F 53 79 6D    C      	db	15,'Symbol Expected'
  0391    62 6F 6C 20    C      
  0395    45 78 70 65    C      
  0399    63 74 65 64    C      
  039D                   C      l03b0:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-10


  039D    0F 42 61 64    C      	db	15,'Bad Dummy Param'
  03A1    20 44 75 6D    C      
  03A5    6D 79 20 50    C      
  03A9    61 72 61 6D    C      
  03AD                   C      l03c0:
  03AD    0A 42 61 64    C      	db	10,'Bad Opcode'
  03B1    20 4F 70 63    C      
  03B5    6F 64 65       C      
  03B8                   C      l03cb:
  03B8    10 49 6C 6C    C      	db	16,'Illegal - 0 Used'
  03BC    65 67 61 6C    C      
  03C0    20 2D 20 30    C      
  03C4    20 55 73 65    C      
  03C8    64             C      
  03C9                   C      l03dc:
  03C9    19 4E 6F 20    C      	db	25,'No Backing Up in COM File'
  03CD    42 61 63 6B    C      
  03D1    69 6E 67 20    C      
  03D5    55 70 20 69    C      
  03D9    6E 20 43 4F    C      
  03DD    4D 20 46 69    C      
  03E1    6C 65          C      
  03E3                   C      @SERR:
  03E3                   C      	ds	10
  03ED                   C      l0400:
  03ED                   C      	ds	16
  03FD                   C      	ds	6,MSB
  0403    00             C      	db	0
  0404                   C      	ds	18,MSB
  0416                   C      	ds	21,0
  042B    80             C      	db	MSB
  042C                   C      	ds	3,0
  042F                   C      	ds	3,MSB
  0432    00             C      	db	0
  0433                   C      	ds	2,MSB
  0435    00             C      	db	0
  0436                   C      	ds	7,MSB
  043D                   C      	ds	8,0
  0445                   C      	ds	143,MSB
  04D4                   C      l04e7::
  04D4    0C 53 79 6E    C      	db	12,'Syntax Error'
  04D8    74 61 78 20    C      
  04DC    45 72 72 6F    C      
  04E0    72             C      
  04E1                   C      l04f4:
  04E1    11 42 79 74    C      	db	17,'Byte Out of Range'
  04E5    65 20 4F 75    C      
  04E9    74 20 6F 66    C      
  04ED    20 52 61 6E    C      
  04F1    67 65          C      
  04F3                   C      l0506:
  04F3    14 49 6E 74    C      	db	20,'Intermediate Corrupt'
  04F7    65 72 6D 65    C      
  04FB    64 69 61 74    C      
  04FF    65 20 43 6F    C      
  0503    72 72 75 70    C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-11


  0507    74             C      
  0508                   C      l051b:
  0508    10 45 78 70    C      	db	16,'Expression Error'
  050C    72 65 73 73    C      
  0510    69 6F 6E 20    C      
  0514    45 72 72 6F    C      
  0518    72             C      
  0519                   C      l052c:
  0519    18 49 6C 6C    C      	db	24,'Illegal in Absolute File'
  051D    65 67 61 6C    C      
  0521    20 69 6E 20    C      
  0525    41 62 73 6F    C      
  0529    6C 75 74 65    C      
  052D    20 46 69 6C    C      
  0531    65             C      
  0532                   C      l0545:
  0532    10 54 6F 6F    C      	db	16,'Too Many Commons'
  0536    20 4D 61 6E    C      
  053A    79 20 43 6F    C      
  053E    6D 6D 6F 6E    C      
  0542    73             C      
  0543                   C      l0556:
  0543    0E 46 69 6C    C      	db	14,'File Not Found'
  0547    65 20 4E 6F    C      
  054B    74 20 46 6F    C      
  054F    75 6E 64       C      
  0552                   C      l0565:
  0552    0E 4D 69 73    C      	db	14,'Missing .PHASE'
  0556    73 69 6E 67    C      
  055A    20 2E 50 48    C      
  055E    41 53 45       C      
  0561                   C      l0574:
  0561    10 4D 69 73    C      	db	16,'Missing .DEPHASE'
  0565    73 69 6E 67    C      
  0569    20 2E 44 45    C      
  056D    50 48 41 53    C      
  0571    45             C      
  0572                   C      l0585:
  0572    0C 4D 69 73    C      	db	12,'Missing ENDM'
  0576    73 69 6E 67    C      
  057A    20 45 4E 44    C      
  057E    4D             C      
  057F                   C      l0592:
  057F    0D 4D 69 73    C      	db	13,'Missing MACRO'
  0583    73 69 6E 67    C      
  0587    20 4D 41 43    C      
  058B    52 4F          C      
  058D                   C      l05a0:
  058D    0A 4D 69 73    C      	db	10,'Missing IF'
  0591    73 69 6E 67    C      
  0595    20 49 46       C      
  0598                   C      l05ab:
  0598    0D 4D 69 73    C      	db	13,'Missing ENDIF'
  059C    73 69 6E 67    C      
  05A0    20 45 4E 44    C      
  05A4    49 46          C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-12


  05A6                   C      l05b9:
  05A6    0D 42 61 64    C      	db	13,'Bad File Name'
  05AA    20 46 69 6C    C      
  05AE    65 20 4E 61    C      
  05B2    6D 65          C      
  05B4                   C      l05c7:
  05B4    0E 43 6F 6D    C      	db	14,'Comma Expected'
  05B8    6D 61 20 45    C      
  05BC    78 70 65 63    C      
  05C0    74 65 64       C      
  05C3                   C      l05d6:
  05C3    0D 53 74 72    C      	db	13,'String Syntax'
  05C7    69 6E 67 20    C      
  05CB    53 79 6E 74    C      
  05CF    61 78          C      
  05D1                   C      l05e4:
  05D1    0C 27 29 27    C      	db	12,''')'' Expected'
  05D5    20 45 78 70    C      
  05D9    65 63 74 65    C      
  05DD    64             C      
  05DE                   C      l05f1:
  05DE    0C 27 2F 27    C      	db	12,'''/'' Expected'
  05E2    20 45 78 70    C      
  05E6    65 63 74 65    C      
  05EA    64             C      
  05EB                   C      l05fe:
  05EB    0E 55 6E 65    C      	db	14,'Unexpected EOF'
  05EF    78 70 65 63    C      
  05F3    74 65 64 20    C      
  05F7    45 4F 46       C      
  05FA                   C      l060d:
  05FA    0D 4C 69 6E    C      	db	13,'Line Too Long'
  05FE    65 20 54 6F    C      
  0602    6F 20 4C 6F    C      
  0606    6E 67          C      
  0608                   C      l061b:
  0608    21 29 2C 20    C      	db	33,'), Bin-Op, or End of Exp Expected'
  060C    42 69 6E 2D    C      
  0610    4F 70 2C 20    C      
  0614    6F 72 20 45    C      
  0618    6E 64 20 6F    C      
  061C    66 20 45 78    C      
  0620    70 20 45 78    C      
  0624    70 65 63 74    C      
  0628    65 64          C      
  062A                   C      l063d:
  062A    1B 49 44 2C    C      	db	27,'ID, (, or Unary Op Expected'
  062E    20 28 2C 20    C      
  0632    6F 72 20 55    C      
  0636    6E 61 72 79    C      
  063A    20 4F 70 20    C      
  063E    45 78 70 65    C      
  0642    63 74 65 64    C      
  0646                   C      l0659:
  0646    0B 4D 61 63    C      	db	11,'Macro Redef'
  064A    72 6F 20 52    C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-13


  064E    65 64 65 66    C      
  0652                   C      l0665:
  0652    0A 42 61 64    C      	db	10,'Bad Number'
  0656    20 4E 75 6D    C      
  065A    62 65 72       C      
  065D                   C      l0670:
  065D    09 4D 69 73    C      	db	9,'Missing :'
  0661    73 69 6E 67    C      
  0665    20 3A          C      
  0667                   C      $FF:
  0667    0D 0C FF       C      	db	cr,ff,eot
  066A                   C      l067d:
  066A    09 09 20 20    C      	db	tab,tab,'  '
  066E                   C      l0681:
  066E    CD 0DA2        C      	call	l0dbc
  0671    18 38          C      	jr	l06be
  0673                   C      l0686:
  0673    CD 07D4        C      	call	l07ee
  0676    18 09          C      	jr	.ProcSRC
  0678                   C      l068b::
  0678    CD 07D7        C      	call	l07f1
  067B    18 04          C      	jr	.ProcSRC
                         C      ;
                         C      ; Process source file
                         C      ;
  067D                   C      ProcSRC:
  067D    ED 73 6845     C      	ld	(SRC.stk),sp	; Save entry stack
  0681                   C      .ProcSRC:
  0681    AF             C      	xor	a
  0682    32 67CD        C      	ld	(l6840),a	; Clear a bit
  0685    CD 14BC        C      	call	GetLine		; Read line, get tokens
  0688    AF             C      	xor	a
  0689    32 67DA        C      	ld	(l684d),a
  068C    32 6806        C      	ld	(l6879),a
  068F    32 6818        C      	ld	(l688b),a
  0692    FD 22 67F2     C      	ld	(l6865),iy
  0696    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
  0699    23             C      	inc	hl
  069A    7E             C      	ld	a,(hl)		; Get token
  069B    FE 35          C      	cp	35h		; Test space
  069D    28 05          C      	jr	z,l06b7		; .. yeap
  069F    3E FF          C      	ld	a,-1
  06A1    32 6818        C      	ld	(l688b),a
  06A4                   C      l06b7:
  06A4    CD 0DA2        C      	call	l0dbc
  06A7    FE 38          C      	cp	38h		; Test ???
  06A9    28 C3          C      	jr	z,l0681
  06AB                   C      l06be:
  06AB    FE 39          C      	cp	39h		; .. or ????
  06AD    28 06          C      	jr	z,l06c8
  06AF    FE 36          C      	cp	36h		; .. or new line
  06B1    28 C0          C      	jr	z,l0686
  06B3    18 08          C      	jr	l06d0
  06B5                   C      l06c8:
  06B5    7E             C      	ld	a,(hl)
  06B6    FE F0          C      	cp	0f0h
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-14


  06B8    20 5B          C      	jr	nz,l072f
  06BA    22 682F        C      	ld	(l68a2),hl
  06BD                   C      l06d0:
  06BD    C5             C      	push	bc
  06BE    2A 6376        C      	ld	hl,(TokStrt)	; Get token start pointer
  06C1    E5             C      	push	hl
  06C2    CD 0DB0        C      	call	l0dca		; .. process ???
  06C5    22 6804        C      	ld	(l6877),hl
  06C8    FE 39          C      	cp	39h		; Test ???
  06CA    28 1A          C      	jr	z,l06f9
  06CC    32 6806        C      	ld	(l6879),a	; .. save token
  06CF    FE 32          C      	cp	32h		; Test :
  06D1    28 1A          C      	jr	z,l0700
  06D3    FE B8          C      	cp	0b8h		; .. MACRO
  06D5    28 16          C      	jr	z,l0700
  06D7    FE B3          C      	cp	0b3h		; .. EQU
  06D9    28 12          C      	jr	z,l0700
  06DB    FE AA          C      	cp	0aah		; .. ASET
  06DD    28 0E          C      	jr	z,l0700
  06DF                   C      l06f2:
  06DF    E1             C      	pop	hl
  06E0    C1             C      	pop	bc
  06E1    2A 682F        C      	ld	hl,(l68a2)
  06E4    18 6D          C      	jr	l076d
  06E6                   C      l06f9:
  06E6    3E FF          C      	ld	a,-1
  06E8    32 6806        C      	ld	(l6879),a
  06EB    18 F2          C      	jr	l06f2
  06ED                   C      l0700:
  06ED    D1             C      	pop	de		; Get back pointer
  06EE    E1             C      	pop	hl		; .. and token
  06EF    3A 6809        C      	ld	a,(l687c)
  06F2    B7             C      	or	a
  06F3    20 20          C      	jr	nz,l072f
  06F5    3D             C      	dec	a
  06F6    32 6818        C      	ld	(l688b),a
  06F9    7D             C      	ld	a,l
  06FA    FE 39          C      	cp	39h		; Test special
  06FC    2A 682F        C      	ld	hl,(l68a2)
  06FF    28 14          C      	jr	z,l072f		; .. yeap
  0701    6F             C      	ld	l,a		; Set index
  0702    AF             C      	xor	a
  0703    32 6806        C      	ld	(l6879),a
                         C      ;	ld	h,HIGH l0400
                         C      ;	bit	7,(hl)		; Test bit
                         C      ;	jp	z,l07c5		; .. nope
  0706    1A             C      	ld	a,(de)
  0707    FE 57          C      	cp	57h		; Test range
  0709    DA 07AB        C      	jp	c,l07c5		; .. letters
  070C    CB F6          C      	set	6,(hl)		; Set bit
  070E    EB             C      	ex	de,hl
  070F    22 6376        C      	ld	(TokStrt),hl	; Set token start pointer
  0712    CD 0FBE        C      	call	GetLabel	; Get label
  0715                   C      l072f:
  0715    22 67D8        C      	ld	(l684b),hl
  0718    FD 22 67DB     C      	ld	(l684e),iy
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-15


  071C    3A 67F1        C      	ld	a,($REL$)	; Get REL mode
  071F    32 67DA        C      	ld	(l684d),a
  0722    CD 0DA2        C      	call	l0dbc
  0725    FE 32          C      	cp	32h		; Test :
  0727    20 25          C      	jr	nz,l0768
  0729    3E FF          C      	ld	a,-1
  072B    32 6818        C      	ld	(l688b),a
  072E    CD 0DA2        C      	call	l0dbc
  0731    FE 32          C      	cp	32h		; .. 2nd :
  0733    20 19          C      	jr	nz,l0768
  0735    3A 6809        C      	ld	a,(l687c)
  0738    B7             C      	or	a
  0739    20 10          C      	jr	nz,l0765	; .. nope
  073B    2A 67D8        C      	ld	hl,(l684b)
  073E    7E             C      	ld	a,(hl)
  073F    FE F0          C      	cp	0f0h
  0741    20 05          C      	jr	nz,l0762
  0743    23             C      	inc	hl
  0744    5E             C      	ld	e,(hl)
  0745    23             C      	inc	hl
  0746    56             C      	ld	d,(hl)
  0747    EB             C      	ex	de,hl
  0748                   C      l0762:
  0748    CD 42BF        C      	call	l431a
  074B                   C      l0765:
  074B    CD 0DA2        C      	call	l0dbc
  074E                   C      l0768:
  074E    FE 36          C      	cp	36h		; Test new line
  0750    CA 0673        C      	jp	z,l0686		; .. yeap
  0753                   C      l076d:
  0753    3A 6809        C      	ld	a,(l687c)
  0756    B7             C      	or	a
  0757    79             C      	ld	a,c		; Get token
  0758    28 20          C      	jr	z,l0794
  075A    FE B5          C      	cp	0b5h		; .. test IF
  075C    28 17          C      	jr	z,l078f
  075E    FE AE          C      	cp	0aeh		; .. ?????
  0760    28 18          C      	jr	z,l0794
  0762    FE B0          C      	cp	0b0h		; .. ENDIF
  0764    28 14          C      	jr	z,l0794
  0766    FE D6          C      	cp	0d6h		; .. range
  0768    38 04          C      	jr	c,l0788
  076A    FE E0          C      	cp	0e0h		; .. range
  076C    38 07          C      	jr	c,l078f
  076E                   C      l0788:
  076E    FE 37          C      	cp	37h		; Test end of file
  0770    CC 0991        C      	call	z,EndOfFile	; .. process it
  0773    18 30          C      	jr	l07bf
  0775                   C      l078f:
  0775    CD 450C        C      	call	l4567
  0778    18 2B          C      	jr	l07bf
  077A                   C      l0794:
  077A    FE 39          C      	cp	39h		; Test ???
  077C    20 08          C      	jr	nz,l07a0
  077E    7E             C      	ld	a,(hl)
  077F    FE F0          C      	cp	0f0h
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-16


  0781    CA 3043        C      	jp	z,l309e
  0784    18 34          C      	jr	l07d4
  0786                   C      l07a0:
  0786    D6 58          C      	sub	58h		; Strip off offset
  0788    FE 8F          C      	cp	0e6h-58h+1	; .. test range
  078A    30 2E          C      	jr	nc,l07d4	; .. no opcode
  078C    4F             C      	ld	c,a
  078D    06 00          C      	ld	b,0
  078F    21 1095        C      	ld	hl,OpCodTab	; Get opcode table
  0792    09             C      	add	hl,bc		; Get index *3
  0793    09             C      	add	hl,bc
  0794    09             C      	add	hl,bc
  0795    7E             C      	ld	a,(hl)		; .. fetch type as index
  0796    23             C      	inc	hl
  0797    EB             C      	ex	de,hl
  0798    87             C      	add	a,a		; .. *2
  0799    4F             C      	ld	c,a
  079A    21 035E        C      	ld	hl,OpExTab
  079D    09             C      	add	hl,bc		; Point to entry
  079E    7E             C      	ld	a,(hl)		; Fetch address
  079F    23             C      	inc	hl
  07A0    66             C      	ld	h,(hl)
  07A1    6F             C      	ld	l,a
  07A2    CD 08F4        C      	call	jp.r.1		; .. execute
  07A5                   C      l07bf:
  07A5    CD 07D1        C      	call	l07eb
  07A8    C3 0681        C      	jp	.ProcSRC	; .. loop
  07AB                   C      l07c5:
  07AB    0E 03          C      	ld	c,3
  07AD                   C      l07c7:
  07AD    21 0000        C      	ld	hl,0
  07B0    22 67D8        C      	ld	(l684b),hl
  07B3    C3 0905        C      	jp	ERROR
  07B6                   C      l07d0:
  07B6    0E 02          C      	ld	c,2
  07B8    18 F3          C      	jr	l07c7
  07BA                   C      l07d4:
  07BA    79             C      	ld	a,c		
  07BB    FE 3C          C      	cp	3ch		; Test * prefix
  07BD    20 07          C      	jr	nz,l07e0
  07BF    CD 0DCB        C      	call	.PartToken	; Get token
  07C2    FE BF          C      	cp	0bfh		; Test EJECT
  07C4    28 C0          C      	jr	z,l07a0		; .. ok
  07C6                   C      l07e0:
  07C6    79             C      	ld	a,c
  07C7    FE 37          C      	cp	37h		; Must be end of file
  07C9    CC 0991        C      	call	z,EndOfFile
  07CC    0E 05          C      	ld	c,5
  07CE    C3 0905        C      	jp	ERROR
  07D1                   C      l07eb:
  07D1    CD 07DA        C      	call	l07f4
  07D4                   C      l07ee:
  07D4    CD 07FD        C      	call	l0817
  07D7                   C      l07f1:
  07D7    C3 6352        C      	jp	l63c5
  07DA                   C      l07f4:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-17


  07DA    3A 6809        C      	ld	a,(l687c)
  07DD    B7             C      	or	a
  07DE    C0             C      	ret	nz
  07DF    3A 67CD        C      	ld	a,(l6840)
  07E2    B7             C      	or	a
  07E3    0E 18          C      	ld	c,24
  07E5    C4 08F5        C      	call	nz,.ERROR
  07E8    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
  07EB    7E             C      	ld	a,(hl)
  07EC    FE 36          C      	cp	'6'
  07EE    C8             C      	ret	z
  07EF    CD 0DCB        C      	call	.PartToken
  07F2    FE 36          C      	cp	'6'
  07F4    C8             C      	ret	z
  07F5    FE 37          C      	cp	'7'
  07F7    C8             C      	ret	z
  07F8    0E 01          C      	ld	c,1
  07FA    C3 08F5        C      	jp	.ERROR
  07FD                   C      l0817:
  07FD    2A 67D8        C      	ld	hl,(l684b)
  0800    7C             C      	ld	a,h
  0801    B5             C      	or	l
  0802    C8             C      	ret	z
  0803    3A 6809        C      	ld	a,(l687c)
  0806    B7             C      	or	a
  0807    20 6C          C      	jr	nz,l088f
  0809    3A 67DA        C      	ld	a,(l684d)
  080C    FE F0          C      	cp	0f0h
  080E    20 05          C      	jr	nz,l082f
  0810    BE             C      	cp	(hl)
  0811    28 62          C      	jr	z,l088f
  0813    18 2D          C      	jr	l085c
  0815                   C      l082f:
  0815    CD 4302        C      	call	l435d
  0818    B7             C      	or	a
  0819    FA 0827        C      	jp	m,l0841
  081C    E6 0F          C      	and	0fh
  081E    FE 0F          C      	cp	0fh
  0820    20 20          C      	jr	nz,l085c
  0822    36 00          C      	ld	(hl),0
  0824    3C             C      	inc	a
  0825    18 0C          C      	jr	l084d
  0827                   C      l0841:
  0827    E5             C      	push	hl
  0828    23             C      	inc	hl
  0829    5E             C      	ld	e,(hl)
  082A    23             C      	inc	hl
  082B    56             C      	ld	d,(hl)
  082C    2A 67DB        C      	ld	hl,(l684e)
  082F    B7             C      	or	a
  0830    ED 52          C      	sbc	hl,de
  0832    E1             C      	pop	hl
  0833                   C      l084d:
  0833    28 0D          C      	jr	z,l085c
  0835    E5             C      	push	hl
  0836    0E 02          C      	ld	c,2
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-18


  0838    CD 08F5        C      	call	.ERROR
  083B    E1             C      	pop	hl
  083C    3A 6617        C      	ld	a,(Pass)	; Get pass
  083F    B7             C      	or	a
  0840    28 33          C      	jr	z,l088f		; .. 1st pass
  0842                   C      l085c:
  0842    3A 67DA        C      	ld	a,(l684d)
  0845    4F             C      	ld	c,a
  0846    7E             C      	ld	a,(hl)
  0847    E6 F0          C      	and	0f0h
  0849    F6 80          C      	or	80h
  084B    B1             C      	or	c
  084C    77             C      	ld	(hl),a
  084D    22 67D8        C      	ld	(l684b),hl
  0850    32 67DA        C      	ld	(l684d),a
  0853    23             C      	inc	hl
  0854    ED 5B 67DB     C      	ld	de,(l684e)
  0858    73             C      	ld	(hl),e
  0859    23             C      	inc	hl
  085A    72             C      	ld	(hl),d
  085B    3A 6818        C      	ld	a,(l688b)
  085E    B7             C      	or	a
  085F    20 09          C      	jr	nz,l0884
  0861    3A 012D        C      	ld	a,($LABEL$)	; Test label in 1st column
  0864    B7             C      	or	a
  0865    0E 21          C      	ld	c,33
  0867    C4 08F5        C      	call	nz,.ERROR	; .. error if so
  086A                   C      l0884:
  086A    3A 6617        C      	ld	a,(Pass)	; Get pass
  086D    3D             C      	dec	a
  086E    20 05          C      	jr	nz,l088f	; .. not 1st pass
  0870    2A 67D8        C      	ld	hl,(l684b)
  0873    CB E6          C      	set	4,(hl)
  0875                   C      l088f:
  0875    21 0000        C      	ld	hl,0
  0878    22 67D8        C      	ld	(l684b),hl
  087B    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  087C                   C      l0896:
  087C    CD 0895        C      	call	l08af
  087F    21 68AC        C      	ld	hl,l691f
  0882    CD 5FA8        C      	call	PrStrg		; Print
  0885    3A 07D7        C      	ld	a,(l07f1)
  0888    FE C9          C      	cp	_RET
  088A    21 026D        C      	ld	hl,$SRCline$	; Get line
  088D    20 03          C      	jr	nz,l08ac
  088F    21 08F1        C      	ld	hl,l090b	; .. new line if RET
  0892                   C      l08ac:
  0892    C3 5FA8        C      	jp	PrStrg		; Print
                         C      ;
                         C      ; Print line if printer enabled
                         C      ;
  0895                   C      l08af:
  0895    C9             C      	ret
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-19


  0896    21 661C        C      	ld	hl,l668f
  0899    34             C      	inc	(hl)		; Bump page count
  089A    3A 62C2        C      	ld	a,(_LST.PAG_)	; Get max
  089D    BE             C      	cp	(hl)
  089E    D0             C      	ret	nc		; .. not yet reached
  089F    36 03          C      	ld	(hl),3		; .. init for header
  08A1    21 62C6        C      	ld	hl,_FF_
  08A4    7E             C      	ld	a,(hl)		; Test form feed at start
  08A5    B7             C      	or	a
  08A6    20 03          C      	jr	nz,l08c5	; .. yeap
  08A8    35             C      	dec	(hl)
  08A9    18 06          C      	jr	l08cb
  08AB                   C      l08c5:
  08AB    21 0667        C      	ld	hl,$FF
  08AE    CD 5FA8        C      	call	PrStrg		; Print form feed
  08B1                   C      l08cb:
  08B1    21 6378        C      	ld	hl,l63eb
  08B4    CD 5FA8        C      	call	PrStrg		; Print
  08B7    21 69FB        C      	ld	hl,l6a6e
  08BA    CD 5FA8        C      	call	PrStrg		; Print
  08BD    3A 0121        C      	ld	a,($TOD.ENA$)	; Test TOD to be inserted
  08C0    B7             C      	or	a
  08C1    28 09          C      	jr	z,l08e6		; .. nope
  08C3    CD 61D1        C      	call	Get$TOD		; Get ASCII format
  08C6    21 6A20        C      	ld	hl,$TOD$
  08C9    CD 5FA8        C      	call	PrStrg		; Print time and date
  08CC                   C      l08e6:
  08CC    21 6799        C      	ld	hl,l680a+2
  08CF    CD 0CAA        C      	call	IncBCD		; Increment value
  08D2    21 6798        C      	ld	hl,l680b
  08D5    3E 03          C      	ld	a,3
  08D7    11 296F        C      	ld	de,l29c1
  08DA    CD 33A2        C      	call	BCDtoASC.	; Convert to ASCII
  08DD    21 295E        C      	ld	hl,l29b0
  08E0    CD 5FA8        C      	call	PrStrg		; Print
  08E3    21 63C9        C      	ld	hl,@MES@
  08E6    CD 5FA8        C      	call	PrStrg		; Print message
  08E9    21 08EF        C      	ld	hl,l0909
  08EC    C3 5FA8        C      	jp	PrStrg		; Print
  08EF                   C      l0909:
  08EF    0D 0A          C      	db	cr,lf
  08F1                   C      l090b:
  08F1    0D 0A FF       C      	db	cr,lf,eot
                         C      ;
                         C      ; Jump via register
                         C      ; ENTRY	Reg HL holds address to be executed
                         C      ;
  08F4                   C      jp.r.1:
  08F4    E9             C      	jp	(hl)
                         C      ;
                         C      ; Process error
                         C      ; ENTRY	Reg C holds error number
                         C      ;
  08F5                   C      .ERROR:
  08F5    21 01A5        C      	ld	hl,l01b8	; Get error table
  08F8    06 00          C      	ld	b,0
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-20


  08FA    09             C      	add	hl,bc
  08FB    09             C      	add	hl,bc		; .. get index
  08FC    7E             C      	ld	a,(hl)		; Fetch address
  08FD    23             C      	inc	hl
  08FE    66             C      	ld	h,(hl)
  08FF    6F             C      	ld	l,a
  0900    C3 5D8E        C      	jp	ERROR?		; .. process it on pass 2
                         C      ;
                         C      ; Most frequented error : Syntax Error
                         C      ;
  0903                   C      SyntaxErr:
  0903    0E 00          C      	ld	c,0
  0905                   C      ERROR:
  0905    CD 08F5        C      	call	.ERROR
  0908                   C      l0922:
  0908    21 62F1        C      	ld	hl,l6364
  090B    22 62F5        C      	ld	(TokPtr),hl	; Init token
  090E    ED 7B 6845     C      	ld	sp,(SRC.stk)	; Get entry stack
  0912    CD 07D4        C      	call	l07ee
  0915    C3 0681        C      	jp	.ProcSRC	; .. get next
                         C      ;
                         C      ; *********************************
                         C      ; *** ENTRY OF HARD WORKING SLR ***
                         C      ; *********************************
                         C      ;
  0918                   C      GO.SLR::
  0918    21 62C3        C      	ld	hl,_OPT_	; Get option
  091B    7E             C      	ld	a,(hl)
  091C    E6 0A          C      	and	@C.P@		; Mask list bits
  091E    FE 0A          C      	cp	@C.P@
  0920    7E             C      	ld	a,(hl)
  0921    20 03          C      	jr	nz,l0940	; Not cross ref on one pass
  0923    EE 03          C      	xor	@P.F@		; Toggle mode
  0925    77             C      	ld	(hl),a
  0926                   C      l0940:
  0926    E6 09          C      	and	@C.F@		; Test list again
  0928    C2 0A28        C      	jp	nz,l0a42	; .. cross ref or full
  092B    3E 02          C      	ld	a,2
  092D    32 6617        C      	ld	(Pass),a	; Set one pass only
  0930    3E C9          C      	ld	a,_RET
  0932    32 1464        C      	ld	($CrsEna),a	; Disable cross reference
  0935    21 12F6        C      	ld	hl,l1310
  0938    CD 0B5F        C      	call	Set.jp.tab	; Init jump table
  093B    CD 0B4F        C      	call	EnaXXX?		; .. another one
  093E    3A 62C3        C      	ld	a,(_OPT_)
  0941    E6 02          C      	and	1 SHL _PASS	; Test one pass
  0943    20 03          C      	jr	nz,l0962	; .. yeap
  0945    CD 0969        C      	call	DisXXX?		; Disable ????
  0948                   C      l0962:
  0948    CD 067D        C      	call	ProcSRC		; Process source file
  094B    CD 0B68        C      	call	SetFileTab	; Set file table
  094E    CD 0969        C      	call	DisXXX?		; Disable ????
  0951    21 6617        C      	ld	hl,Pass
  0954    34             C      	inc	(hl)		; Bump pass
  0955    CD 502B        C      	call	l5086
  0958                   C      l0972:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-21


  0958    3E FF          C      	ld	a,eot
  095A    32 63C9        C      	ld	(@MES@),a	; .. set no message
  095D    CD 0B4F        C      	call	EnaXXX?		; Init jump table
  0960    CD 5B09        C      	call	l5b64
  0963    CD 0BC5        C      	call	l0bdf
  0966    C3 0B87        C      	jp	EndOfASM	; .. that's it
                         C      ;
                         C      ; Disable ?????
                         C      ;
  0969                   C      DisXXX?:
  0969    3E C9          C      	ld	a,_RET		; Set immediate return
  096B    32 0895        C      	ld	(l08af),a
  096E    21 1365        C      	ld	hl,l137f
  0971    11 634C        C      	ld	de,l63bf
  0974    01 0015        C      	ld	bc,l1394-l137f
  0977    ED B0          C      	ldir
  0979    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  097A                   C      l0994:
  097A    7E             C      	ld	a,(hl)
  097B    36 00          C      	ld	(hl),0
  097D    23             C      	inc	hl
  097E    B6             C      	or	(hl)
  097F    36 00          C      	ld	(hl),0
  0981    C8             C      	ret	z
  0982    AF             C      	xor	a
  0983    32 6809        C      	ld	(l687c),a
  0986    21 0DE5        C      	ld	hl,.FullToken
  0989    22 0DE3        C      	ld	($GetVec),hl	; Set token routine
  098C    0E 15          C      	ld	c,21
  098E    C3 08F5        C      	jp	.ERROR
                         C      ;
                         C      ; >>> END OF FILE <<<
                         C      ;
  0991                   C      EndOfFile:
  0991    21 67F8        C      	ld	hl,l686b
  0994    CD 097A        C      	call	l0994
  0997    21 67D1        C      	ld	hl,l6844
  099A    CD 097A        C      	call	l0994
  099D    21 0349        C      	ld	hl,$END.PASS
  09A0    CD 6134        C      	call	PutStr		; Print end of this pass
  09A3    CD 3FE6        C      	call	l4041
  09A6    2A 6618        C      	ld	hl,(ABS.ORG)	; Get origin
  09A9    23             C      	inc	hl
  09AA    7C             C      	ld	a,h		; Test wrap
  09AB    B5             C      	or	l
  09AC    20 0C          C      	jr	nz,l09d4	; .. nope
  09AE    CD 0A1D        C      	call	l0a37
  09B1    21 0100        C      	ld	hl,TPA
  09B4    28 01          C      	jr	z,l09d1
  09B6    25             C      	dec	h
  09B7                   C      l09d1:
  09B7    22 6618        C      	ld	(ABS.ORG),hl	; .. set origin
  09BA                   C      l09d4:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-22


  09BA    3A 6617        C      	ld	a,(Pass)	; Get pass
  09BD    B7             C      	or	a
  09BE    28 5B          C      	jr	z,l0a35		; .. 1st pass
  09C0    FE 01          C      	cp	1
  09C2    28 05          C      	jr	z,l09e3		; .. 2nd pass
  09C4    3E FE          C      	ld	a,0feh
  09C6    CD 6322        C      	call	l6395
  09C9                   C      l09e3:
  09C9    CD 618F        C      	call	push.r		; Push regs
  09CC    3A 6801        C      	ld	a,(CurUsr)	; Get user
  09CF    CD 6179        C      	call	SetUsr		; .. log it
  09D2    ED 5B 67F4     C      	ld	de,(CurFCB)	; Get FCB
  09D6    0E 10          C      	ld	c,.close
  09D8    CD 0005        C      	call	BDOS		; Close file
  09DB    3A 6844        C      	ld	a,(LogUsr.)
  09DE    CD 6179        C      	call	SetUsr		; Log user
  09E1    CD 61AE        C      	call	pop.r		; Pop regs
  09E4    3A 67CE        C      	ld	a,(l6841)
  09E7    B7             C      	or	a
  09E8    28 31          C      	jr	z,l0a35
  09EA    01 03ED        C      	ld	bc,l0400
  09ED    CD 229A        C      	call	d.alloc_	; Allocate memory
  09F0    22 67CF        C      	ld	(l6842),hl
  09F3    CD 618F        C      	call	push.r		; Push regs
  09F6    3A 688B        C      	ld	a,($$FCB$$)	; Get disk
  09F9    3D             C      	dec	a		; .. fix
  09FA    CD 6180        C      	call	SetDsk		; .. log it
  09FD    0E 10          C      	ld	c,.close
  09FF    11 688B        C      	ld	de,$$FCB$$
  0A02    CD 0005        C      	call	BDOS		; Close file
  0A05    AF             C      	xor	a
  0A06    32 6897        C      	ld	($$FCB$$+_EXT),a; Clear extent
  0A09    11 688B        C      	ld	de,$$FCB$$
  0A0C    0E 0F          C      	ld	c,.open
  0A0E    CD 0005        C      	call	BDOS		; Re-open file
  0A11    CD 61AE        C      	call	pop.r		; Pop regs
  0A14    AF             C      	xor	a
  0A15    32 6897        C      	ld	($$FCB$$+_EXT),a; Clear extent
  0A18    32 68AB        C      	ld	($$FCB$$+_CR),a	; .. current record
  0A1B                   C      l0a35:
  0A1B    E1             C      	pop	hl
  0A1C    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  0A1D                   C      l0a37:
  0A1D    3A 62C3        C      	ld	a,(_OPT_)	; Get option
  0A20    CB 7F          C      	bit	_REL,a		; Test relocatable
  0A22    C8             C      	ret	z		; .. nope
  0A23    3A 0133        C      	ld	a,($ASEG$)	; Zero is 0100H on ABS
  0A26    B7             C      	or	a
  0A27    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  0A28                   C      l0a42:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-23


  0A28    21 1323        C      	ld	hl,l133d
  0A2B    CD 0B5F        C      	call	Set.jp.tab	; Init jump table
  0A2E    21 2385        C      	ld	hl,NoMemory	; Init error vector
  0A31    22 22FE        C      	ld	(@MEMER@),hl
  0A34    AF             C      	xor	a
  0A35    32 6617        C      	ld	(Pass),a	; Set 1st pass
  0A38    01 0050        C      	ld	bc,l0050
  0A3B    CD 229A        C      	call	d.alloc_	; Allocate memory
  0A3E    22 0B85        C      	ld	(l0b9f),hl
  0A41    EB             C      	ex	de,hl
  0A42    2A 67F4        C      	ld	hl,(l6867)
  0A45    01 FFF2        C      	ld	bc,lfff2
  0A48    09             C      	add	hl,bc
  0A49    01 0032        C      	ld	bc,l0032
  0A4C    ED B0          C      	ldir			; .. copy into memory
  0A4E    21 63C9        C      	ld	hl,@MES@
  0A51    01 001E        C      	ld	bc,l001e
  0A54    ED B0          C      	ldir			; Get message
  0A56    CD 0969        C      	call	DisXXX?		; Disable ???
  0A59    CD 4D3B        C      	call	l4d96
  0A5C    CD 3FBD        C      	call	l4018
  0A5F    CD 067D        C      	call	ProcSRC		; Process source file
  0A62    CD 479F        C      	call	l47fa
  0A65    AF             C      	xor	a
  0A66    32 67D3        C      	ld	(l6846),a
  0A69    3E F0          C      	ld	a,-16
  0A6B    32 661C        C      	ld	(l668f),a
  0A6E    21 6AD1        C      	ld	hl,l6b44
  0A71    22 6317        C      	ld	(LinePtr),hl	; Init line pointer
  0A74    3E 04          C      	ld	a,4
  0A76    32 6314        C      	ld	(l6387),a
  0A79    21 6617        C      	ld	hl,Pass
  0A7C    34             C      	inc	(hl)		; Bump pass
  0A7D    3E 32          C      	ld	a,'2'
  0A7F    32 035A        C      	ld	($PASS),a	; Set pass 2
  0A82    2A 0117        C      	ld	hl,($FOUR$)	; Reset presets
  0A85    22 62C4        C      	ld	(_FOUR_),hl
  0A88    2A 67F4        C      	ld	hl,(l6867)
  0A8B    01 FFF2        C      	ld	bc,lfff2
  0A8E    09             C      	add	hl,bc
  0A8F    01 0032        C      	ld	bc,l0032
  0A92    EB             C      	ex	de,hl
  0A93    2A 0B85        C      	ld	hl,(l0b9f)
  0A96    ED B0          C      	ldir
  0A98    11 63C9        C      	ld	de,@MES@
  0A9B    01 001E        C      	ld	bc,l001e
  0A9E    ED B0          C      	ldir			; Put into message
                         C      	ld.hl	1,1
  0AA0    21 0101        C+     	ld	hl,1*256+1
  0AA3    22 67FF        C      	ld	(_rPage_),hl	; Init pages
  0AA6    CD 227D        C      	call	l22a2
  0AA9    3A 012C        C      	ld	a,($CLOSE$)	; Test close and reopen
  0AAC    B7             C      	or	a
  0AAD    28 2F          C      	jr	z,l0af8		; .. nope
  0AAF    CD 618F        C      	call	push.r		; Push regs
  0AB2    3A 6801        C      	ld	a,(CurUsr)	; Get user
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-24


  0AB5    CD 6179        C      	call	SetUsr		; .. log it
  0AB8    ED 5B 67F4     C      	ld	de,(CurFCB)	; Get FCB
  0ABC    D5             C      	push	de
  0ABD    1A             C      	ld	a,(de)		; Fetch disk
  0ABE    3D             C      	dec	a
  0ABF    CD 6180        C      	call	SetDsk		; .. log it
  0AC2    D1             C      	pop	de
  0AC3    D5             C      	push	de
  0AC4    0E 10          C      	ld	c,.close
  0AC6    CD 0005        C      	call	BDOS		; Close file
  0AC9    D1             C      	pop	de
  0ACA    21 000C        C      	ld	hl,_EXT
  0ACD    19             C      	add	hl,de
  0ACE    36 00          C      	ld	(hl),0		; Clear extent
  0AD0    0E 0F          C      	ld	c,.open
  0AD2    CD 0005        C      	call	BDOS		; Re-open file
  0AD5    3A 6844        C      	ld	a,(LogUsr.)
  0AD8    CD 6179        C      	call	SetUsr		; Log user
  0ADB    CD 61AE        C      	call	pop.r		; Pop regs
  0ADE                   C      l0af8:
  0ADE    CD 0B68        C      	call	SetFileTab	; Set file table
  0AE1    CD 6325        C      	call	Ini$FO		; Init file mode
  0AE4    3E C9          C      	ld	a,_RET
  0AE6    32 503A        C      	ld	(l5095),a
  0AE9    21 62C3        C      	ld	hl,_OPT_
  0AEC    CB 46          C      	bit	_FULL,(hl)	; Test full listing
  0AEE    C4 0B4F        C      	call	nz,EnaXXX?	; .. yeap, init table
  0AF1    3A 62C3        C      	ld	a,(_OPT_)
  0AF4    CB 5F          C      	bit	_CROSS,a	; Test cross reference
  0AF6    C4 5C9C        C      	call	nz,l5cf7	; .. yeap
  0AF9    CD 3FBD        C      	call	l4018
  0AFC    3A 67C2        C      	ld	a,(OS.Flg)	; Test vector swapped
  0AFF    B7             C      	or	a
  0B00    28 0A          C      	jr	z,l0b26		; .. nope
  0B02    AF             C      	xor	a
  0B03    32 67C2        C      	ld	(OS.Flg),a	; Clear flag
  0B06    2A 4D7C        C      	ld	hl,(OS.sav)	; Reset OS vector
  0B09    22 0001        C      	ld	(OS+1),hl
  0B0C                   C      l0b26:
  0B0C    CD 5ADA        C      	call	l5b35
  0B0F    18 05          C      	jr	l0b30
  0B11                   C      l0b2b:
  0B11    7E             C      	ld	a,(hl)
  0B12    FE F0          C      	cp	0f0h
  0B14    28 07          C      	jr	z,l0b37
  0B16                   C      l0b30:
  0B16    CD 5AF0        C      	call	l5b4b
  0B19    20 F6          C      	jr	nz,l0b2b
  0B1B    18 14          C      	jr	l0b4b
  0B1D                   C      l0b37:
  0B1D    23             C      	inc	hl
  0B1E    5E             C      	ld	e,(hl)
  0B1F    23             C      	inc	hl
  0B20    56             C      	ld	d,(hl)
  0B21    13             C      	inc	de
  0B22    13             C      	inc	de
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-25


  0B23    13             C      	inc	de
  0B24    3A 6819        C      	ld	a,(l688c)
  0B27    B7             C      	or	a
  0B28    20 01          C      	jr	nz,l0b45
  0B2A    13             C      	inc	de
  0B2B                   C      l0b45:
  0B2B    AF             C      	xor	a
  0B2C    12             C      	ld	(de),a
  0B2D    13             C      	inc	de
  0B2E    12             C      	ld	(de),a
  0B2F    18 E5          C      	jr	l0b30
  0B31                   C      l0b4b:
  0B31    21 0000        C      	ld	hl,0
  0B34    22 680C        C      	ld	(l687f),hl
  0B37    3E 0A          C      	ld	a,10
  0B39    CD 4B71        C      	call	SetRadix	; Set radix 10
  0B3C    CD 067D        C      	call	ProcSRC		; Process source file
  0B3F    3E 01          C      	ld	a,1
  0B41    CD 604A        C      	call	SelFile		; Select file
  0B44    3E CD          C      	ld	a,_CALL		; Set call
  0B46    32 503A        C      	ld	(l5095),a
  0B49    CD 51E3        C      	call	l523e
  0B4C    C3 0958        C      	jp	l0972
                         C      ;
                         C      ; Init ????? table
                         C      ;
  0B4F                   C      EnaXXX?:
  0B4F    AF             C      	xor	a		; Set NOP
  0B50    32 0895        C      	ld	(l08af),a
  0B53    21 1350        C      	ld	hl,l136a
  0B56    11 634C        C      	ld	de,l63bf
  0B59    01 0015        C      	ld	bc,l137f-l136a
  0B5C    ED B0          C      	ldir
  0B5E    C9             C      	ret
                         C      ;
                         C      ; Init jump table
                         C      ; ENTRY	Reg HL holds source table
                         C      ;
  0B5F                   C      Set.jp.tab:
  0B5F    11 631F        C      	ld	de,l6392
  0B62    01 002D        C      	ld	bc,l1289-l125c
  0B65    ED B0          C      	ldir
  0B67    C9             C      	ret
                         C      ;
                         C      ; Prepare file table
                         C      ;
  0B68                   C      SetFileTab:
  0B68    3A 62C3        C      	ld	a,(_OPT_)	; Get option
  0B6B    87             C      	add	a,a		; Test relocatable
  0B6C    38 0C          C      	jr	c,l0b94		; .. yeap
  0B6E    21 1242        C      	ld	hl,l125c
  0B71    87             C      	add	a,a		; Test .HEX
  0B72    30 03          C      	jr	nc,l0b91	; .. nope, ABS
  0B74    21 126F        C      	ld	hl,l1289
  0B77                   C      l0b91:
  0B77    C3 0B5F        C      	jp	Set.jp.tab	; .. set table
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-26


  0B7A                   C      l0b94:
  0B7A    21 12C9        C      	ld	hl,l12e3
  0B7D    87             C      	add	a,a		; Test REL-80
  0B7E    30 F7          C      	jr	nc,l0b91	; .. nope
  0B80    21 129C        C      	ld	hl,l12b6
  0B83    18 F2          C      	jr	l0b91		; .. set table
  0B85                   C      l0b9f:
  0B85    0000           C      	dw	0
                         C      ;
                         C      ; @@@@@@@@@@@@@@@@@@@@@@@@
                         C      ; !!! End of assembler !!!
                         C      ; @@@@@@@@@@@@@@@@@@@@@@@@
                         C      ;
  0B87                   C      EndOfASM::
  0B87    3A 0120        C      	ld	a,($FF.EOL$)	; Test form feed at end
  0B8A    B7             C      	or	a
  0B8B    21 0667        C      	ld	hl,$FF
  0B8E    C4 5FA8        C      	call	nz,PrStrg	; Print form feed if enabled
  0B91    3A 5FC0        C      	ld	a,(l601b)	; Get enable flag
  0B94    B7             C      	or	a
  0B95    20 08          C      	jr	nz,l0bb9	; .. yeap
  0B97    3E 02          C      	ld	a,2
  0B99    CD 604A        C      	call	SelFile		; Select file
  0B9C    CD 5EBA        C      	call	l5f15
  0B9F                   C      l0bb9:
  0B9F    CD 618F        C      	call	push.r		; Push regs
  0BA2    3A 6843        C      	ld	a,(LogDsk.)	; Get disk
  0BA5    3D             C      	dec	a
  0BA6    CD 6180        C      	call	SetDsk		; .. log it
  0BA9    3A 6844        C      	ld	a,(LogUsr.)
  0BAC    CD 6179        C      	call	SetUsr		; .. and user
  0BAF    CD 61AE        C      	call	pop.r		; Pop regs
  0BB2    3A 67C2        C      	ld	a,(OS.Flg)	; Test vector swapped
  0BB5    B7             C      	or	a
  0BB6    28 0A          C      	jr	z,.NextASM	; .. nope
  0BB8    AF             C      	xor	a
  0BB9    32 67C2        C      	ld	(OS.Flg),a	; Clear flag
  0BBC    2A 4D7C        C      	ld	hl,(OS.sav)	; Reset OS vector
  0BBF    22 0001        C      	ld	(OS+1),hl
  0BC2                   C      .NextASM:
  0BC2    C3 2535        C      	jp	NextASM		; Try next run
                         C      ;
                         C      ;
                         C      ;
  0BC5                   C      l0bdf:
  0BC5    3E FF          C      	ld	a,YES
  0BC7    32 62C9        C      	ld	(_DIR_),a	; Force UPPER-LOWER
  0BCA    3A 62C3        C      	ld	a,(_OPT_)
  0BCD    CB 57          C      	bit	_SYM,a		; Test symbol file
  0BCF    C4 5BE4        C      	call	nz,l5c3f	; .. yeap
  0BD2    3A 62C3        C      	ld	a,(_OPT_)
  0BD5    CB 5F          C      	bit	_CROSS,a	; Test cross reference
  0BD7    C4 5CDB        C      	call	nz,l5d36	; .. yeap
  0BDA    C9             C      	ret
                         C      ;
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-27


                         C      ;
  0BDB                   C      l0bf5:
  0BDB    3A 07D7        C      	ld	a,(l07f1)	; Get codes
  0BDE    21 62C4        C      	ld	hl,_FOUR_	; .. list more than four
  0BE1    AE             C      	xor	(hl)
  0BE2    FE C9          C      	cp	_RET
  0BE4    CA 0C83        C      	jp	z,l0c9d
  0BE7    3A 62C5        C      	ld	a,(_FALSE_)	; Get list FALSE
  0BEA    2F             C      	cpl
  0BEB    21 6809        C      	ld	hl,l687c
  0BEE    A6             C      	and	(hl)
  0BEF    FA 0C83        C      	jp	m,l0c9d
  0BF2    2A 67F4        C      	ld	hl,(l6867)
  0BF5    CB 7E          C      	bit	@MSB,(hl)
  0BF7    28 18          C      	jr	z,l0c2b
  0BF9    21 62C7        C      	ld	hl,_MACRO_
  0BFC    CB 46          C      	bit	0,(hl)		; Test .LALL
  0BFE    20 11          C      	jr	nz,l0c2b	; .. yeap
  0C00    CB 56          C      	bit	2,(hl)		; .. or .SALL
  0C02    20 7F          C      	jr	nz,l0c9d	; .. yeap
  0C04    3A 67D3        C      	ld	a,(l6846)
  0C07    B7             C      	or	a
  0C08    20 79          C      	jr	nz,l0c9d
  0C0A    3A 6314        C      	ld	a,(l6387)
  0C0D    FE 04          C      	cp	4
  0C0F    28 72          C      	jr	z,l0c9d
  0C11                   C      l0c2b:
  0C11    3A 67D3        C      	ld	a,(l6846)
  0C14    B7             C      	or	a
  0C15    20 18          C      	jr	nz,l0c49
  0C17    21 6314        C      	ld	hl,l6387
  0C1A    3A 67DA        C      	ld	a,(l684d)
  0C1D    B7             C      	or	a
  0C1E    F2 0C25        C      	jp	p,l0c3f
  0C21    FE F0          C      	cp	0f0h
  0C23    20 05          C      	jr	nz,l0c44
  0C25                   C      l0c3f:
  0C25    7E             C      	ld	a,(hl)
  0C26    FE 04          C      	cp	4
  0C28    28 05          C      	jr	z,l0c49
  0C2A                   C      l0c44:
  0C2A    36 06          C      	ld	(hl),6
  0C2C    CD 0CBA        C      	call	l0cd4
  0C2F                   C      l0c49:
  0C2F    3A 013B        C      	ld	a,($NEST$)	; Test nesting level to print
  0C32    B7             C      	or	a
  0C33    28 11          C      	jr	z,l0c60		; .. nope
  0C35    3A 67BA        C      	ld	a,(l682d)	; Test letter
  0C38    B7             C      	or	a
  0C39    28 0B          C      	jr	z,l0c60		; .. nope
  0C3B    C6 40          C      	add	a,'A'-1		; Make ASCII
  0C3D    FE 5B          C      	cp	'Z'+1		; Test range
  0C3F    38 02          C      	jr	c,l0c5d
  0C41    3E 2A          C      	ld	a,'*'		; .. map asterisk
  0C43                   C      l0c5d:
  0C43    32 6ADC        C      	ld	(l6b4f),a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-28


  0C46                   C      l0c60:
  0C46    21 67FA        C      	ld	hl,CurLine	; Point to current line
  0C49    3A 0127        C      	ld	a,($LIN.NR$)	; Test # statement
  0C4C    B7             C      	or	a
  0C4D    28 03          C      	jr	z,l0c6c		; .. nope
  0C4F    21 6621        C      	ld	hl,l6694
  0C52                   C      l0c6c:
  0C52    11 6AC4        C      	ld	de,l6b37
  0C55    3E 05          C      	ld	a,5
  0C57    CD 33A2        C      	call	BCDtoASC.	; Convert to ASCII
  0C5A    3A 0128        C      	ld	a,($PR.LINNR$)	; Test # to be printed
  0C5D    B7             C      	or	a
  0C5E    21 6AC3        C      	ld	hl,l6b36
  0C61    11 6ACA        C      	ld	de,l6b3d
  0C64    20 01          C      	jr	nz,l0c81	; .. yeap
  0C66    EB             C      	ex	de,hl
  0C67                   C      l0c81:
  0C67    D5             C      	push	de
  0C68    11 68AC        C      	ld	de,l691f
  0C6B    CD 5E9C        C      	call	ldir.8		; Copy message
  0C6E    E1             C      	pop	hl
  0C6F    CD 5E9C        C      	call	ldir.8		; .. append
  0C72    3E FF          C      	ld	a,0ffh
  0C74    12             C      	ld	(de),a
  0C75    CD 635B        C      	call	l63ce
  0C78    3E C9          C      	ld	a,_RET
  0C7A    32 07D7        C      	ld	(l07f1),a
  0C7D    21 6623        C      	ld	hl,l6694+2
  0C80    CD 0CAA        C      	call	IncBCD		; Increment value
  0C83                   C      l0c9d:
  0C83    3A 67F1        C      	ld	a,($REL$)	; Get REL mode
  0C86    32 6313        C      	ld	(l6386),a
  0C89    FD 22 6311     C      	ld	($PC$),iy	; Set PC
  0C8D    3E 04          C      	ld	a,4
  0C8F    32 6314        C      	ld	(l6387),a
  0C92    AF             C      	xor	a
  0C93    32 67D3        C      	ld	(l6846),a
  0C96    21 6AD1        C      	ld	hl,l6b44
  0C99    22 6317        C      	ld	(LinePtr),hl	; Init line pointer
  0C9C                   C      l0cb6:
  0C9C    21 6ACB        C      	ld	hl,l6b3e
  0C9F    11 6ACC        C      	ld	de,l6b3e+1
  0CA2    01 0011        C      	ld	bc,18-1
  0CA5    36 20          C      	ld	(hl),' '
  0CA7    ED B0          C      	ldir
  0CA9    C9             C      	ret
                         C      ;
                         C      ; Increment BCD value by one (Three BCDs)
                         C      ; ENTRY	Reg HL points to LSD of BCD
                         C      ;
  0CAA                   C      IncBCD:
  0CAA    7E             C      	ld	a,(hl)
  0CAB    C6 01          C      	add	a,1		; .. increment
  0CAD    27             C      	daa
  0CAE    77             C      	ld	(hl),a
  0CAF    D0             C      	ret	nc		; .. done
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-29


  0CB0    2B             C      	dec	hl		; Get previous
  0CB1    8E             C      	adc	a,(hl)
  0CB2    27             C      	daa
  0CB3    77             C      	ld	(hl),a
  0CB4    D0             C      	ret	nc		; .. done
  0CB5    2B             C      	dec	hl		; Get last
  0CB6    8E             C      	adc	a,(hl)
  0CB7    27             C      	daa
  0CB8    77             C      	ld	(hl),a
  0CB9    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  0CBA                   C      l0cd4:
  0CBA    21 6ACB        C      	ld	hl,l6b3e
  0CBD    22 6317        C      	ld	(LinePtr),hl	; Init line pointer
  0CC0    2A 6311        C      	ld	hl,($PC$)	; Get PC
  0CC3    3A 62C9        C      	ld	a,(_DIR_)	; Test direction of bytes
  0CC6    B7             C      	or	a
  0CC7    3A 6313        C      	ld	a,(l6386)
  0CCA    20 50          C      	jr	nz,l0d36	; .. UPPER-LOWER
  0CCC    3E FF          C      	ld	a,YES
  0CCE    32 62C9        C      	ld	(_DIR_),a	; Force UPPER-LOWER
  0CD1    3A 6313        C      	ld	a,(l6386)
  0CD4    CD 0D1C        C      	call	l0d36
  0CD7    AF             C      	xor	a
  0CD8    32 62C9        C      	ld	(_DIR_),a	; Reset LOWER-UPPER
  0CDB    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  0CDC                   C      l0cf6:
  0CDC    FD 23          C      	inc	iy
  0CDE    E5             C      	push	hl
  0CDF    D5             C      	push	de
  0CE0    C5             C      	push	bc
  0CE1    F5             C      	push	af
  0CE2    2A 6317        C      	ld	hl,(LinePtr)	; Get line pointer
  0CE5    36 3F          C      	ld	(hl),'?'	; .. set quotes
  0CE7    23             C      	inc	hl
  0CE8    36 3F          C      	ld	(hl),'?'
  0CEA    23             C      	inc	hl
  0CEB    18 14          C      	jr	l0d1b
                         C      ;
                         C      ; ????????????????????
                         C      ; ENTRY	Accu holds ???
                         C      ;
  0CED                   C      l0d07:
  0CED    FD 23          C      	inc	iy
  0CEF    E5             C      	push	hl
  0CF0    D5             C      	push	de
  0CF1    C5             C      	push	bc
  0CF2    F5             C      	push	af
  0CF3    21 6315        C      	ld	hl,l6388
  0CF6    77             C      	ld	(hl),a
  0CF7    ED 5B 6317     C      	ld	de,(LinePtr)	; Get line pointer
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-30


  0CFB    3E 02          C      	ld	a,2
  0CFD    CD 33CD        C      	call	BCDtoASC	; Convert byte to ASCII
  0D00    EB             C      	ex	de,hl
  0D01                   C      l0d1b:
  0D01    36 20          C      	ld	(hl),' '	; Set delimiter
  0D03    23             C      	inc	hl
  0D04    22 6317        C      	ld	(LinePtr),hl	; Save line pointer
  0D07    21 6314        C      	ld	hl,l6387
  0D0A                   C      l0d24:
  0D0A    35             C      	dec	(hl)		; Count down
  0D0B    CC 6352        C      	call	z,l63c5		; .. ??? if zero
  0D0E    F1             C      	pop	af
  0D0F    C1             C      	pop	bc
  0D10    D1             C      	pop	de
  0D11    E1             C      	pop	hl
  0D12    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  0D13                   C      l0d2d:
  0D13    72             C      	ld	(hl),d
  0D14    2B             C      	dec	hl
  0D15    73             C      	ld	(hl),e
  0D16    18 15          C      	jr	l0d47
  0D18                   C      l0d32:
  0D18    FD 23          C      	inc	iy
  0D1A    FD 23          C      	inc	iy
  0D1C                   C      l0d36:
  0D1C    E5             C      	push	hl
  0D1D    D5             C      	push	de
  0D1E    C5             C      	push	bc
  0D1F    F5             C      	push	af
  0D20    EB             C      	ex	de,hl
  0D21    21 6316        C      	ld	hl,l6389
  0D24                   C      l0d3e:
  0D24    3A 62C9        C      	ld	a,(_DIR_)	; Test direction
  0D27    B7             C      	or	a
  0D28    28 E9          C      	jr	z,l0d2d		; .. LOWER-UPPER
  0D2A    73             C      	ld	(hl),e
  0D2B    2B             C      	dec	hl
  0D2C    72             C      	ld	(hl),d
  0D2D                   C      l0d47:
  0D2D    ED 5B 6317     C      	ld	de,(LinePtr)	; Get line pointer
  0D31    3E 04          C      	ld	a,4
  0D33    CD 33CD        C      	call	BCDtoASC	; Convert word to ASCII
  0D36    F1             C      	pop	af		; Get address mode
  0D37                   C      l0d51:
  0D37    F5             C      	push	af
  0D38    EB             C      	ex	de,hl
  0D39                   C      l0d53:
  0D39    B7             C      	or	a		; Test address mode
  0D3A    0E 20          C      	ld	c,' '		; .. absolute
  0D3C    28 12          C      	jr	z,l0d6a
  0D3E    3D             C      	dec	a
  0D3F    0E 27          C      	ld	c,''''
  0D41    28 0D          C      	jr	z,l0d6a		; .. code segment
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-31


  0D43    3D             C      	dec	a
  0D44    0E 22          C      	ld	c,'"'
  0D46    28 08          C      	jr	z,l0d6a		; .. data segment
  0D48    0E 23          C      	ld	c,'#'
  0D4A    FE 0D          C      	cp	cr
  0D4C    30 02          C      	jr	nc,l0d6a
  0D4E    0E 2A          C      	ld	c,'*'
  0D50                   C      l0d6a:
  0D50    71             C      	ld	(hl),c		; Save address mode
  0D51    23             C      	inc	hl
  0D52    36 20          C      	ld	(hl),' '	; .. blank next
  0D54    23             C      	inc	hl
  0D55    22 6317        C      	ld	(LinePtr),hl	; Set line pointer
  0D58    21 6314        C      	ld	hl,l6387
  0D5B    35             C      	dec	(hl)
  0D5C    18 AC          C      	jr	l0d24
                         C      ;
                         C      ;
                         C      ;
  0D5E                   C      l0d78:
  0D5E    FD 23          C      	inc	iy
  0D60    FD 23          C      	inc	iy
  0D62    E5             C      	push	hl
  0D63    D5             C      	push	de
  0D64    C5             C      	push	bc
  0D65    F5             C      	push	af
  0D66    2A 6317        C      	ld	hl,(LinePtr)	; Get line pointer
  0D69    3E 3F          C      	ld	a,'?'
  0D6B    77             C      	ld	(hl),a		; Indicate quote
  0D6C    23             C      	inc	hl
  0D6D    77             C      	ld	(hl),a
  0D6E    23             C      	inc	hl
  0D6F    77             C      	ld	(hl),a
  0D70    23             C      	inc	hl
  0D71    77             C      	ld	(hl),a
  0D72    23             C      	inc	hl
  0D73    AF             C      	xor	a
  0D74    18 C3          C      	jr	l0d53
                         C      ;
                         C      ; Got ' or "
                         C      ;
  0D76                   C      @STRG.1:
  0D76    E1             C      	pop	hl
  0D77    62             C      	ld	h,d
  0D78    6B             C      	ld	l,e
  0D79    4E             C      	ld	c,(hl)
  0D7A    06 00          C      	ld	b,0
  0D7C    09             C      	add	hl,bc
  0D7D    23             C      	inc	hl
  0D7E    22 62F5        C      	ld	(TokPtr),hl	; Save token pointer
  0D81    79             C      	ld	a,c
  0D82    0E 56          C      	ld	c,'V'
  0D84    FE 03          C      	cp	3
  0D86    30 17          C      	jr	nc,l0db9
  0D88    21 679A        C      	ld	hl,l680d
  0D8B    CB 46          C      	bit	0,(hl)
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-32


  0D8D    28 04          C      	jr	z,l0dad
  0D8F    FE 02          C      	cp	2
  0D91    28 0C          C      	jr	z,l0db9
  0D93                   C      l0dad:
  0D93    0E 38          C      	ld	c,'8'
  0D95    EB             C      	ex	de,hl
  0D96    23             C      	inc	hl
  0D97    50             C      	ld	d,b
  0D98    5E             C      	ld	e,(hl)
  0D99    3D             C      	dec	a
  0D9A    28 03          C      	jr	z,l0db9
  0D9C    53             C      	ld	d,e
  0D9D    23             C      	inc	hl
  0D9E    5E             C      	ld	e,(hl)
  0D9F                   C      l0db9:
  0D9F    EB             C      	ex	de,hl
  0DA0    79             C      	ld	a,c
  0DA1    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  0DA2                   C      l0dbc:
  0DA2    3E FF          C      	ld	a,-1
  0DA4    32 6792        C      	ld	(l6805),a	; Set flag
  0DA7    CD 0DE2        C      	call	GetToken	; .. get token
  0DAA                   C      l0dc4:
  0DAA    AF             C      	xor	a
  0DAB    32 6792        C      	ld	(l6805),a	; Clear flag
  0DAE    79             C      	ld	a,c		; Get back token ??
  0DAF    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  0DB0                   C      l0dca:
  0DB0    3E FF          C      	ld	a,-1
  0DB2    32 6792        C      	ld	(l6805),a
  0DB5    CD 0DCB        C      	call	.PartToken
  0DB8    18 F0          C      	jr	l0dc4
                         C      ;
                         C      ;
                         C      ;
  0DBA                   C      l0dd4:
  0DBA    36 00          C      	ld	(hl),0
  0DBC    4F             C      	ld	c,a
  0DBD    2A 6804        C      	ld	hl,(l6877)
  0DC0    3C             C      	inc	a
  0DC1    28 02          C      	jr	z,l0ddf
  0DC3    3D             C      	dec	a
  0DC4    C9             C      	ret
  0DC5                   C      l0ddf:
  0DC5    2A 6376        C      	ld	hl,(TokStrt)	; Get token start pointer
  0DC8    7E             C      	ld	a,(hl)		; .. and token
  0DC9    18 2D          C      	jr	l0e12		; .. convert
                         C      ;
                         C      ; Get token supressing ????????????
                         C      ; EXIT	Accu holds token
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-33


                         C      ;
  0DCB                   C      .PartToken:
  0DCB    3E C9          C      	ld	a,_RET
  0DCD    32 138D        C      	ld	(l13a7),a
  0DD0                   C      l0dea:
  0DD0    CD 0DE5        C      	call	.FullToken	; Process token
  0DD3    4F             C      	ld	c,a
  0DD4    3E CD          C      	ld	a,_CALL		; Set call
  0DD6    32 138D        C      	ld	(l13a7),a
  0DD9    79             C      	ld	a,c
  0DDA    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  0DDB                   C      l0df5:
  0DDB    3E C3          C      	ld	a,_JP
  0DDD    32 138D        C      	ld	(l13a7),a
  0DE0    18 EE          C      	jr	l0dea
                         C      ;
                         C      ; Get token
                         C      ; EXIT	Accu holds token
                         C      ;
  0DE2                   C      GetToken:
  0DE2    C3 0DE5        C      	jp	.FullToken	; Process token
  0DE3                   C      $GetVec	equ	$-2
                         C      ;
                         C      ; Get token
                         C      ; EXIT	Accu holds token
                         C      ;
  0DE5                   C      .FullToken:
  0DE5    21 6806        C      	ld	hl,l6879
  0DE8    7E             C      	ld	a,(hl)
  0DE9    B7             C      	or	a		; Test flag
  0DEA    20 CE          C      	jr	nz,l0dd4
  0DEC    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
  0DEF                   C      l0e09:
  0DEF    23             C      	inc	hl
  0DF0    7E             C      	ld	a,(hl)		; Get token
  0DF1    FE 35          C      	cp	35h		; Test white space
  0DF3    28 FA          C      	jr	z,l0e09		; .. skip
  0DF5    22 6376        C      	ld	(TokStrt),hl	; Save pointer if not a space
  0DF8                   C      l0e12:
  0DF8    FE 53          C      	cp	53h		; Test range
  0DFA    38 08          C      	jr	c,l0e1e		; .. 'normal'
  0DFC    CD 0E31        C      	call	ProcToken	; .. process token
  0DFF    C2 0FBE        C      	jp	nz,GetLabel	; .. must be label
  0E02    2B             C      	dec	hl
  0E03    79             C      	ld	a,c		; Get resulting token
  0E04                   C      l0e1e:
  0E04    22 62F5        C      	ld	(TokPtr),hl	; Save token pointer
  0E07    6F             C      	ld	l,a		; Get token as index
  0E08    26 03          C      	ld	h,HIGH l0400
  0E0A    CB 76          C      	bit	6,(hl)		; Test bit set
  0E0C    4F             C      	ld	c,a
  0E0D    C8             C      	ret	z		; .. nope
  0E0E    3A 6792        C      	ld	a,(l6805)
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-34


  0E11    B7             C      	or	a
  0E12    79             C      	ld	a,c
  0E13    C8             C      	ret	z
  0E14    2A 6376        C      	ld	hl,(TokStrt)	; Get token start pointer
  0E17    3E C9          C      	ld	a,_RET
  0E19    32 1390        C      	ld	(l13aa),a	; .. disable check
  0E1C    C5             C      	push	bc
  0E1D    CD 0FBE        C      	call	GetLabel	; Get label
  0E20    C1             C      	pop	bc
  0E21    3E 30          C      	ld	a,_JR.NC	; .. enable check
  0E23    32 1390        C      	ld	(l13aa),a
  0E26    79             C      	ld	a,c
  0E27    D8             C      	ret	c
  0E28    7E             C      	ld	a,(hl)
  0E29    FE F0          C      	cp	0f0h
  0E2B    79             C      	ld	a,c
  0E2C    C0             C      	ret	nz
  0E2D    0E 39          C      	ld	c,39h
  0E2F    79             C      	ld	a,c
  0E30    C9             C      	ret
                         C      ;
                         C      ; Convert to a token
                         C      ;
  0E31                   C      ProcToken:
  0E31    C3 0E34        C      	jp	DoToken		; Default is lower to UPPER
  0E32                   C      $TokVec	equ	$-2
                         C      ;
                         C      ; Process lower as UPPER
                         C      ;
  0E34                   C      DoToken:
  0E34    23             C      	inc	hl
  0E35    EB             C      	ex	de,hl
  0E36    FE 80          C      	cp	80h		; Test case
  0E38    D2 1EB8        C      	jp	nc,@LABEL	; .. lower case
  0E3B    D6 53          C      	sub	53h		; Strip off offset
  0E3D    26 02          C      	ld	h,HIGH TokenTab
  0E3F    87             C      	add	a,a		; * 2
  0E40    6F             C      	ld	l,a		; .. as index
  0E41    7E             C      	ld	a,(hl)		; Fetch execution address
  0E42    23             C      	inc	hl
  0E43    66             C      	ld	h,(hl)
  0E44    6F             C      	ld	l,a
  0E45    E9             C      	jp	(hl)		; .. jump
                         C      ;
                         C      ; Process different case token
                         C      ;
  0E46                   C      DoLowToken:
  0E46    FE 56          C      	cp	56h
  0E48    28 EA          C      	jr	z,DoToken	; .. process string
  0E4A    11 681A        C      	ld	de,$LOTOK$	; Init buffer
                         C      	ld.bc	32,53h
  0E4D    01 2053        C+     	ld	bc,32*256+53h
  0E50                   C      l0e6a:
  0E50    7E             C      	ld	a,(hl)
  0E51    FE 80          C      	cp	80h		; Test lower case
  0E53    38 06          C      	jr	c,l0e75		; .. nope
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-35


  0E55    FE 9A          C      	cp	80h+'z'-'a'+1	; Test range
  0E57    30 02          C      	jr	nc,l0e75	; .. out of range
  0E59    D6 1A          C      	sub	80h-66h		; Convert to UPPER case
  0E5B                   C      l0e75:
  0E5B    12             C      	ld	(de),a		; Save token
  0E5C    23             C      	inc	hl
  0E5D    13             C      	inc	de
  0E5E    B9             C      	cp	c		; Test range
  0E5F    38 07          C      	jr	c,l0e82
  0E61                   C      l0e7b:
  0E61    10 ED          C      	djnz	l0e6a
  0E63    3E 56          C      	ld	a,56h		; Set string
  0E65    12             C      	ld	(de),a
  0E66    18 09          C      	jr	l0e8b
  0E68                   C      l0e82:
  0E68    1B             C      	dec	de
  0E69    1B             C      	dec	de
  0E6A    1A             C      	ld	a,(de)
  0E6B    13             C      	inc	de
  0E6C    13             C      	inc	de
  0E6D    FE 56          C      	cp	56h		; Test previous string
  0E6F    28 F0          C      	jr	z,l0e7b		; .. yeap
  0E71                   C      l0e8b:
  0E71    2A 6376        C      	ld	hl,(TokStrt)	; Get start pointer
  0E74    E5             C      	push	hl		; .. save
  0E75    21 681A        C      	ld	hl,$LOTOK$	; Swap pointer
  0E78    22 6376        C      	ld	(TokStrt),hl
  0E7B    7E             C      	ld	a,(hl)		; Get token
  0E7C    CD 0E34        C      	call	DoToken		; .. convert
  0E7F    20 0F          C      	jr	nz,l0eaa	; .. no known token
  0E81                   C      l0e9b:
  0E81    EB             C      	ex	de,hl
  0E82    E3             C      	ex	(sp),hl		; Get back old pointer
  0E83    22 6376        C      	ld	(TokStrt),hl	; .. bring back
  0E86    E5             C      	push	hl
  0E87    21 97E6        C      	ld	hl,-$LOTOK$	; .. ** MYSTERIOUS ** l9773
  0E8A    19             C      	add	hl,de
  0E8B    D1             C      	pop	de
  0E8C    19             C      	add	hl,de
  0E8D    D1             C      	pop	de
  0E8E    AF             C      	xor	a
  0E8F    C9             C      	ret
  0E90                   C      l0eaa:
  0E90    E1             C      	pop	hl		; Get back old pointer
  0E91    22 6376        C      	ld	(TokStrt),hl	; .. reset
  0E94    7E             C      	ld	a,(hl)		; Get token
  0E95    18 9D          C      	jr	DoToken		; .. convert
                         C      ;
                         C      ; Convert string to hex
                         C      ;
  0E97                   C      l0eb1:
  0E97    D1             C      	pop	de
  0E98    23             C      	inc	hl
  0E99    7E             C      	ld	a,(hl)		; Get length
  0E9A    FE 06          C      	cp	6		; Test hex range
  0E9C    30 65          C      	jr	nc,l0f1d	; .. nope
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-36


  0E9E    23             C      	inc	hl		; .. skip length
  0E9F    11 6824        C      	ld	de,l6897
  0EA2    EB             C      	ex	de,hl
  0EA3    E5             C      	push	hl
  0EA4    06 01          C      	ld	b,HIGH CtrlArr	; Load control page
  0EA6                   C      l0ec0:
  0EA6    F5             C      	push	af
  0EA7    1A             C      	ld	a,(de)		; Get character
  0EA8    FE 61          C      	cp	'a'		; Test case
  0EAA    38 06          C      	jr	c,l0ecc
  0EAC    FE 7B          C      	cp	'z'+1
  0EAE    30 02          C      	jr	nc,l0ecc
  0EB0    D6 20          C      	sub	'a'-'A'		; .. convert to UPPER case
  0EB2                   C      l0ecc:
  0EB2    4F             C      	ld	c,a		; .. set as index
  0EB3    0A             C      	ld	a,(bc)		; Get control
  0EB4    77             C      	ld	(hl),a		; .. unpack
  0EB5    23             C      	inc	hl
  0EB6    13             C      	inc	de
  0EB7    F1             C      	pop	af
  0EB8    3D             C      	dec	a
  0EB9    20 EB          C      	jr	nz,l0ec0
  0EBB    ED 53 62F5     C      	ld	(TokPtr),de	; Save token pointer
  0EBF    2B             C      	dec	hl
  0EC0    C3 0F5E        C      	jp	Get$HEX		; Get hex number
                         C      ;
                         C      ; Got 0
                         C      ;
  0EC3                   C      @ZERO:
  0EC3    E1             C      	pop	hl
  0EC4    EB             C      	ex	de,hl
  0EC5    3E 5C          C      	ld	a,5ch		; Set 0
  0EC7    2B             C      	dec	hl
  0EC8                   C      l0ee2:
  0EC8    23             C      	inc	hl
  0EC9    BE             C      	cp	(hl)
  0ECA    28 FC          C      	jr	z,l0ee2		; Skip leading zeroes
  0ECC    E5             C      	push	hl
  0ECD    18 05          C      	jr	l0eee
                         C      ;
                         C      ; Numeric input, got 1..9
                         C      ;
  0ECF                   C      @NUMB:
  0ECF    2A 6376        C      	ld	hl,(TokStrt)	; Get token start pointer
  0ED2    E3             C      	ex	(sp),hl
  0ED3    EB             C      	ex	de,hl
  0ED4                   C      l0eee:
  0ED4    2B             C      	dec	hl
  0ED5    3E 5B          C      	ld	a,5bh		; Set @
  0ED7                   C      l0ef1:
  0ED7    23             C      	inc	hl
  0ED8    BE             C      	cp	(hl)		; Test range
  0ED9    38 FC          C      	jr	c,l0ef1		; .. skip not numeric
  0EDB    2B             C      	dec	hl
  0EDC    22 62F5        C      	ld	(TokPtr),hl	; Save token pointer
  0EDF    3A 6615        C      	ld	a,(Radix)	; Get radix
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-37


  0EE2    C6 5C          C      	add	a,5ch		; .. add 0
  0EE4    4F             C      	ld	c,a
  0EE5    7E             C      	ld	a,(hl)
  0EE6    B9             C      	cp	c		; Compare
  0EE7    DA 0000        C      	jp	c,$-$
  0EE8                   C      l0f02	equ	$-2
  0EEA    2B             C      	dec	hl
  0EEB    FE 6D          C      	cp	6dh
  0EED    28 6F          C      	jr	z,Get$HEX	; Get hex
  0EEF    FE 67          C      	cp	67h
  0EF1    CA 0F75        C      	jp	z,Get$BIN	; .. binary
  0EF4    FE 69          C      	cp	69h
  0EF6    28 28          C      	jr	z,Get$DEC	; .. decimal
  0EF8    FE 74          C      	cp	74h
  0EFA    CA 0F8C        C      	jp	z,Get$OCT	; .. octal
  0EFD    FE 76          C      	cp	76h
  0EFF    CA 0F8C        C      	jp	z,Get$OCT	; .. dtto.
  0F02    E1             C      	pop	hl
  0F03                   C      l0f1d:
  0F03    0E 20          C      	ld	c,32
  0F05    3A 138D        C      	ld	a,(l13a7)	; Test enabled
  0F08    FE C9          C      	cp	_RET
  0F0A    28 08          C      	jr	z,l0f2e		; .. nope
  0F0C    CD 08F5        C      	call	.ERROR		; .. error
  0F0F    21 0000        C      	ld	hl,0		; Return NUL
  0F12    18 1C          C      	jr	l0f4a
  0F14                   C      l0f2e:
  0F14    3A 62C3        C      	ld	a,(_OPT_)	; Get option
  0F17    E6 20          C      	and	1 SHL _NOUPP	; Test conversion to UPPER
  0F19    0E 39          C      	ld	c,39h
  0F1B    C2 0E81        C      	jp	nz,l0e9b	; .. nope, disabled
  0F1E    79             C      	ld	a,c		; .. get reurn
  0F1F    C9             C      	ret
                         C      ;
                         C      ; Get decimal input
                         C      ;
  0F20                   C      Get$DEC:
  0F20    D1             C      	pop	de
  0F21    B7             C      	or	a
  0F22    ED 52          C      	sbc	hl,de		; Test only one digit
  0F24    28 29          C      	jr	z,l0f69		; .. yeap
  0F26    2C             C      	inc	l
  0F27    28 32          C      	jr	z,l0f75
  0F29    7D             C      	ld	a,l
  0F2A    EB             C      	ex	de,hl
  0F2B    CD 34EA        C      	call	In$DEC		; Get decimal
  0F2E                   C      l0f48:
  0F2E    38 D3          C      	jr	c,l0f1d
  0F30                   C      l0f4a:
  0F30    0E 38          C      	ld	c,38h
  0F32                   C      l0f4c:
  0F32    3A 62C3        C      	ld	a,(_OPT_)	; Get option
  0F35    E6 20          C      	and	1 SHL _NOUPP	; Test conversion
  0F37    79             C      	ld	a,c
  0F38    C8             C      	ret	z		; .. yeap
  0F39    E5             C      	push	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-38


  0F3A    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
  0F3D    11 97E6        C      	ld	de,-$LOTOK$	; ** MYSTERIOUS ** l9773
  0F40    19             C      	add	hl,de
  0F41    D1             C      	pop	de
  0F42    C1             C      	pop	bc
  0F43    ED 43 6376     C      	ld	(TokStrt),bc	; .. save start pointer
  0F47    09             C      	add	hl,bc
  0F48    22 62F5        C      	ld	(TokPtr),hl	; Set token pointer
  0F4B    EB             C      	ex	de,hl
  0F4C    D1             C      	pop	de
  0F4D    4F             C      	ld	c,a
  0F4E    C9             C      	ret
  0F4F                   C      l0f69:
  0F4F    1A             C      	ld	a,(de)		; Get token
  0F50    D6 5C          C      	sub	5ch		; Strip off 0
  0F52    FE 0A          C      	cp	9+1		; Test range
  0F54                   C      l0f6e:
  0F54    30 AD          C      	jr	nc,l0f1d	; .. overflow
  0F56                   C      l0f70:
  0F56    26 00          C      	ld	h,0		; Clear hi
  0F58    6F             C      	ld	l,a		; .. save lo
  0F59    18 D5          C      	jr	l0f4a
  0F5B                   C      l0f75:
  0F5B    AF             C      	xor	a
  0F5C    18 F8          C      	jr	l0f70
                         C      ;
                         C      ; Get hexadecimal input
                         C      ;
  0F5E                   C      Get$HEX:
  0F5E    D1             C      	pop	de
  0F5F    B7             C      	or	a
  0F60    ED 52          C      	sbc	hl,de		; Test only one digit
  0F62    28 0A          C      	jr	z,l0f88		;.. yeap
  0F64    2C             C      	inc	l
  0F65    28 F4          C      	jr	z,l0f75
  0F67    7D             C      	ld	a,l
  0F68    EB             C      	ex	de,hl
  0F69    CD 3513        C      	call	In$HEX		; Get hex
  0F6C    18 C0          C      	jr	l0f48
  0F6E                   C      l0f88:
  0F6E    1A             C      	ld	a,(de)		; Get token
  0F6F    D6 5C          C      	sub	5ch		; Strip off 0
  0F71    FE 10          C      	cp	15+1		; Test range
  0F73    18 DF          C      	jr	l0f6e
                         C      ;
                         C      ; Get binary input
                         C      ;
  0F75                   C      Get$BIN:
  0F75    D1             C      	pop	de
  0F76    B7             C      	or	a
  0F77    ED 52          C      	sbc	hl,de		; Test only one digit
  0F79    28 0A          C      	jr	z,l0f9f		; .. yeap
  0F7B    2C             C      	inc	l
  0F7C    28 DD          C      	jr	z,l0f75
  0F7E    7D             C      	ld	a,l
  0F7F    EB             C      	ex	de,hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-39


  0F80    CD 354C        C      	call	In$BIN		; Get binary
  0F83    18 A9          C      	jr	l0f48
  0F85                   C      l0f9f:
  0F85    1A             C      	ld	a,(de)		; Get token
  0F86    D6 5C          C      	sub	5ch		; .. strip off 0
  0F88    FE 02          C      	cp	1+1		; Test range
  0F8A    18 C8          C      	jr	l0f6e
                         C      ;
                         C      ; Get octal input
                         C      ;
  0F8C                   C      Get$OCT:
  0F8C    D1             C      	pop	de
  0F8D    B7             C      	or	a
  0F8E    ED 52          C      	sbc	hl,de		; Test only one digit
  0F90    28 0A          C      	jr	z,l0fb6		; .. yeap
  0F92    2C             C      	inc	l
  0F93    28 C6          C      	jr	z,l0f75
  0F95    7D             C      	ld	a,l
  0F96    EB             C      	ex	de,hl
  0F97    CD 3530        C      	call	In$OCT		; Get octal
  0F9A    18 92          C      	jr	l0f48
  0F9C                   C      l0fb6:
  0F9C    1A             C      	ld	a,(de)		; Get token
  0F9D    D6 5C          C      	sub	5ch		; .. strip off 0
  0F9F    FE 08          C      	cp	7+1		; Test range
  0FA1    18 B1          C      	jr	l0f6e
                         C      ;
                         C      ; Get any base input
                         C      ;
  0FA3                   C      Get$NUM:
  0FA3    D1             C      	pop	de
  0FA4    B7             C      	or	a
  0FA5    ED 52          C      	sbc	hl,de		; Test only one digit
  0FA7    28 0B          C      	jr	z,l0fce		; .. yeap
  0FA9    2C             C      	inc	l
  0FAA    28 AF          C      	jr	z,l0f75
  0FAC    7D             C      	ld	a,l
  0FAD    EB             C      	ex	de,hl
  0FAE    CD 3564        C      	call	In$NUM		; Get any base number
  0FB1    C3 0F2E        C      	jp	l0f48
  0FB4                   C      l0fce:
  0FB4    3A 6615        C      	ld	a,(Radix)	; Get radix
  0FB7    4F             C      	ld	c,a
  0FB8    1A             C      	ld	a,(de)		; Get token
  0FB9    D6 5C          C      	sub	5ch		; Strip off 0
  0FBB    B9             C      	cp	c		; .. test range
  0FBC    18 96          C      	jr	l0f6e
                         C      ;
                         C      ; Get label
                         C      ;
  0FBE                   C      GetLabel:
  0FBE    3E 56          C      	ld	a,56h		; Set string
  0FC0    2B             C      	dec	hl
  0FC1                   C      l0fdb:
  0FC1    23             C      	inc	hl
  0FC2    BE             C      	cp	(hl)		; Position pointer behind token
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-40


  0FC3    DA 0FC1        C      	jp	c,l0fdb
  0FC6    ED 5B 6376     C      	ld	de,(TokStrt)	; Get start pointer
  0FCA    2B             C      	dec	hl
  0FCB    22 62F5        C      	ld	(TokPtr),hl	; Save token pointer
  0FCE    ED 52          C      	sbc	hl,de		; .. get difference
  0FD0    7D             C      	ld	a,l
  0FD1    3C             C      	inc	a
  0FD2    FE 10          C      	cp	16		; Test range
  0FD4    38 02          C      	jr	c,l0ff2
  0FD6    3E 10          C      	ld	a,16		; .. truncate max
  0FD8                   C      l0ff2:
  0FD8    6F             C      	ld	l,a
  0FD9    3C             C      	inc	a
  0FDA    32 6831        C      	ld	(l68a4),a	; Set length of label
  0FDD    19             C      	add	hl,de		; Point to end of label
  0FDE    7E             C      	ld	a,(hl)		; Get token there
  0FDF    E5             C      	push	hl
  0FE0    36 00          C      	ld	(hl),0		; .. clear temporary
  0FE2    F5             C      	push	af
  0FE3    CD 138D        C      	call	l13a7
  0FE6    D1             C      	pop	de
  0FE7    7A             C      	ld	a,d		; Get back token
  0FE8    D1             C      	pop	de
  0FE9    12             C      	ld	(de),a		; .. reset
  0FEA    3E 39          C      	ld	a,39h		; Return LABEL
  0FEC    4F             C      	ld	c,a
  0FED    C9             C      	ret
  0FEE                   C      l1008:
  0FEE                   C      	ds	5
                         C      ;
                         C      ; Got '<'
                         C      ;
  0FF3                   C      @OPER.1:
  0FF3    E1             C      	pop	hl
  0FF4    EB             C      	ex	de,hl
  0FF5    7E             C      	ld	a,(hl)
  0FF6    FE 49          C      	cp	49h		; Test <=
  0FF8    0E 4C          C      	ld	c,4ch
  0FFA    28 30          C      	jr	z,l1046
  0FFC    FE 54          C      	cp	54h		; .. <>
  0FFE    0E 4A          C      	ld	c,4ah
  1000    28 2A          C      	jr	z,l1046
  1002    FE 53          C      	cp	53h		; .. <<
  1004    0E 43          C      	ld	c,43h
  1006    28 24          C      	jr	z,l1046
  1008    2B             C      	dec	hl
  1009    0E 4B          C      	ld	c,4bh		; Set < operator
  100B    18 1F          C      	jr	l1046
                         C      ;
                         C      ; Got '>'
                         C      ;
  100D                   C      @OPER.2:
  100D    E1             C      	pop	hl
  100E    EB             C      	ex	de,hl
  100F    7E             C      	ld	a,(hl)
  1010    FE 49          C      	cp	49h		; Test >=
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-41


  1012    0E 4E          C      	ld	c,4eh
  1014    28 16          C      	jr	z,l1046
  1016    FE 54          C      	cp	54h		; .. >>
  1018    0E 42          C      	ld	c,42h
  101A    28 10          C      	jr	z,l1046
  101C    2B             C      	dec	hl
  101D    0E 4D          C      	ld	c,4dh		; Set > operator
  101F    18 0B          C      	jr	l1046
                         C      ;
                         C      ; Found any left parenthesis ( [ or {
                         C      ;
  1021                   C      @PAREN:
  1021    E1             C      	pop	hl
  1022    CD 1032        C      	call	l104c		; Get register
  1025    28 05          C      	jr	z,l1046		; .. it's closed
  1027    0E 55          C      	ld	c,55h		; Set ( [ {
  1029    2A 6376        C      	ld	hl,(TokStrt)	; Get entry pointer
  102C                   C      l1046:
  102C    22 62F5        C      	ld	(TokPtr),hl	; Save token pointer
  102F    C3 0F32        C      	jp	l0f4c
                         C      ;
                         C      ; Try to find (HL), (I..
                         C      ;
  1032                   C      l104c:
  1032    EB             C      	ex	de,hl
  1033    7E             C      	ld	a,(hl)
  1034    FE 6D          C      	cp	6dh		; Test (H..
  1036    28 20          C      	jr	z,l1072
  1038    FE 6E          C      	cp	6eh		; .. I
  103A    20 2D          C      	jr	nz,l1083
  103C    23             C      	inc	hl
  103D    7E             C      	ld	a,(hl)
  103E    FE 7E          C      	cp	7eh		; Try IY
  1040    28 22          C      	jr	z,l107e
  1042    FE 7D          C      	cp	7dh		; .. IX
  1044    C0             C      	ret	nz		; .. nope
                         C      	ld.bc	2ah,2dh
  1045    01 2A2D        C+     	ld	bc,2ah*256+2dh
  1048                   C      l1062:
  1048    23             C      	inc	hl
  1049    7E             C      	ld	a,(hl)
  104A    FE 57          C      	cp	57h		; Test valid range
  104C    30 07          C      	jr	nc,l106f	; .. nope
  104E    FE 52          C      	cp	52h		; Test closure
  1050    C8             C      	ret	z		; .. yeap
  1051    2B             C      	dec	hl
  1052    AF             C      	xor	a
  1053    48             C      	ld	c,b		; Unpack code
  1054    C9             C      	ret
  1055                   C      l106f:
  1055    AF             C      	xor	a
  1056    3C             C      	inc	a
  1057    C9             C      	ret
  1058                   C      l1072:
  1058    23             C      	inc	hl
  1059    7E             C      	ld	a,(hl)
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-42


  105A    FE 71          C      	cp	71h		; .. L
  105C    C0             C      	ret	nz
  105D    0E 16          C      	ld	c,16h		; Map HL
  105F                   C      l1079:
  105F    23             C      	inc	hl
  1060    7E             C      	ld	a,(hl)
  1061    FE 52          C      	cp	52h		; Test closure ) ] }
  1063    C9             C      	ret
  1064                   C      l107e:
                         C      	ld.bc	2bh,2eh
  1064    01 2B2E        C+     	ld	bc,2bh*256+2eh
  1067    18 DF          C      	jr	l1062
  1069                   C      l1083:
  1069    FE 69          C      	cp	69h		; Test DE
  106B    28 16          C      	jr	z,l109d		; .. maybe
  106D    FE 67          C      	cp	67h
  106F    28 1B          C      	jr	z,l10a6		; .. maybe BC
  1071    FE 68          C      	cp	68h		; Simple C
  1073    0E 31          C      	ld	c,31h
  1075    28 E8          C      	jr	z,l1079		; .. yeap
  1077    FE 78          C      	cp	78h		; Test SP
  1079    C0             C      	ret	nz		; .. nope
  107A    23             C      	inc	hl
  107B    7E             C      	ld	a,(hl)
  107C    FE 75          C      	cp	75h		; Verify SP
  107E    C0             C      	ret	nz
  107F    0E 2C          C      	ld	c,2ch		; .. map
  1081    18 DC          C      	jr	l1079
  1083                   C      l109d:
  1083    23             C      	inc	hl
  1084    7E             C      	ld	a,(hl)
  1085    FE 6A          C      	cp	6ah		; Verify DE
  1087    C0             C      	ret	nz		; .. nope
  1088    0E 30          C      	ld	c,30h		; .. map
  108A    18 D3          C      	jr	l1079
  108C                   C      l10a6:
  108C    23             C      	inc	hl
  108D    7E             C      	ld	a,(hl)
  108E    FE 68          C      	cp	68h		; Verify BC
  1090    C0             C      	ret	nz		; .. nope
  1091    0E 2F          C      	ld	c,2fh		; .. map
  1093    18 CA          C      	jr	l1079
                         C      ;
                         C      ; Opcode type table
                         C      ;
  1095                   C      OpCodTab:
                         C      ;
                         C      ; Part 1 : Regular opcodes
                         C      ;
  1095    05 88 4A       C      	db	 5,088h,04ah	; 58	ADC
  1098    06 09 80       C      	db	 6,009h,080h	; 59	ADD
  109B    07 A0 00       C      	db	 7,0a0h,000h	; 5A	AND
  109E    08 40 00       C      	db	 8,040h,000h	; 5B	BIT
  10A1    03 CD C4       C      	db	 3,0cdh,0c4h	; 5C	CALL
  10A4    01 3F 00       C      	db	 1,03fh,000h	; 5D	CCF
  10A7    07 B8 00       C      	db	 7,0b8h,000h	; 5E	CP
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-43


  10AA    02 A9 00       C      	db	 2,0a9h,000h	; 5F	CPDR
  10AD    02 B9 00       C      	db	 2,0b9h,000h	; 60	CPD
  10B0    02 A1 00       C      	db	 2,0a1h,000h	; 61	CPIR
  10B3    02 B1 00       C      	db	 2,0b1h,000h	; 62	CPI
  10B6    01 2F 00       C      	db	 1,02fh,000h	; 63	CPL
  10B9    01 27 00       C      	db	 1,027h,000h	; 64	DAA
  10BC    09 05 0B       C      	db	 9,005h,00bh	; 65	DEC
  10BF    01 F3 00       C      	db	 1,0f3h,000h	; 66	DI
                         C      	val.adr	 0,l2cc9	; 67	DJNZ
  10C2    00             C+     	db	0
  10C3    2C6E           C+     	dw	l2cc9
  10C5    01 FB 00       C      	db	 1,0fbh,000h	; 68	EI
                         C      	val.adr	 0,l2f94	; 69	EX
  10C8    00             C+     	db	0
  10C9    2F39           C+     	dw	l2f94
  10CB    01 D9 00       C      	db	 1,0d9h,000h	; 6A	EXX
  10CE    01 76 00       C      	db	 1,076h,000h	; 6B	HALT
                         C      	val.adr	 0,l2cba	; 6C	IM
  10D1    00             C+     	db	0
  10D2    2C5F           C+     	dw	l2cba
                         C      	val.adr	 0,l2f32	; 6D	IN
  10D4    00             C+     	db	0
  10D5    2ED7           C+     	dw	l2f32
                         C      	val.adr	 0,l2ed2	; 6E	IN0
  10D7    00             C+     	db	0
  10D8    2E77           C+     	dw	l2ed2
  10DA    09 04 03       C      	db	 9,004h,003h	; 6F	INC
  10DD    02 AA 00       C      	db	 2,0aah,000h	; 70	IND
  10E0    02 BA 00       C      	db	 2,0bah,000h	; 71	INDR
  10E3    02 A2 00       C      	db	 2,0a2h,000h	; 72	INI
  10E6    02 B2 00       C      	db	 2,0b2h,000h	; 73	INIR
  10E9    0A C3 C2       C      	db	10,0c3h,0c2h	; 74	JP
                         C      	val.adr	 0,l2cd0	; 75	JR
  10EC    00             C+     	db	0
  10ED    2C75           C+     	dw	l2cd0
                         C      	val.adr	 0,l2e11	; 76	LD
  10EF    00             C+     	db	0
  10F0    2DB6           C+     	dw	l2e11
  10F2    02 A8 00       C      	db	 2,0a8h,000h	; 77	LDD
  10F5    02 B8 00       C      	db	 2,0b8h,000h	; 78	LDDR
  10F8    02 A0 00       C      	db	 2,0a0h,000h	; 79	LDI
  10FB    02 B0 00       C      	db	 2,0b0h,000h	; 7A	LDIR
                         C      	val.adr	 0,l2ef7	; 7B	MLT
  10FE    00             C+     	db	0
  10FF    2E9C           C+     	dw	l2ef7
  1101    02 44 00       C      	db	 2,044h,000h	; 7C	NEG
  1104    01 00 00       C      	db	 1,000h,000h	; 7D	NOP
  1107    07 B0 00       C      	db	 7,0b0h,000h	; 7E	OR
  110A    02 8B 00       C      	db	 2,08bh,000h	; 7F	OTDM
  110D    02 9B 00       C      	db	 2,09bh,000h	; 80	OTDMR
  1110    02 BB 00       C      	db	 2,0bbh,000h	; 81	OTDR
  1113    02 83 00       C      	db	 2,083h,000h	; 82	OTIM
  1116    02 93 00       C      	db	 2,093h,000h	; 83	OTIMR
  1119    02 B3 00       C      	db	 2,0b3h,000h	; 84	OTIR
                         C      	val.adr	 0,l2f5a	; 85	OUT
  111C    00             C+     	db	0
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-44


  111D    2EFF           C+     	dw	l2f5a
                         C      	val.adr	 0,l2ee6	; 86	OUT0
  111F    00             C+     	db	0
  1120    2E8B           C+     	dw	l2ee6
  1122    02 AB 00       C      	db	 2,0abh,000h	; 87	OUTD
  1125    02 A3 00       C      	db	 2,0a3h,000h	; 88	OUTI
  1128    0B C1 00       C      	db	11,0c1h,000h	; 89	POP
  112B    0B C5 00       C      	db	11,0c5h,000h	; 8A	PUSH
  112E    08 80 00       C      	db	 8,080h,000h	; 8B	RES
                         C      	val.adr	 0,l2ec3	; 8C	RET
  1131    00             C+     	db	0
  1132    2E68           C+     	dw	l2ec3
  1134    02 4D 00       C      	db	 2,04dh,000h	; 8D	RETI
  1137    02 45 00       C      	db	 2,045h,000h	; 8E	RETN
  113A    04 10 00       C      	db	 4,010h,000h	; 8F	RL
  113D    01 17 00       C      	db	 1,017h,000h	; 90	RLA
  1140    04 00 00       C      	db	 4,000h,000h	; 91	RLC
  1143    01 07 00       C      	db	 1,007h,000h	; 92	RLCA
  1146    02 6F 00       C      	db	 2,06fh,000h	; 93	RLD
  1149    04 18 00       C      	db	 4,018h,000h	; 94	RR
  114C    01 1F 00       C      	db	 1,01fh,000h	; 95	RRA
  114F    04 08 00       C      	db	 4,008h,000h	; 96	RRC
  1152    01 0F 00       C      	db	 1,00fh,000h	; 97	RRCA
  1155    02 67 00       C      	db	 2,067h,000h	; 98	RRD
                         C      	val.adr	 0,l2fe3	; 99	RST
  1158    00             C+     	db	0
  1159    2F88           C+     	dw	l2fe3
  115B    05 98 42       C      	db	 5,098h,042h	; 9A	SBC
  115E    01 37 00       C      	db	 1,037h,000h	; 9B	SCF
  1161    08 C0 00       C      	db	 8,0c0h,000h	; 9C	SET
  1164    04 20 00       C      	db	 4,020h,000h	; 9D	SLA
  1167    02 76 00       C      	db	 2,076h,000h	; 9E	SLP
  116A    04 28 00       C      	db	 4,028h,000h	; 9F	SRA
  116D    04 38 00       C      	db	 4,038h,000h	; A0	SRL
  1170    07 90 00       C      	db	 7,090h,000h	; A1	SUB
                         C      	val.adr	 0,l2f04	; A2	TST
  1173    00             C+     	db	0
  1174    2EA9           C+     	dw	l2f04
                         C      	val.adr	 0,l2f24	; A3	TSTIO
  1176    00             C+     	db	0
  1177    2EC9           C+     	dw	l2f24
  1179    07 A8 00       C      	db	 7,0a8h,000h	; A4	XOR
                         C      ;
                         C      ; Part 2 : Pseudo opcodes
                         C      ;
                         C      	val.adr	 0,l3e95	; A5	ASEG
  117C    00             C+     	db	0
  117D    3E3A           C+     	dw	l3e95
                         C      	val.adr	12,_FALSE_	; A6	LFCOND
  117F    0C             C+     	db	12
  1180    62C5           C+     	dw	_FALSE_
                         C      	val.adr	 0,l3f47	; A7	COMMON
  1182    00             C+     	db	0
  1183    3EEC           C+     	dw	l3f47
                         C      	val.adr	 0,l4033	; A8	DSEG
  1185    00             C+     	db	0
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-45


  1186    3FD8           C+     	dw	l4033
                         C      	val.adr	 0,l4079	; A9	DB
  1188    00             C+     	db	0
  1189    401E           C+     	dw	l4079
                         C      	val.adr	 0,l4370	; AA	ASET
  118B    00             C+     	db	0
  118C    4315           C+     	dw	l4370
                         C      	val.adr	 0,l416c	; AB	DS
  118E    00             C+     	db	0
  118F    4111           C+     	dw	l416c
                         C      	val.adr	 0,l4228	; AC	DW
  1191    00             C+     	db	0
  1192    41CD           C+     	dw	l4228
                         C      	val.adr	 0,l425a	; AD	.DEPHASE
  1194    00             C+     	db	0
  1195    41FF           C+     	dw	l425a
                         C      	val.adr	 0,l4283	; AE	???
  1197    00             C+     	db	0
  1198    4228           C+     	dw	l4283
                         C      	val.adr	 0,l42a4	; AF	END
  119A    00             C+     	db	0
  119B    4249           C+     	dw	l42a4
                         C      	val.adr	 0,l42db	; B0	ENDIF
  119D    00             C+     	db	0
  119E    4280           C+     	dw	l42db
                         C      	val.adr	 0,l42fd	; B1	ENDM
  11A0    00             C+     	db	0
  11A1    42A2           C+     	dw	l42fd
                         C      	val.adr	 0,l4302	; B2	ENTRY
  11A3    00             C+     	db	0
  11A4    42A7           C+     	dw	l4302
                         C      	val.adr	 0,l4374	; B3	EQU
  11A6    00             C+     	db	0
  11A7    4319           C+     	dw	l4374
                         C      	val.adr	 0,l4404	; B4	EXTERN
  11A9    00             C+     	db	0
  11AA    43A9           C+     	dw	l4404
                         C      	val.adr	 0,l4541	; B5	IF
  11AC    00             C+     	db	0
  11AD    44E6           C+     	dw	l4541
                         C      	val.adr	 0,l4590	; B6	INCLUDE
  11AF    00             C+     	db	0
  11B0    4535           C+     	dw	l4590
                         C      	val.adr	 0,l47fa	; B7	LIST
  11B2    00             C+     	db	0
  11B3    479F           C+     	dw	l47fa
                         C      	val.adr	 0,l4943	; B8	MACRO
  11B5    00             C+     	db	0
  11B6    48E8           C+     	dw	l4943
                         C      	val.adr	12,_FOUR_	; B9	MTLIST
  11B8    0C             C+     	db	12
  11B9    62C4           C+     	dw	_FOUR_
                         C      	val.adr	 0,l4a25	; BA	NAME
  11BB    00             C+     	db	0
  11BC    49CA           C+     	dw	l4a25
                         C      	val.adr	13,_FALSE_	; BB	.SFCOND
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-46


  11BE    0D             C+     	db	13
  11BF    62C5           C+     	dw	_FALSE_
                         C      	val.adr	 0,l4a74	; BC	.XLIST
  11C1    00             C+     	db	0
  11C2    4A19           C+     	dw	l4a74
                         C      	val.adr	13,_FOUR_	; BD	NMTLIST
  11C4    0D             C+     	db	13
  11C5    62C4           C+     	dw	_FOUR_
                         C      	val.adr	 0,l4a8e	; BE	ORG
  11C7    00             C+     	db	0
  11C8    4A33           C+     	dw	l4a8e
                         C      	val.adr	 0,l4af1	; BF	EJECT
  11CA    00             C+     	db	0
  11CB    4A96           C+     	dw	l4af1
                         C      	val.adr	 0,l4b40	; C0	.PHASE
  11CD    00             C+     	db	0
  11CE    4AE5           C+     	dw	l4b40
                         C      	val.adr	 0,l4b8d	; C1	CSEG
  11D0    00             C+     	db	0
  11D1    4B32           C+     	dw	l4b8d
                         C      	val.adr	 0,l4cf8	; C2	TITLE
  11D3    00             C+     	db	0
  11D4    4C9D           C+     	dw	l4cf8
                         C      	val.adr	 0,l3eb0	; C3	.ACCEPT
  11D6    00             C+     	db	0
  11D7    3E55           C+     	dw	l3eb0
                         C      	val.adr	 0,l3fed	; C4	.COMMENT
  11D9    00             C+     	db	0
  11DA    3F92           C+     	dw	l3fed
                         C      	val.adr	 0,l4018	; C5	.CREF
  11DC    00             C+     	db	0
  11DD    3FBD           C+     	dw	l4018
                         C      	val.adr	 0,l43cc	; C6	EXITM
  11DF    00             C+     	db	0
  11E0    4371           C+     	dw	l43cc
  11E2    02 46 00       C      	db	 2,046h,000h	; C7	IM0
  11E5    02 56 00       C      	db	 2,056h,000h	; C8	IM1
  11E8    02 5E 00       C      	db	 2,05eh,000h	; C9	IM2
                         C      	val.adr	 0,l4727	; CA	IRPC
  11EB    00             C+     	db	0
  11EC    46CC           C+     	dw	l4727
                         C      	val.adr	 0,l472c	; CB	IRP
  11EE    00             C+     	db	0
  11EF    46D1           C+     	dw	l472c
                         C      	val.adr	 0,l3ea2	; CC	.LALL
  11F1    00             C+     	db	0
  11F2    3E47           C+     	dw	l3ea2
                         C      	val.adr	 0,l4817	; CD	LOCAL
  11F4    00             C+     	db	0
  11F5    47BC           C+     	dw	l4817
                         C      	val.adr	 0,l457e	; CE	MACLIB
  11F7    00             C+     	db	0
  11F8    4523           C+     	dw	l457e
                         C      	val.adr	 0,l4c05	; CF	REPT
  11FA    00             C+     	db	0
  11FB    4BAA           C+     	dw	l4c05
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-47


                         C      	val.adr	 0,l4c69	; D0	.REQUEST
  11FD    00             C+     	db	0
  11FE    4C0E           C+     	dw	l4c69
                         C      	val.adr	 0,l3ea6	; D1	.SALL
  1200    00             C+     	db	0
  1201    3E4B           C+     	dw	l3ea6
                         C      	val.adr	 0,l4cd4	; D2	SUBTTL
  1203    00             C+     	db	0
  1204    4C79           C+     	dw	l4cd4
                         C      	val.adr	 0,l3eaa	; D3	.XALL
  1206    00             C+     	db	0
  1207    3E4F           C+     	dw	l3eaa
                         C      	val.adr	 0,l4d96	; D4	.XCREF
  1209    00             C+     	db	0
  120A    4D3B           C+     	dw	l4d96
                         C      	val.adr	 0,l4060	; D5	.Z80
  120C    00             C+     	db	0
  120D    4005           C+     	dw	l4060
                         C      	val.adr	 0,l44f2	; D6	IF0
  120F    00             C+     	db	0
  1210    4497           C+     	dw	l44f2
                         C      	val.adr	 0,l44f6	; D7	IF1
  1212    00             C+     	db	0
  1213    449B           C+     	dw	l44f6
                         C      	val.adr	 0,l44f9	; D8	IF2
  1215    00             C+     	db	0
  1216    449E           C+     	dw	l44f9
                         C      	val.adr	 0,l4509	; D9	IFDEF
  1218    00             C+     	db	0
  1219    44AE           C+     	dw	l4509
                         C      	val.adr	 0,l44d9	; DA	IFDIF
  121B    00             C+     	db	0
  121C    447E           C+     	dw	l44d9
                         C      	val.adr	 0,l44d4	; DB	IFIDN
  121E    00             C+     	db	0
  121F    4479           C+     	dw	l44d4
                         C      	val.adr	 0,l44de	; DC	IFB
  1221    00             C+     	db	0
  1222    4483           C+     	dw	l44de
                         C      	val.adr	 0,l4531	; DD	IFF
  1224    00             C+     	db	0
  1225    44D6           C+     	dw	l4531
                         C      	val.adr	 0,l44e8	; DE	IFNB
  1227    00             C+     	db	0
  1228    448D           C+     	dw	l44e8
                         C      	val.adr	 0,l4518	; DF	IFNDEF
  122A    00             C+     	db	0
  122B    44BD           C+     	dw	l4518
                         C      	val.adr	 0,l4cbb	; E0	.PRINTX
  122D    00             C+     	db	0
  122E    4C60           C+     	dw	l4cbb
                         C      	val.adr	 0,l406e	; E1	DC
  1230    00             C+     	db	0
  1231    4013           C+     	dw	l406e
                         C      	val.adr	 0,l4075	; E2	DEFZ
  1233    00             C+     	db	0
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-48


  1234    401A           C+     	dw	l4075
                         C      	val.adr	 0,l43fc	; E3	BYTE
  1236    00             C+     	db	0
  1237    43A1           C+     	dw	l43fc
                         C      	val.adr	 0,l4b9b	; E4	.RADIX
  1239    00             C+     	db	0
  123A    4B40           C+     	dw	l4b9b
                         C      	val.adr	 0,l4cf1	; E5	.TFCOND
  123C    00             C+     	db	0
  123D    4C96           C+     	dw	l4cf1
                         C      	val.adr	 0,l4cd4	; E6	$TITLE
  123F    00             C+     	db	0
  1240    4C79           C+     	dw	l4cd4
                         C      ;
                         C      ; Jump vectors to l6392
                         C      ; Jump table 1.1 -> Requested ABS mode
                         C      ;
  1242                   C      l125c:
  1242    C3 506D        C      	jp	IllConst	; l6392
  1245    C3 506D        C      	jp	IllConst	; l6395
  1248    C3 55BA        C      	jp	Ini$ABS		; Ini$FO
  124B    C3 5118        C      	jp	Con$ABS		; Con$Put
  124E    C3 511B        C      	jp	ABS.Const	; l639e
  1251    C3 544D        C      	jp	l54a8		; l63a1
  1254    C3 5365        C      	jp	l53c0		; l63a4
  1257    C3 52D9        C      	jp	l5334		; l63a7
  125A    C3 506D        C      	jp	IllConst	; l63aa
  125D    C3 50F0        C      	jp	l514b		; l63ad
  1260    C3 3B68        C      	jp	l3bc3		; l63b0
  1263    C3 506D        C      	jp	IllConst	; l63b3
  1266    C3 506D        C      	jp	IllConst	; l63b6
  1269    C3 506D        C      	jp	IllConst	; l63b9
  126C    C3 3C30        C      	jp	l3c8b		; l63bc
                         C      ;
                         C      ; Jump table 1.2 -> Requested HEX mode
                         C      ;
  126F                   C      l1289:
  126F    C3 506D        C      	jp	IllConst
  1272    C3 506D        C      	jp	IllConst
  1275    C3 55EF        C      	jp	Ini$HEX
  1278    C3 5118        C      	jp	Con$ABS
  127B    C3 511B        C      	jp	ABS.Const
  127E    C3 53EC        C      	jp	l5447
  1281    C3 52FB        C      	jp	l5356
  1284    C3 51EE        C      	jp	l5249
  1287    C3 506D        C      	jp	IllConst
  128A    C3 50F0        C      	jp	l514b
  128D    C3 3B68        C      	jp	l3bc3
  1290    C3 506D        C      	jp	IllConst
  1293    C3 506D        C      	jp	IllConst
  1296    C3 506D        C      	jp	IllConst
  1299    C3 3C30        C      	jp	l3c8b
                         C      ;
                         C      ; Jump table 1.3 -> Requested REL-80 format
                         C      ;
  129C                   C      l12b6:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-49


  129C    C3 570B        C      	jp	WrSPC.opcode
  129F    C3 579C        C      	jp	REL.Const
  12A2    C3 5607        C      	jp	Ini$REL
  12A5    C3 5799        C      	jp	Con$REL
  12A8    C3 579C        C      	jp	REL.Const
  12AB    C3 544D        C      	jp	l54a8
  12AE    C3 5316        C      	jp	l5371
  12B1    C3 51FD        C      	jp	l5258
  12B4    C3 5889        C      	jp	l58e4
  12B7    C3 574B        C      	jp	l57a6
  12BA    C3 3B68        C      	jp	l3bc3
  12BD    C3 56E0        C      	jp	l573b
  12C0    C3 56E5        C      	jp	l5740
  12C3    C3 57E0        C      	jp	SPC.push
  12C6    C3 3C30        C      	jp	l3c8b
                         C      ;
                         C      ; Jump table 1.4 -> Requested SLR format
                         C      ;
  12C9                   C      l12e3:
  12C9    C3 5961        C      	jp	l59bc
  12CC    C3 5499        C      	jp	l54f4
  12CF    C3 5976        C      	jp	Ini$SLR
  12D2    C3 5474        C      	jp	Con$SLR
  12D5    C3 5477        C      	jp	SLR.Const
  12D8    C3 506D        C      	jp	IllConst
  12DB    C3 5321        C      	jp	l537c
  12DE    C3 5A24        C      	jp	l5a7f
  12E1    C3 591A        C      	jp	l5975
  12E4    C3 574B        C      	jp	l57a6
  12E7    C3 3B68        C      	jp	l3bc3
  12EA    C3 56D4        C      	jp	l572f
  12ED    C3 56DC        C      	jp	l5737
  12F0    C3 590B        C      	jp	l5966
  12F3    C3 3C30        C      	jp	l3c8b
                         C      ;
                         C      ; Jump table 1.5
                         C      ;
  12F6                   C      l1310:
  12F6    C3 5961        C      	jp	l59bc
  12F9    C3 2FB8        C      	jp	l3013
  12FC    C3 0000        C      	jp	OS
  12FF    C3 2F99        C      	jp	l2ff4
  1302    C3 2F9C        C      	jp	l2ff7
  1305    C3 0000        C      	jp	OS
  1308    C3 137F        C      	jp	l1399
  130B    C3 0000        C      	jp	OS
  130E    C3 5912        C      	jp	l596d
  1311    C3 506D        C      	jp	IllConst
  1314    C3 1384        C      	jp	l139e
  1317    C3 506D        C      	jp	IllConst
  131A    C3 506D        C      	jp	IllConst
  131D    C3 3CFF        C      	jp	l3d5a
  1320    C3 3C34        C      	jp	l3c8f
                         C      ;
                         C      ; Jump table 1.6
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-50


  1323                   C      l133d:
  1323    C3 1343        C      	jp	ImRet
  1326    C3 1343        C      	jp	ImRet
  1329    C3 1343        C      	jp	ImRet
  132C    C3 137C        C      	jp	Inc.y
  132F    C3 137C        C      	jp	Inc.y
  1332    C3 0000        C      	jp	OS
  1335    C3 1343        C      	jp	ImRet
  1338    C3 0000        C      	jp	OS
  133B    C3 137A        C      	jp	Inc..y
  133E    C3 506D        C      	jp	IllConst
  1341    3E 0F          C      	ld	a,0fh
  1343                   C      ImRet:
  1343    C9             C      	ret
  1344    C3 1343        C      	jp	ImRet
  1347    C3 1343        C      	jp	ImRet
  134A    C3 1343        C      	jp	ImRet
  134D    C3 137A        C      	jp	Inc..y
                         C      ;
                         C      ; Jump table 2.1
                         C      ;
  1350                   C      l136a:
  1350    C3 0CED        C      	jp	l0d07		; FN 1	l63bf
  1353    C3 0D18        C      	jp	l0d32		; FN 2	l63c2
  1356    C3 0BDB        C      	jp	l0bf5		; FN 3	l63c5
  1359    C3 0D5E        C      	jp	l0d78		; FN 4	l63c8
  135C    C3 0CDC        C      	jp	l0cf6		; FN 5	l63cb
  135F    C3 087C        C      	jp	l0896		; FN 6	l63ce
  1362    C3 4DCF        C      	jp	l4e2a		; FN 7	l63d1
                         C      ;
                         C      ; Jump table 2.2
                         C      ;
  1365                   C      l137f:
  1365    C3 137C        C      	jp	Inc.y		; FN 1
  1368    C3 137A        C      	jp	Inc..y		; FN 2
  136B    C9             C      	ret			; FN 3 --
  136C    00             C      	nop
  136D    00             C      	nop
  136E    C3 137A        C      	jp	Inc..y		; FN 4
  1371    C3 137C        C      	jp	Inc.y		; FN 5
  1374    C9             C      	ret			; FN 6 --
  1375    00             C      	nop
  1376    00             C      	nop
  1377    C9             C      	ret			; FN 7 --
  1378    00             C      	nop
  1379    00             C      	nop
  137A                   C      l1394	equ	$
                         C      ;
                         C      ; Increment IY by 2
                         C      ;
  137A                   C      Inc..y:
  137A    FD 23          C      	inc	iy
                         C      ;
                         C      ; Increment IY by 1
                         C      ;
  137C                   C      Inc.y:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-51


  137C    FD 23          C      	inc	iy
  137E    C9             C      	ret
  137F                   C      l1399:
  137F    F6 A0          C      	or	0a0h
  1381    C3 51C8        C      	jp	l5223
  1384                   C      l139e:
  1384    CB C6          C      	set	0,(hl)
  1386    3E 0F          C      	ld	a,0fh
  1388    C9             C      	ret
  1389                   C      l13a3:
  1389    0000           C      	dw	0
  138B                   C      l13a5:
  138B    37             C      	scf
  138C    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  138D                   C      l13a7:
  138D    CD 142A        C      	call	l1444		; May be RET, CALL or JP
  1390                   C      l13aa:
  1390    30 F9          C      	jr	nc,l13a5	; .. may be RET
  1392    E5             C      	push	hl
  1393    EB             C      	ex	de,hl
  1394    2A 661D        C      	ld	hl,(l6690)
  1397    23             C      	inc	hl
  1398    23             C      	inc	hl
  1399    22 661D        C      	ld	(l6690),hl
  139C    2B             C      	dec	hl
  139D    37             C      	scf
  139E    ED 52          C      	sbc	hl,de
  13A0    28 0C          C      	jr	z,l13c8
  13A2    44             C      	ld	b,h
  13A3    4D             C      	ld	c,l
  13A4    2A 661D        C      	ld	hl,(l6690)
  13A7    2B             C      	dec	hl
  13A8    54             C      	ld	d,h
  13A9    5D             C      	ld	e,l
  13AA    2B             C      	dec	hl
  13AB    2B             C      	dec	hl
  13AC    ED B8          C      	lddr
  13AE                   C      l13c8:
  13AE    2A 1389        C      	ld	hl,(l13a3)
  13B1    2C             C      	inc	l
  13B2    3A 6831        C      	ld	a,(l68a4)
  13B5    85             C      	add	a,l
  13B6    06 00          C      	ld	b,0
  13B8    4F             C      	ld	c,a
  13B9    CD 229A        C      	call	d.alloc_	; Allocate memory
  13BC    D1             C      	pop	de
  13BD    E5             C      	push	hl
  13BE    EB             C      	ex	de,hl
  13BF    73             C      	ld	(hl),e
  13C0    23             C      	inc	hl
  13C1    72             C      	ld	(hl),d
  13C2    21 0FEE        C      	ld	hl,l1008
  13C5    ED A0          C      	ldi
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-52


  13C7    ED A0          C      	ldi
  13C9    ED A0          C      	ldi
  13CB    3A 6819        C      	ld	a,(l688c)
  13CE    B7             C      	or	a
  13CF    28 04          C      	jr	z,l13ef
  13D1    ED A0          C      	ldi
  13D3    ED A0          C      	ldi
  13D5                   C      l13ef:
  13D5    2A 6376        C      	ld	hl,(TokStrt)	; Get start pointer
  13D8    ED B0          C      	ldir			; .. unpack tokens
  13DA    2A 661F        C      	ld	hl,(l6692)
  13DD    2B             C      	dec	hl
  13DE    22 661F        C      	ld	(l6692),hl
  13E1    7C             C      	ld	a,h
  13E2    B5             C      	or	l
  13E3    E1             C      	pop	hl
  13E4    C0             C      	ret	nz
  13E5    E5             C      	push	hl
  13E6    01 03ED        C      	ld	bc,l0400
  13E9    CD 22D9        C      	call	alloc_		; Allocate memory
  13EC    2A 631B        C      	ld	hl,(DynPtr2)	; Get pointer
  13EF    09             C      	add	hl,bc		; .. bump
  13F0    22 631B        C      	ld	(DynPtr2),hl
  13F3    21 0200        C      	ld	hl,l0200
  13F6    22 661F        C      	ld	(l6692),hl
  13F9    D9             C      	exx
  13FA    D5             C      	push	de
  13FB    14             C      	inc	d
  13FC    14             C      	inc	d
  13FD    14             C      	inc	d
  13FE    14             C      	inc	d
  13FF    24             C      	inc	h
  1400    24             C      	inc	h
  1401    24             C      	inc	h
  1402    24             C      	inc	h
  1403    D9             C      	exx
  1404    E1             C      	pop	hl
  1405    54             C      	ld	d,h
  1406    5D             C      	ld	e,l
  1407    ED 4B 6624     C      	ld	bc,(l6697)
  140B    ED 42          C      	sbc	hl,bc
  140D    28 0B          C      	jr	z,l1434
  140F    44             C      	ld	b,h
  1410    4D             C      	ld	c,l
  1411    62             C      	ld	h,d
  1412    6B             C      	ld	l,e
  1413    14             C      	inc	d
  1414    14             C      	inc	d
  1415    14             C      	inc	d
  1416    14             C      	inc	d
  1417    03             C      	inc	bc
  1418    ED B8          C      	lddr
  141A                   C      l1434:
  141A    21 6625        C      	ld	hl,l6697+1
  141D    7E             C      	ld	a,(hl)
  141E    C6 04          C      	add	a,4
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-53


  1420    77             C      	ld	(hl),a
  1421    21 6627        C      	ld	hl,TopPtr+1
  1424    7E             C      	ld	a,(hl)		; Get pages
  1425    C6 04          C      	add	a,4		; .. bump
  1427    77             C      	ld	(hl),a
  1428    E1             C      	pop	hl
  1429    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  142A                   C      l1444:
  142A    2A 6376        C      	ld	hl,(TokStrt)	; Get start pointer
  142D    22 1454        C      	ld	(l146e),hl	; .. save
  1430    01 6BDA        C      	ld	bc,l6c4d	; Load top
  1433    2A 661D        C      	ld	hl,(l6690)
  1436    22 69F6        C      	ld	(l6a69),hl	; Unpack pointer
  1439    18 04          C      	jr	l1459
  143B                   C      l1455:
  143B    2A 69F6        C      	ld	hl,(l6a69)
  143E    03             C      	inc	bc
  143F                   C      l1459:
  143F    37             C      	scf
  1440    ED 42          C      	sbc	hl,bc		; Test pointer reached
  1442    28 2E          C      	jr	z,l148c		; .. yeap
  1444    CB 3C          C      	srl	h		; .. divide by two
  1446    CB 1D          C      	rr	l
  1448    CB C5          C      	set	0,l		; .. make odd
  144A    09             C      	add	hl,bc		; Position address
  144B    E5             C      	push	hl
  144C    5E             C      	ld	e,(hl)		; Fetch pointer
  144D    23             C      	inc	hl
  144E    56             C      	ld	d,(hl)
  144F    2A 1389        C      	ld	hl,(l13a3)	; Get base
  1452    19             C      	add	hl,de
  1453    11 67DF        C      	ld	de,l6852
  1454                   C      l146e	equ	$-2
  1456                   C      l1470:
  1456    1A             C      	ld	a,(de)
  1457    BE             C      	cp	(hl)
  1458    20 0D          C      	jr	nz,l1481
  145A    13             C      	inc	de
  145B    23             C      	inc	hl
  145C    B7             C      	or	a
  145D    20 F7          C      	jr	nz,l1470
  145F    E1             C      	pop	hl
  1460    5E             C      	ld	e,(hl)
  1461    23             C      	inc	hl
  1462    56             C      	ld	d,(hl)
  1463    EB             C      	ex	de,hl
  1464                   C      $CrsEna:
  1464    C3 1479        C      	jp	l1493		; RET if disabled
  1465                   C      $CrsVec	equ	$-2
  1467                   C      l1481:
  1467    30 06          C      	jr	nc,l1489
  1469    E1             C      	pop	hl
  146A    22 69F6        C      	ld	(l6a69),hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-54


  146D    18 D0          C      	jr	l1459
  146F                   C      l1489:
  146F    C1             C      	pop	bc
  1470    18 C9          C      	jr	l1455
  1472                   C      l148c:
  1472    F6 FF          C      	or	ALL
  1474    37             C      	scf
  1475    2A 69F6        C      	ld	hl,(l6a69)
  1478    C9             C      	ret
                         C      ;
                         C      ; 1st pass cross ref
                         C      ;
  1479                   C      l1493:
  1479    23             C      	inc	hl
  147A    23             C      	inc	hl
  147B    23             C      	inc	hl
  147C    34             C      	inc	(hl)
  147D    28 04          C      	jr	z,l149d
  147F                   C      l1499:
  147F    2B             C      	dec	hl
  1480    2B             C      	dec	hl
  1481    2B             C      	dec	hl
  1482    C9             C      	ret
  1483                   C      l149d:
  1483    23             C      	inc	hl
  1484    34             C      	inc	(hl)
  1485    2B             C      	dec	hl
  1486    18 F7          C      	jr	l1499
                         C      ;
                         C      ; 2nd pass and one pass only cross ref
                         C      ;
  1488                   C      l14a2:
  1488    D5             C      	push	de
  1489    23             C      	inc	hl
  148A    23             C      	inc	hl
  148B    23             C      	inc	hl
  148C    5E             C      	ld	e,(hl)
  148D    23             C      	inc	hl
  148E    56             C      	ld	d,(hl)
  148F    E5             C      	push	hl
  1490    D5             C      	push	de
  1491    EB             C      	ex	de,hl
  1492    7E             C      	ld	a,(hl)
  1493    23             C      	inc	hl
  1494    B6             C      	or	(hl)
  1495    D1             C      	pop	de
  1496    20 1B          C      	jr	nz,l14cd
  1498    21 6621        C      	ld	hl,l6694
  149B    3A 0127        C      	ld	a,($LIN.NR$)	; Test # statement
  149E    B7             C      	or	a
  149F    20 0C          C      	jr	nz,l14c7	; .. yeap
  14A1    21 67FA        C      	ld	hl,CurLine	; Get current line
  14A4    3A 67BA        C      	ld	a,(l682d)	; Get flag
  14A7    B7             C      	or	a
  14A8    28 03          C      	jr	z,l14c7		; .. zero
  14AA    21 62F9        C      	ld	hl,l636c
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-55


  14AD                   C      l14c7:
  14AD    ED A0          C      	ldi			; .. unpack line
  14AF    ED A0          C      	ldi
  14B1    ED A0          C      	ldi
  14B3                   C      l14cd:
  14B3    E1             C      	pop	hl
  14B4    72             C      	ld	(hl),d
  14B5    2B             C      	dec	hl
  14B6    73             C      	ld	(hl),e
  14B7    2B             C      	dec	hl
  14B8    2B             C      	dec	hl
  14B9    2B             C      	dec	hl
  14BA    D1             C      	pop	de
  14BB    C9             C      	ret
                         C      ;
                         C      ; Read line from file and convert to token
                         C      ;
  14BC                   C      GetLine:
  14BC    CD 14C2        C      	call	RdLine		; Read line
  14BF    C3 1662        C      	jp	CnvToken	; .. convert to token
                         C      ;
                         C      ; Get line from file
                         C      ;
  14C2                   C      RdLine:
  14C2    C3 14C5        C      	jp	.RdLine
  14C3                   C      $LinVec	equ	$-2
                         C      ;
                         C      ; Real processing from file
                         C      ;
  14C5                   C      .RdLine:
  14C5    3A 6314        C      	ld	a,(l6387)
  14C8    FE 04          C      	cp	4
  14CA    C4 6352        C      	call	nz,l63c5
  14CD    3E C3          C      	ld	a,_JP
  14CF    32 07D7        C      	ld	(l07f1),a
  14D2    3A 67FF        C      	ld	a,(_rPage_)	; Get page count
  14D5    B7             C      	or	a
  14D6    06 80          C      	ld	b,RecLng	; Set default length
  14D8    28 05          C      	jr	z,l14f9		; .. done
  14DA    FE 80          C      	cp	RecLng		; Test max
  14DC    30 01          C      	jr	nc,l14f9
  14DE    47             C      	ld	b,a		; Truncate
  14DF                   C      l14f9:
  14DF    21 67FC        C      	ld	hl,CurLine+2
  14E2    CD 0CAA        C      	call	IncBCD		; Increment current line
  14E5    2A 67FD        C      	ld	hl,(l6870)
  14E8    0E 7F          C      	ld	c,NoMSB		; Set mask
  14EA    11 026D        C      	ld	de,$SRCline$	; Init line
  14ED    F6 FF          C      	or	ALL		; Set all bits ?????????
  14EF    18 09          C      	jr	l1514
  14F1                   C      l150b:
  14F1    7E             C      	ld	a,(hl)		; Get from source
  14F2                   C      @EIGHT@:
  14F2    A1             C      	and	c		; .. mask or NOP
  14F3    23             C      	inc	hl
  14F4    12             C      	ld	(de),a		; Save to line
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-56


  14F5    FE 20          C      	cp	' '		; Test control
  14F7    38 13          C      	jr	c,l1526
  14F9                   C      l1513:
  14F9    1C             C      	inc	e		; Bump pointer
  14FA                   C      l1514:
  14FA    10 F5          C      	djnz	l150b
  14FC    28 60          C      	jr	z,l1578
  14FE    3A 6800        C      	ld	a,(_rPage_+1)	; Count down pages
  1501    3D             C      	dec	a
  1502    32 6800        C      	ld	(_rPage_+1),a
  1505    28 78          C      	jr	z,l1599		; .. get from file
  1507                   C      l1521:
  1507    AF             C      	xor	a
  1508    93             C      	sub	e
  1509    47             C      	ld	b,a
  150A    18 E5          C      	jr	l150b
  150C                   C      l1526:
  150C    FE 0A          C      	cp	lf		; Test range
  150E    38 E9          C      	jr	c,l1513		; Allow some control
  1510    28 53          C      	jr	z,l157f		; .. process \n
  1512    FE 1A          C      	cp	eof		; Check end of file
  1514    20 E3          C      	jr	nz,l1513
  1516                   C      l1530:
  1516    2A 67F4        C      	ld	hl,(l6867)
  1519    11 FFF2        C      	ld	de,lfff2
  151C    19             C      	add	hl,de
  151D    5E             C      	ld	e,(hl)
  151E    23             C      	inc	hl
  151F    56             C      	ld	d,(hl)
  1520    7B             C      	ld	a,e
  1521    B2             C      	or	d
  1522    28 30          C      	jr	z,l156e
  1524    E5             C      	push	hl
  1525    D5             C      	push	de
  1526    C5             C      	push	bc
  1527    CD 618F        C      	call	push.r		; Push regs
  152A    3A 6801        C      	ld	a,(CurUsr)	; Get user
  152D    CD 6179        C      	call	SetUsr		; .. log it
  1530    ED 5B 67F4     C      	ld	de,(CurFCB)	; Get FCB
  1534    1A             C      	ld	a,(de)
  1535    B7             C      	or	a		; Test current drive
  1536    0E 10          C      	ld	c,.close
  1538    D5             C      	push	de
  1539    C4 0005        C      	call	nz,BDOS		; Close file if not
  153C    E1             C      	pop	hl
  153D    36 00          C      	ld	(hl),0
  153F    3A 6844        C      	ld	a,(LogUsr.)
  1542    CD 6179        C      	call	SetUsr		; Log user
  1545    CD 61AE        C      	call	pop.r		; Pop regs
  1548    C1             C      	pop	bc
  1549    D1             C      	pop	de
  154A    E1             C      	pop	hl
  154B    CD 1624        C      	call	l163e
  154E    CD 2232        C      	call	FCBtoStr	; Convert FCB to string
  1551    C3 14C2        C      	jp	RdLine		; .. next read
  1554                   C      l156e:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-57


  1554    21 026D        C      	ld	hl,$SRCline$
  1557    36 1A          C      	ld	(hl),eof	; Clear line
  1559    23             C      	inc	hl
  155A    36 FF          C      	ld	(hl),eot
  155C    37             C      	scf			; .. indicate end
  155D    C9             C      	ret
  155E                   C      l1578:
  155E    0E 1C          C      	ld	c,28
  1560    CD 08F5        C      	call	.ERROR
  1563    18 EF          C      	jr	l156e
                         C      ;
                         C      ; -->> Line Feed found
                         C      ;
  1565                   C      l157f:
  1565    1C             C      	inc	e
  1566    3E FF          C      	ld	a,eot
  1568    12             C      	ld	(de),a		; Clear end of line
  1569    22 67FD        C      	ld	(l6870),hl
  156C    3A 67FF        C      	ld	a,(_rPage_)	; Get page count
  156F    C6 80          C      	add	a,RecLng	; .. bump
  1571    93             C      	sub	e		; Get difference
  1572    32 67FF        C      	ld	(_rPage_),a
  1575    21 6802        C      	ld	hl,l6875
  1578    35             C      	dec	(hl)
  1579    C0             C      	ret	nz
  157A    36 0A          C      	ld	(hl),10
  157C    C3 5F5B        C      	jp	IsChar		; Process keyboard
  157F                   C      l1599:
  157F    D5             C      	push	de
  1580    C5             C      	push	bc
  1581    3E 01          C      	ld	a,1
  1583    32 6802        C      	ld	(l6875),a
  1586    ED 5B 67F4     C      	ld	de,(CurFCB)	; Get FCB
  158A    21 0024        C      	ld	hl,FCBlen+3
  158D    19             C      	add	hl,de		; .. point to buffer
  158E    EB             C      	ex	de,hl
  158F    CD 159A        C      	call	Rd$File		; Read from disk
  1592    C1             C      	pop	bc
  1593    D1             C      	pop	de
  1594    C2 1507        C      	jp	nz,l1521	; .. any read
  1597    C3 1516        C      	jp	l1530		; .. nothing read
                         C      ;
                         C      ; Read from file
                         C      ; ENTRY	Reg HL points to FCB
                         C      ;	Reg DE points to disk buffer
                         C      ; EXIT	Zero set if nothing read
                         C      ;	Reg HL points to start of buffer
                         C      ;	Reg B  holds records read
                         C      ;
  159A                   C      Rd$File:
  159A    22 15CA        C      	ld	(Rd$FCB$),hl	; Save FCB
  159D    ED 53 15B9     C      	ld	(Rd$DMA$),de	; .. and buffer
  15A1    CD 618F        C      	call	push.r		; Push regs
  15A4    7E             C      	ld	a,(hl)
  15A5    3D             C      	dec	a
  15A6    CD 6180        C      	call	SetDsk		; Log disk
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-58


  15A9    3A 6801        C      	ld	a,(CurUsr)
  15AC    CD 6179        C      	call	SetUsr		; .. and user
  15AF    3A 0126        C      	ld	a,($MULS$)	; Test multi sector enabled
  15B2    B7             C      	or	a
  15B3    20 4B          C      	jr	nz,l161a	; .. yeap
  15B5    06 08          C      	ld	b,@SEC@		; Set records
  15B7    C5             C      	push	bc
  15B8    11 0000        C      	ld	de,$-$
  15B9                   C      Rd$DMA$	equ	$-2
  15BB    18 09          C      	jr	l15e0		; .. set disk buffer
  15BD                   C      l15d7:
  15BD    C5             C      	push	bc
  15BE    2A 67D4        C      	ld	hl,(_DMA_)	; Get current buffer
  15C1    11 0080        C      	ld	de,RecLng
  15C4    19             C      	add	hl,de		; .. bump
  15C5    EB             C      	ex	de,hl
  15C6                   C      l15e0:
  15C6    CD 6161        C      	call	SetDMA		; Set disk buffer
  15C9    11 0000        C      	ld	de,$-$
  15CA                   C      Rd$FCB$	equ	$-2
  15CC    0E 14          C      	ld	c,.rdseq
  15CE    CD 0005        C      	call	BDOS		; Read sector
  15D1    C1             C      	pop	bc
  15D2    B7             C      	or	a		; Test end of file
  15D3    20 02          C      	jr	nz,l15f1	; .. yeap
  15D5    10 E6          C      	djnz	l15d7
  15D7                   C      l15f1:
  15D7    3E 08          C      	ld	a,@SEC@
  15D9    90             C      	sub	b		; Calculate records read
  15DA                   C      l15f4:
  15DA    CB 3F          C      	srl	a		; Get pages
  15DC    30 0B          C      	jr	nc,l1603	; .. even
  15DE    3C             C      	inc	a		; .. fix for even
  15DF    47             C      	ld	b,a
  15E0    3A 67FF        C      	ld	a,(_rPage_)
  15E3    C6 80          C      	add	a,RecLng	; .. fix lower part
  15E5    32 67FF        C      	ld	(_rPage_),a
  15E8    78             C      	ld	a,b
  15E9                   C      l1603:
  15E9    32 6800        C      	ld	(_rPage_+1),a	; Save pages
  15EC    3A 6844        C      	ld	a,(LogUsr.)
  15EF    CD 6179        C      	call	SetUsr		; Log user
  15F2    CD 61AE        C      	call	pop.r		; Pop regs
  15F5    2A 67FF        C      	ld	hl,(_rPage_)	; Get pages read
  15F8    7C             C      	ld	a,h
  15F9    B7             C      	or	a
  15FA    C8             C      	ret	z		; .. none
  15FB    45             C      	ld	b,l
  15FC    2A 15B9        C      	ld	hl,(Rd$DMA$)	; Return disk buffer
  15FF    C9             C      	ret
  1600                   C      l161a:
  1600    ED 5B 15B9     C      	ld	de,(Rd$DMA$)
  1604    CD 6161        C      	call	SetDMA		; Set disk buffer
  1607    ED 5B 15CA     C      	ld	de,(Rd$FCB$)
  160B    0E 14          C      	ld	c,.rdseq
  160D    CD 0005        C      	call	BDOS		; Read sector
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-59


  1610    B7             C      	or	a		; Test success
  1611    3E 08          C      	ld	a,@SEC@
  1613    28 C5          C      	jr	z,l15f4		; .. yeap
  1615    3A 62D2        C      	ld	a,(OSver)	; Get OS version
  1618    3D             C      	dec	a
  1619    7C             C      	ld	a,h		; Get back result
  161A    28 04          C      	jr	z,l163a		; .. skip CP/M+
  161C    1F             C      	rra			; MP/M returns upper bits
  161D    1F             C      	rra
  161E    1F             C      	rra
  161F    1F             C      	rra
  1620                   C      l163a:
  1620    E6 07          C      	and	RecMask		; .. mask result
  1622    18 B6          C      	jr	l15f4
                         C      ;
                         C      ;
                         C      ;
  1624                   C      l163e:
  1624    23             C      	inc	hl
  1625    4E             C      	ld	c,(hl)
  1626    23             C      	inc	hl
  1627    46             C      	ld	b,(hl)
  1628    23             C      	inc	hl
  1629    C5             C      	push	bc
  162A    D5             C      	push	de
  162B    11 67F8        C      	ld	de,l686b
  162E    01 000A        C      	ld	bc,l000a
  1631    ED B0          C      	ldir
  1633    11 FFF2        C      	ld	de,lfff2
  1636    19             C      	add	hl,de
  1637    D1             C      	pop	de
  1638    C1             C      	pop	bc
  1639    09             C      	add	hl,bc
  163A    22 631B        C      	ld	(DynPtr2),hl	; Set pointer
  163D    21 67BA        C      	ld	hl,l682d
  1640    35             C      	dec	(hl)		; .. count down
  1641    EB             C      	ex	de,hl
  1642    22 67F4        C      	ld	(l6867),hl
  1645    CB 7E          C      	bit	7,(hl)
  1647    21 14C5        C      	ld	hl,.RdLine	; Set default
  164A    28 03          C      	jr	z,l1669
  164C    21 31E1        C      	ld	hl,l323c	; Set ?????
  164F                   C      l1669:
  164F    22 14C3        C      	ld	($LinVec),hl	; Set line processor
  1652    AF             C      	xor	a
  1653    67             C      	ld	h,a
  1654    6F             C      	ld	l,a
  1655    22 67D1        C      	ld	(l6844),hl
  1658    32 6809        C      	ld	(l687c),a
  165B    21 0DE5        C      	ld	hl,.FullToken
  165E    22 0DE3        C      	ld	($GetVec),hl	; Set token routine
  1661    C9             C      	ret
                         C      
                                
                         C      	include	slr180.002
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-60


                         C      ; Convert line to token
                         C      ;
  1662                   C      CnvToken:
  1662    21 026D        C      	ld	hl,$SRCline$	; Get source
                         C      ;
                         C      ; Convert line to token
                         C      ; ENTRY	Reg HL points to source line
                         C      ;
  1665                   C      .CnvToken::
  1665    11 6ADD        C      	ld	de,$TOKEN$	; .. destination
  1668    01 01ED        C      	ld	bc,CtrlArr	; .. control
  166B    18 02          C      	jr	l1689
  166D                   C      l1687:
  166D    12             C      	ld	(de),a		; Simple save token
  166E    13             C      	inc	de
  166F                   C      l1689:
  166F    4E             C      	ld	c,(hl)		; Get control index
  1670    23             C      	inc	hl
  1671    0A             C      	ld	a,(bc)		; Get control
  1672                   C      l168c:
  1672    FE 9B          C      	cp	9bh		; Compare
  1674    DA 166D        C      	jp	c,l1687		; .. no special
  1677    28 F6          C      	jr	z,l1689		; .. not printable, skip
  1679    D6 9C          C      	sub	9ch		; Strip off offset
  167B    28 1F          C      	jr	z,l16b6		; .. blank or tab
  167D    3D             C      	dec	a
  167E    28 2A          C      	jr	z,l16c4		; .. new line, comment (;)
  1680    3D             C      	dec	a
  1681    28 55          C      	jr	z,l16f2		; .. '
  1683    3D             C      	dec	a
  1684    28 37          C      	jr	z,l16d7		; .. "
  1686    3D             C      	dec	a
  1687    28 0B          C      	jr	z,l16ae		; .. EOF
  1689    3D             C      	dec	a
  168A    28 04          C      	jr	z,l16aa		; .. ^
  168C    C6 A1          C      	add	a,9ch+5		; Get original value
  168E    18 DD          C      	jr	l1687
                         C      ;
                         C      ; ->> Got ^
                         C      ;
  1690                   C      l16aa:
  1690    3E 51          C      	ld	a,51h		; .. map to non printable
  1692    18 D9          C      	jr	l1687
                         C      ;
                         C      ; ->> Got EOF
                         C      ;
  1694                   C      l16ae:
  1694    3E 37          C      	ld	a,37h		; .. map
  1696    CD 16AC        C      	call	l16c6
  1699    13             C      	inc	de
  169A    12             C      	ld	(de),a
  169B    C9             C      	ret
                         C      ;
                         C      ; ->> Got white space
                         C      ;
  169C                   C      l16b6:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-61


  169C    4E             C      	ld	c,(hl)		; Get index
  169D    23             C      	inc	hl
  169E    0A             C      	ld	a,(bc)
  169F    FE 9C          C      	cp	9ch		; Skip spaces
  16A1    28 F9          C      	jr	z,l16b6
  16A3    EB             C      	ex	de,hl
  16A4    36 35          C      	ld	(hl),35h	; Map white space
  16A6    EB             C      	ex	de,hl
  16A7    13             C      	inc	de
  16A8    18 C8          C      	jr	l168c
                         C      ;
                         C      ; ->> Got form feed
                         C      ;
  16AA                   C      l16c4:
  16AA    3E 36          C      	ld	a,36h		; Map form feed
  16AC                   C      l16c6:
  16AC    47             C      	ld	b,a		; Save code
  16AD    1B             C      	dec	de
  16AE    1A             C      	ld	a,(de)
  16AF    FE 35          C      	cp	35h		; Test previous white space
  16B1    28 01          C      	jr	z,l16ce		; .. delete
  16B3    13             C      	inc	de
  16B4                   C      l16ce:
  16B4    78             C      	ld	a,b		; Get back code
  16B5    12             C      	ld	(de),a		; .. store
  16B6    21 6ADC        C      	ld	hl,l6b4f
  16B9    22 62F5        C      	ld	(TokPtr),hl	; Set token pointer
  16BC    C9             C      	ret
                         C      ;
                         C      ; ->> Got string quote "
                         C      ;
  16BD                   C      l16d7:
  16BD    3E 56          C      	ld	a,56h
  16BF    12             C      	ld	(de),a		; Map quote
  16C0    13             C      	inc	de
  16C1    D5             C      	push	de
  16C2                   C      l16dc:
  16C2    12             C      	ld	(de),a		; .. set code
  16C3    13             C      	inc	de
  16C4    7E             C      	ld	a,(hl)
  16C5    FE 20          C      	cp	' '		; Test control
  16C7    DC 172F        C      	call	c,l1749		; .. process it
  16CA    23             C      	inc	hl
  16CB    FE 22          C      	cp	'"'		; Test end
  16CD    20 F3          C      	jr	nz,l16dc	; .. nope
  16CF    7E             C      	ld	a,(hl)
  16D0    FE 22          C      	cp	'"'		; Test double
  16D2    23             C      	inc	hl
  16D3    28 ED          C      	jr	z,l16dc		; .. yeap, store
  16D5    2B             C      	dec	hl
  16D6    18 36          C      	jr	l1728
                         C      ;
                         C      ; ->> Got string quote '
                         C      ;
  16D8                   C      l16f2:
  16D8    1B             C      	dec	de		; Fix back
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-62


  16D9    1B             C      	dec	de
  16DA    1A             C      	ld	a,(de)
  16DB    13             C      	inc	de
  16DC    FE 66          C      	cp	66h		; Test A
  16DE    28 02          C      	jr	z,l16fc
  16E0    FE 80          C      	cp	80h		; .. or a
  16E2                   C      l16fc:
  16E2    1A             C      	ld	a,(de)
  16E3    13             C      	inc	de
  16E4    20 0F          C      	jr	nz,l170f
  16E6    FE 6B          C      	cp	6bh		; .. AF'
  16E8    28 04          C      	jr	z,l1708
  16EA    FE 85          C      	cp	85h		; .. af'
  16EC    20 07          C      	jr	nz,l170f	; .. nope
  16EE                   C      l1708:
  16EE    1B             C      	dec	de
  16EF    1B             C      	dec	de
  16F0    3E 29          C      	ld	a,29h		; Map special AF'
  16F2    C3 166D        C      	jp	l1687
  16F5                   C      l170f:
  16F5    3E 56          C      	ld	a,56h		; Map quote
  16F7    12             C      	ld	(de),a
  16F8    13             C      	inc	de
  16F9    D5             C      	push	de
  16FA                   C      l1714:
  16FA    12             C      	ld	(de),a		; Save code
  16FB    13             C      	inc	de
  16FC    7E             C      	ld	a,(hl)
  16FD    FE 20          C      	cp	' '		; Test control
  16FF    DC 172F        C      	call	c,l1749		; .. process it
  1702    23             C      	inc	hl
  1703    FE 27          C      	cp	''''		; Test end of string
  1705    20 F3          C      	jr	nz,l1714
  1707    7E             C      	ld	a,(hl)
  1708    23             C      	inc	hl
  1709    FE 27          C      	cp	''''		; .. maybe twice
  170B    28 ED          C      	jr	z,l1714
  170D    2B             C      	dec	hl
  170E                   C      l1728:
  170E    E3             C      	ex	(sp),hl
  170F    D5             C      	push	de
  1710    EB             C      	ex	de,hl
  1711    B7             C      	or	a
  1712    ED 52          C      	sbc	hl,de		; Get length of string
  1714    2B             C      	dec	hl
  1715    7C             C      	ld	a,h		; Test any within quotes
  1716    B5             C      	or	l
  1717    28 07          C      	jr	z,l173a		; .. nope
  1719    12             C      	ld	(de),a		; .. set length
  171A    D1             C      	pop	de
  171B    E1             C      	pop	hl
  171C    AF             C      	xor	a		; .. closed by zero
  171D    C3 166D        C      	jp	l1687
  1720                   C      l173a:
  1720    1B             C      	dec	de
  1721    E1             C      	pop	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-63


  1722    E1             C      	pop	hl
  1723    3A 67CD        C      	ld	a,(l6840)	; Test control flag
  1726    B7             C      	or	a
  1727    CA 166F        C      	jp	z,l1689		; .. nope
  172A    3E 51          C      	ld	a,51h		; Map unprintable
  172C    C3 166D        C      	jp	l1687
                         C      ;
                         C      ; Got control within string
                         C      ; ENTRY	Accu holds character
                         C      ;
  172F                   C      l1749:
  172F    F5             C      	push	af
  1730    FE 09          C      	cp	tab		; Test tab
  1732    20 06          C      	jr	nz,l1754	; .. nope
  1734    3A 013A        C      	ld	a,($TAB.STR$)	; Test tabs allowed in string
  1737    B7             C      	or	a
  1738    20 05          C      	jr	nz,l1759	; .. yeap
  173A                   C      l1754:
  173A    3E FF          C      	ld	a,YES
  173C    32 67CD        C      	ld	(l6840),a	; Set control flag
  173F                   C      l1759:
  173F    F1             C      	pop	af
  1740    FE 0D          C      	cp	cr		; Test end of line
  1742    28 03          C      	jr	z,l1761
  1744    FE 0A          C      	cp	lf		; .. or line feed
  1746    C0             C      	ret	nz
  1747                   C      l1761:
  1747    F1             C      	pop	af		; .. clean stack
  1748    18 C4          C      	jr	l1728		; .. go
                         C      ;
                         C      ; Test only A
                         C      ;
  174A                   C      l1764:
  174A    FE 57          C      	cp	57h		; Test range
  174C    0E 17          C      	ld	c,17h		; .. maybe A only
  174E    30 41          C      	jr	nc,l17ab	; .. nope
  1750    AF             C      	xor	a
  1751    C9             C      	ret
                         C      ;
                         C      ; Letter A
                         C      ;
  1752                   C      @LET.A:
  1752    EB             C      	ex	de,hl
  1753    7E             C      	ld	a,(hl)
  1754    FE 69          C      	cp	69h
  1756    38 F2          C      	jr	c,l1764		; .. AA .. AC
  1758    28 28          C      	jr	z,l179c		; .. AD
  175A    FE 73          C      	cp	73h
  175C    28 1F          C      	jr	z,l1797		; .. AN
  175E    FE 6B          C      	cp	6bh
  1760    28 17          C      	jr	z,l1793		; .. AF
  1762    FE 78          C      	cp	78h		; .. AS
  1764    C0             C      	ret	nz
  1765    23             C      	inc	hl
  1766    7E             C      	ld	a,(hl)
  1767    FE 6A          C      	cp	6ah		; .. ASE
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-64


  1769    C0             C      	ret	nz
  176A    23             C      	inc	hl
  176B    7E             C      	ld	a,(hl)
  176C    0E A5          C      	ld	c,0a5h
  176E    FE 6C          C      	cp	6ch
  1770    28 72          C      	jr	z,l17fe		; .. ASEG
  1772    FE 79          C      	cp	79h
  1774    C0             C      	ret	nz
  1775    0E AA          C      	ld	c,0aah		; .. ASET
  1777    18 6B          C      	jr	l17fe
  1779                   C      l1793:
  1779    0E 1D          C      	ld	c,1dh		; Set AF code
  177B    18 67          C      	jr	l17fe
  177D                   C      l1797:
                         C      	ld.bc	69h,5ah		; .. AND
  177D    01 695A        C+     	ld	bc,69h*256+5ah
  1780    18 5E          C      	jr	l17fa
  1782                   C      l179c:
  1782    23             C      	inc	hl
  1783    7E             C      	ld	a,(hl)
  1784    0E 58          C      	ld	c,58h
  1786    FE 68          C      	cp	68h		; .. ADC
  1788    28 5A          C      	jr	z,l17fe
  178A    FE 69          C      	cp	69h		; .. ADD
  178C    C0             C      	ret	nz
  178D    0E 59          C      	ld	c,59h
  178F    18 53          C      	jr	l17fe
  1791                   C      l17ab:
  1791    FE 67          C      	cp	67h		; .. AB
  1793    C0             C      	ret	nz
                         C      	ld.bc	78h,0a5h	; .. ABS
  1794    01 78A5        C+     	ld	bc,78h*256+0a5h
  1797    18 47          C      	jr	l17fa
                         C      ;
                         C      ; Letter B
                         C      ;
  1799                   C      @LET.B:
  1799    EB             C      	ex	de,hl
  179A    7E             C      	ld	a,(hl)
  179B    FE 68          C      	cp	68h
  179D    0E 1A          C      	ld	c,1ah
  179F    28 43          C      	jr	z,l17fe		; .. BC
  17A1    0E 10          C      	ld	c,10h
  17A3    38 41          C      	jr	c,l1800		; .. B only
  17A5    FE 6E          C      	cp	6eh
                         C      	ld.bc	079h,5bh
  17A7    01 795B        C+     	ld	bc,079h*256+5bh
  17AA    28 34          C      	jr	z,l17fa		; .. BII
  17AC    FE 7E          C      	cp	7eh
  17AE    C0             C      	ret	nz		; .. not BY
  17AF    23             C      	inc	hl
  17B0    7E             C      	ld	a,(hl)
  17B1    FE 79          C      	cp	79h
  17B3    C0             C      	ret	nz		; .. not BYT
                         C      	ld.bc	6ah,0e3h	; .. BYTE
  17B4    01 6AE3        C+     	ld	bc,6ah*256+0e3h
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-65


  17B7    18 27          C      	jr	l17fa
                         C      ;
                         C      ; Letter C
                         C      ;
  17B9                   C      @LET.C:
  17B9    EB             C      	ex	de,hl
  17BA    7E             C      	ld	a,(hl)
  17BB    FE 66          C      	cp	66h		; .. CA
  17BD    28 4B          C      	jr	z,l1824
  17BF    0E 11          C      	ld	c,11h
  17C1    38 23          C      	jr	c,l1800		; .. C only
  17C3    FE 75          C      	cp	75h
  17C5    28 4D          C      	jr	z,l182e		; .. CP
  17C7    FE 68          C      	cp	68h
  17C9    28 6D          C      	jr	z,l1852		; .. CC
  17CB    FE 74          C      	cp	74h
  17CD    28 1C          C      	jr	z,l1805		; .. CO
  17CF    FE 78          C      	cp	78h
  17D1    28 05          C      	jr	z,l17f2		; .. CS
  17D3    0E A6          C      	ld	c,0a6h
  17D5    C3 1BBB        C      	jp	l1bd5		; .. CLIST
  17D8                   C      l17f2:
  17D8    23             C      	inc	hl
  17D9    7E             C      	ld	a,(hl)
  17DA    FE 6A          C      	cp	6ah		; .. CSE
  17DC    C0             C      	ret	nz
                         C      	ld.bc	6ch,0c1h	; .. CSEG
  17DD    01 6CC1        C+     	ld	bc,6ch*256+0c1h
  17E0                   C      l17fa:
  17E0    23             C      	inc	hl
  17E1    7E             C      	ld	a,(hl)
  17E2    B8             C      	cp	b
  17E3    C0             C      	ret	nz
  17E4                   C      l17fe:
  17E4    23             C      	inc	hl
  17E5    7E             C      	ld	a,(hl)
  17E6                   C      l1800:
  17E6    FE 56          C      	cp	56h
  17E8    D0             C      	ret	nc
  17E9                   C      l1803:
  17E9    AF             C      	xor	a
  17EA    C9             C      	ret
  17EB                   C      l1805:
  17EB    23             C      	inc	hl
  17EC    7E             C      	ld	a,(hl)
  17ED    FE 72          C      	cp	72h		; .. COM
  17EF    28 08          C      	jr	z,l1813
  17F1    FE 73          C      	cp	73h		; .. CON
  17F3    C0             C      	ret	nz
                         C      	ld.bc	69h,0b5h	; .. COND
  17F4    01 69B5        C+     	ld	bc,69h*256+0b5h
  17F7    18 E7          C      	jr	l17fa
  17F9                   C      l1813:
  17F9    23             C      	inc	hl
  17FA    7E             C      	ld	a,(hl)
  17FB    0E A7          C      	ld	c,0a7h
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-66


  17FD    FE 72          C      	cp	72h		; .. COMM
  17FF    20 E5          C      	jr	nz,l1800	; .. yeao, short form
  1801    23             C      	inc	hl
  1802    7E             C      	ld	a,(hl)
  1803    FE 74          C      	cp	74h		; .. COMMO
  1805    C0             C      	ret	nz
  1806    06 73          C      	ld	b,73h		; .. COMMON
  1808    18 D6          C      	jr	l17fa
  180A                   C      l1824:
  180A    23             C      	inc	hl
  180B    7E             C      	ld	a,(hl)
  180C    FE 71          C      	cp	71h		; .. CAL
  180E    C0             C      	ret	nz
                         C      	ld.bc	071h,5ch	; .. CALL
  180F    01 715C        C+     	ld	bc,071h*256+5ch
  1812    18 CC          C      	jr	l17fa
  1814                   C      l182e:
  1814    23             C      	inc	hl
  1815    7E             C      	ld	a,(hl)
  1816    FE 57          C      	cp	57h		; .. CP only
  1818    0E 5E          C      	ld	c,5eh
  181A    38 CD          C      	jr	c,l1803
  181C    FE 69          C      	cp	69h		; .. CPD
  181E    28 0D          C      	jr	z,l1847
  1820    FE 6E          C      	cp	6eh		; .. CPI
  1822    0E 61          C      	ld	c,61h
  1824    28 09          C      	jr	z,l1849
  1826    FE 71          C      	cp	71h		; .. CPL
  1828    C0             C      	ret	nz
  1829    0E 63          C      	ld	c,63h
  182B    18 B7          C      	jr	l17fe
  182D                   C      l1847:
  182D    0E 5F          C      	ld	c,5fh
  182F                   C      l1849:
  182F    23             C      	inc	hl
  1830    7E             C      	ld	a,(hl)
  1831    FE 77          C      	cp	77h		; .. R
  1833    20 B1          C      	jr	nz,l1800
  1835    0C             C      	inc	c
  1836    18 AC          C      	jr	l17fe
  1838                   C      l1852:
                         C      	ld.bc	6bh,5dh		; .. CCF
  1838    01 6B5D        C+     	ld	bc,6bh*256+5dh
  183B    18 A3          C      	jr	l17fa
                         C      ;
                         C      ;
                         C      ;
  183D                   C      l1857:
  183D    FE 57          C      	cp	57h
  183F    0E 12          C      	ld	c,12h
  1841    38 48          C      	jr	c,l18a5		; .. D only
  1843    FE 67          C      	cp	67h		; .. DB
  1845                   C      l185f:
  1845    0E A9          C      	ld	c,0a9h
  1847    28 3D          C      	jr	z,l18a0
  1849    FE 68          C      	cp	68h		; .. DC
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-67


  184B                   C      l1865:
  184B    0E E1          C      	ld	c,0e1h
  184D    28 37          C      	jr	z,l18a0
  184F    FE 66          C      	cp	66h		; .. DA
  1851    C0             C      	ret	nz
  1852    23             C      	inc	hl
  1853    7E             C      	ld	a,(hl)
  1854    0E 64          C      	ld	c,64h
  1856    FE 66          C      	cp	66h		; .. DAA
  1858    28 2C          C      	jr	z,l18a0
  185A    FE 79          C      	cp	79h		; .. DAT
  185C    C0             C      	ret	nz
                         C      	ld.bc	66h,0a8h	; .. DATA
  185D    01 66A8        C+     	ld	bc,66h*256+0a8h
  1860    18 20          C      	jr	l189c
                         C      ;
                         C      ; Letter D
                         C      ;
  1862                   C      @LET.D:
  1862    EB             C      	ex	de,hl
  1863    7E             C      	ld	a,(hl)
  1864    FE 6A          C      	cp	6ah
  1866    38 D5          C      	jr	c,l1857		; .. DA..DD
  1868    28 32          C      	jr	z,l18b6		; .. DE
  186A    FE 78          C      	cp	78h
  186C    38 1F          C      	jr	c,l18a7		; .. DF..DR
  186E    28 07          C      	jr	z,l1891		; DS
  1870    FE 7C          C      	cp	7ch		; DW
  1872    C0             C      	ret	nz
  1873                   C      l188d:
  1873    0E AC          C      	ld	c,0ach
  1875    18 0F          C      	jr	l18a0
  1877                   C      l1891:
  1877    23             C      	inc	hl
  1878    7E             C      	ld	a,(hl)
  1879    FE 6A          C      	cp	6ah		; .. DSE
  187B    0E AB          C      	ld	c,0abh
  187D    20 09          C      	jr	nz,l18a2
                         C      	ld.bc	6ch,0a8h
  187F    01 6CA8        C+     	ld	bc,6ch*256+0a8h
  1882                   C      l189c:
  1882    23             C      	inc	hl
  1883    7E             C      	ld	a,(hl)
  1884    B8             C      	cp	b
  1885    C0             C      	ret	nz
  1886                   C      l18a0:
  1886    23             C      	inc	hl
  1887    7E             C      	ld	a,(hl)
  1888                   C      l18a2:
  1888    FE 56          C      	cp	56h
  188A    D0             C      	ret	nc
  188B                   C      l18a5:
  188B    AF             C      	xor	a
  188C    C9             C      	ret
  188D                   C      l18a7:
  188D    FE 6F          C      	cp	6fh		; .. DJ
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-68


  188F    28 41          C      	jr	z,l18ec
  1891    FE 6E          C      	cp	6eh		; .. DI
  1893    C0             C      	ret	nz
  1894    0E 66          C      	ld	c,66h
  1896    18 EE          C      	jr	l18a0
  1898                   C      l18b2:
  1898    0E 1B          C      	ld	c,1bh
  189A    AF             C      	xor	a
  189B    C9             C      	ret
  189C                   C      l18b6:
  189C    23             C      	inc	hl
  189D    7E             C      	ld	a,(hl)
  189E    FE 57          C      	cp	57h
  18A0    38 F6          C      	jr	c,l18b2		; .. DE only
  18A2    FE 68          C      	cp	68h
  18A4    0E 65          C      	ld	c,65h
  18A6    28 DE          C      	jr	z,l18a0		; .. DEC
  18A8    FE 6B          C      	cp	6bh
  18AA    C0             C      	ret	nz		; .. DEF
  18AB    23             C      	inc	hl
  18AC    7E             C      	ld	a,(hl)
  18AD    FE 67          C      	cp	67h
  18AF    28 94          C      	jr	z,l185f		; .. DEFB
  18B1    FE 68          C      	cp	68h
  18B3    28 96          C      	jr	z,l1865		; .. DEFC
  18B5    FE 72          C      	cp	72h
  18B7    28 8C          C      	jr	z,l185f		; .. DEFM
  18B9    FE 78          C      	cp	78h
  18BB    28 11          C      	jr	z,l18e8		; .. DEFS
  18BD    FE 7C          C      	cp	7ch
  18BF    28 B2          C      	jr	z,l188d		; .. DEFW
  18C1    FE 7F          C      	cp	7fh
  18C3    0E E2          C      	ld	c,0e2h
  18C5    28 BF          C      	jr	z,l18a0		; .. DEFZ
  18C7    FE 71          C      	cp	71h		; .. DEFL
  18C9    C0             C      	ret	nz
  18CA    0E AA          C      	ld	c,0aah
  18CC    18 B8          C      	jr	l18a0
  18CE                   C      l18e8:
  18CE    0E AB          C      	ld	c,0abh		; Load DS
  18D0    18 B4          C      	jr	l18a0
  18D2                   C      l18ec:
  18D2    23             C      	inc	hl
  18D3    7E             C      	ld	a,(hl)
  18D4    FE 73          C      	cp	73h		; .. DJN
  18D6    C0             C      	ret	nz
                         C      	ld.bc	07fh,67h	; .. DJNZ
  18D7    01 7F67        C+     	ld	bc,07fh*256+67h
  18DA    18 A6          C      	jr	l189c
                         C      ;
                         C      ; Letter E
                         C      ;
  18DC                   C      @LET.E:
  18DC    EB             C      	ex	de,hl
  18DD    7E             C      	ld	a,(hl)
  18DE    FE 73          C      	cp	73h		; .. EA..EN
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-69


  18E0    30 24          C      	jr	nc,l1920
  18E2    0E 13          C      	ld	c,13h
  18E4    FE 6E          C      	cp	6eh		; Test E only
  18E6    38 47          C      	jr	c,l1949		; .. yeap
  18E8    0E 68          C      	ld	c,68h
  18EA    28 41          C      	jr	z,l1947		; .. EI
  18EC    FE 6F          C      	cp	6fh
  18EE    28 0D          C      	jr	z,l1917		; .. EJ
  18F0    FE 71          C      	cp	71h		; .. EL
  18F2    C0             C      	ret	nz
  18F3    23             C      	inc	hl
  18F4    7E             C      	ld	a,(hl)
  18F5    FE 78          C      	cp	78h		; .. ELS
  18F7    C0             C      	ret	nz
                         C      	ld.bc	6ah,0aeh	; ELSE
  18F8    01 6AAE        C+     	ld	bc,6ah*256+0aeh
  18FB    18 2C          C      	jr	l1943
  18FD                   C      l1917:
  18FD    11 1F94        C      	ld	de,l1fae	; .. EJECT
                         C      	ld.bc	3,0bfh
  1900    01 03BF        C+     	ld	bc,3*256+0bfh
  1903    C3 1F49        C      	jp	CmpToken
  1906                   C      l1920:
  1906    28 50          C      	jr	z,l1972		; .. EN
  1908    FE 7D          C      	cp	7dh
  190A    28 28          C      	jr	z,l194e		; .. EX
  190C    FE 76          C      	cp	76h		; .. EQ
  190E    C0             C      	ret	nz
  190F    23             C      	inc	hl
  1910    7E             C      	ld	a,(hl)
  1911    0E B3          C      	ld	c,0b3h
  1913    FE 7A          C      	cp	7ah		; .. EQU
  1915    28 16          C      	jr	z,l1947
  1917    0E 49          C      	ld	c,49h
  1919    18 14          C      	jr	l1949		; .. EQ only
  191B                   C      l1935:
  191B    23             C      	inc	hl
  191C    7E             C      	ld	a,(hl)
  191D    0E B4          C      	ld	c,0b4h
  191F    FE 6A          C      	cp	6ah		; .. EXTE
  1921    28 2D          C      	jr	z,l196a
  1923    FE 77          C      	cp	77h		; .. EXTR
  1925    20 08          C      	jr	nz,l1949
  1927    06 73          C      	ld	b,73h		; .. EXTRN
  1929                   C      l1943:
  1929    23             C      	inc	hl
  192A    7E             C      	ld	a,(hl)
  192B    B8             C      	cp	b
  192C    C0             C      	ret	nz
  192D                   C      l1947:
  192D    23             C      	inc	hl
  192E    7E             C      	ld	a,(hl)
  192F                   C      l1949:
  192F    FE 56          C      	cp	56h
  1931    D0             C      	ret	nc
  1932                   C      l194c:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-70


  1932    AF             C      	xor	a
  1933    C9             C      	ret
  1934                   C      l194e:
  1934    23             C      	inc	hl
  1935    7E             C      	ld	a,(hl)
  1936    0E 6A          C      	ld	c,6ah
  1938    FE 7D          C      	cp	7dh
  193A    28 F1          C      	jr	z,l1947		; .. EXX
  193C    FE 79          C      	cp	79h
  193E    28 DB          C      	jr	z,l1935		; .. EXT
  1940    FE 6E          C      	cp	6eh		; .. EXI
  1942    0E 69          C      	ld	c,69h
  1944    20 E9          C      	jr	nz,l1949	; .. EX only
  1946    23             C      	inc	hl
  1947    7E             C      	ld	a,(hl)
  1948    FE 79          C      	cp	79h		; .. EXIT
  194A    C0             C      	ret	nz
                         C      	ld.bc	72h,0c6h	; .. EXITM
  194B    01 72C6        C+     	ld	bc,72h*256+0c6h
  194E    18 D9          C      	jr	l1943
  1950                   C      l196a:
  1950    11 1F97        C      	ld	de,l1fb1
  1953    06 04          C      	ld	b,4
  1955    C3 1F49        C      	jp	CmpToken	; .. EXTERNAL
  1958                   C      l1972:
  1958    23             C      	inc	hl
  1959    7E             C      	ld	a,(hl)
  195A    FE 69          C      	cp	69h		; .. END
  195C    28 0F          C      	jr	z,l1987
  195E    FE 79          C      	cp	79h		; .. ENT
  1960    C0             C      	ret	nz
  1961    0E B2          C      	ld	c,0b2h
  1963    23             C      	inc	hl
  1964    7E             C      	ld	a,(hl)
  1965    FE 77          C      	cp	77h		; .. ENTR
  1967    20 C6          C      	jr	nz,l1949
  1969    06 7E          C      	ld	b,7eh
  196B    18 BC          C      	jr	l1943		; .. ENTRY
  196D                   C      l1987:
  196D    23             C      	inc	hl
  196E    7E             C      	ld	a,(hl)
  196F    0E AF          C      	ld	c,0afh
  1971    FE 57          C      	cp	57h		; Test range
  1973    38 BD          C      	jr	c,l194c		; .. END
  1975    0E B0          C      	ld	c,0b0h
  1977    FE 68          C      	cp	68h
  1979    28 B2          C      	jr	z,l1947		; .. ENDC
  197B    FE 6E          C      	cp	6eh
  197D    06 6B          C      	ld	b,6bh
  197F    28 A8          C      	jr	z,l1943		; .. ENDIF
  1981    FE 72          C      	cp	72h
  1983    C0             C      	ret	nz
  1984    0E B1          C      	ld	c,0b1h		; .. ENDM
  1986    18 A5          C      	jr	l1947
                         C      ;
                         C      ; Letter G
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-71


                         C      ;
  1988                   C      @LET.G:
  1988    EB             C      	ex	de,hl
  1989    7E             C      	ld	a,(hl)
  198A    FE 71          C      	cp	71h
  198C    28 0D          C      	jr	z,l19b5		; .. GL
  198E    0E 4E          C      	ld	c,4eh
  1990    FE 6A          C      	cp	6ah
  1992    28 38          C      	jr	z,l19e6		; .. GE only
  1994    FE 79          C      	cp	79h
  1996    C0             C      	ret	nz
  1997    0E 4D          C      	ld	c,4dh
  1999    18 31          C      	jr	l19e6		; .. GT only
  199B                   C      l19b5:
  199B    11 1F9B        C      	ld	de,l1fb5
                         C      	ld.bc	4,0b2h
  199E    01 04B2        C+     	ld	bc,4*256+0b2h
  19A1    C3 1F49        C      	jp	CmpToken	; .. GLOBAL
                         C      ;
                         C      ; Letter H
                         C      ;
  19A4                   C      @LET.H:
  19A4    EB             C      	ex	de,hl
  19A5    7E             C      	ld	a,(hl)
  19A6    0E 1C          C      	ld	c,1ch
  19A8    FE 71          C      	cp	71h		; .. HL only
  19AA    28 20          C      	jr	z,l19e6
  19AC    0E 14          C      	ld	c,14h
  19AE    FE 66          C      	cp	66h		; .. HA
  19B0    28 0E          C      	jr	z,l19da
  19B2    FE 6E          C      	cp	6eh		; .. HI
  19B4    20 18          C      	jr	nz,l19e8
  19B6    23             C      	inc	hl
  19B7    7E             C      	ld	a,(hl)
  19B8    FE 6C          C      	cp	6ch		; .. HIG
  19BA    C0             C      	ret	nz		; .. return H only
                         C      	ld.bc	6dh,46h		; Test HIGH
  19BB    01 6D46        C+     	ld	bc,6dh*256+46h
  19BE    18 08          C      	jr	l19e2
  19C0                   C      l19da:
  19C0    23             C      	inc	hl
  19C1    7E             C      	ld	a,(hl)
  19C2    FE 71          C      	cp	71h		; .. HAL
  19C4    C0             C      	ret	nz
                         C      	ld.bc	079h,6bh	; .. HALT
  19C5    01 796B        C+     	ld	bc,079h*256+6bh
  19C8                   C      l19e2:
  19C8    23             C      	inc	hl
  19C9    7E             C      	ld	a,(hl)
  19CA    B8             C      	cp	b
  19CB    C0             C      	ret	nz
  19CC                   C      l19e6:
  19CC    23             C      	inc	hl
  19CD    7E             C      	ld	a,(hl)
  19CE                   C      l19e8:
  19CE    FE 56          C      	cp	56h
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-72


  19D0    D0             C      	ret	nc
  19D1    AF             C      	xor	a
  19D2    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  19D3                   C      l19ed:
  19D3    23             C      	inc	hl
  19D4    7E             C      	ld	a,(hl)
  19D5    FE 68          C      	cp	68h		; .. INC
  19D7    28 6D          C      	jr	z,l1a60
  19D9    FE 69          C      	cp	69h		; .. IND
  19DB    28 19          C      	jr	z,l1a10
  19DD    FE 6E          C      	cp	6eh		; .. INI
  19DF    28 0A          C      	jr	z,l1a05
  19E1    FE 5C          C      	cp	5ch
  19E3    0E 6D          C      	ld	c,6dh
  19E5    20 E7          C      	jr	nz,l19e8	; .. IN only
  19E7    0E 6E          C      	ld	c,6eh		; .. IN0
  19E9    18 E1          C      	jr	l19e6
  19EB                   C      l1a05:
  19EB    0E 72          C      	ld	c,72h
  19ED                   C      l1a07:
  19ED    23             C      	inc	hl
  19EE    7E             C      	ld	a,(hl)
  19EF    FE 77          C      	cp	77h		; .. R
  19F1    20 DB          C      	jr	nz,l19e8
  19F3    0C             C      	inc	c
  19F4    18 D6          C      	jr	l19e6
  19F6                   C      l1a10:
  19F6    0E 70          C      	ld	c,70h
  19F8    18 F3          C      	jr	l1a07
                         C      ;
                         C      ; Letter I
                         C      ;
  19FA                   C      @LET.I:
  19FA    EB             C      	ex	de,hl
  19FB    7E             C      	ld	a,(hl)
  19FC    FE 73          C      	cp	73h		; .. IN
  19FE    28 D3          C      	jr	z,l19ed
  1A00    FE 7D          C      	cp	7dh
  1A02    0E 1F          C      	ld	c,1fh
  1A04    28 C6          C      	jr	z,l19e6		; .. IX
  1A06    FE 7E          C      	cp	7eh
  1A08    0E 20          C      	ld	c,20h
  1A0A    28 C0          C      	jr	z,l19e6		; .. IY
  1A0C    FE 6B          C      	cp	6bh
  1A0E    28 47          C      	jr	z,l1a71		; .. IF
  1A10    FE 72          C      	cp	72h
  1A12    28 08          C      	jr	z,l1a36		; .. IM
  1A14    FE 77          C      	cp	77h
  1A16    28 1D          C      	jr	z,l1a4f		; .. IR
  1A18    0E 18          C      	ld	c,18h
  1A1A    18 B2          C      	jr	l19e8		; .. I only
  1A1C                   C      l1a36:
  1A1C    0E 6C          C      	ld	c,6ch
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-73


  1A1E    23             C      	inc	hl
  1A1F    7E             C      	ld	a,(hl)
  1A20    FE 5C          C      	cp	5ch		; Test digit
  1A22    38 AA          C      	jr	c,l19e8		; .. IM only
  1A24    0E C7          C      	ld	c,0c7h
  1A26    28 4C          C      	jr	z,l1a8e		; .. IM0
  1A28    0E C8          C      	ld	c,0c8h
  1A2A    FE 5D          C      	cp	5dh
  1A2C    28 46          C      	jr	z,l1a8e		; .. IM1
  1A2E    FE 5E          C      	cp	5eh
  1A30    C0             C      	ret	nz
  1A31    0E C9          C      	ld	c,0c9h
  1A33    18 3F          C      	jr	l1a8e		; .. IM2
  1A35                   C      l1a4f:
  1A35    23             C      	inc	hl
  1A36    7E             C      	ld	a,(hl)
  1A37    FE 75          C      	cp	75h		; .. IRP
  1A39    C0             C      	ret	nz
  1A3A    23             C      	inc	hl
  1A3B    7E             C      	ld	a,(hl)
  1A3C    0E CB          C      	ld	c,0cbh
  1A3E    FE 68          C      	cp	68h		; .. IRPC
  1A40    20 34          C      	jr	nz,l1a90	; .. IRP only
  1A42    0E CA          C      	ld	c,0cah
  1A44    18 2E          C      	jr	l1a8e
  1A46                   C      l1a60:
  1A46    23             C      	inc	hl
  1A47    0E 6F          C      	ld	c,6fh
  1A49    7E             C      	ld	a,(hl)
  1A4A    FE 71          C      	cp	71h		; .. INCL
  1A4C    20 28          C      	jr	nz,l1a90	; .. INC only
  1A4E    11 1FA2        C      	ld	de,l1fbc
                         C      	ld.bc	3,0b6h
  1A51    01 03B6        C+     	ld	bc,3*256+0b6h
  1A54    C3 1F49        C      	jp	CmpToken	; INCLUDE
  1A57                   C      l1a71:
  1A57    23             C      	inc	hl
  1A58    7E             C      	ld	a,(hl)
  1A59    FE 69          C      	cp	69h
  1A5B    38 1E          C      	jr	c,l1a95		; .. IF only or IF<num>
  1A5D    28 4B          C      	jr	z,l1ac4		; .. IFD
  1A5F    FE 6E          C      	cp	6eh
  1A61    38 32          C      	jr	c,l1aaf		; .. IFxx
  1A63    28 3B          C      	jr	z,l1aba		; .. IFI
  1A65    FE 73          C      	cp	73h
  1A67    28 50          C      	jr	z,l1ad3		; .. IFN
  1A69    FE 79          C      	cp	79h
  1A6B    C0             C      	ret	nz		; .. IFT
  1A6C    0E B5          C      	ld	c,0b5h
  1A6E    18 04          C      	jr	l1a8e
  1A70                   C      l1a8a:
  1A70    23             C      	inc	hl
  1A71    7E             C      	ld	a,(hl)
  1A72    B8             C      	cp	b
  1A73    C0             C      	ret	nz
  1A74                   C      l1a8e:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-74


  1A74    23             C      	inc	hl
  1A75    7E             C      	ld	a,(hl)
  1A76                   C      l1a90:
  1A76    FE 56          C      	cp	56h
  1A78    D0             C      	ret	nc
  1A79    AF             C      	xor	a
  1A7A    C9             C      	ret
  1A7B                   C      l1a95:
  1A7B    0E B5          C      	ld	c,0b5h
  1A7D    FE 5C          C      	cp	5ch
  1A7F    38 F5          C      	jr	c,l1a90		; .. IF only
  1A81    0E D6          C      	ld	c,0d6h
  1A83    28 EF          C      	jr	z,l1a8e		; .. IF0
  1A85    0C             C      	inc	c
  1A86    D6 5D          C      	sub	5dh
  1A88    28 EA          C      	jr	z,l1a8e		; .. IF1
  1A8A    0C             C      	inc	c
  1A8B    3D             C      	dec	a
  1A8C    28 E6          C      	jr	z,l1a8e		; .. IF2
  1A8E    FE 09          C      	cp	67h-5dh-1
  1A90    C0             C      	ret	nz
  1A91    0E DC          C      	ld	c,0dch
  1A93    18 DF          C      	jr	l1a8e		; .. IFB
  1A95                   C      l1aaf:
  1A95    0E DD          C      	ld	c,0ddh
  1A97    FE 6A          C      	cp	6ah
  1A99    28 D9          C      	jr	z,l1a8e		; .. IFE
  1A9B    FE 6B          C      	cp	6bh
  1A9D    C0             C      	ret	nz
  1A9E    18 D4          C      	jr	l1a8e		; .. IFF
  1AA0                   C      l1aba:
  1AA0    23             C      	inc	hl
  1AA1    7E             C      	ld	a,(hl)
  1AA2    FE 69          C      	cp	69h		; .. IFID
  1AA4    C0             C      	ret	nz
                         C      	ld.bc	073h,0dbh
  1AA5    01 73DB        C+     	ld	bc,073h*256+0dbh
  1AA8    18 C6          C      	jr	l1a8a		; .. IFIDN
  1AAA                   C      l1ac4:
  1AAA    23             C      	inc	hl
  1AAB    7E             C      	ld	a,(hl)
                         C      	ld.bc	6bh,0d9h
  1AAC    01 6BD9        C+     	ld	bc,6bh*256+0d9h
  1AAF    FE 6A          C      	cp	6ah
  1AB1    28 BD          C      	jr	z,l1a8a		; .. IFDEF
  1AB3    0C             C      	inc	c
  1AB4    FE 6E          C      	cp	6eh
  1AB6    28 B8          C      	jr	z,l1a8a		; .. IFDI
  1AB8    C9             C      	ret
  1AB9                   C      l1ad3:
  1AB9    23             C      	inc	hl
  1ABA    7E             C      	ld	a,(hl)
  1ABB    0E DE          C      	ld	c,0deh
  1ABD    FE 67          C      	cp	67h
  1ABF    28 B3          C      	jr	z,l1a8e		; .. IFNB
  1AC1    FE 69          C      	cp	69h		; .. IFND
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-75


  1AC3    C0             C      	ret	nz
  1AC4    23             C      	inc	hl
  1AC5    7E             C      	ld	a,(hl)
  1AC6    FE 6A          C      	cp	6ah		; .. IFNDE
  1AC8    C0             C      	ret	nz
                         C      	ld.bc	6bh,0dfh	; .. IFNDEF
  1AC9    01 6BDF        C+     	ld	bc,6bh*256+0dfh
  1ACC    18 A2          C      	jr	l1a8a
                         C      ;
                         C      ; Letter J
                         C      ;
  1ACE                   C      @LET.J:
  1ACE    EB             C      	ex	de,hl
  1ACF    7E             C      	ld	a,(hl)
  1AD0    0E 74          C      	ld	c,74h
  1AD2    FE 75          C      	cp	75h		; .. JP
  1AD4    28 9E          C      	jr	z,l1a8e
  1AD6    FE 77          C      	cp	77h		; .. JR
  1AD8    C0             C      	ret	nz
  1AD9    0E 75          C      	ld	c,75h
  1ADB    18 97          C      	jr	l1a8e
                         C      ;
                         C      ; Letter L
                         C      ;
  1ADD                   C      @LET.L:
  1ADD    EB             C      	ex	de,hl
  1ADE    7E             C      	ld	a,(hl)
  1ADF    FE 69          C      	cp	69h
  1AE1    28 30          C      	jr	z,l1b2d		; .. LD
  1AE3    FE 57          C      	cp	57h
  1AE5    0E 15          C      	ld	c,15h
  1AE7    38 56          C      	jr	c,l1b59		; .. L only
  1AE9    FE 6E          C      	cp	6eh
  1AEB    28 40          C      	jr	z,l1b47		; .. LI
  1AED    FE 6A          C      	cp	6ah
  1AEF    0E 4C          C      	ld	c,4ch
  1AF1    28 47          C      	jr	z,l1b54		; .. LE
  1AF3    FE 79          C      	cp	79h
  1AF5    0E 4B          C      	ld	c,4bh
  1AF7    28 0E          C      	jr	z,l1b21		; .. LT
  1AF9    FE 74          C      	cp	74h		; .. LO
  1AFB    C0             C      	ret	nz
  1AFC    23             C      	inc	hl
  1AFD    7E             C      	ld	a,(hl)
  1AFE    FE 68          C      	cp	68h
  1B00    28 07          C      	jr	z,l1b23		; .. LOC
  1B02    FE 7C          C      	cp	7ch
  1B04    C0             C      	ret	nz
  1B05    0E 47          C      	ld	c,47h		; .. LOW
  1B07                   C      l1b21:
  1B07    18 31          C      	jr	l1b54
  1B09                   C      l1b23:
  1B09    23             C      	inc	hl
  1B0A    7E             C      	ld	a,(hl)
  1B0B    FE 66          C      	cp	66h		; .. LOCA
  1B0D    C0             C      	ret	nz
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-76


                         C      	ld.bc	71h,0cdh	; .. LOCAL
  1B0E    01 71CD        C+     	ld	bc,71h*256+0cdh
  1B11    18 23          C      	jr	l1b50
  1B13                   C      l1b2d:
  1B13    23             C      	inc	hl
  1B14    7E             C      	ld	a,(hl)
  1B15    FE 57          C      	cp	57h
  1B17    0E 76          C      	ld	c,76h
  1B19    38 24          C      	jr	c,l1b59		; .. LD only
  1B1B    FE 69          C      	cp	69h
  1B1D    28 45          C      	jr	z,l1b7e		; .. LDD
  1B1F    FE 6E          C      	cp	6eh		; .. LDI
  1B21    C0             C      	ret	nz
  1B22    0E 79          C      	ld	c,79h
  1B24                   C      l1b3e:
  1B24    23             C      	inc	hl
  1B25    7E             C      	ld	a,(hl)
  1B26    FE 77          C      	cp	77h		; .. R
  1B28    20 12          C      	jr	nz,l1b56
  1B2A    0C             C      	inc	c
  1B2B    18 DA          C      	jr	l1b21
  1B2D                   C      l1b47:
  1B2D    0E B7          C      	ld	c,0b7h
  1B2F                   C      l1b49:
  1B2F    23             C      	inc	hl
  1B30    7E             C      	ld	a,(hl)
  1B31    FE 78          C      	cp	78h		; .. LIS
  1B33    C0             C      	ret	nz
  1B34    06 79          C      	ld	b,79h		; .. LIST
  1B36                   C      l1b50:
  1B36    23             C      	inc	hl
  1B37    7E             C      	ld	a,(hl)
  1B38    B8             C      	cp	b
  1B39    C0             C      	ret	nz
  1B3A                   C      l1b54:
  1B3A    23             C      	inc	hl
  1B3B    7E             C      	ld	a,(hl)
  1B3C                   C      l1b56:
  1B3C    FE 56          C      	cp	56h
  1B3E    D0             C      	ret	nc
  1B3F                   C      l1b59:
  1B3F    AF             C      	xor	a
  1B40    C9             C      	ret
                         C      ;
                         C      ; Letter M
                         C      ;
  1B41                   C      @LET.M:
  1B41    EB             C      	ex	de,hl
  1B42    7E             C      	ld	a,(hl)
  1B43    FE 66          C      	cp	66h
  1B45    28 31          C      	jr	z,l1b92		; .. MA
  1B47    0E 28          C      	ld	c,28h
  1B49    38 F1          C      	jr	c,l1b56		; .. M only
  1B4B    FE 79          C      	cp	79h
  1B4D    28 19          C      	jr	z,l1b82		; .. MT
  1B4F    FE 6A          C      	cp	6ah
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-77


  1B51    28 1B          C      	jr	z,l1b88		; .. ME
  1B53    FE 74          C      	cp	74h
  1B55    28 08          C      	jr	z,l1b79		; .. MO
  1B57    FE 71          C      	cp	71h
  1B59    C0             C      	ret	nz		; .. ML
                         C      	ld.bc	79h,7bh
  1B5A    01 797B        C+     	ld	bc,79h*256+7bh
  1B5D    18 D7          C      	jr	l1b50		; .. MLT
  1B5F                   C      l1b79:
                         C      	ld.bc	69h,3eh		; .. MOD
  1B5F    01 693E        C+     	ld	bc,69h*256+3eh
  1B62    18 D2          C      	jr	l1b50
  1B64                   C      l1b7e:
  1B64    0E 77          C      	ld	c,77h		; .. set LDD(R)
  1B66    18 BC          C      	jr	l1b3e
  1B68                   C      l1b82:
  1B68    23             C      	inc	hl
  1B69    7E             C      	ld	a,(hl)
  1B6A    0E B9          C      	ld	c,0b9h		; Set MTLIST
  1B6C    18 4D          C      	jr	l1bd5
  1B6E                   C      l1b88:
  1B6E    23             C      	inc	hl
  1B6F    7E             C      	ld	a,(hl)
  1B70    FE 73          C      	cp	73h		; .. MEN
  1B72    C0             C      	ret	nz
                         C      	ld.bc	69h,0b1h	; .. MEND
  1B73    01 69B1        C+     	ld	bc,69h*256+0b1h
  1B76    18 BE          C      	jr	l1b50
  1B78                   C      l1b92:
  1B78    23             C      	inc	hl
  1B79    7E             C      	ld	a,(hl)
  1B7A    FE 68          C      	cp	68h		; .. MAC
  1B7C    C0             C      	ret	nz
  1B7D    23             C      	inc	hl
  1B7E    7E             C      	ld	a,(hl)
  1B7F    FE 77          C      	cp	77h		; .. MACR
  1B81    20 05          C      	jr	nz,l1ba2
                         C      	ld.bc	74h,0b8h
  1B83    01 74B8        C+     	ld	bc,74h*256+0b8h
  1B86    18 AE          C      	jr	l1b50		; .. MACRO
  1B88                   C      l1ba2:
  1B88    FE 71          C      	cp	71h		; .. MACL
  1B8A    C0             C      	ret	nz
  1B8B    23             C      	inc	hl
  1B8C    7E             C      	ld	a,(hl)
  1B8D    FE 6E          C      	cp	6eh		; .. MACLI
  1B8F    C0             C      	ret	nz
                         C      	ld.bc	67h,0ceh
  1B90    01 67CE        C+     	ld	bc,67h*256+0ceh
  1B93    18 A1          C      	jr	l1b50		; .. MACLIB
                         C      ;
                         C      ;
                         C      ;
  1B95                   C      l1baf:
  1B95    FE 68          C      	cp	68h
  1B97    38 0D          C      	jr	c,l1bc0		; .. NA..NB
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-78


  1B99    C0             C      	ret	nz
  1B9A    23             C      	inc	hl
  1B9B    7E             C      	ld	a,(hl)
  1B9C    FE 71          C      	cp	71h		; .. NCL
  1B9E    0E BB          C      	ld	c,0bbh
  1BA0    28 19          C      	jr	z,l1bd5
  1BA2    0E 23          C      	ld	c,23h
  1BA4    18 47          C      	jr	l1c07		; .. NC only
  1BA6                   C      l1bc0:
  1BA6    FE 66          C      	cp	66h		; .. NA
  1BA8    C0             C      	ret	nz
  1BA9    23             C      	inc	hl
  1BAA    7E             C      	ld	a,(hl)
  1BAB    FE 72          C      	cp	72h		; .. NAM
  1BAD    C0             C      	ret	nz
                         C      	ld.bc	6ah,0bah
  1BAE    01 6ABA        C+     	ld	bc,6ah*256+0bah
  1BB1    18 34          C      	jr	l1c01		; .. NAME
  1BB3                   C      l1bcd:
  1BB3    FE 6A          C      	cp	6ah
  1BB5    38 DE          C      	jr	c,l1baf		; .. NA..ND
  1BB7    28 0D          C      	jr	z,l1be0		; .. NE
  1BB9    0E BC          C      	ld	c,0bch
  1BBB                   C      l1bd5:
  1BBB    FE 71          C      	cp	71h		; .. xL
  1BBD    C0             C      	ret	nz
  1BBE    23             C      	inc	hl
  1BBF    7E             C      	ld	a,(hl)
  1BC0    FE 6E          C      	cp	6eh		; .. xLI
  1BC2    C0             C      	ret	nz
  1BC3    C3 1B2F        C      	jp	l1b49		; .. xLIST
  1BC6                   C      l1be0:
  1BC6    23             C      	inc	hl
  1BC7    7E             C      	ld	a,(hl)
  1BC8    FE 6C          C      	cp	6ch		; .. NEG
  1BCA    0E 7C          C      	ld	c,7ch
  1BCC    28 1D          C      	jr	z,l1c05
  1BCE    0E 4A          C      	ld	c,4ah
  1BD0    18 1B          C      	jr	l1c07		; .. NE only
                         C      ;
                         C      ; Letter N
                         C      ;
  1BD2                   C      @LET.N:
  1BD2    EB             C      	ex	de,hl
  1BD3    7E             C      	ld	a,(hl)
  1BD4    FE 72          C      	cp	72h
  1BD6    38 DB          C      	jr	c,l1bcd		; .. NA..NL
  1BD8    28 18          C      	jr	z,l1c0c		; .. NM
  1BDA    FE 7B          C      	cp	7bh
  1BDC    38 32          C      	jr	c,l1c2a		; .. NN..NU
  1BDE    28 1D          C      	jr	z,l1c17		; .. NV
  1BE0    FE 7F          C      	cp	7fh		; .. NZ
  1BE2    C0             C      	ret	nz
  1BE3    0E 21          C      	ld	c,21h
  1BE5    18 04          C      	jr	l1c05		; Set NZ
  1BE7                   C      l1c01:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-79


  1BE7    23             C      	inc	hl
  1BE8    7E             C      	ld	a,(hl)
  1BE9    B8             C      	cp	b
  1BEA    C0             C      	ret	nz
  1BEB                   C      l1c05:
  1BEB    23             C      	inc	hl
  1BEC    7E             C      	ld	a,(hl)
  1BED                   C      l1c07:
  1BED    FE 56          C      	cp	56h
  1BEF    D0             C      	ret	nc
  1BF0    AF             C      	xor	a
  1BF1    C9             C      	ret
  1BF2                   C      l1c0c:
  1BF2    23             C      	inc	hl
  1BF3    7E             C      	ld	a,(hl)
  1BF4    FE 79          C      	cp	79h
  1BF6    C0             C      	ret	nz		; .. NMT
  1BF7    23             C      	inc	hl
  1BF8    7E             C      	ld	a,(hl)
  1BF9    0E BD          C      	ld	c,0bdh
  1BFB    18 BE          C      	jr	l1bd5		; .. NMTLIST
  1BFD                   C      l1c17:
  1BFD    0E 25          C      	ld	c,25h
  1BFF    18 EA          C      	jr	l1c05		; .. Set NV
  1C01                   C      l1c1b:
  1C01    23             C      	inc	hl
  1C02    7E             C      	ld	a,(hl)
  1C03    FE 75          C      	cp	75h
  1C05    0E 7D          C      	ld	c,7dh
  1C07    28 E2          C      	jr	z,l1c05		; .. NOP
  1C09    FE 79          C      	cp	79h		; .. NOT
  1C0B    C0             C      	ret	nz
  1C0C    0E 44          C      	ld	c,44h
  1C0E    18 DB          C      	jr	l1c05
  1C10                   C      l1c2a:
  1C10    FE 74          C      	cp	74h		; .. NO
  1C12    28 ED          C      	jr	z,l1c1b
  1C14    FE 7A          C      	cp	7ah		; .. NU
  1C16    C0             C      	ret	nz
                         C      	ld.bc	71h,48h
  1C17    01 7148        C+     	ld	bc,71h*256+48h
  1C1A    18 CB          C      	jr	l1c01		; .. NUL
                         C      ;
                         C      ; Letter O
                         C      ;
  1C1C                   C      @LET.O:
  1C1C    EB             C      	ex	de,hl
  1C1D    7E             C      	ld	a,(hl)
  1C1E    FE 77          C      	cp	77h
  1C20    28 24          C      	jr	z,l1c60		; .. OR
  1C22    FE 79          C      	cp	79h
  1C24    28 2C          C      	jr	z,l1c6c		; .. OT
  1C26    FE 7A          C      	cp	7ah		; .. OU
  1C28    C0             C      	ret	nz
  1C29    23             C      	inc	hl
  1C2A    7E             C      	ld	a,(hl)
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-80


  1C2B    FE 79          C      	cp	79h		; .. OUT
  1C2D    C0             C      	ret	nz
  1C2E    23             C      	inc	hl
  1C2F    7E             C      	ld	a,(hl)
  1C30    FE 6E          C      	cp	6eh
  1C32    0E 88          C      	ld	c,88h
  1C34    28 B5          C      	jr	z,l1c05		; .. OUTI
  1C36    FE 69          C      	cp	69h
  1C38    0E 87          C      	ld	c,87h
  1C3A    28 AF          C      	jr	z,l1c05		; .. OUTD
  1C3C    FE 5C          C      	cp	5ch
  1C3E    0E 86          C      	ld	c,86h
  1C40    28 A9          C      	jr	z,l1c05		; .. OUT0
  1C42    0E 85          C      	ld	c,85h
  1C44    18 A7          C      	jr	l1c07		; .. OUT only
  1C46                   C      l1c60:
  1C46    23             C      	inc	hl
  1C47    7E             C      	ld	a,(hl)
  1C48    FE 6C          C      	cp	6ch
  1C4A    0E BE          C      	ld	c,0beh
  1C4C    28 9D          C      	jr	z,l1c05		; .. ORG
  1C4E    0E 7E          C      	ld	c,7eh
  1C50    18 9B          C      	jr	l1c07		; .. OR only
  1C52                   C      l1c6c:
  1C52    23             C      	inc	hl
  1C53    7E             C      	ld	a,(hl)
  1C54    FE 69          C      	cp	69h
  1C56    28 0F          C      	jr	z,l1c81		; .. OTD
  1C58    FE 6E          C      	cp	6eh
  1C5A    C0             C      	ret	nz		; .. OTI
  1C5B    23             C      	inc	hl
  1C5C    7E             C      	ld	a,(hl)
  1C5D    FE 77          C      	cp	77h
  1C5F    0E 84          C      	ld	c,84h
  1C61    28 88          C      	jr	z,l1c05		; .. OTIR
  1C63    0E 82          C      	ld	c,82h
  1C65    18 0B          C      	jr	l1c8c		; .. OTIM(R)
  1C67                   C      l1c81:
  1C67    23             C      	inc	hl
  1C68    7E             C      	ld	a,(hl)
  1C69    FE 77          C      	cp	77h
  1C6B    0E 81          C      	ld	c,81h
  1C6D    CA 1BEB        C      	jp	z,l1c05		; .. OTDR
  1C70    0E 7F          C      	ld	c,7fh
  1C72                   C      l1c8c:
  1C72    FE 72          C      	cp	72h		; .. OTDM
  1C74    C0             C      	ret	nz
  1C75    23             C      	inc	hl
  1C76    7E             C      	ld	a,(hl)
  1C77    FE 77          C      	cp	77h		; .. OTDMR
  1C79    C2 1D1B        C      	jp	nz,l1d35
  1C7C    0C             C      	inc	c
  1C7D    C3 1D19        C      	jp	l1d33
                         C      ;
                         C      ; Letter P
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-81


  1C80                   C      @LET.P:
  1C80    EB             C      	ex	de,hl
  1C81    7E             C      	ld	a,(hl)
  1C82    FE 74          C      	cp	74h
  1C84    28 18          C      	jr	z,l1cb8		; .. PO
  1C86    FE 7A          C      	cp	7ah
  1C88    28 22          C      	jr	z,l1cc6		; .. PU
  1C8A    FE 6A          C      	cp	6ah
  1C8C    28 44          C      	jr	z,l1cec		; .. PE
  1C8E    FE 77          C      	cp	77h
  1C90    28 36          C      	jr	z,l1ce2		; .. PR
  1C92    FE 66          C      	cp	66h
  1C94    28 40          C      	jr	z,l1cf0		; .. PA
  1C96    FE 78          C      	cp	78h
  1C98    28 29          C      	jr	z,l1cdd		; .. PS
  1C9A    0E 27          C      	ld	c,27h
  1C9C    18 7D          C      	jr	l1d35		; .. P only
  1C9E                   C      l1cb8:
  1C9E    23             C      	inc	hl
  1C9F    7E             C      	ld	a,(hl)
  1CA0    FE 75          C      	cp	75h
  1CA2    28 04          C      	jr	z,l1cc2		; .. POP
  1CA4    0E 25          C      	ld	c,25h
  1CA6    18 73          C      	jr	l1d35		; .. PO only
  1CA8                   C      l1cc2:
  1CA8    0E 89          C      	ld	c,89h
  1CAA    18 6D          C      	jr	l1d33
  1CAC                   C      l1cc6:
  1CAC    23             C      	inc	hl
  1CAD    7E             C      	ld	a,(hl)
  1CAE    FE 78          C      	cp	78h		; .. PUS
  1CB0    20 05          C      	jr	nz,l1cd1
                         C      	ld.bc	6dh,8ah
  1CB2    01 6D8A        C+     	ld	bc,6dh*256+8ah
  1CB5    18 5E          C      	jr	l1d2f		; .. PUSH
  1CB7                   C      l1cd1:
  1CB7    FE 67          C      	cp	67h		; .. PUB
  1CB9    C0             C      	ret	nz
  1CBA    11 1F8D        C      	ld	de,l1fa7
                         C      	ld.bc	3,0b2h
  1CBD    01 03B2        C+     	ld	bc,3*256+0b2h
  1CC0    C3 1F49        C      	jp	CmpToken	; .. PUBLIC
  1CC3                   C      l1cdd:
                         C      	ld.bc	7ch,1dh
  1CC3    01 7C1D        C+     	ld	bc,7ch*256+1dh
  1CC6    18 4D          C      	jr	l1d2f		; .. PSW
  1CC8                   C      l1ce2:
  1CC8    23             C      	inc	hl
  1CC9    7E             C      	ld	a,(hl)
  1CCA    FE 74          C      	cp	74h		; .. PRO
  1CCC    C0             C      	ret	nz
                         C      	ld.bc	6ch,0c1h
  1CCD    01 6CC1        C+     	ld	bc,6ch*256+0c1h
  1CD0    18 43          C      	jr	l1d2f		; .. PROG
  1CD2                   C      l1cec:
  1CD2    0E 26          C      	ld	c,26h
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-82


  1CD4    18 43          C      	jr	l1d33		; .. set PE
  1CD6                   C      l1cf0:
  1CD6    23             C      	inc	hl
  1CD7    7E             C      	ld	a,(hl)
  1CD8    FE 6C          C      	cp	6ch		; .. PAG
  1CDA    C0             C      	ret	nz
                         C      	ld.bc	6ah,0bfh
  1CDB    01 6ABF        C+     	ld	bc,6ah*256+0bfh
  1CDE    18 35          C      	jr	l1d2f		; .. PAGE
                         C      ;
                         C      ; Letter R
                         C      ;
  1CE0                   C      @LET.R:
  1CE0    EB             C      	ex	de,hl
  1CE1    7E             C      	ld	a,(hl)
  1CE2    FE 6A          C      	cp	6ah
  1CE4    28 10          C      	jr	z,l1d10		; .. RE
  1CE6    FE 71          C      	cp	71h
  1CE8    28 4A          C      	jr	z,l1d4e		; .. RL
  1CEA    FE 77          C      	cp	77h
  1CEC    28 68          C      	jr	z,l1d70		; .. RR
  1CEE    FE 78          C      	cp	78h
  1CF0    28 7A          C      	jr	z,l1d86		; .. RS
  1CF2    0E 19          C      	ld	c,19h
  1CF4    18 25          C      	jr	l1d35		; .. R only
  1CF6                   C      l1d10:
  1CF6    23             C      	inc	hl
  1CF7    7E             C      	ld	a,(hl)
  1CF8    FE 78          C      	cp	78h
  1CFA    28 34          C      	jr	z,l1d4a		; .. RES
  1CFC    FE 79          C      	cp	79h		; .. RET
  1CFE    20 20          C      	jr	nz,l1d3a
  1D00    23             C      	inc	hl
  1D01    7E             C      	ld	a,(hl)
  1D02    0E 8C          C      	ld	c,8ch
  1D04    FE 57          C      	cp	57h
  1D06    38 16          C      	jr	c,l1d38		; .. RET only
  1D08    FE 6E          C      	cp	6eh
  1D0A    0E 8D          C      	ld	c,8dh
  1D0C    28 0B          C      	jr	z,l1d33		; .. RETI
  1D0E    FE 73          C      	cp	73h		; .. RETN
  1D10    0E 8E          C      	ld	c,8eh
  1D12    C0             C      	ret	nz
  1D13    18 04          C      	jr	l1d33
  1D15                   C      l1d2f:
  1D15    23             C      	inc	hl
  1D16    7E             C      	ld	a,(hl)
  1D17    B8             C      	cp	b
  1D18    C0             C      	ret	nz
  1D19                   C      l1d33:
  1D19    23             C      	inc	hl
  1D1A    7E             C      	ld	a,(hl)
  1D1B                   C      l1d35:
  1D1B    FE 56          C      	cp	56h
  1D1D    D0             C      	ret	nc
  1D1E                   C      l1d38:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-83


  1D1E    AF             C      	xor	a
  1D1F    C9             C      	ret
  1D20                   C      l1d3a:
  1D20    FE 71          C      	cp	71h		; .. REL
  1D22    20 04          C      	jr	nz,l1d42
  1D24    0E C1          C      	ld	c,0c1h
  1D26    18 F1          C      	jr	l1d33
  1D28                   C      l1d42:
  1D28    FE 75          C      	cp	75h		; .. REP
  1D2A    C0             C      	ret	nz
                         C      	ld.bc	79h,0cfh
  1D2B    01 79CF        C+     	ld	bc,79h*256+0cfh
  1D2E    18 E5          C      	jr	l1d2f		; .. REPT
  1D30                   C      l1d4a:
  1D30    0E 8B          C      	ld	c,8bh
  1D32    18 E5          C      	jr	l1d33		; .. set RES
  1D34                   C      l1d4e:
  1D34    23             C      	inc	hl
  1D35    7E             C      	ld	a,(hl)
  1D36    FE 68          C      	cp	68h
  1D38    28 10          C      	jr	z,l1d64		; .. RLC
  1D3A    FE 66          C      	cp	66h
  1D3C    0E 90          C      	ld	c,90h
  1D3E    28 D9          C      	jr	z,l1d33		; .. RLA
  1D40    FE 69          C      	cp	69h
  1D42    0E 93          C      	ld	c,93h
  1D44    28 D3          C      	jr	z,l1d33		; .. RLD
  1D46    0E 8F          C      	ld	c,8fh
  1D48    18 D1          C      	jr	l1d35		; .. RL only
  1D4A                   C      l1d64:
  1D4A    23             C      	inc	hl
  1D4B    7E             C      	ld	a,(hl)
  1D4C    FE 66          C      	cp	66h
  1D4E    0E 92          C      	ld	c,92h
  1D50    28 C7          C      	jr	z,l1d33		; .. RLCA
  1D52    0E 91          C      	ld	c,91h
  1D54    18 C5          C      	jr	l1d35		; .. RLC only
  1D56                   C      l1d70:
  1D56    23             C      	inc	hl
  1D57    7E             C      	ld	a,(hl)
  1D58    FE 68          C      	cp	68h
  1D5A    28 15          C      	jr	z,l1d8b		; .. RRC
  1D5C    FE 66          C      	cp	66h
  1D5E    0E 95          C      	ld	c,95h
  1D60    28 B7          C      	jr	z,l1d33		; .. RRA
  1D62    FE 69          C      	cp	69h
  1D64    0E 98          C      	ld	c,98h
  1D66    28 B1          C      	jr	z,l1d33		; .. RRD
  1D68    0E 94          C      	ld	c,94h
  1D6A    18 AF          C      	jr	l1d35		; .. RR only
  1D6C                   C      l1d86:
                         C      	ld.bc	79h,99h
  1D6C    01 7999        C+     	ld	bc,79h*256+99h
  1D6F    18 A4          C      	jr	l1d2f		; .. RST
  1D71                   C      l1d8b:
  1D71    23             C      	inc	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-84


  1D72    7E             C      	ld	a,(hl)
  1D73    FE 66          C      	cp	66h
  1D75    0E 97          C      	ld	c,97h
  1D77    28 A0          C      	jr	z,l1d33		; .. RRCA
  1D79    0E 96          C      	ld	c,96h
  1D7B    18 9E          C      	jr	l1d35		; .. RRC only
                         C      ;
                         C      ;
                         C      ;
  1D7D                   C      l1d97:
  1D7D    23             C      	inc	hl
  1D7E    7E             C      	ld	a,(hl)
  1D7F    FE 67          C      	cp	67h		; .. SUB
  1D81    C0             C      	ret	nz
  1D82    0E A1          C      	ld	c,0a1h
  1D84    23             C      	inc	hl
  1D85    3E 79          C      	ld	a,79h		; .. SUBT
  1D87    BE             C      	cp	(hl)
  1D88    20 6A          C      	jr	nz,l1e0e
  1D8A    23             C      	inc	hl
  1D8B    BE             C      	cp	(hl)		; .. SUBTT
  1D8C    C0             C      	ret	nz
                         C      	ld.bc	71h,0d2h
  1D8D    01 71D2        C+     	ld	bc,71h*256+0d2h
  1D90    18 5D          C      	jr	l1e09		; .. SUBTTL
                         C      ;
                         C      ; Letter S
                         C      ;
  1D92                   C      @LET.S:
  1D92    EB             C      	ex	de,hl
  1D93    7E             C      	ld	a,(hl)
  1D94    FE 7A          C      	cp	7ah
  1D96    28 E5          C      	jr	z,l1d97		; .. SU
  1D98    FE 67          C      	cp	67h
  1D9A    28 50          C      	jr	z,l1e06		; .. SB
  1D9C    FE 6A          C      	cp	6ah
  1D9E    28 33          C      	jr	z,l1ded		; .. SE
  1DA0    FE 68          C      	cp	68h
  1DA2    28 34          C      	jr	z,l1df2		; .. SC
  1DA4    FE 71          C      	cp	71h
  1DA6    28 35          C      	jr	z,l1df7		; .. SL
  1DA8    FE 75          C      	cp	75h
  1DAA    0E 1E          C      	ld	c,1eh
  1DAC    28 45          C      	jr	z,l1e0d		; .. SP
  1DAE    FE 77          C      	cp	77h
  1DB0    28 12          C      	jr	z,l1dde		; .. SR
  1DB2    FE 6D          C      	cp	6dh		; .. SH
  1DB4    C0             C      	ret	nz
  1DB5    23             C      	inc	hl
  1DB6    7E             C      	ld	a,(hl)
  1DB7    FE 71          C      	cp	71h
  1DB9    0E 43          C      	ld	c,43h
  1DBB    28 36          C      	jr	z,l1e0d		; .. SHL
  1DBD    FE 77          C      	cp	77h
  1DBF    C0             C      	ret	nz
  1DC0    0E 42          C      	ld	c,42h
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-85


  1DC2    18 2F          C      	jr	l1e0d		; .. SHR
  1DC4                   C      l1dde:
  1DC4    23             C      	inc	hl
  1DC5    7E             C      	ld	a,(hl)
  1DC6    0E 9F          C      	ld	c,9fh
  1DC8    FE 66          C      	cp	66h
  1DCA    28 27          C      	jr	z,l1e0d		; .. SRA
  1DCC    FE 71          C      	cp	71h		; .. SRL
  1DCE    C0             C      	ret	nz
  1DCF    0E A0          C      	ld	c,0a0h
  1DD1    18 20          C      	jr	l1e0d		; .. set SRL
  1DD3                   C      l1ded:
                         C      	ld.bc	79h,9ch
  1DD3    01 799C        C+     	ld	bc,79h*256+9ch
  1DD6    18 17          C      	jr	l1e09		; .. SET
  1DD8                   C      l1df2:
                         C      	ld.bc	6bh,9bh
  1DD8    01 6B9B        C+     	ld	bc,6bh*256+9bh
  1DDB    18 12          C      	jr	l1e09		; .. SCF
  1DDD                   C      l1df7:
  1DDD    23             C      	inc	hl
  1DDE    7E             C      	ld	a,(hl)
  1DDF    FE 66          C      	cp	66h
  1DE1    0E 9D          C      	ld	c,9dh
  1DE3    28 0E          C      	jr	z,l1e0d		; .. SLA
  1DE5    FE 75          C      	cp	75h
  1DE7    C0             C      	ret	nz
  1DE8    0E 9E          C      	ld	c,9eh
  1DEA    18 07          C      	jr	l1e0d		; .. SLP
  1DEC                   C      l1e06:
                         C      	ld.bc	68h,9ah		; .. SBC
  1DEC    01 689A        C+     	ld	bc,68h*256+9ah
  1DEF                   C      l1e09:
  1DEF    23             C      	inc	hl
  1DF0    7E             C      	ld	a,(hl)
  1DF1    B8             C      	cp	b
  1DF2    C0             C      	ret	nz
  1DF3                   C      l1e0d:
  1DF3    23             C      	inc	hl
  1DF4                   C      l1e0e:
  1DF4    7E             C      	ld	a,(hl)
  1DF5                   C      l1e0f:
  1DF5    FE 56          C      	cp	56h		; .. test end range
  1DF7    D0             C      	ret	nc
  1DF8    AF             C      	xor	a
  1DF9    C9             C      	ret
                         C      ;
                         C      ; Letter T
                         C      ;
  1DFA                   C      @LET.T:
  1DFA    EB             C      	ex	de,hl
  1DFB    7E             C      	ld	a,(hl)
  1DFC    FE 6E          C      	cp	6eh
  1DFE    11 1FA9        C      	ld	de,l1fc3
                         C      	ld.bc	3,0c2h
  1E01    01 03C2        C+     	ld	bc,3*256+0c2h
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-86


  1E04    CA 1F49        C      	jp	z,CmpToken	; .. TITLE
  1E07    FE 7E          C      	cp	7eh
  1E09    28 15          C      	jr	z,l1e3a		; .. TY
  1E0B    FE 78          C      	cp	78h		; .. TS
  1E0D    C0             C      	ret	nz
  1E0E    23             C      	inc	hl
  1E0F    7E             C      	ld	a,(hl)
  1E10    FE 79          C      	cp	79h		; .. TST
  1E12    C0             C      	ret	nz
  1E13    23             C      	inc	hl
  1E14    7E             C      	ld	a,(hl)
  1E15    FE 6E          C      	cp	6eh		; .. TSTI
  1E17    0E A2          C      	ld	c,0a2h
  1E19    20 DA          C      	jr	nz,l1e0f	; .. TST only
                         C      	ld.bc	74h,0a3h
  1E1B    01 74A3        C+     	ld	bc,74h*256+0a3h
  1E1E    18 CF          C      	jr	l1e09		; .. TSTIO
  1E20                   C      l1e3a:
  1E20    23             C      	inc	hl
  1E21    7E             C      	ld	a,(hl)
  1E22    FE 75          C      	cp	75h		; .. TYP
  1E24    C0             C      	ret	nz
                         C      	ld.bc	6ah,4fh
  1E25    01 6A4F        C+     	ld	bc,6ah*256+4fh
  1E28    18 C5          C      	jr	l1e09		; .. TYPE
                         C      ;
                         C      ; Letter V
                         C      ;
  1E2A                   C      @LET.V:
  1E2A    EB             C      	ex	de,hl
  1E2B    0E 26          C      	ld	c,26h
  1E2D    18 C5          C      	jr	l1e0e		; Set V only
                         C      ;
                         C      ; Letter X
                         C      ;
  1E2F                   C      @LET.X:
  1E2F    EB             C      	ex	de,hl
  1E30    7E             C      	ld	a,(hl)
  1E31    FE 74          C      	cp	74h
                         C      	ld.bc	77h,0a4h
  1E33    01 77A4        C+     	ld	bc,77h*256+0a4h
  1E36    28 B7          C      	jr	z,l1e09		; .. XOR
  1E38    FE 56          C      	cp	56h		; .. X' ot X"
  1E3A    C0             C      	ret	nz
  1E3B    C3 0E97        C      	jp	l0eb1		; .. process hex number
                         C      ;
                         C      ; Letter .Z
                         C      ;
  1E3E                   C      @PS.OP.Z:
  1E3E    23             C      	inc	hl
  1E3F    7E             C      	ld	a,(hl)
  1E40    FE 64          C      	cp	64h		; .. .Z8
  1E42    C0             C      	ret	nz
                         C      	ld.bc	5ch,0d5h
  1E43    01 5CD5        C+     	ld	bc,5ch*256+0d5h
  1E46    18 A7          C      	jr	l1e09		; .. .Z80
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-87


                         C      ;
                         C      ; Letter Z
                         C      ;
  1E48                   C      @LET.Z:
  1E48    EB             C      	ex	de,hl
  1E49    0E 22          C      	ld	c,22h
  1E4B    18 A7          C      	jr	l1e0e		; .. set Z only
                         C      ;
                         C      ; Letter .L
                         C      ;
  1E4D                   C      @PS.OP.L:
  1E4D    23             C      	inc	hl
  1E4E    7E             C      	ld	a,(hl)
  1E4F    FE 66          C      	cp	66h
  1E51    28 15          C      	jr	z,l1e82		; .. .LA
  1E53    FE 6B          C      	cp	6bh
  1E55    0E A6          C      	ld	c,0a6h
  1E57    CA 1F00        C      	jp	z,l1f1a		; .. .LF
  1E5A    FE 6E          C      	cp	6eh		; .. .LI
  1E5C    C0             C      	ret	nz
  1E5D    0E B7          C      	ld	c,0b7h
  1E5F    23             C      	inc	hl
  1E60    7E             C      	ld	a,(hl)
  1E61    FE 78          C      	cp	78h		; .. .LIS
  1E63    C0             C      	ret	nz
  1E64    06 79          C      	ld	b,79h
  1E66    18 87          C      	jr	l1e09		; .. .LIST
  1E68                   C      l1e82:
  1E68    0E CC          C      	ld	c,0cch
  1E6A                   C      l1e84:
  1E6A    23             C      	inc	hl
  1E6B    7E             C      	ld	a,(hl)		; .. Test xLL
  1E6C    FE 71          C      	cp	71h
  1E6E    C0             C      	ret	nz
  1E6F    06 71          C      	ld	b,71h
  1E71    C3 1DEF        C      	jp	l1e09
                         C      ;
                         C      ; Got $
                         C      ;
  1E74                   C      @PC.REF:
  1E74    EB             C      	ex	de,hl
  1E75    7E             C      	ld	a,(hl)
  1E76    FE 57          C      	cp	57h		; Test range
  1E78    30 1C          C      	jr	nc,l1eb0
  1E7A    2B             C      	dec	hl
  1E7B    22 62F5        C      	ld	(TokPtr),hl	; .. save token pointer
  1E7E    E1             C      	pop	hl
  1E7F    2A 67F2        C      	ld	hl,(l6865)
  1E82    3A 67F1        C      	ld	a,($REL$)	; Get REL flag
  1E85    F6 80          C      	or	80h
  1E87    32 630E        C      	ld	(l6381),a
  1E8A    22 630F        C      	ld	(l6382),hl
  1E8D    21 630E        C      	ld	hl,l6381
  1E90    3E 39          C      	ld	a,39h
  1E92    4F             C      	ld	c,a
  1E93    C3 0F32        C      	jp	l0f4c
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-88


  1E96                   C      l1eb0:
  1E96    FE 6A          C      	cp	6ah
  1E98    11 1F93        C      	ld	de,l1fad
                         C      	ld.bc	4,0bfh
  1E9B    01 04BF        C+     	ld	bc,4*256+0bfh
  1E9E    CA 1F49        C      	jp	z,CmpToken	; .. $EJECT
  1EA1    FE 6E          C      	cp	6eh
  1EA3    11 1F9F        C      	ld	de,l1fb9
                         C      	ld.bc	6,0b6h
  1EA6    01 06B6        C+     	ld	bc,6*256+0b6h
  1EA9    CA 1F49        C      	jp	z,CmpToken	; .. $INCLUDE
  1EAC    FE 79          C      	cp	79h
  1EAE    C0             C      	ret	nz
  1EAF    11 1FA8        C      	ld	de,l1fc2
                         C      	ld.bc	4,0e6h
  1EB2    01 04E6        C+     	ld	bc,4*256+0e6h
  1EB5    CA 1F49        C      	jp	z,CmpToken	; .. $TITLE
                         C      ;
                         C      ; Got unknown token, treat as label
                         C      ;
  1EB8                   C      @LABEL:
  1EB8    EB             C      	ex	de,hl
  1EB9    AF             C      	xor	a
  1EBA    3D             C      	dec	a
  1EBB    C9             C      	ret
                         C      ;
                         C      ; Letter .A
                         C      ;
  1EBC                   C      @PS.OP.A:
  1EBC    11 1FBA        C      	ld	de,l1fd4
                         C      	ld.bc	5,0c3h
  1EBF    01 05C3        C+     	ld	bc,5*256+0c3h
  1EC2    C3 1F49        C      	jp	CmpToken	; .. .ACCEPT
                         C      ;
                         C      ; Letter .C
                         C      ;
  1EC5                   C      @PS.OP.C:
  1EC5    23             C      	inc	hl
  1EC6    7E             C      	ld	a,(hl)
  1EC7    FE 77          C      	cp	77h		; .. .CR
  1EC9    20 09          C      	jr	nz,l1eee
  1ECB    11 1FAD        C      	ld	de,l1fc7
                         C      	ld.bc	2,0c5h
  1ECE    01 02C5        C+     	ld	bc,2*256+0c5h
  1ED1    C3 1F49        C      	jp	CmpToken	; .. .CREF
  1ED4                   C      l1eee:
  1ED4    FE 74          C      	cp	74h		; .. .CO
  1ED6    C0             C      	ret	nz
  1ED7    11 1FBF        C      	ld	de,l1fd9
                         C      	ld.bc	5,0c4h
  1EDA    01 05C4        C+     	ld	bc,5*256+0c4h
  1EDD    18 6A          C      	jr	CmpToken	; .. .COMMENT
                         C      ;
                         C      ; Letter .D
                         C      ;
  1EDF                   C      @PS.OP.D:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-89


  1EDF    11 1FAF        C      	ld	de,l1fc9
                         C      	ld.bc	6,0adh
  1EE2    01 06AD        C+     	ld	bc,6*256+0adh
  1EE5    18 62          C      	jr	CmpToken	; .. .DEPHASE
                         C      ;
                         C      ; Letter .P
                         C      ;
  1EE7                   C      @PS.OP.P:
  1EE7    23             C      	inc	hl
  1EE8    7E             C      	ld	a,(hl)
  1EE9    FE 6D          C      	cp	6dh
  1EEB    28 0B          C      	jr	z,l1f12		; .. .PH
  1EED    FE 77          C      	cp	77h		; .. .PR
  1EEF    C0             C      	ret	nz
  1EF0    11 1FC4        C      	ld	de,l1fde
                         C      	ld.bc	4,0e0h
  1EF3    01 04E0        C+     	ld	bc,4*256+0e0h
  1EF6    18 51          C      	jr	CmpToken	; .. .PRINTX
  1EF8                   C      l1f12:
  1EF8    11 1FB2        C      	ld	de,l1fcc
                         C      	ld.bc	3,0c0h
  1EFB    01 03C0        C+     	ld	bc,3*256+0c0h
  1EFE    18 49          C      	jr	CmpToken	; .. .PHASE
  1F00                   C      l1f1a:
  1F00    11 1FC9        C      	ld	de,l1fe3
  1F03    06 04          C      	ld	b,4
  1F05    18 42          C      	jr	CmpToken	; .. .LFCOND
                         C      ;
                         C      ; Got pseudo opcode prefix '.'
                         C      ;
  1F07                   C      @PS.OP:
  1F07    EB             C      	ex	de,hl
  1F08    7E             C      	ld	a,(hl)
  1F09    FE 66          C      	cp	66h
  1F0B    28 AF          C      	jr	z,@PS.OP.A	; .. .A
  1F0D    FE 68          C      	cp	68h
  1F0F    28 B4          C      	jr	z,@PS.OP.C	; .. .C
  1F11    FE 69          C      	cp	69h
  1F13    28 CA          C      	jr	z,@PS.OP.D	; .. .D
  1F15    FE 71          C      	cp	71h
  1F17    CA 1E4D        C      	jp	z,@PS.OP.L	; .. .L
  1F1A    FE 75          C      	cp	75h
  1F1C    28 C9          C      	jr	z,@PS.OP.P	; .. .P
  1F1E    FE 77          C      	cp	77h
  1F20    28 12          C      	jr	z,@PS.OP.R	; .. .R
  1F22    FE 78          C      	cp	78h
  1F24    28 2D          C      	jr	z,@PS.OP.S	; .. .S
  1F26    FE 79          C      	cp	79h
  1F28    28 39          C      	jr	z,@PS.OP.T	; .. .T
  1F2A    FE 7D          C      	cp	7dh
  1F2C    28 3D          C      	jr	z,@PS.OP.X	; .. .X
  1F2E    FE 7F          C      	cp	7fh
  1F30    C0             C      	ret	nz
  1F31    C3 1E3E        C      	jp	@PS.OP.Z	; .. .Z
                         C      ;
                         C      ; Letter .R
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-90


                         C      ;
  1F34                   C      @PS.OP.R:
  1F34    23             C      	inc	hl
  1F35    7E             C      	ld	a,(hl)
  1F36    FE 6A          C      	cp	6ah
  1F38    11 1FB5        C      	ld	de,l1fcf
                         C      	ld.bc	5,0d0h
  1F3B    01 05D0        C+     	ld	bc,5*256+0d0h
  1F3E    28 09          C      	jr	z,CmpToken	; .. .REQUEST
  1F40    FE 66          C      	cp	66h		; .. .RA
  1F42    C0             C      	ret	nz
  1F43    11 1FCD        C      	ld	de,l1fe7
                         C      	ld.bc	3,0e4h		; .. .RADIX
  1F46    01 03E4        C+     	ld	bc,3*256+0e4h
                         C      ;
                         C      ; Compare field
                         C      ; ENTRY	Reg DE points to 1st field
                         C      ;	Reg HL points to 2nd field-1
                         C      ;	Reg B  holds length of 1st field
                         C      ;	Reg C  holds token
                         C      ;
  1F49                   C      CmpToken:
  1F49    1A             C      	ld	a,(de)		; Get from field
  1F4A    23             C      	inc	hl
  1F4B    BE             C      	cp	(hl)		; Compare
  1F4C    C0             C      	ret	nz		; .. nope
  1F4D    13             C      	inc	de
  1F4E    10 F9          C      	djnz	CmpToken
  1F50    C3 1DF3        C      	jp	l1e0d		; .. got it
                         C      ;
                         C      ; Letter .S
                         C      ;
  1F53                   C      @PS.OP.S:
  1F53    23             C      	inc	hl
  1F54    7E             C      	ld	a,(hl)
  1F55    FE 66          C      	cp	66h
  1F57    0E D1          C      	ld	c,0d1h
  1F59    CA 1E6A        C      	jp	z,l1e84		; .. .SALL
  1F5C    FE 6B          C      	cp	6bh		; .. .SF
  1F5E    C0             C      	ret	nz
  1F5F    0E BB          C      	ld	c,0bbh
  1F61    18 9D          C      	jr	l1f1a		; .. .SFCOND
                         C      ;
                         C      ; Letter .T
                         C      ;
  1F63                   C      @PS.OP.T:
  1F63    11 1FC8        C      	ld	de,l1fe2
                         C      	ld.bc	5,0e5h
  1F66    01 05E5        C+     	ld	bc,5*256+0e5h
  1F69    18 DE          C      	jr	CmpToken	; .. TFCOND
                         C      ;
                         C      ; Letter .X
                         C      ;
  1F6B                   C      @PS.OP.X:
  1F6B    23             C      	inc	hl
  1F6C    7E             C      	ld	a,(hl)
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-91


  1F6D    FE 66          C      	cp	66h
  1F6F    28 0F          C      	jr	z,l1f9a		; .. .XA
  1F71    FE 68          C      	cp	68h
  1F73    28 10          C      	jr	z,l1f9f		; .. .XC
  1F75    FE 71          C      	cp	71h		; .. .XL
  1F77    C0             C      	ret	nz
  1F78    11 1F90        C      	ld	de,l1faa
                         C      	ld.bc	3,0bch
  1F7B    01 03BC        C+     	ld	bc,3*256+0bch
  1F7E    18 C9          C      	jr	CmpToken	; .. .XLIST
  1F80                   C      l1f9a:
  1F80    0E D3          C      	ld	c,0d3h
  1F82    C3 1E6A        C      	jp	l1e84		; .. set .XALL
  1F85                   C      l1f9f:
  1F85    11 1FAC        C      	ld	de,l1fc6
                         C      	ld.bc	3,0d4h
  1F88    01 03D4        C+     	ld	bc,3*256+0d4h
  1F8B    18 BC          C      	jr	CmpToken	; .. XCREF
                         C      ;
                         C      ; Coded section
                         C      ;
  1F8D                   C      l1fa7:
  1F8D    71 6E 68       C      	db	71h,6eh,68h		; LIC
  1F90                   C      l1faa:
  1F90    6E 78 79       C      	db	6eh,78h,79h		; IST
  1F93                   C      l1fad:
  1F93    6F             C      	db	6fh			; J
  1F94                   C      l1fae:
  1F94    6A 68 79       C      	db	6ah,68h,79h		; ECT
  1F97                   C      l1fb1:
  1F97    77 73 66 71    C      	db	77h,73h,66h,71h		; RNAL
  1F9B                   C      l1fb5:
  1F9B    74 67 66 71    C      	db	74h,67h,66h,71h		; OBAL
  1F9F                   C      l1fb9:
  1F9F    73 68 71       C      	db	73h,68h,71h		; NCL
  1FA2                   C      l1fbc:
  1FA2    7A 69 6A       C      	db	7ah,69h,6ah		; UDE
  1FA5                   C      l1fbf:
  1FA5    68 66 71       C      	db	68h,66h,71h		; CAL
  1FA8                   C      l1fc2:
  1FA8    6E             C      	db	6eh			; I
  1FA9                   C      l1fc3:
  1FA9    79 71 6A       C      	db	79h,71h,6ah		; TLE
  1FAC                   C      l1fc6:
  1FAC    77             C      	db	77h			; R
  1FAD                   C      l1fc7:
  1FAD    6A 6B          C      	db	6ah,6bh			; EF
  1FAF                   C      l1fc9:
  1FAF    6A 75 6D       C      	db	6ah,75h,6dh		; EPH
  1FB2                   C      l1fcc:
  1FB2    66 78 6A       C      	db	66h,78h,6ah		; ASE
  1FB5                   C      l1fcf:
  1FB5    76 7A 6A 78    C      	db	76h,7ah,6ah,78h,79h	; QUEST
  1FB9    79             C      
  1FBA                   C      l1fd4:
  1FBA    68 68 6A 75    C      	db	68h,68h,6ah,75h,79h	; CCEPT
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-92


  1FBE    79             C      
  1FBF                   C      l1fd9:
  1FBF    72 72 6A 73    C      	db	72h,72h,6ah,73h,79h	; MMENT
  1FC3    79             C      
  1FC4                   C      l1fde:
  1FC4    6E 73 79 7D    C      	db	6eh,73h,79h,7dh		; INTX
  1FC8                   C      l1fe2:
  1FC8    6B             C      	db	6bh			; F
  1FC9                   C      l1fe3:
  1FC9    68 74 73 69    C      	db	68h,74h,73h,69h		; COND
  1FCD                   C      l1fe7:
  1FCD    69 6E 7D       C      	db	69h,6eh,7dh		; DIX
                         C      ;
                         C      ; Process assign errors
                         C      ;
  1FD0                   C      IllDrv:
  1FD0    21 212F        C      	ld	hl,$FN.ERR
  1FD3    CD 5D93        C      	call	DO.ERROR	; Process error
  1FD6                   C      .EndOfASM:
  1FD6    C3 0B87        C      	jp	EndOfASM	; .. restart
                         C      ;
                         C      ; Assign files
                         C      ;
  1FD9                   C      AssignF:
  1FD9    21 005D        C      	ld	hl,FCB+@drv	; Point to name
  1FDC    7E             C      	ld	a,(hl)
  1FDD    FE 20          C      	cp	' '		; Test name given
  1FDF    20 05          C      	jr	nz,Ass..	; .. yeap
  1FE1    21 213F        C      	ld	hl,$NO.FILE
  1FE4    18 F0          C      	jr	.EndOfASM	; Tell error
  1FE6                   C      Ass..:
  1FE6    11 6AB7        C      	ld	de,SrcFCB+@drv
  1FE9    01 0008        C      	ld	bc,@nam
  1FEC    ED B0          C      	ldir			; Save name
  1FEE    21 013D        C      	ld	hl,$$180
  1FF1    ED A0          C      	ldi			; .. set extension .180
  1FF3    ED A0          C      	ldi
  1FF5    ED A0          C      	ldi
  1FF7    AF             C      	xor	a
  1FF8    12             C      	ld	(de),a
  1FF9    3A 0065        C      	ld	a,(FCB+@drv+@nam)
  1FFC    D6 40          C      	sub	'A'-1
  1FFE    32 6AB6        C      	ld	(SrcFCB),a	; Save source drive
  2001    FE 11          C      	cp	'P'-'A'+2
  2003    30 CB          C      	jr	nc,IllDrv	; .. should be
  2005    21 6AB6        C      	ld	hl,SrcFCB
  2008    11 688B        C      	ld	de,$$FCB$$
  200B    01 0009        C      	ld	bc,@drv+@nam
  200E    ED B0          C      	ldir			; Unpack name
  2010    3E FF          C      	ld	a,eot
  2012    32 688B        C      	ld	($$FCB$$),a	; .. set no drive
  2015    CD 2148        C      	call	ResetF		; Reset files
  2018    21 22D9        C      	ld	hl,alloc_
  201B    22 225F        C      	ld	(@ALLOC@),hl	; Change allocation routine
  201E    CA 0B87        C      	jp	z,EndOfASM	; .. bad reset, restart
  2021    AF             C      	xor	a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-93


  2022    32 67BA        C      	ld	(l682d),a	; .. clear a bit
  2025    32 6869        C      	ld	(DstFCB+_CR),a
  2028    32 688A        C      	ld	(LstFCB+_CR),a
  202B    32 68AB        C      	ld	($$FCB$$+_CR),a
  202E    21 6AB7        C      	ld	hl,SrcFCB+@drv
  2031    11 6832        C      	ld	de,$$PRGN$$	; Point to name of program
  2034    06 08          C      	ld	b,@nam
  2036                   C      l2050:
  2036    7E             C      	ld	a,(hl)		; Set file name as program name
  2037    23             C      	inc	hl
  2038    FE 20          C      	cp	' '
  203A    28 04          C      	jr	z,l205a		; .. end on blank
  203C    12             C      	ld	(de),a		; .. save
  203D    13             C      	inc	de
  203E    10 F6          C      	djnz	l2050
  2040                   C      l205a:
  2040    3E FF          C      	ld	a,eot
  2042    12             C      	ld	(de),a		; .. clear end
  2043    3E FF          C      	ld	a,-1
  2045    32 6849        C      	ld	(DstFCB),a	; Set no destination
  2048    3A 0066        C      	ld	a,(FCB+@drv+@nam+1)
  204B    D6 40          C      	sub	'A'-1		; Test destination drive
  204D    FE 11          C      	cp	'P'-'A'+2
  204F    30 42          C      	jr	nc,l20ad
  2051    32 6849        C      	ld	(DstFCB),a	; .. save drive
  2054    21 005D        C      	ld	hl,FCB+@drv	; Point to name
  2057    11 684A        C      	ld	de,DstFCB+@drv
  205A    01 0008        C      	ld	bc,@nam
  205D    ED B0          C      	ldir			; Save it
  205F    3A 62C3        C      	ld	a,(_OPT_)	; Get option
  2062    21 0140        C      	ld	hl,$$REL
  2065    17             C      	rla			; Test extension
  2066    38 09          C      	jr	c,l208b		; .. .REL
  2068    21 0143        C      	ld	hl,$$COM
  206B    17             C      	rla
  206C    30 03          C      	jr	nc,l208b	; .. .COM
  206E    21 0146        C      	ld	hl,$$HEX	; .. .HEX
  2071                   C      l208b:
  2071    ED A0          C      	ldi			; Copy extension
  2073    ED A0          C      	ldi
  2075    ED A0          C      	ldi
  2077    AF             C      	xor	a
  2078    12             C      	ld	(de),a
  2079    11 6849        C      	ld	de,DstFCB	; Get destination
  207C    D5             C      	push	de
  207D    CD 2107        C      	call	Rewrite		; Create file
  2080    E1             C      	pop	hl
  2081    22 6742        C      	ld	(WrFCB1),hl	; Save FCB
  2084    3C             C      	inc	a		; Test success
  2085    20 0C          C      	jr	nz,l20ad	; .. yeap
  2087                   C      l20a1:
  2087    22 67F4        C      	ld	(CurFCB),hl	; Save error FCB
  208A    21 228A        C      	ld	hl,$NO.MAKE
  208D    CD 5D93        C      	call	DO.ERROR	; .. tell not creatable
  2090    C3 0B87        C      	jp	EndOfASM	; Restart
  2093                   C      l20ad:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-94


  2093    01 03ED        C      	ld	bc,l0400
  2096    3A 62C3        C      	ld	a,(_OPT_)	; Get option
  2099    17             C      	rla			; Test relocatable
  209A    30 04          C      	jr	nc,l20ba	; .. nope
  209C    17             C      	rla			; Test format
  209D    38 01          C      	jr	c,l20ba		; .. .REL
  209F    04             C      	inc	b		; .. one page more for SLR
  20A0                   C      l20ba:
  20A0    ED 43 673C     C      	ld	(BufLen1),bc	; Set length
  20A4    CD 229A        C      	call	d.alloc_	; Allocate memory
  20A7    22 673E        C      	ld	(l67b1),hl
  20AA    22 6740        C      	ld	(l67b3),hl
  20AD    3E FF          C      	ld	a,-1
  20AF    32 686A        C      	ld	(LstFCB),a	; Set no list
  20B2    3A 62C3        C      	ld	a,(_OPT_)	; Get option
  20B5    E6 0F          C      	and	LoMask		; Test listing
  20B7    28 48          C      	jr	z,l211b		; .. nope
  20B9    3A 0067        C      	ld	a,(FCB+@drv+@nam+2)
  20BC    D6 40          C      	sub	'A'-1		; Test list drive
  20BE    FE 11          C      	cp	'P'-'A'+2
  20C0    30 58          C      	jr	nc,l213f
  20C2    32 686A        C      	ld	(LstFCB),a	; Save drive
  20C5    21 005D        C      	ld	hl,FCB+@drv	; Point to name
  20C8    11 686B        C      	ld	de,LstFCB+@drv
  20CB    01 0008        C      	ld	bc,@nam
  20CE    ED B0          C      	ldir			; Save it
  20D0    21 0149        C      	ld	hl,$$LST
  20D3    0E 03          C      	ld	c,@ext
  20D5    ED B0          C      	ldir			; Set extension .LST
  20D7    AF             C      	xor	a
  20D8    12             C      	ld	(de),a
  20D9    11 686A        C      	ld	de,LstFCB	; Get list file
  20DC    D5             C      	push	de
  20DD    CD 2107        C      	call	Rewrite		; Create it
  20E0    3C             C      	inc	a
  20E1    E1             C      	pop	hl
  20E2    22 674A        C      	ld	(WrFCB2),hl	; .. save address
  20E5    28 A0          C      	jr	z,l20a1		; .. error
  20E7    AF             C      	xor	a
  20E8    32 5FC0        C      	ld	(l601b),a	; .. clear a bit
  20EB    01 03ED        C      	ld	bc,l0400
  20EE    ED 43 6744     C      	ld	(BufLen2),bc	; Set buffer length
  20F2    CD 229A        C      	call	d.alloc_	; Allocate memory
  20F5    22 6746        C      	ld	(l67b9),hl
  20F8    22 6748        C      	ld	(l67bb),hl
  20FB    3A 62C3        C      	ld	a,(_OPT_)	; Get option
  20FE    E6 07          C      	and	7		; Test list
  2100    C0             C      	ret	nz		; .. yeap
  2101                   C      l211b:
  2101    3E C9          C      	ld	a,_RET		; Set RET
  2103    32 07D7        C      	ld	(l07f1),a
  2106    C9             C      	ret
                         C      ;
                         C      ; Create file
                         C      ; ENTRY	Reg DE points to FCB
                         C      ; EXIT	Accu holds error code
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-95


                         C      ;
  2107                   C      Rewrite:
  2107    CD 618F        C      	call	push.r		; Push regs
  210A    D5             C      	push	de
  210B    1A             C      	ld	a,(de)		; Get disk
  210C    3D             C      	dec	a
  210D    CD 6180        C      	call	SetDsk		; .. log it
  2110    D1             C      	pop	de
                         C      ;	push	de
                         C      ;	ld	a,($MS.DOS$)	; Test MS DOS emulation
                         C      ;	or	a
                         C      ;	ld	c,.delete
                         C      ;	call	z,BDOS		; Delete file if not
                         C      ;	pop	de
  2111    0E 16          C      	ld	c,.make
  2113    CD 0005        C      	call	BDOS		; .. create new one
  2116    CD 61AE        C      	call	pop.r		; Pop regs
  2119    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  211A                   C      l213f:
  211A    FE 18          C      	cp	18h		; Test I reg
  211C    20 06          C      	jr	nz,l2149
  211E    AF             C      	xor	a
  211F    32 60D0        C      	ld	(l6143),a
  2122    18 07          C      	jr	l2150
  2124                   C      l2149:
  2124    FE 19          C      	cp	19h		; Test R reg
  2126    C0             C      	ret	nz
  2127    AF             C      	xor	a
  2128    32 60C4        C      	ld	(l6137),a
  212B                   C      l2150:
  212B    32 6077        C      	ld	(l60ea),a
  212E    C9             C      	ret
                         C      ;
  212F                   C      $FN.ERR:
  212F    0F 46 69 6C    C      	db	15,'File Name Error'
  2133    65 20 4E 61    C      
  2137    6D 65 20 45    C      
  213B    72 72 6F 72    C      
  213F                   C      $NO.FILE:
  213F    08 4E 6F 20    C      	db	8,'No File!'
  2143    46 69 6C 65    C      
  2147    21             C      
                         C      ;
                         C      ; Reset file
                         C      ; EXIT	Zero set if not posible
                         C      ;
  2148                   C      ResetF:
  2148    01 041F        C      	ld	bc,l0400+FCBlenr+14
  214B                   C      .ResetF:
  214B    CD 2247        C      	call	malloc_		; Allocate memory
                         C      	ld.hl	1,1
  214E    21 0101        C+     	ld	hl,1*256+1
  2151    22 67FF        C      	ld	(_rPage_),hl	; Init read pages
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-96


  2154    21 14C5        C      	ld	hl,.RdLine	; Set vector
  2157    22 14C3        C      	ld	($LinVec),hl
  215A    ED 5B 67F4     C      	ld	de,(CurFCB)	; Get FCB
  215E    CD 618F        C      	call	push.r		; Push regs
  2161    21 6AB6        C      	ld	hl,SrcFCB
  2164    7E             C      	ld	a,(hl)		; Test disk
  2165    B7             C      	or	a
  2166    20 04          C      	jr	nz,l2191	; .. yeap
  2168    3A 6843        C      	ld	a,(LogDsk.)	; Get logged disk, one relative
  216B    77             C      	ld	(hl),a
  216C                   C      l2191:
  216C    01 000D        C      	ld	bc,@drv+@nam+@ext+1
  216F    ED B0          C      	ldir			; Unpack FCB
  2171    21 0017        C      	ld	hl,FCBlenr-@drv-@nam-@ext-1
  2174    19             C      	add	hl,de
  2175    E5             C      	push	hl		; Point to disk buffer
  2176    3D             C      	dec	a
  2177    CD 6180        C      	call	SetDsk		; Log disk
  217A    D1             C      	pop	de
  217B    CD 6161        C      	call	SetDMA		; Set disk buffer
  217E    CD 2232        C      	call	FCBtoStr	; Unpack file name
  2181    D5             C      	push	de
  2182    3A 6844        C      	ld	a,(LogUsr.)	; Get logged user
  2185                   C      l21aa:
  2185    32 6801        C      	ld	(CurUsr),a	; .. save
  2188    CD 6179        C      	call	SetUsr		; .. and log
  218B    ED 5B 67F4     C      	ld	de,(CurFCB)	; Get FCB
  218F    3A 62D2        C      	ld	a,(OSver)
  2192    FE 02          C      	cp	_MPM		; Test MP/M
  2194    20 06          C      	jr	nz,l21c1	; .. nope
  2196    21 0006        C      	ld	hl,_MPMoff
  2199    19             C      	add	hl,de
  219A    CB FE          C      	set	@MSB,(hl)	; Set FCB bit
  219C                   C      l21c1:
  219C    0E 0F          C      	ld	c,.open
  219E    CD 0005        C      	call	BDOS		; Open file
  21A1    FE FF          C      	cp	OSerr		; Test success
  21A3    20 0D          C      	jr	nz,l21d7	; .. yeap
  21A5    21 6801        C      	ld	hl,CurUsr
  21A8    3A 0137        C      	ld	a,(@SYSUSR@)
  21AB    BE             C      	cp	(hl)		; Test alternate user
  21AC    20 D7          C      	jr	nz,l21aa	; .. not same
  21AE    3E FF          C      	ld	a,OSerr
  21B0    18 56          C      	jr	l222d		; .. set error
  21B2                   C      l21d7:
  21B2    3A 62D2        C      	ld	a,(OSver)	; Get OS version
  21B5    B7             C      	or	a
  21B6    28 4F          C      	jr	z,l222c		; .. simple CP/M
  21B8    3A 0121        C      	ld	a,($TOD.ENA$)	; Test TOD to be inserted
  21BB    B7             C      	or	a
  21BC    28 49          C      	jr	z,l222c		; .. nope
  21BE    ED 5B 67F4     C      	ld	de,(CurFCB)	; Get FCB
  21C2    21 0024        C      	ld	hl,FCBlen+3
  21C5    19             C      	add	hl,de		; Point to buffer
  21C6    EB             C      	ex	de,hl
  21C7    D5             C      	push	de
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-97


  21C8    01 000C        C      	ld	bc,@drv+@nam+@ext
  21CB    ED B0          C      	ldir			; Unpack FCB
  21CD    D1             C      	pop	de
  21CE    D5             C      	push	de
  21CF    0E 66          C      	ld	c,.rdstmp
  21D1    CD 0005        C      	call	BDOS		; Read date stamp/pw
  21D4    E1             C      	pop	hl
  21D5    3C             C      	inc	a
  21D6    28 2F          C      	jr	z,l222c		; .. no success
  21D8    11 001C        C      	ld	de,UpStmp
  21DB    19             C      	add	hl,de		; Point to update stamp
  21DC    7E             C      	ld	a,(hl)		; Test date defined
  21DD    23             C      	inc	hl
  21DE    B6             C      	or	(hl)
  21DF    20 09          C      	jr	nz,l220f	; .. yeap, get it
  21E1    11 FFFB        C      	ld	de,C$AStmp-UpStmp-1
  21E4    19             C      	add	hl,de
  21E5    7E             C      	ld	a,(hl)		; Test creation stamp
  21E6    23             C      	inc	hl
  21E7    B6             C      	or	(hl)
  21E8    28 1D          C      	jr	z,l222c		; .. nope
  21EA                   C      l220f:
  21EA    2B             C      	dec	hl
  21EB    11 6A31        C      	ld	de,TOD.PB
  21EE    01 0004        C      	ld	bc,TODlen
  21F1    ED B0          C      	ldir			; Copy stamp to TOD data
  21F3    CD 61D9        C      	call	.Get$TOD	; Convert to ASCII
  21F6    21 6A20        C      	ld	hl,$TOD$
  21F9    D1             C      	pop	de
  21FA    3E 20          C      	ld	a,' '		; Set delimiter
  21FC    12             C      	ld	(de),a
  21FD    13             C      	inc	de
  21FE    01 000F        C      	ld	bc,$TODlen-1
  2201    ED B0          C      	ldir			; Unpack
  2203    3E FF          C      	ld	a,eot
  2205    12             C      	ld	(de),a		; .. close end
  2206    D5             C      	push	de
  2207                   C      l222c:
  2207    AF             C      	xor	a		; Set open success
  2208                   C      l222d:
  2208    D1             C      	pop	de		; Clean stack
  2209    F5             C      	push	af		; Save code
  220A    3A 6844        C      	ld	a,(LogUsr.)	; Get logged user
  220D    CD 6179        C      	call	SetUsr		; .. log
  2210    F1             C      	pop	af
  2211    CD 61AE        C      	call	pop.r		; Pop regs
  2214    2A 67F4        C      	ld	hl,(CurFCB)	; Get FCB
  2217    11 0020        C      	ld	de,_CR
  221A    19             C      	add	hl,de
  221B    36 00          C      	ld	(hl),0		; .. clear current record
  221D    3C             C      	inc	a		; Test file found
  221E    C0             C      	ret	nz		; .. yeap
  221F    23             C      	inc	hl
  2220    36 1A          C      	ld	(hl),eof	; Set end of file
  2222    22 67FD        C      	ld	(l6870),hl
                         C      	ld.hl	1,2
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-98


  2225    21 0102        C+     	ld	hl,1*256+2
  2228    22 67FF        C      	ld	(_rPage_),hl	; Init read pages
  222B    0E 0E          C      	ld	c,14
  222D    CD 08F5        C      	call	.ERROR		; Process error
  2230    AF             C      	xor	a
  2231    C9             C      	ret
                         C      ;
                         C      ; Unpack current file name
                         C      ;
  2232                   C      FCBtoStr:
  2232    2A 67F4        C      	ld	hl,(CurFCB)	; Get FCB
  2235    23             C      	inc	hl
  2236    11 63C9        C      	ld	de,@MES@	; Point to name
  2239    06 0B          C      	ld	b,@nam+@ext
  223B                   C      l2260:
  223B    7E             C      	ld	a,(hl)		; Get file name
  223C    E6 7F          C      	and	NoMSB
  223E    12             C      	ld	(de),a		; .. unpack
  223F    23             C      	inc	hl
  2240    13             C      	inc	de
  2241    10 F8          C      	djnz	l2260
  2243    3E FF          C      	ld	a,eot		; Set end
  2245    12             C      	ld	(de),a
  2246    C9             C      	ret
                         C      ;
                         C      ; Allocate memory
                         C      ; ENTRY	Reg BC holds bytes to be allocated
                         C      ; EXIT	Reg HL holds address
                         C      ;
  2247                   C      malloc_:
  2247    21 67BA        C      	ld	hl,l682d	; Get entry
  224A    7E             C      	ld	a,(hl)
  224B    34             C      	inc	(hl)
  224C    B7             C      	or	a
  224D    20 0F          C      	jr	nz,l2283	; .. already set
  224F    21 67FA        C      	ld	hl,CurLine
  2252    11 62F9        C      	ld	de,l636c
  2255    ED A0          C      	ldi			; .. unpack curent line
  2257    ED A0          C      	ldi
  2259    ED A0          C      	ldi
  225B    03             C      	inc	bc		; .. adjust entry
  225C    03             C      	inc	bc
  225D    03             C      	inc	bc
  225E                   C      l2283:
  225E    CD 22D9        C      	call	alloc_		; Allocate memory
  225F                   C      @ALLOC@	equ	$-2
  2261    ED 5B 67F4     C      	ld	de,(l6867)	; Get pointer
  2265    73             C      	ld	(hl),e		; .. save
  2266    23             C      	inc	hl
  2267    72             C      	ld	(hl),d
  2268    23             C      	inc	hl
  2269    71             C      	ld	(hl),c		; .. set entry
  226A    23             C      	inc	hl
  226B    70             C      	ld	(hl),b
  226C    01 000B        C      	ld	bc,l000b
  226F    09             C      	add	hl,bc		; Point to next
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-99


  2270    22 67F4        C      	ld	(l6867),hl
  2273    EB             C      	ex	de,hl
  2274    1B             C      	dec	de
  2275    21 6801        C      	ld	hl,l686a+l000a	;; CurUsr
  2278    01 000A        C      	ld	bc,l000a
  227B    ED B8          C      	lddr			; .. move down
  227D                   C      l22a2:
  227D    21 0000        C      	ld	hl,0
  2280    22 67F8        C      	ld	(l686b),hl
  2283    22 67FA        C      	ld	(CurLine),hl	; Clear line count
  2286    22 67FB        C      	ld	(CurLine+1),hl
  2289    C9             C      	ret
                         C      ;
  228A                   C      $NO.MAKE:
  228A    0F 43 61 6E    C      	db	15,'Can''t Make File'
  228E    27 74 20 4D    C      
  2292    61 6B 65 20    C      
  2296    46 69 6C 65    C      
                         C      ;
                         C      ; Allocate memory
                         C      ; ENTRY	Reg BC holds memory to be allocated
                         C      ; EXIT	Reg HL holds address
                         C      ;
                         C      ; NOTE	Allocation will be done from top down
                         C      ;
  229A                   C      d.alloc_:
  229A    2A 631D        C      	ld	hl,(SymPtr)	; Get pointer
  229D    B7             C      	or	a
  229E    ED 42          C      	sbc	hl,bc		; .. fix
  22A0    22 631D        C      	ld	(SymPtr),hl
  22A3                   C      l22c8:
  22A3    E5             C      	push	hl
  22A4    D5             C      	push	de
  22A5    ED 5B 6319     C      	ld	de,(DynPtr1)	; Get limit pointer
  22A9    14             C      	inc	d		; .. allow one page buffer
  22AA    ED 52          C      	sbc	hl,de		; Test within limits
  22AC    D1             C      	pop	de
  22AD    E1             C      	pop	hl
  22AE    D0             C      	ret	nc		; .. yeap, that's it
  22AF    E5             C      	push	hl
  22B0    D5             C      	push	de
  22B1    C5             C      	push	bc
  22B2    CD 2401        C      	call	d.free_		; .. free memory
  22B5    C1             C      	pop	bc
  22B6    D1             C      	pop	de
  22B7    E1             C      	pop	hl
  22B8    18 E9          C      	jr	l22c8
                         C      ;
                         C      ; Allocate memory
                         C      ; ENTRY	Reg BC holds memory to be allocated
                         C      ; EXIT	Reg HL holds address
                         C      ;
                         C      ; NOTE	Allocation will be done from bottom up
                         C      ;
  22BA                   C      u.alloc_:
  22BA    2A 6626        C      	ld	hl,(TopPtr)	; Get top pointer
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-100


  22BD    E5             C      	push	hl
  22BE    09             C      	add	hl,bc		; .. add value
  22BF    22 6626        C      	ld	(TopPtr),hl	; .. set new
  22C2    D5             C      	push	de
  22C3    ED 5B 631B     C      	ld	de,(DynPtr2)	; Get pointer
  22C7    15             C      	dec	d		; .. less one page
  22C8    ED 52          C      	sbc	hl,de		; Test room
  22CA    D1             C      	pop	de
  22CB    E1             C      	pop	hl
  22CC    D8             C      	ret	c		; .. yeap
  22CD    22 6626        C      	ld	(TopPtr),hl	; .. truncate top
  22D0    D5             C      	push	de
  22D1    C5             C      	push	bc
  22D2    CD 239E        C      	call	u.free_		; Free memory
  22D5    C1             C      	pop	bc
  22D6    D1             C      	pop	de
  22D7    18 E1          C      	jr	u.alloc_
                         C      ;
                         C      ; Allocate memory
                         C      ; ENTRY	Reg BC holds memory to be allocated
                         C      ; EXIT	Reg HL holds address
                         C      ;
                         C      ; NOTE	Allocation will be done from top down
                         C      ;
  22D9                   C      alloc_:
  22D9    2A 631B        C      	ld	hl,(DynPtr2)	; Get pointer
  22DC    B7             C      	or	a
  22DD    ED 42          C      	sbc	hl,bc		; .. free memory
  22DF    22 631B        C      	ld	(DynPtr2),hl
  22E2    E5             C      	push	hl
  22E3    D5             C      	push	de
  22E4    ED 5B 6626     C      	ld	de,(TopPtr)	; Get top pointer
  22E8    14             C      	inc	d		; .. allow one page
  22E9    ED 52          C      	sbc	hl,de		; Test room
  22EB    D1             C      	pop	de
  22EC    E1             C      	pop	hl
  22ED    D0             C      	ret	nc		; .. yeap
  22EE    09             C      	add	hl,bc
  22EF    22 631B        C      	ld	(DynPtr2),hl	; .. force end
  22F2    E5             C      	push	hl
  22F3    D5             C      	push	de
  22F4    C5             C      	push	bc
  22F5    CD 239E        C      	call	u.free_		; Free memory
  22F8    C1             C      	pop	bc
  22F9    D1             C      	pop	de
  22FA    E1             C      	pop	hl
  22FB    18 DC          C      	jr	alloc_
                         C      ;
                         C      ;
                         C      ;
  22FD                   C      l2322:
  22FD    C3 2300        C      	jp	l2325
  22FE                   C      @MEMER@	equ	$-2
  2300                   C      l2325:
  2300    3E 03          C      	ld	a,3
  2302    CD 604A        C      	call	SelFile		; Select file
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-101


  2305    3A 67CE        C      	ld	a,(l6841)
  2308    B7             C      	or	a
  2309    20 3E          C      	jr	nz,l236e
  230B    21 014C        C      	ld	hl,$$$$1
  230E    11 6894        C      	ld	de,l6907
  2311    01 0003        C      	ld	bc,@ext
  2314    ED B0          C      	ldir			; Set .$$1
  2316    12             C      	ld	(de),a
  2317    21 688B        C      	ld	hl,$$FCB$$	; Get temp FCB ?????
  231A    22 69F2        C      	ld	(WrFCBc),hl	; .. save
  231D    CD 618F        C      	call	push.r		; Push regs
  2320    3A 0136        C      	ld	a,($TMP.DRV$)	; Get temp drive
  2323    B7             C      	or	a
  2324    20 03          C      	jr	nz,l234e	; .. defined
  2326    3A 6843        C      	ld	a,(LogDsk.)	; Get logged disk one relative
  2329                   C      l234e:
  2329    77             C      	ld	(hl),a
  232A    3D             C      	dec	a
  232B    CD 6180        C      	call	SetDsk		; .. log disk
  232E    11 688B        C      	ld	de,$$FCB$$
  2331    0E 16          C      	ld	c,.make
  2333    CD 0005        C      	call	BDOS		; Create temp file ????
  2336    CD 61AE        C      	call	pop.r		; Pop regs
  2339    3C             C      	inc	a
  233A    28 49          C      	jr	z,NoMemory	; .. cannot create
  233C    32 67CE        C      	ld	(l6841),a
  233F    AF             C      	xor	a
  2340    32 68AB        C      	ld	($$FCB$$+_CR),a	; Clear current record
  2343    21 03ED        C      	ld	hl,l0400
  2346    22 69EC        C      	ld	(l6a5f),hl	; Init record count
  2349                   C      l236e:
  2349    2A 6626        C      	ld	hl,(TopPtr)	; Get top pointer
  234C    ED 5B 6624     C      	ld	de,(l6697)
  2350    B7             C      	or	a
  2351    ED 52          C      	sbc	hl,de		; Get gap
  2353    38 30          C      	jr	c,NoMemory	; .. no memory
  2355    01 046D        C      	ld	bc,l0400+RecLng
  2358    ED 42          C      	sbc	hl,bc		; Let some buffer space
  235A    38 29          C      	jr	c,NoMemory	; .. oops
  235C    06 00          C      	ld	b,0		; Force gap
  235E    09             C      	add	hl,bc
  235F    E5             C      	push	hl
  2360    ED 53 69F0     C      	ld	(FilBuf),de	; Get file buffer
  2364    CD 5FE1        C      	call	WrToFile	; .. write to file
  2367    2A 6624        C      	ld	hl,(l6697)
  236A    54             C      	ld	d,h
  236B    5D             C      	ld	e,l
  236C    24             C      	inc	h
  236D    24             C      	inc	h
  236E    24             C      	inc	h
  236F    24             C      	inc	h
  2370    C1             C      	pop	bc
  2371    ED B0          C      	ldir
  2373    21 6627        C      	ld	hl,TopPtr+1
  2376    7E             C      	ld	a,(hl)		; Get top pointer
  2377    D6 04          C      	sub	4		; .. less memory
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-102


  2379    77             C      	ld	(hl),a		; .. save
  237A    D9             C      	exx
  237B    25             C      	dec	h
  237C    25             C      	dec	h
  237D    25             C      	dec	h
  237E    25             C      	dec	h
  237F    15             C      	dec	d
  2380    15             C      	dec	d
  2381    15             C      	dec	d
  2382    15             C      	dec	d
  2383    D9             C      	exx
  2384    C9             C      	ret
  2385                   C      NoMemory:
  2385    21 238E        C      	ld	hl,$NO.MEM
  2388    CD 5D93        C      	call	DO.ERROR
  238B    C3 0B87        C      	jp	EndOfASM	; Restart
                         C      ;
  238E                   C      $NO.MEM:
  238E    0F 4F 55 54    C      	db	15,'OUT OF MEMORY !'
  2392    20 4F 46 20    C      
  2396    4D 45 4D 4F    C      
  239A    52 59 20 21    C      
                         C      ;
                         C      ; Release memory
                         C      ;
  239E                   C      u.free_:
  239E    2A 631D        C      	ld	hl,(SymPtr)	; Get pointers
  23A1    ED 5B 6319     C      	ld	de,(DynPtr1)
  23A5    3E 05          C      	ld	a,5		; Add for gap
  23A7    82             C      	add	a,d
  23A8    47             C      	ld	b,a
  23A9    4B             C      	ld	c,e
  23AA    ED 42          C      	sbc	hl,bc		; .. test overlapping
  23AC    DA 22FD        C      	jp	c,l2322		; .. yeap
  23AF    2A 631B        C      	ld	hl,(DynPtr2)	; Get pointer
  23B2    EB             C      	ex	de,hl
  23B3    ED 52          C      	sbc	hl,de
  23B5    50             C      	ld	d,b
  23B6    59             C      	ld	e,c
  23B7    44             C      	ld	b,h
  23B8    4D             C      	ld	c,l
  23B9    2A 6319        C      	ld	hl,(DynPtr1)	; Get old
  23BC    ED 53 6319     C      	ld	(DynPtr1),de	; .. set new
  23C0    03             C      	inc	bc
  23C1    ED B8          C      	lddr			; .. unpack data
  23C3    13             C      	inc	de
  23C4    ED 53 631B     C      	ld	(DynPtr2),de	; Set top
  23C8    01 0500        C      	ld	bc,l0500
  23CB                   C      l23f0:
  23CB    2A 660D        C      	ld	hl,(l6680)
  23CE    09             C      	add	hl,bc
  23CF    22 660D        C      	ld	(l6680),hl
  23D2    21 6802        C      	ld	hl,l6875
  23D5                   C      l23fa:
  23D5    11 FFFB        C      	ld	de,-l0005
  23D8    19             C      	add	hl,de
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-103


  23D9    CD 23EA        C      	call	l240f
  23DC    11 FFF8        C      	ld	de,lfff8
  23DF    19             C      	add	hl,de
  23E0    7E             C      	ld	a,(hl)
  23E1    2B             C      	dec	hl
  23E2    B6             C      	or	(hl)
  23E3    C8             C      	ret	z
  23E4    CD 23EA        C      	call	l240f
  23E7    EB             C      	ex	de,hl
  23E8    18 EB          C      	jr	l23fa
  23EA                   C      l240f:
  23EA    5E             C      	ld	e,(hl)
  23EB    23             C      	inc	hl
  23EC    56             C      	ld	d,(hl)
  23ED    E5             C      	push	hl
  23EE    2A 631D        C      	ld	hl,(SymPtr)	; Get pointer
  23F1    B7             C      	or	a
  23F2    ED 52          C      	sbc	hl,de
  23F4    38 08          C      	jr	c,l2423
  23F6    EB             C      	ex	de,hl
  23F7    09             C      	add	hl,bc
  23F8    EB             C      	ex	de,hl
  23F9    E1             C      	pop	hl
  23FA    72             C      	ld	(hl),d
  23FB    2B             C      	dec	hl
  23FC    73             C      	ld	(hl),e
  23FD    C9             C      	ret
  23FE                   C      l2423:
  23FE    E1             C      	pop	hl
  23FF                   C      l2424:
  23FF    2B             C      	dec	hl
  2400    C9             C      	ret
                         C      ;
                         C      ; Release memory
                         C      ;
  2401                   C      d.free_:
  2401    2A 631B        C      	ld	hl,(DynPtr2)	; Get pointers
  2404    ED 5B 6626     C      	ld	de,(TopPtr)
  2408    3E 05          C      	ld	a,5		; Fix for gap
  240A    82             C      	add	a,d
  240B    47             C      	ld	b,a
  240C    4B             C      	ld	c,e
  240D    ED 42          C      	sbc	hl,bc		; Test overlapping
  240F    DA 22FD        C      	jp	c,l2322		; .. yeap
  2412    2A 6319        C      	ld	hl,(DynPtr1)	; Get pointers
  2415    ED 5B 631B     C      	ld	de,(DynPtr2)
  2419    ED 52          C      	sbc	hl,de		; .. calculate gap
  241B    44             C      	ld	b,h
  241C    4D             C      	ld	c,l
  241D    EB             C      	ex	de,hl
  241E    7C             C      	ld	a,h
  241F    D6 05          C      	sub	5		; Move base down
  2421    57             C      	ld	d,a
  2422    5D             C      	ld	e,l
  2423    ED 53 631B     C      	ld	(DynPtr2),de	; Set new base
  2427    03             C      	inc	bc
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-104


  2428    ED B0          C      	ldir			; .. unpack gap
  242A    1B             C      	dec	de
  242B    ED 53 6319     C      	ld	(DynPtr1),de	; Set new top
  242F    01 FB00        C      	ld	bc,-l0500	;; lfb00
  2432    18 97          C      	jr	l23f0
                         C      ;
                         C      ; $$$ COLD START -- PARTS ENCRYPTED $$$
                         C      ;
                         C      ; PART OF ENCRYPTOR FOLLOWS
                         C      ; #########################
                         C      ;
                         C      ; Remove bullshit
  2434                   C      MAIN:
                         C      ;	ld	hl,l2460
                         C      ;	ld	de,SN_
                         C      ;	call	l246d		; Do mystery things
                         C      ;l2460	equ	$-2
                         C      ;	ld	hl,IndRec
                         C      ;	ld	de,l2486
                         C      ;	call	l246d		; .. twice
                         C      ;	jr	MAIN_		; .. then go
                         C      ;l246d:
                         C      ;	or	a
                         C      ;	sbc	hl,de
                         C      ;	srl	h
                         C      ;	rr	l
                         C      ;	ld	b,l
                         C      ;	ld	c,h
                         C      ;	jr	z,l2479
                         C      ;	inc	c
                         C      ;l2479:
                         C      ;	ex	de,hl
                         C      ;l247a:
                         C      ;	rrc	(hl)
                         C      ;	inc	hl
                         C      ;	rlc	(hl)
                         C      ;	inc	hl
                         C      ;	djnz	l247a
                         C      ;	dec	c
                         C      ;	jr	nz,l247a
                         C      ;	ret
                         C      ;
                         C      ; END OF ENCRYPTOR
                         C      ; ################
                         C      ;
                         C      ; End of bullshit
  2434                   C      l2486:
  2434    3A 62F2        C      	ld	a,(Empty)	; Was command line empty ?
  2437    B7             C      	or	a
  2438    CA 28B3        C      	jp	z,$$Q$$		; .. nope
  243B    3A 62BF        C      	ld	a,(CON.ena)	; Test console enabled
  243E    B7             C      	or	a
  243F    C2 28B3        C      	jp	nz,$$Q$$	; .. nope
  2442    21 29AE        C      	ld	hl,l2a09
  2445    CD 6134        C      	call	PutStr		; Print
  2448    21 007F        C      	ld	hl,CCP-1
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-105


  244B    36 80          C      	ld	(hl),CmdLen
  244D    EB             C      	ex	de,hl
  244E    0E 0A          C      	ld	c,.rdcon
  2450    CD 5EA9        C      	call	.BDOS		; Get line from keyboard
  2453    1E 0A          C      	ld	e,lf
  2455    0E 02          C      	ld	c,.conout
  2457    CD 5EA9        C      	call	.BDOS		; Close line
  245A    21 0080        C      	ld	hl,CCP
  245D    7E             C      	ld	a,(hl)
  245E    B7             C      	or	a		; Test any in line
  245F    28 D3          C      	jr	z,l2486		; .. nope, empty
  2461    23             C      	inc	hl
  2462    22 62F7        C      	ld	(CmdPtr),hl	; Set pointer
  2465    4F             C      	ld	c,a
  2466    06 00          C      	ld	b,0
  2468    09             C      	add	hl,bc
  2469    36 0D          C      	ld	(hl),cr		; Close line
  246B    23             C      	inc	hl
  246C    36 1A          C      	ld	(hl),eof
  246E    C9             C      	ret
                         C      ;
                         C      ; $$$ REAL COLD START $$$
                         C      ;
  246F                   C      MAIN_:
  246F    ED 7B 0006     C      	ld	sp,(BDOS+1)	; Get top of memory
  2473    2A 010F        C      	ld	hl,(ZENV)	; Test ZCPR environment
  2476    7C             C      	ld	a,h
  2477    B5             C      	or	l
  2478    28 14          C      	jr	z,NoZENV	; .. nope
  247A    11 0022        C      	ld	de,_MBP
  247D    19             C      	add	hl,de
  247E    7E             C      	ld	a,(hl)
  247F    23             C      	inc	hl
  2480    66             C      	ld	h,(hl)
  2481    6F             C      	ld	l,a		; Test message pointer
  2482    B4             C      	or	h
  2483    28 09          C      	jr	z,NoZENV	; .. nope
  2485    11 0006        C      	ld	de,_MEP
  2488    19             C      	add	hl,de		; Point to error message
  2489    22 01A3        C      	ld	(@ZERR),hl	; .. save
  248C    36 FF          C      	ld	(hl),-1		; .. set value
  248E                   C      NoZENV:
  248E    3E FF          C      	ld	a,-1
  2490    32 686A        C      	ld	(LstFCB),a	; Set no list
  2493    32 6849        C      	ld	(DstFCB),a	; .. and no destination
  2496    21 0000        C      	ld	hl,0
  2499    22 67BB        C      	ld	(ErrCnt),hl	; Clear error counts
  249C    22 62CF        C      	ld	(TotalErr),hl
  249F    0E 0C          C      	ld	c,.vers
  24A1    CD 0005        C      	call	BDOS		; Get version
  24A4    25             C      	dec	h
  24A5    28 14          C      	jr	z,MPM		; .. MP/M
  24A7    7D             C      	ld	a,l
  24A8    FE 30          C      	cp	CPM3		; Test CP/M+
  24AA    30 13          C      	jr	nc,CPM_
  24AC    AF             C      	xor	a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-106


  24AD    32 0126        C      	ld	($MULS$),a	; Clear multi sector count
  24B0    21 0121        C      	ld	hl,$TOD.ENA$	; Test TOD enabled
  24B3    7E             C      	ld	a,(hl)
  24B4    B7             C      	or	a
  24B5    28 0D          C      	jr	z,CPM		; .. nope
  24B7    36 01          C      	ld	(hl),1		; Force to be set
  24B9    18 09          C      	jr	CPM
  24BB                   C      MPM:
  24BB    3E 02          C      	ld	a,_MPM
  24BD    18 02          C      	jr	xPM
  24BF                   C      CPM_:
  24BF    3E 01          C      	ld	a,_CPM_
  24C1                   C      xPM:
  24C1    32 62D2        C      	ld	(OSver),a	; Save OS version
  24C4                   C      CPM:
  24C4    3A 0126        C      	ld	a,($MULS$)	; Test multi sectors enabled
  24C7    B7             C      	or	a
  24C8    1E 08          C      	ld	e,@SEC@
  24CA    0E 2C          C      	ld	c,.mulsec
  24CC    C4 0005        C      	call	nz,BDOS		; Set 1kB sectors if so
  24CF    3A 62D2        C      	ld	a,(OSver)	; Get version
  24D2    3D             C      	dec	a
  24D3    11 FF00        C      	ld	de,_ERR@
  24D6    0E 6C          C      	ld	c,.prgret
  24D8    CC 0005        C      	call	z,BDOS		; Set error return on CP/M+
  24DB    3A 013C        C      	ld	a,($EIGHT$)	; Test all bits
  24DE    B7             C      	or	a
  24DF    20 03          C      	jr	nz,All.Eight	; .. nope mask
  24E1    32 14F2        C      	ld	(@EIGHT@),a	; Set no mask (NOP)
  24E4                   C      All.Eight:
  24E4    2A 0006        C      	ld	hl,(BDOS+1)	; Get top of memory
  24E7    F9             C      	ld	sp,hl		; .. as stack
  24E8    25             C      	dec	h		; Allow two pages
  24E9    25             C      	dec	h
  24EA    22 62F3        C      	ld	(Heap),hl	; .. for top
  24ED    AF             C      	xor	a
  24EE    32 62F2        C      	ld	(Empty),a	; Set command
  24F1    32 67F0        C      	ld	(LST.ena),a	; .. disable LST:
  24F4    32 67C2        C      	ld	(OS.Flg),a	; .. clear warm vector swap
  24F7    21 0080        C      	ld	hl,CCP
  24FA    7E             C      	ld	a,(hl)		; Test any input
  24FB    B7             C      	or	a
  24FC    0E 0D          C      	ld	c,cr
  24FE    20 08          C      	jr	nz,Got.CCP.Cmd	; .. yeap
  2500    0E 1A          C      	ld	c,eof
  2502    3E FF          C      	ld	a,-1
  2504    32 62F2        C      	ld	(Empty),a	; Set empty
  2507    7E             C      	ld	a,(hl)
  2508                   C      Got.CCP.Cmd:
  2508    23             C      	inc	hl
  2509    22 62F7        C      	ld	(CmdPtr),hl	; Set pointer
  250C    5F             C      	ld	e,a
  250D    16 00          C      	ld	d,0
  250F    19             C      	add	hl,de
  2510    71             C      	ld	(hl),c		; Set closure
  2511    23             C      	inc	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-107


  2512    36 1A          C      	ld	(hl),eof	; .. total end
  2514    0E 19          C      	ld	c,.retdsk
  2516    CD 0005        C      	call	BDOS		; Get logged disk
  2519    32 69F4        C      	ld	(LogDsk),a	; .. save
  251C    3C             C      	inc	a
  251D    32 6843        C      	ld	(LogDsk.),a	; .. one relative
  2520    0E 20          C      	ld	c,.usrcod
  2522    1E FF          C      	ld	e,_get
  2524    CD 0005        C      	call	BDOS		; Get logged user
  2527    32 69F5        C      	ld	(LogUsr),a	; .. save
  252A    32 6844        C      	ld	(LogUsr.),a
  252D    21 2975        C      	ld	hl,$BANNER
  2530    CD 6134        C      	call	PutStr		; Print message
  2533    18 32          C      	jr	CmdScan		; .. and enter hard go
                         C      ;
                         C      ; Restart of SLR
                         C      ;
  2535                   C      NextASM:
  2535    21 015D        C      	ld	hl,$TRAIL$
  2538    CD 613E        C      	call	LstCtrl		; Give trailer to printer
  253B    3A 62D2        C      	ld	a,(OSver)	; Get OS version
  253E    FE 02          C      	cp	_MPM
  2540    0E 9F          C      	ld	c,.DetLst
  2542    CC 5EA9        C      	call	z,.BDOS		; Detache list on MP/M
  2545    11 6849        C      	ld	de,DstFCB	; Get destination
  2548    CD 2A66        C      	call	Close?		; Test close
  254B    11 686A        C      	ld	de,LstFCB	; Get list device
  254E    CD 2A66        C      	call	Close?		
  2551    11 688B        C      	ld	de,$$FCB$$
  2554    CD 2A66        C      	call	Close?		; Close temp file ???
  2557    3A 67CE        C      	ld	a,(l6841)
  255A    B7             C      	or	a
  255B    28 0A          C      	jr	z,CmdScan
  255D    11 688B        C      	ld	de,$$FCB$$
  2560    AF             C      	xor	a
  2561    12             C      	ld	(de),a
  2562    0E 13          C      	ld	c,.delete
  2564    CD 5EA9        C      	call	.BDOS		; Delete temp file ????
                         C      ;
                         C      ; Common entry of command scanning
                         C      ;
  2567                   C      CmdScan::
  2567    3E FF          C      	ld	a,-1
  2569    32 688B        C      	ld	($$FCB$$),a	; Set no drive
  256C    21 229A        C      	ld	hl,d.alloc_
  256F    22 225F        C      	ld	(@ALLOC@),hl	; Init allocation routine
  2572    AF             C      	xor	a
  2573    32 67C2        C      	ld	(OS.Flg),a	; Clear warm vector swap
  2576    21 290D        C      	ld	hl,$CRLF
  2579    CD 6134        C      	call	PutStr		; Close line
  257C    2A 62CF        C      	ld	hl,(TotalErr)	; Get current errors
  257F    ED 5B 67BB     C      	ld	de,(ErrCnt)
  2583    19             C      	add	hl,de		; .. get total
  2584    22 62CF        C      	ld	(TotalErr),hl
  2587    3E 0A          C      	ld	a,10
  2589    CD 4B71        C      	call	SetRadix	; Set radix 10
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-108


  258C    3A 62BE        C      	ld	a,(l6331)
  258F    B7             C      	or	a
  2590    C2 28B3        C      	jp	nz,$$Q$$	; .. exit
  2593    21 0113        C      	ld	hl,$CON.COL$
  2596    11 62C0        C      	ld	de,_CON.COL_	; Init data
  2599    01 000A        C      	ld	bc,$SUPPR$-$CON.COL$
  259C    ED B0          C      	ldir			; Unpack data
  259E    3E C9          C      	ld	a,_RET
  25A0    32 60D0        C      	ld	(l6143),a	; Set RET code
  25A3    32 60C4        C      	ld	(l6137),a
  25A6    32 5FC0        C      	ld	(l601b),a
  25A9    32 6077        C      	ld	(l60ea),a
  25AC    21 0DE5        C      	ld	hl,.FullToken
  25AF    22 0DE3        C      	ld	($GetVec),hl	; Set token routine
  25B2    21 2300        C      	ld	hl,l2325	; Set memory overflow
  25B5    22 22FE        C      	ld	(@MEMER@),hl
  25B8    2A 0006        C      	ld	hl,(BDOS+1)	; Get top of memory
  25BB    F9             C      	ld	sp,hl
  25BC    2A 62F3        C      	ld	hl,(Heap)	; Get current heap
  25BF    22 631D        C      	ld	(SymPtr),hl	; .. save
  25C2    3A 6843        C      	ld	a,(LogDsk.)	; Get logged disk
  25C5    3D             C      	dec	a
  25C6    32 69F4        C      	ld	(LogDsk),a	; .. set
  25C9    5F             C      	ld	e,a
  25CA    0E 0E          C      	ld	c,.setdsk
  25CC    CD 5EA9        C      	call	.BDOS		; .. select
  25CF    21 6634        C      	ld	hl,l66a7
  25D2    11 6635        C      	ld	de,l66a7+1
  25D5    01 01E2        C      	ld	bc,SetFlg-l66a7-1
  25D8    36 00          C      	ld	(hl),0
  25DA    ED B0          C      	ldir			; Clear data
  25DC    21 2910        C      	ld	hl,$INIDAT
  25DF    11 6615        C      	ld	de,Radix
  25E2    01 001F        C      	ld	bc,IniLen
  25E5    ED B0          C      	ldir			; Init data
  25E7    2A 631D        C      	ld	hl,(SymPtr)	; Get top memory pointer
  25EA    ED 5B 6626     C      	ld	de,(TopPtr)	; Get top of data
  25EE    ED 52          C      	sbc	hl,de		; .. calculate gap
  25F0    CB 3C          C      	srl	h		; .. halfe
  25F2    CB 1D          C      	rr	l
  25F4    19             C      	add	hl,de		; Add to data
  25F5    22 6319        C      	ld	(DynPtr1),hl	; .. save
  25F8    22 631B        C      	ld	(DynPtr2),hl
  25FB    3E FF          C      	ld	a,eot		;;; YES
  25FD    32 026D        C      	ld	($SRCline$),a	; Clear line
  2600    32 6378        C      	ld	(l63eb),a
  2603    32 69FB        C      	ld	(l6a6e),a
  2606    11 005D        C      	ld	de,FCB+@drv	; Point to name
  2609    06 08          C      	ld	b,@nam
  260B                   C      SkpCmdSpc::
  260B    CD 29B0        C      	call	GetCmdCh	; Get from command line
  260E    FE 20          C      	cp	' '
  2610    28 F9          C      	jr	z,SkpCmdSpc	; Sync for non delimiter
  2612    FE 2C          C      	cp	','
  2614    28 F5          C      	jr	z,SkpCmdSpc
  2616    FE 0D          C      	cp	cr
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-109


  2618    28 F1          C      	jr	z,SkpCmdSpc
  261A    FE 0A          C      	cp	lf
  261C    28 ED          C      	jr	z,SkpCmdSpc
  261E    18 03          C      	jr	TstCmdChr	; .. then check it
  2620                   C      NxtCmdChr:
  2620    CD 29B0        C      	call	GetCmdCh	; Get from command line
  2623                   C      TstCmdChr:
  2623    FE 0D          C      	cp	cr		; Sync for delimter
  2625    28 17          C      	jr	z,EndCmdFile
  2627    FE 20          C      	cp	' '
  2629    28 13          C      	jr	z,EndCmdFile
  262B    FE 2F          C      	cp	'/'
  262D    28 0F          C      	jr	z,EndCmdFile
  262F    FE 2C          C      	cp	','
  2631    28 0B          C      	jr	z,EndCmdFile
  2633    FE 2E          C      	cp	'.'
  2635    28 07          C      	jr	z,EndCmdFile
  2637    12             C      	ld	(de),a		; Build file name
  2638    13             C      	inc	de
  2639    10 E5          C      	djnz	NxtCmdChr
  263B    CD 29B0        C      	call	GetCmdCh	; Get next character
  263E                   C      EndCmdFile:
  263E    4F             C      	ld	c,a
  263F    78             C      	ld	a,b		; Test remainder
  2640    B7             C      	or	a
  2641    28 06          C      	jr	z,SkpFillFile	; .. nope
  2643    3E 20          C      	ld	a,' '		; .. fill rest with blanks
  2645                   C      SpcCmdFile:
  2645    12             C      	ld	(de),a
  2646    13             C      	inc	de
  2647    10 FC          C      	djnz	SpcCmdFile
  2649                   C      SkpFillFile:
  2649    41             C      	ld	b,c
  264A    3A 6843        C      	ld	a,(LogDsk.)	; Get logged disk
  264D    C6 40          C      	add	a,'A'-1		; Make ASCII
  264F    4F             C      	ld	c,a		; .. save
  2650    78             C      	ld	a,b
  2651    06 03          C      	ld	b,@ext
  2653    FE 2E          C      	cp	'.'		; Test extension
  2655    20 21          C      	jr	nz,EndCmdDrive	; .. nope
  2657                   C      l26a9:
  2657    CD 29B0        C      	call	GetCmdCh	; Get from command line
  265A    FE 2F          C      	cp	'/'		; Sync for delimiter
  265C    28 1A          C      	jr	z,EndCmdDrive
  265E    FE 0D          C      	cp	cr
  2660    28 16          C      	jr	z,EndCmdDrive
  2662    FE 2C          C      	cp	','
  2664    28 12          C      	jr	z,EndCmdDrive
  2666    FE 20          C      	cp	' '
  2668    28 0E          C      	jr	z,EndCmdDrive
  266A    FE 40          C      	cp	'@'		; Test current disk
  266C    20 01          C      	jr	nz,l26c1	; .. nope
  266E    79             C      	ld	a,c		; .. set it
  266F                   C      l26c1:
  266F    12             C      	ld	(de),a		; Save drive option
  2670    13             C      	inc	de
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-110


  2671    10 E4          C      	djnz	l26a9
  2673    CD 29B0        C      	call	GetCmdCh	; Get from command line
  2676    18 07          C      	jr	l26d1
  2678                   C      EndCmdDrive:
  2678    F5             C      	push	af
  2679                   C      l26cb:
  2679    79             C      	ld	a,c
  267A    12             C      	ld	(de),a		; Fill remainder with drive
  267B    13             C      	inc	de
  267C    10 FB          C      	djnz	l26cb
  267E    F1             C      	pop	af
  267F                   C      l26d1:
  267F    FE 2F          C      	cp	'/'		; Test option
  2681    28 05          C      	jr	z,GetCmdOpt	; .. yeap
  2683    FE 20          C      	cp	' '
  2685    C2 274A        C      	jp	nz,l279c
  2688                   C      GetCmdOpt:
  2688    CD 29B0        C      	call	GetCmdCh	; Get from command line
  268B    4F             C      	ld	c,a
  268C    FE 38          C      	cp	'8'		; Test numeric
  268E    38 17          C      	jr	c,l26f9		; .. yeap
  2690    D6 41          C      	sub	'A'		; Test A..Z
  2692    FE 1A          C      	cp	'Z'-'A'+1
  2694    D2 2749        C      	jp	nc,l279b	; .. nope
  2697    87             C      	add	a,a
  2698    21 2A6C        C      	ld	hl,OptTab
  269B    4F             C      	ld	c,a
  269C    06 00          C      	ld	b,0
  269E    09             C      	add	hl,bc
  269F    5E             C      	ld	e,(hl)		; Get address from table
  26A0    23             C      	inc	hl
  26A1    56             C      	ld	d,(hl)
  26A2    CD 26BE        C      	call	OptGo		; .. go
  26A5    18 E1          C      	jr	GetCmdOpt
  26A7                   C      l26f9:
  26A7    06 00          C      	ld	b,0
  26A9    FE 37          C      	cp	'7'
  26AB    28 06          C      	jr	z,l2705
  26AD    FE 36          C      	cp	'6'
  26AF    C2 2749        C      	jp	nz,l279b
  26B2    05             C      	dec	b
  26B3                   C      l2705:
  26B3    78             C      	ld	a,b
  26B4    32 62C8        C      	ld	(_REL_),a	; Set length mode
  26B7    11 26F6        C      	ld	de,$$M$$
  26BA    21 2688        C      	ld	hl,GetCmdOpt
  26BD    E5             C      	push	hl		; Set return
  26BE                   C      OptGo:
  26BE    D5             C      	push	de		; Set execution address
  26BF    21 62C3        C      	ld	hl,_OPT_	; Get option word
  26C2    C9             C      	ret			; .. go
                         C      ;
                         C      ; Option A : Select ABSOLUTE mode
                         C      ;
  26C3                   C      $$A$$:
  26C3    CB BE          C      	res	_REL,(hl)	; Clear bits
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-111


  26C5    CB B6          C      	res	_HEX,(hl)
  26C7    C9             C      	ret
                         C      ;
                         C      ; Option C : Enable Console output driver
                         C      ;
  26C8                   C      $$C$$:
  26C8    AF             C      	xor	a
  26C9    32 60D0        C      	ld	(l6143),a
  26CC                   C      l271e:
  26CC    32 6077        C      	ld	(l60ea),a
  26CF    C9             C      	ret
                         C      ;
                         C      ; Option D : Disable lower to UPPER case conversion
                         C      ;
  26D0                   C      $$D$$:
  26D0    CB EE          C      	set	_NOUPP,(hl)	; Set disable
  26D2    C9             C      	ret
                         C      ;
                         C      ; Option E : Enable lower to UPPER case conversion
                         C      ;
  26D3                   C      $$E$$:
  26D3    CB AE          C      	res	_NOUPP,(hl)	; Reset disable
  26D5    C9             C      	ret
                         C      ;
                         C      ; Option F : Enable full listing
                         C      ;
  26D6                   C      $$F$$:
  26D6    CB C6          C      	set	_FULL,(hl)	; Set full listing
  26D8    CB 8E          C      	res	_PASS,(hl)	; .. and pass
  26DA    C9             C      	ret
                         C      ;
                         C      ; Option H : Select INTEL HEX mode
                         C      ;
  26DB                   C      $$H$$:
  26DB    CB BE          C      	res	_REL,(hl)	; Set bits
  26DD    CB F6          C      	set	_HEX,(hl)
  26DF    C9             C      	ret
                         C      ;
                         C      ; Option K : Kill all console
                         C      ;
  26E0                   C      $$K$$:
  26E0    3E FF          C      	ld	a,-1
  26E2    32 62BF        C      	ld	(CON.ena),a	; Disable console
  26E5    3A 62D2        C      	ld	a,(OSver)	; Get OS version
  26E8    FE 02          C      	cp	_MPM
  26EA    0E 93          C      	ld	c,.DetCon
  26EC    CC 5EA9        C      	call	z,.BDOS		; Detache console on MP/M
  26EF    C9             C      	ret
                         C      ;
                         C      ; Option L : Select one pass
                         C      ;
  26F0                   C      $$L$$:
  26F0    CB CE          C      	set	_PASS,(hl)	; Set bits
  26F2    CB 86          C      	res	_FULL,(hl)
  26F4    18 20          C      	jr	$$Y$$
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-112


                         C      ; Option M : Force relocatable code
                         C      ;
  26F6                   C      $$M$$:
  26F6    CB F6          C      	set	_HEX,(hl)	; Set bits
  26F8                   C      l274a:
  26F8    CB FE          C      	set	_REL,(hl)
  26FA    C9             C      	ret
                         C      ;
                         C      ; Option N : Restart with new options
                         C      ;
  26FB                   C      $$N$$:
  26FB    36 00          C      	ld	(hl),0		; Clear all options
  26FD    C9             C      	ret
                         C      ;
                         C      ; Option P : Enable the printer
                         C      ;
  26FE                   C      $$P$$:
  26FE    AF             C      	xor	a
  26FF    32 60C4        C      	ld	(l6137),a	; Set NOP
  2702    3D             C      	dec	a
  2703    32 67F0        C      	ld	(LST.ena),a	; Enable printer
  2706    3C             C      	inc	a
  2707    18 C3          C      	jr	l271e
                         C      ;
                         C      ; Option R : Select SLR REL file
                         C      ;
  2709                   C      $$R$$:
  2709    CB B6          C      	res	_HEX,(hl)	; Fix bit
  270B    18 EB          C      	jr	l274a
                         C      ;
                         C      ; Option S : Select Symbol file
                         C      ;
  270D                   C      $$S$$:
  270D    CB D6          C      	set	_SYM,(hl)	; Set bit
  270F    C9             C      	ret
                         C      ;
                         C      ; Option U : Declare undefined as externals
                         C      ;
  2710                   C      $$U$$:
  2710    CB E6          C      	set	_UNDEF,(hl)	; Set bit
  2712    C9             C      	ret
                         C      ;
                         C      ; Option X : Select cross reference
                         C      ;
  2713                   C      $$X$$:
  2713    CB DE          C      	set	_CROSS,(hl)	; Set bit
  2715    C9             C      	ret
                         C      ;
                         C      ; Option X : De-select cross reference
                         C      ;
  2716                   C      $$Y$$:
  2716    CB 9E          C      	res	_CROSS,(hl)	; Reset bit
  2718    C9             C      	ret
                         C      ;
                         C      ; Option T : Define time and date string
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-113


  2719                   C      $$T$$:
  2719    11 6A20        C      	ld	de,$TOD$	; Init format buffer
  271C    06 10          C      	ld	b,$TODlen	; .. length
  271E                   C      l2770:
  271E    CD 29B0        C      	call	GetCmdCh	; Get from command line
  2721    FE 0D          C      	cp	cr		; Test end
  2723    28 0E          C      	jr	z,l2785		; .. yeap
  2725    FE 2C          C      	cp	','		; .. or delimiter
  2727    28 0A          C      	jr	z,l2785
  2729    12             C      	ld	(de),a		; Unpack time and date
  272A    13             C      	inc	de
  272B    10 F1          C      	djnz	l2770
  272D    CD 29B0        C      	call	GetCmdCh	; Get nex from command line
  2730    4F             C      	ld	c,a		; .. save
  2731    18 07          C      	jr	l278c
  2733                   C      l2785:
  2733    4F             C      	ld	c,a		; Save last one
  2734    3E 20          C      	ld	a,' '
  2736                   C      l2788:
  2736    12             C      	ld	(de),a		; Fill rest with blanks
  2737    13             C      	inc	de
  2738    10 FC          C      	djnz	l2788
  273A                   C      l278c:
  273A    3E FF          C      	ld	a,-1
  273C    12             C      	ld	(de),a		; Close line
  273D    32 0121        C      	ld	($TOD.ENA$),a	; Enable TOD
  2740    32 0125        C      	ld	($TOD.FORM$),a	; .. set long TOD format
  2743    3E C9          C      	ld	a,_RET
  2745    32 61D1        C      	ld	(Get$TOD),a	; Disable conversion
  2748                   C      l279a:
  2748    E1             C      	pop	hl
  2749                   C      l279b:
  2749    79             C      	ld	a,c		; Get back last one kept
  274A                   C      l279c:
  274A    FE 20          C      	cp	' '
  274C    28 09          C      	jr	z,CmdDelFnd
  274E    FE 2C          C      	cp	','
  2750    28 05          C      	jr	z,CmdDelFnd
  2752    FE 0D          C      	cp	cr
  2754    C2 28A9        C      	jp	nz,l28fb
  2757                   C      CmdDelFnd:
  2757    21 62C3        C      	ld	hl,_OPT_	; Get option
  275A    CB 7E          C      	bit	_REL,(hl)	; Test relocatble
  275C    28 05          C      	jr	z,l27b5		; .. nope
  275E    3E 01          C      	ld	a,1
  2760    32 67F1        C      	ld	($REL$),a	; Set flag
  2763                   C      l27b5:
  2763    CB 6E          C      	bit	_NOUPP,(hl)	; Test case
  2765    21 0E34        C      	ld	hl,DoToken
  2768    28 03          C      	jr	z,l27bf		; .. enable lower to UPPER
  276A    21 0E46        C      	ld	hl,DoLowToken
  276D                   C      l27bf:
  276D    22 0E32        C      	ld	($TokVec),hl	; Set vector
  2770    21 290D        C      	ld	hl,$CRLF
  2773    CD 6134        C      	call	PutStr		; Close line
  2776    0E 07          C      	ld	c,7
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-114


  2778    3A 62C8        C      	ld	a,(_REL_)	; Get flag
  277B    B7             C      	or	a
  277C    28 01          C      	jr	z,l27d1		; .. long
  277E    0D             C      	dec	c		; Fix for short
  277F                   C      l27d1:
  277F    79             C      	ld	a,c
  2780    32 583F        C      	ld	(@REL1@),a	; Save length
  2783    32 5843        C      	ld	(@REL2@),a
  2786    21 0155        C      	ld	hl,$LEAD$
  2789    CD 613E        C      	call	LstCtrl		; Give lead in
  278C    CD 1FD9        C      	call	AssignF		; Assign files
  278F    01 0100        C      	ld	bc,l0100
  2792    CD 22BA        C      	call	u.alloc_	; Allocate memory
  2795    54             C      	ld	d,h		; .. copy
  2796    5D             C      	ld	e,l
  2797    13             C      	inc	de
  2798    01 0000        C      	ld	bc,0
  279B    D9             C      	exx
  279C    3A 67F1        C      	ld	a,($REL$)	; Get REL flag
  279F    32 6313        C      	ld	(l6386),a	; .. save
  27A2    21 1350        C      	ld	hl,l136a
  27A5    11 634C        C      	ld	de,l63bf
  27A8    01 0015        C      	ld	bc,l137f-l136a
  27AB    ED B0          C      	ldir			; Init jumps
  27AD    0E 66          C      	ld	c,066h		; Init conversion mask
  27AF    3A 62C3        C      	ld	a,(_OPT_)	; Get option
  27B2    FD 21 0000     C      	ld	iy,PC.REL	; Init PC
  27B6    CB 7F          C      	bit	_REL,a		; Test relocatable
  27B8    20 04          C      	jr	nz,l2810	; .. yeap
  27BA    FD 21 0100     C      	ld	iy,PC.ABS	; Set absolute
  27BE                   C      l2810:
  27BE    FD 22 6311     C      	ld	($PC$),iy	; Init PC
  27C2    E6 20          C      	and	1 SHL _NOUPP	; Test conversion
  27C4    28 02          C      	jr	z,l281a		; .. enabled
  27C6    0E 80          C      	ld	c,080h		; Set conversion mask
  27C8                   C      l281a:
  27C8    21 024E        C      	ld	hl,CtrlArr+'a'	; Init field for lower case
  27CB    06 1A          C      	ld	b,'Z'-'A'+1	; .. and length
  27CD                   C      l281f:
  27CD    71             C      	ld	(hl),c		; Set mask
  27CE    23             C      	inc	hl
  27CF    0C             C      	inc	c
  27D0    10 FB          C      	djnz	l281f		; .. for a..z
  27D2    06 E7          C      	ld	b,l04e7-l0400
  27D4    21 03ED        C      	ld	hl,l0400	; Init field
  27D7                   C      l2829::
  27D7    CB B6          C      	res	6,(hl)		; Clear bit in array
  27D9    23             C      	inc	hl
  27DA    10 FB          C      	djnz	l2829
  27DC    21 6AD1        C      	ld	hl,l6b44
  27DF    22 6317        C      	ld	(LinePtr),hl	; Init line pointer
  27E2    3E 04          C      	ld	a,4
  27E4    32 6314        C      	ld	(l6387),a
  27E7    21 292F        C      	ld	hl,l2981
  27EA    11 026D        C      	ld	de,$SRCline$
  27ED    01 0032        C      	ld	bc,l29b3-l2981
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-115


  27F0    ED B0          C      	ldir			; Copy banner to line
  27F2    CD 1662        C      	call	CnvToken	; Convert to token
  27F5    21 6ADD        C      	ld	hl,$TOKEN$	; Init token pointer
  27F8    22 62F5        C      	ld	(TokPtr),hl
  27FB    CD 4C9D        C      	call	l4cf8
  27FE    3E 31          C      	ld	a,'1'
  2800    32 035A        C      	ld	($PASS),a	; Set pass 1
  2803    3E FF          C      	ld	a,0ffh
  2805    32 67C8        C      	ld	(l683b),a
  2808    3E 06          C      	ld	a,6
  280A    32 6AC3        C      	ld	(l6b36),a
  280D    3E 12          C      	ld	a,12h
  280F    32 6ACA        C      	ld	(l6b3d),a
  2812    3E 20          C      	ld	a,' '
  2814    32 6B3C        C      	ld	(6b3ch),a
  2817    CD 0C9C        C      	call	l0cb6
  281A    21 62C3        C      	ld	hl,_OPT_	; Get option
  281D    3E 05          C      	ld	a,5
  281F    CB 5E          C      	bit	_CROSS,(hl)	; Test cross ref
  2821    20 02          C      	jr	nz,l2877	; .. yeap
  2823    3E 03          C      	ld	a,3
  2825                   C      l2877:
  2825    32 1389        C      	ld	(l13a3),a	; Set mode
  2828    D6 05          C      	sub	5
  282A    9F             C      	sbc	a,a
  282B    2F             C      	cpl
  282C    32 6819        C      	ld	(l688c),a
  282F    CD 557D        C      	call	l55d8
  2832    C3 0918        C      	jp	GO.SLR		; .. GO
  2835                   C      l2887:
  2835    21 283E        C      	ld	hl,l2890
  2838    CD 6134        C      	call	PutStr		; Tell error
  283B    C3 2535        C      	jp	NextASM		; .. restart
  283E                   C      l2890:
  283E    4E 6F 20 4E    C      	db	'No Nesting /I Files',cr,lf,eot
  2842    65 73 74 69    C      
  2846    6E 67 20 2F    C      
  284A    49 20 46 69    C      
  284E    6C 65 73 0D    C      
  2852    0A FF          C      
                         C      ;
                         C      ; Option I : Indirect command file
                         C      ;
  2854                   C      $$I$$:
  2854    2A 62CA        C      	ld	hl,(IndFIB)	; Test file already enabled
  2857    7C             C      	ld	a,h
  2858    B5             C      	or	l
  2859    20 DA          C      	jr	nz,l2887	; .. yeap, error
  285B    22 67F4        C      	ld	(CurFCB),hl	; .. save
  285E    21 005D        C      	ld	hl,FCB+@drv	; Point to name
  2861    11 6AB7        C      	ld	de,SrcFCB+@drv
  2864    01 0008        C      	ld	bc,@nam
  2867    ED B0          C      	ldir			; .. unpack it
  2869    7E             C      	ld	a,(hl)		; Get drive
  286A    D6 40          C      	sub	'A'-1
  286C    32 6AB6        C      	ld	(SrcFCB),a	; .. save
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-116


  286F    21 014F        C      	ld	hl,$$SUB
  2872    ED A0          C      	ldi			; Set extension .SUB
  2874    ED A0          C      	ldi
  2876    ED A0          C      	ldi
  2878    EB             C      	ex	de,hl
  2879    36 00          C      	ld	(hl),0
  287B    01 00B2        C      	ld	bc,RecLng+FCBlenr+14
  287E    CD 214B        C      	call	.ResetF		; Reset files again
  2881    CA 2535        C      	jp	z,NextASM	; .. nope
  2884    2A 67F4        C      	ld	hl,(CurFCB)	; Get FCB pointer
  2887    22 62CA        C      	ld	(IndFIB),hl	; .. for command file
  288A    3A 6801        C      	ld	a,(CurUsr)
  288D    32 62CE        C      	ld	(IndUsr),a	; Set user
  2890    3E 01          C      	ld	a,1
  2892    32 62D1        C      	ld	(Indirect),a	; Set enable flag
  2895    32 62CC        C      	ld	(IndRec),a	; .. init remaining bytes
  2898    ED 5B 62F7     C      	ld	de,(CmdPtr)	; Get pointer
  289C    2B             C      	dec	hl
  289D    72             C      	ld	(hl),d		; .. save
  289E    2B             C      	dec	hl
  289F    73             C      	ld	(hl),e
  28A0    2A 631D        C      	ld	hl,(SymPtr)
  28A3    22 62F3        C      	ld	(Heap),hl	; Restore heap
  28A6    C3 2535        C      	jp	NextASM		; .. re-enter
  28A9                   C      l28fb:
  28A9    21 28F1        C      	ld	hl,l2943
  28AC    CD 6134        C      	call	PutStr		; Tell error
  28AF    21 62D0        C      	ld	hl,TotalErr+1
  28B2    34             C      	inc	(hl)		; Bump error count
                         C      ;
                         C      ; Option Q : Abort interactive command line acceptance
                         C      ;
  28B3                   C      $$Q$$:
  28B3    CD 618F        C      	call	push.r		; Push regs
  28B6                   C      BREAK:
  28B6    2A 62CF        C      	ld	hl,(TotalErr)	; Test any error
  28B9    7C             C      	ld	a,h
  28BA    B5             C      	or	l
  28BB    20 13          C      	jr	nz,l2922	; .. yeap
  28BD    3A 62D2        C      	ld	a,(OSver)	; Get OS version
  28C0    3D             C      	dec	a		; Test CP/M+
  28C1    11 0000        C      	ld	de,_NOER@
  28C4    0E 6C          C      	ld	c,.prgret
  28C6    CC 0005        C      	call	z,BDOS		; .. set no error if so
  28C9    2A 01A3        C      	ld	hl,(@ZERR)
  28CC    36 00          C      	ld	(hl),0		; Clear ZCPR error
  28CE    18 0C          C      	jr	l292e
  28D0                   C      l2922:
  28D0    3A 0138        C      	ld	a,($ERASE$)	; Test submit file erasure
  28D3    B7             C      	or	a
  28D4    11 28E4        C      	ld	de,l2936
  28D7    0E 13          C      	ld	c,.delete
  28D9    C4 0005        C      	call	nz,BDOS		; Delete submit file
  28DC                   C      l292e:
  28DC    3A 6843        C      	ld	a,(LogDsk.)	; Get logged disk
  28DF    3D             C      	dec	a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-117


  28E0    CD 6180        C      	call	SetDsk		; .. select
  28E3    C7             C      	rst	0		; .. exit SLR
                         C      ;
  28E4                   C      l2936:
  28E4    01 24 24 24    C      	db	'A'-'@','$$$     SUB',null
  28E8    20 20 20 20    C      
  28EC    20 53 55 42    C      
  28F0    00             C      
  28F1                   C      l2943:
  28F1    43 6F 6D 6D    C      	db	'Command Syntax Error - Abort'
  28F5    61 6E 64 20    C      
  28F9    53 79 6E 74    C      
  28FD    61 78 20 45    C      
  2901    72 72 6F 72    C      
  2905    20 2D 20 41    C      
  2909    62 6F 72 74    C      
  290D                   C      $CRLF:
  290D    0D 0A FF       C      	db	cr,lf,eot
                         C      
                                
                         C      	include	slr180.003
                         C      ;
                         C      
                         C      ; Move to 'Radix'
                         C      
                         C      ;
                         C      
  2910                   C      $INIDAT:
                         C      
  2910    000A           C      	dw	10		; Radix
                         C      
  2912    FF             C      	db	-1
                         C      
  2913    FFFF           C      	dw	-1
                         C      
  2915    FF             C      	db	0ffh
                         C      
  2916    04             C      	db	4
                         C      
  2917    F0             C      	db	-16
                         C      
  2918    6BDB           C      	dw	l6c4d+1
                         C      
  291A    0200           C      	dw	l0200		; CtrlArr  ??????
                         C      
  291C    00 00 01       C      	db	0,0,1
                         C      
  291F    6FDD           C      	dw	l7050
                         C      
  2921    6FDD           C      	dw	l7050
                         C      
  2923    62D8 62DD      C      	dw	l634b,l6350,l6346,l6356,l635b,l635f
  2927    62D3 62E3      C      
  292B    62E8 62EC      C      
                         C      
  001F                   C      IniLen	equ	$-$INIDAT
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-118


                         C      
                         C      ;
                         C      
  292F                   C      l2981:
                         C      
  292F    09 53 4C 52    C      	db	tab,'SLR180 SuperFast Relocating '
  2933    31 38 30 20    C      
  2937    53 75 70 65    C      
  293B    72 46 61 73    C      
  293F    74 20 52 65    C      
  2943    6C 6F 63 61    C      
  2947    74 69 6E 67    C      
  294B    20             C      
                         C      
  294C    4D 61 63 72    C      	db	'Macro Assembler',cr,lf,eot
  2950    6F 20 41 73    C      
  2954    73 65 6D 62    C      
  2958    6C 65 72 0D    C      
  295C    0A FF          C      
                         C      
  295E                   C      l29b0:
                         C      
  295E    53 4C 52       C      	db	'SLR'
                         C      
  2961                   C      l29b3:
                         C      
  2961    31 38 30 20    C      	db	'180 1.31 Page '
  2965    31 2E 33 31    C      
  2969    20 50 61 67    C      
  296D    65 20          C      
                         C      
  296F                   C      l29c1:
                         C      
  296F    30 30 30 0D    C      	db	'000',cr,lf,eot
  2973    0A FF          C      
                         C      
  2975                   C      $BANNER:
                         C      
  2975    0D 0A 53 4C    C      	db	cr,lf,'SLR180 Copyright (C) 1985-86 '
  2979    52 31 38 30    C      
  297D    20 43 6F 70    C      
  2981    79 72 69 67    C      
  2985    68 74 20 28    C      
  2989    43 29 20 31    C      
  298D    39 38 35 2D    C      
  2991    38 36 20       C      
                         C      
  2994    62 79 20 53    C      	db	'by SLR Systems Rel. 1.31 #'
  2998    4C 52 20 53    C      
  299C    79 73 74 65    C      
  29A0    6D 73 20 52    C      
  29A4    65 6C 2E 20    C      
  29A8    31 2E 33 31    C      
  29AC    20 23          C      
                         C      
  29AE                   C      l2a09:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-119


                         C      
  29AE    25 FF          C      	db	'%',eot
                         C      
                         C      ;
                         C      
                         C      ; Get character from command line
                         C      
                         C      ; EXIT	Accu holds character
                         C      
                         C      ;
                         C      
  29B0                   C      GetCmdCh::
                         C      
  29B0    E5             C      	push	hl
                         C      
  29B1    D5             C      	push	de
                         C      
  29B2    C5             C      	push	bc
                         C      
  29B3    3A 62D1        C      	ld	a,(Indirect)	; Test from command file
                         C      
  29B6    B7             C      	or	a
                         C      
  29B7    28 4A          C      	jr	z,l2a5e		; .. nope
                         C      
  29B9    21 62CC        C      	ld	hl,IndRec
                         C      
  29BC    35             C      	dec	(hl)		; Count down
                         C      
  29BD    20 44          C      	jr	nz,l2a5e	; .. still any in buffer
                         C      
  29BF    36 80          C      	ld	(hl),RecLng	; Init for new scan
                         C      
  29C1    CD 618F        C      	call	push.r		; Push regs
                         C      
  29C4    3A 62CE        C      	ld	a,(IndUsr)
                         C      
  29C7    CD 6179        C      	call	SetUsr		; Log user
                         C      
  29CA    3A 0126        C      	ld	a,($MULS$)	; Test multi sectors enabled
                         C      
  29CD    B7             C      	or	a
                         C      
  29CE    F5             C      	push	af
                         C      
  29CF    1E 01          C      	ld	e,1
                         C      
  29D1    0E 2C          C      	ld	c,.mulsec
                         C      
  29D3    C4 0005        C      	call	nz,BDOS		; Set one sector if so
                         C      
  29D6    2A 62CA        C      	ld	hl,(IndFIB)	; Get pointer to file
                         C      
  29D9    11 0024        C      	ld	de,FCBlen+3
                         C      
  29DC    EB             C      	ex	de,hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-120


                         C      
  29DD    19             C      	add	hl,de		; Point to buffer
                         C      
  29DE    EB             C      	ex	de,hl
                         C      
  29DF    CD 6161        C      	call	SetDMA		; Set disk buffer
                         C      
  29E2    EB             C      	ex	de,hl
                         C      
  29E3    0E 14          C      	ld	c,.rdseq
                         C      
  29E5    CD 0005        C      	call	BDOS		; Read record
                         C      
  29E8    B7             C      	or	a
                         C      
  29E9    C2 28B6        C      	jp	nz,BREAK	; .. break on error
                         C      
  29EC    F1             C      	pop	af
                         C      
  29ED    1E 08          C      	ld	e,@SEC@
                         C      
  29EF    0E 2C          C      	ld	c,.mulsec
                         C      
  29F1    C4 0005        C      	call	nz,BDOS		; Set 1kB sectors
                         C      
  29F4    3A 6844        C      	ld	a,(LogUsr.)	; Get logged user
                         C      
  29F7    CD 6179        C      	call	SetUsr		; .. log
                         C      
  29FA    CD 61AE        C      	call	pop.r		; Pop regs
                         C      
  29FD    2A 67D4        C      	ld	hl,(_DMA_)
                         C      
  2A00    22 62F7        C      	ld	(CmdPtr),hl	; Reset pointer
                         C      
  2A03                   C      l2a5e:
                         C      
  2A03    2A 62F7        C      	ld	hl,(CmdPtr)
                         C      
  2A06    7E             C      	ld	a,(hl)
                         C      
  2A07    FE 1A          C      	cp	eof		; Test end of commands
                         C      
  2A09    20 3B          C      	jr	nz,l2aa1	; .. nope
                         C      
  2A0B    21 62D1        C      	ld	hl,Indirect	; Test command file
                         C      
  2A0E    7E             C      	ld	a,(hl)
                         C      
  2A0F    B7             C      	or	a
                         C      
  2A10    28 31          C      	jr	z,l2a9e		; .. nope
                         C      
  2A12    36 00          C      	ld	(hl),0		; Disable file
                         C      
  2A14    CD 618F        C      	call	push.r		; Push regs
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-121


                         C      
  2A17    3A 62CE        C      	ld	a,(IndUsr)
                         C      
  2A1A    CD 6179        C      	call	SetUsr		; Log user
                         C      
  2A1D    ED 5B 62CA     C      	ld	de,(IndFIB)	; Get command file
                         C      
  2A21    0E 10          C      	ld	c,.close
                         C      
  2A23    CD 0005        C      	call	BDOS		; Close file
                         C      
  2A26    3A 6844        C      	ld	a,(LogUsr.)	; Get user
                         C      
  2A29    CD 6179        C      	call	SetUsr		; .. log
                         C      
  2A2C    CD 61AE        C      	call	pop.r		; Pop regs
                         C      
  2A2F    2A 62CA        C      	ld	hl,(IndFIB)	; Get pointer
                         C      
  2A32    2B             C      	dec	hl
                         C      
  2A33    56             C      	ld	d,(hl)		; Get pointer
                         C      
  2A34    2B             C      	dec	hl
                         C      
  2A35    5E             C      	ld	e,(hl)
                         C      
  2A36    13             C      	inc	de
                         C      
  2A37    ED 53 62F7     C      	ld	(CmdPtr),de	; Set pointer
                         C      
  2A3B    21 0000        C      	ld	hl,0
                         C      
  2A3E    22 62CA        C      	ld	(IndFIB),hl	; Clear command file
                         C      
  2A41    18 C0          C      	jr	l2a5e
                         C      
  2A43                   C      l2a9e:
                         C      
  2A43    CD 2434        C      	call	l2486
                         C      
  2A46                   C      l2aa1:
                         C      
  2A46    2A 62F7        C      	ld	hl,(CmdPtr)	; Get pointer
                         C      
  2A49    7E             C      	ld	a,(hl)
                         C      
  2A4A    23             C      	inc	hl
                         C      
  2A4B    22 62F7        C      	ld	(CmdPtr),hl
                         C      
  2A4E    F5             C      	push	af
                         C      
  2A4F    5F             C      	ld	e,a
                         C      
  2A50    3A 62BF        C      	ld	a,(CON.ena)	; Test console enabled
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-122


                         C      
  2A53    B7             C      	or	a
                         C      
  2A54    0E 02          C      	ld	c,.conout
                         C      
  2A56    CC 5EA9        C      	call	z,.BDOS		; Print character if so
                         C      
  2A59    F1             C      	pop	af
                         C      
  2A5A    C1             C      	pop	bc
                         C      
  2A5B    D1             C      	pop	de
                         C      
  2A5C    E1             C      	pop	hl
                         C      
  2A5D    FE 61          C      	cp	'a'
                         C      
  2A5F    D8             C      	ret	c
                         C      
  2A60    FE 7B          C      	cp	'z'+1
                         C      
  2A62    D0             C      	ret	nc
                         C      
  2A63    E6 5F          C      	and	01011111b	; .. map
                         C      
  2A65    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Test file to be closed
                         C      
                         C      ; ENTRY	Reg DE points to FCB
                         C      
                         C      ;
                         C      
  2A66                   C      Close?:
                         C      
  2A66    1A             C      	ld	a,(de)		; Get drive
                         C      
  2A67    3C             C      	inc	a		; Test enabled
                         C      
  2A68    C8             C      	ret	z		; .. nope
                         C      
  2A69    C3 5F0A        C      	jp	FClose		; Go close
                         C      
                         C      ;
                         C      
                         C      ; The option table
                         C      
                         C      ;
                         C      
  2A6C                   C      OptTab:
                         C      
  2A6C    26C3           C      	dw	$$A$$
                         C      
  2A6E    2748           C      	dw	l279a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-123


                         C      
  2A70    26C8           C      	dw	$$C$$
                         C      
  2A72    26D0           C      	dw	$$D$$
                         C      
  2A74    26D3           C      	dw	$$E$$
                         C      
  2A76    26D6           C      	dw	$$F$$
                         C      
  2A78    2748           C      	dw	l279a
                         C      
  2A7A    26DB           C      	dw	$$H$$
                         C      
  2A7C    2854           C      	dw	$$I$$
                         C      
  2A7E    2748           C      	dw	l279a
                         C      
  2A80    26E0           C      	dw	$$K$$
                         C      
  2A82    26F0           C      	dw	$$L$$
                         C      
  2A84    26F6           C      	dw	$$M$$
                         C      
  2A86    26FB           C      	dw	$$N$$
                         C      
  2A88    2748           C      	dw	l279a
                         C      
  2A8A    26FE           C      	dw	$$P$$
                         C      
  2A8C    28B3           C      	dw	$$Q$$
                         C      
  2A8E    2709           C      	dw	$$R$$
                         C      
  2A90    270D           C      	dw	$$S$$
                         C      
  2A92    2719           C      	dw	$$T$$
                         C      
  2A94    2710           C      	dw	$$U$$
                         C      
  2A96    2748           C      	dw	l279a
                         C      
  2A98    2748           C      	dw	l279a
                         C      
  2A9A    2713           C      	dw	$$X$$
                         C      
  2A9C    2716           C      	dw	$$Y$$
                         C      
  2A9E    2748           C      	dw	l279a
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 0 : Special execution
                         C      
                         C      ;
                         C      
  2AA0                   C      jp.ind.r:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-124


                         C      
  2AA0    1A             C      	ld	a,(de)		; Get address
                         C      
  2AA1    6F             C      	ld	l,a
                         C      
  2AA2    13             C      	inc	de
                         C      
  2AA3    1A             C      	ld	a,(de)
                         C      
  2AA4    67             C      	ld	h,a
                         C      
  2AA5    E9             C      	jp	(hl)		; .. go
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 1 : Single instruction
                         C      
                         C      ;
                         C      
  2AA6                   C      l2b01:
                         C      
  2AA6    1A             C      	ld	a,(de)		; Get from table
                         C      
  2AA7    C3 6328        C      	jp	Con$Put		; .. to file
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 2 : Two byte instruction
                         C      
                         C      ;
                         C      
  2AAA                   C      l2b05:
                         C      
  2AAA    CD 2FF9        C      	call	l3054
                         C      
  2AAD    18 F7          C      	jr	l2b01
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 3 : CALL <cond> instruction
                         C      
                         C      ;
                         C      
  2AAF                   C      l2b0a:
                         C      
  2AAF    D5             C      	push	de		; .. save table
                         C      
  2AB0    CD 3E06        C      	call	GetCC		; Get condition code
                         C      
  2AB3                   C      l2b0e:
                         C      
  2AB3    38 0F          C      	jr	c,l2b1f		; .. nope
                         C      
  2AB5    E1             C      	pop	hl		; Get back table
                         C      
  2AB6    23             C      	inc	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-125


                         C      
  2AB7    B6             C      	or	(hl)		; .. build combination
                         C      
  2AB8    CD 6328        C      	call	Con$Put		; .. put to file
                         C      
  2ABB    CD 2F8E        C      	call	l2fe9
                         C      
  2ABE    CD 358D        C      	call	l35e8
                         C      
  2AC1    C3 6349        C      	jp	l63bc
                         C      
  2AC4                   C      l2b1f:
                         C      
  2AC4    E3             C      	ex	(sp),hl
                         C      
  2AC5    F5             C      	push	af
                         C      
  2AC6    7E             C      	ld	a,(hl)
                         C      
  2AC7    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  2ACA    F1             C      	pop	af
                         C      
  2ACB    E1             C      	pop	hl
                         C      
  2ACC    CD 3590        C      	call	l35eb
                         C      
  2ACF    C3 6349        C      	jp	l63bc
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 4 : Shift instructions
                         C      
                         C      ;
                         C      
  2AD2                   C      l2b2d:
                         C      
  2AD2    D5             C      	push	de
                         C      
  2AD3    CD 3D07        C      	call	GetReg		; Get register
                         C      
  2AD6    DA 0903        C      	jp	c,SyntaxErr	; .. must be
                         C      
  2AD9    4F             C      	ld	c,a
                         C      
  2ADA    FE 08          C      	cp	2dh-25h		; Test index regs
                         C      
  2ADC    38 08          C      	jr	c,l2b41		; .. nope
                         C      
  2ADE    CC 2FE7        C      	call	z,IXprefix
                         C      
  2AE1    C4 2FEF        C      	call	nz,IYprefix
                         C      
  2AE4    3E 06          C      	ld	a,16h-10h	; Map to HL
                         C      
  2AE6                   C      l2b41:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-126


                         C      
  2AE6    CD 2FF4        C      	call	l304f
                         C      
  2AE9    CB 59          C      	bit	3,c
                         C      
  2AEB    28 05          C      	jr	z,l2b4d
                         C      
  2AED    F5             C      	push	af
                         C      
  2AEE    CD 3B83        C      	call	l3bde
                         C      
  2AF1    F1             C      	pop	af
                         C      
  2AF2                   C      l2b4d:
                         C      
  2AF2    E1             C      	pop	hl
                         C      
  2AF3    B6             C      	or	(hl)
                         C      
  2AF4    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 5 : Math ADC and SBC
                         C      
                         C      ;
                         C      
  2AF7                   C      l2b52:
                         C      
  2AF7    D5             C      	push	de
                         C      
  2AF8    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2AFB    FE 1C          C      	cp	1ch		; Test HL
                         C      
  2AFD    20 18          C      	jr	nz,l2b72	; .. nope
                         C      
  2AFF    CD 2F8E        C      	call	l2fe9
                         C      
  2B02    3E ED          C      	ld	a,0edh
                         C      
  2B04    CD 6328        C      	call	Con$Put		; Put prefix to file
                         C      
  2B07    CD 3DF0        C      	call	l3e4b
                         C      
  2B0A    38 4A          C      	jr	c,l2bb1
                         C      
  2B0C    4F             C      	ld	c,a
                         C      
  2B0D    D1             C      	pop	de
                         C      
  2B0E    13             C      	inc	de
                         C      
  2B0F    1A             C      	ld	a,(de)
                         C      
  2B10    B1             C      	or	c
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-127


                         C      
  2B11    C3 6328        C      	jp	Con$Put		; .. and code
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  2B14                   C      l2b6f:
                         C      
  2B14    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2B17                   C      l2b72:
                         C      
  2B17    FE 17          C      	cp	17h		; Test ACCU
                         C      
  2B19    20 14          C      	jr	nz,l2b8a	; .. nope
                         C      
  2B1B    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2B1E    FE 50          C      	cp	50h		; Test ,
                         C      
  2B20    28 0A          C      	jr	z,l2b87
                         C      
  2B22    32 6806        C      	ld	(l6879),a
                         C      
  2B25    22 6804        C      	ld	(l6877),hl
                         C      
  2B28    3E 17          C      	ld	a,17h		; .. set ACCU
                         C      
  2B2A    18 03          C      	jr	l2b8a
                         C      
  2B2C                   C      l2b87:
                         C      
  2B2C    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2B2F                   C      l2b8a:
                         C      
  2B2F    CD 3D55        C      	call	l3db0		; Get valid operand
                         C      
  2B32    38 22          C      	jr	c,l2bb1		; .. nope
                         C      
  2B34    4F             C      	ld	c,a
                         C      
  2B35    FE 08          C      	cp	18h-10h		; Test registers
                         C      
  2B37    30 0D          C      	jr	nc,l2ba1	; .. nope
                         C      
  2B39                   C      l2b94:
                         C      
  2B39    E1             C      	pop	hl
                         C      
  2B3A    B6             C      	or	(hl)		; Combine code
                         C      
  2B3B    CB 59          C      	bit	3,c
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-128


                         C      
  2B3D    CA 6328        C      	jp	z,Con$Put	; .. put to file
                         C      
  2B40    CD 6328        C      	call	Con$Put		; .. twice
                         C      
  2B43    C3 3B83        C      	jp	l3bde
                         C      
  2B46                   C      l2ba1:
                         C      
  2B46    FE 0A          C      	cp	0ah		; Test TYPE
                         C      
  2B48    28 0F          C      	jr	z,l2bb4
                         C      
  2B4A    FE 08          C      	cp	8
                         C      
  2B4C    CC 2FE7        C      	call	z,IXprefix
                         C      
  2B4F    C4 2FEF        C      	call	nz,IYprefix
                         C      
  2B52    3E 06          C      	ld	a,6
                         C      
  2B54    18 E3          C      	jr	l2b94
                         C      
  2B56                   C      l2bb1:
                         C      
  2B56    C3 0903        C      	jp	SyntaxErr
                         C      
  2B59                   C      l2bb4:
                         C      
  2B59    D1             C      	pop	de
                         C      
  2B5A    1A             C      	ld	a,(de)
                         C      
  2B5B    F6 46          C      	or	01000110b	;; 46h
                         C      
  2B5D    CD 6328        C      	call	Con$Put		; .. put to file
                         C      
  2B60    C3 3B96        C      	jp	l3bf1
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 6 : Math ADD
                         C      
                         C      ;
                         C      
  2B63                   C      l2bbe:
                         C      
  2B63    D5             C      	push	de
                         C      
  2B64    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2B67    FE 1C          C      	cp	1ch		; Test HL
                         C      
  2B69    20 0F          C      	jr	nz,l2bd5	; .. nope
                         C      
  2B6B    CD 2F8E        C      	call	l2fe9
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-129


                         C      
  2B6E    CD 3DF0        C      	call	l3e4b
                         C      
  2B71    38 E3          C      	jr	c,l2bb1
                         C      
  2B73                   C      l2bce:
                         C      
  2B73    4F             C      	ld	c,a
                         C      
  2B74    D1             C      	pop	de
                         C      
  2B75    1A             C      	ld	a,(de)
                         C      
  2B76    B1             C      	or	c
                         C      
  2B77    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
  2B7A                   C      l2bd5:
                         C      
  2B7A    FE 1F          C      	cp	1fh		; Test IX
                         C      
  2B7C    20 0D          C      	jr	nz,l2be6
                         C      
  2B7E    CD 2F8E        C      	call	l2fe9
                         C      
  2B81    CD 2FE7        C      	call	IXprefix
                         C      
  2B84    CD 3D96        C      	call	l3df1
                         C      
  2B87    38 CD          C      	jr	c,l2bb1
                         C      
  2B89    18 E8          C      	jr	l2bce
                         C      
  2B8B                   C      l2be6:
                         C      
  2B8B    FE 20          C      	cp	20h		; Test IY
                         C      
  2B8D    28 05          C      	jr	z,l2bef
                         C      
  2B8F    D1             C      	pop	de
                         C      
  2B90    13             C      	inc	de
                         C      
  2B91    D5             C      	push	de
                         C      
  2B92    18 83          C      	jr	l2b72
                         C      
  2B94                   C      l2bef:
                         C      
  2B94    CD 2F8E        C      	call	l2fe9
                         C      
  2B97    CD 2FEF        C      	call	IYprefix
                         C      
  2B9A    CD 3DD5        C      	call	l3e30
                         C      
  2B9D    38 B7          C      	jr	c,l2bb1
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-130


                         C      
  2B9F    18 D2          C      	jr	l2bce
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 7 : 8 bit math and logicals
                         C      
                         C      ;
                         C      
  2BA1                   C      l2bfc:
                         C      
  2BA1    D5             C      	push	de
                         C      
  2BA2    C3 2B14        C      	jp	l2b6f
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 8 : Bit instructions
                         C      
                         C      ;
                         C      
  2BA5                   C      l2c00:
                         C      
  2BA5    D5             C      	push	de
                         C      
  2BA6    CD 358D        C      	call	l35e8
                         C      
  2BA9    CD 302E        C      	call	l3089
                         C      
  2BAC    CD 2F8E        C      	call	l2fe9
                         C      
  2BAF    CD 3D07        C      	call	GetReg		; Get register
                         C      
  2BB2    DA 0903        C      	jp	c,SyntaxErr	; .. should be
                         C      
  2BB5    4F             C      	ld	c,a
                         C      
  2BB6    FE 08          C      	cp	2dh-25h		; Test index register
                         C      
  2BB8    38 08          C      	jr	c,l2c1d		; .. nope
                         C      
  2BBA    CC 2FE7        C      	call	z,IXprefix
                         C      
  2BBD    C4 2FEF        C      	call	nz,IYprefix
                         C      
  2BC0    3E 06          C      	ld	a,16h-10h	; Map to HL
                         C      
  2BC2                   C      l2c1d:
                         C      
  2BC2    F5             C      	push	af
                         C      
  2BC3    CD 2FF4        C      	call	l304f
                         C      
  2BC6    CB 59          C      	bit	3,c
                         C      
  2BC8    C4 3B83        C      	call	nz,l3bde
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-131


                         C      
  2BCB    CD 3026        C      	call	l3081
                         C      
  2BCE    C1             C      	pop	bc
                         C      
  2BCF    D1             C      	pop	de
                         C      
  2BD0    1A             C      	ld	a,(de)
                         C      
  2BD1    B0             C      	or	b
                         C      
  2BD2    C3 3BC1        C      	jp	l3c1c
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 9 : DEC and INC instruction
                         C      
                         C      ;
                         C      
  2BD5                   C      l2c30:
                         C      
  2BD5    D5             C      	push	de
                         C      
  2BD6    CD 3D07        C      	call	GetReg		; Get register
                         C      
  2BD9    38 1D          C      	jr	c,l2c53		; .. nope
                         C      
  2BDB    4F             C      	ld	c,a
                         C      
  2BDC    FE 08          C      	cp	2dh-25h		; Test index register
                         C      
  2BDE    38 08          C      	jr	c,l2c43		; .. nope
                         C      
  2BE0    CC 2FE7        C      	call	z,IXprefix
                         C      
  2BE3    C4 2FEF        C      	call	nz,IYprefix
                         C      
  2BE6    3E 06          C      	ld	a,16h-10h	; Map to HL
                         C      
  2BE8                   C      l2c43:
                         C      
  2BE8    87             C      	add	a,a
                         C      
  2BE9    87             C      	add	a,a
                         C      
  2BEA    87             C      	add	a,a
                         C      
  2BEB    E1             C      	pop	hl
                         C      
  2BEC    B6             C      	or	(hl)
                         C      
  2BED    CB 59          C      	bit	3,c
                         C      
  2BEF    CA 6328        C      	jp	z,Con$Put	; Put to file
                         C      
  2BF2    CD 6328        C      	call	Con$Put		; .. more
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-132


                         C      
  2BF5    C3 3B83        C      	jp	l3bde
                         C      
  2BF8                   C      l2c53:
                         C      
  2BF8    CD 3DF3        C      	call	l3e4e
                         C      
  2BFB    38 24          C      	jr	c,l2c7c
                         C      
  2BFD                   C      l2c58:
                         C      
  2BFD    E1             C      	pop	hl
                         C      
  2BFE    23             C      	inc	hl
                         C      
  2BFF    B6             C      	or	(hl)
                         C      
  2C00    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 10 : JP <cond> instruction
                         C      
                         C      ;
                         C      
  2C03                   C      l2c5e:
                         C      
  2C03    D5             C      	push	de
                         C      
  2C04    CD 3E2B        C      	call	l3e86
                         C      
  2C07    30 06          C      	jr	nc,l2c6a
                         C      
  2C09    CD 3E09        C      	call	l3e64
                         C      
  2C0C    C3 2AB3        C      	jp	l2b0e
                         C      
  2C0F                   C      l2c6a:
                         C      
  2C0F    D1             C      	pop	de
                         C      
  2C10    FE 16          C      	cp	16h		; Test (HL)
                         C      
  2C12    28 08          C      	jr	z,l2c77	
                         C      
  2C14    FE 2D          C      	cp	2dh		; .. test (IX)
                         C      
  2C16    CC 2FE7        C      	call	z,IXprefix
                         C      
  2C19    C4 2FEF        C      	call	nz,IYprefix
                         C      
  2C1C                   C      l2c77:
                         C      
  2C1C    3E E9          C      	ld	a,0e9h
                         C      
  2C1E    C3 6328        C      	jp	Con$Put		; Put JP (HL) to file
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-133


                         C      
  2C21                   C      l2c7c:
                         C      
  2C21    FE 21          C      	cp	21h
                         C      
  2C23    30 46          C      	jr	nc,l2cc6	; .. condition code
                         C      
  2C25    FE 1F          C      	cp	1fh
                         C      
  2C27    38 42          C      	jr	c,l2cc6		; .. normal regs
                         C      
  2C29    CC 2FE7        C      	call	z,IXprefix	; Process IX
                         C      
  2C2C    C4 2FEF        C      	call	nz,IYprefix	; .. IY
                         C      
  2C2F    3E 20          C      	ld	a,20h
                         C      
  2C31    18 CA          C      	jr	l2c58
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 11 : POP and PUSH instructions
                         C      
                         C      ;
                         C      
  2C33                   C      l2c8e:
                         C      
  2C33    D5             C      	push	de
                         C      
  2C34    CD 3DC5        C      	call	l3e20
                         C      
  2C37    38 05          C      	jr	c,l2c99
                         C      
  2C39                   C      l2c94:
                         C      
  2C39    E1             C      	pop	hl
                         C      
  2C3A    B6             C      	or	(hl)
                         C      
  2C3B    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
  2C3E                   C      l2c99:
                         C      
  2C3E    CD 3E1F        C      	call	l3e7a
                         C      
  2C41    38 28          C      	jr	c,l2cc6
                         C      
  2C43    FE 1F          C      	cp	1fh		; Test IX
                         C      
  2C45    CC 2FE7        C      	call	z,IXprefix
                         C      
  2C48    C4 2FEF        C      	call	nz,IYprefix
                         C      
  2C4B    3E 20          C      	ld	a,20h		; .. set IY
                         C      
  2C4D    18 EA          C      	jr	l2c94
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-134


                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 12 : Special setting TRUE
                         C      
                         C      ;
                         C      
  2C4F                   C      l2caa:
                         C      
  2C4F    1A             C      	ld	a,(de)		; Fetch address
                         C      
  2C50    6F             C      	ld	l,a
                         C      
  2C51    13             C      	inc	de
                         C      
  2C52    1A             C      	ld	a,(de)
                         C      
  2C53    67             C      	ld	h,a
                         C      
  2C54    36 FF          C      	ld	(hl),TRUE	; Set boolean
                         C      
  2C56    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Process opcode type 13 : Special setting FALSE
                         C      
                         C      ;
                         C      
  2C57                   C      l2cb2:
                         C      
  2C57    1A             C      	ld	a,(de)		; Fetch address
                         C      
  2C58    6F             C      	ld	l,a
                         C      
  2C59    13             C      	inc	de
                         C      
  2C5A    1A             C      	ld	a,(de)
                         C      
  2C5B    67             C      	ld	h,a
                         C      
  2C5C    36 00          C      	ld	(hl),FALSE	; Set boolean
                         C      
  2C5E    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Opcode : IM
                         C      
                         C      ;
                         C      
  2C5F                   C      l2cba:
                         C      
  2C5F    CD 2FF9        C      	call	l3054
                         C      
  2C62    CD 358D        C      	call	l35e8
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-135


                         C      
  2C65    D2 3BF2        C      	jp	nc,l3c4d
                         C      
  2C68    DA 0903        C      	jp	c,SyntaxErr
                         C      
  2C6B                   C      l2cc6:
                         C      
  2C6B    C3 0903        C      	jp	SyntaxErr
                         C      
                         C      ;
                         C      
                         C      ; Opcode : DJNZ
                         C      
                         C      ;
                         C      
  2C6E                   C      l2cc9:
                         C      
  2C6E    3E 10          C      	ld	a,10h
                         C      
  2C70    CD 6328        C      	call	Con$Put		; Put DJNZ to file
                         C      
  2C73    18 11          C      	jr	l2ce1
                         C      
                         C      ;
                         C      
                         C      ; Opcode : JR <cond>
                         C      
                         C      ;
                         C      
  2C75                   C      l2cd0:
                         C      
  2C75    CD 3E06        C      	call	GetCC		; Get condition
                         C      
  2C78    38 31          C      	jr	c,l2d06		; .. none
                         C      
  2C7A    FE 20          C      	cp	8*(25h-21h)	; Test valid code
                         C      
  2C7C    30 ED          C      	jr	nc,l2cc6	; .. nope
                         C      
  2C7E    F6 20          C      	or	20h		; Build opcode
                         C      
  2C80    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  2C83    CD 2F8E        C      	call	l2fe9
                         C      
  2C86                   C      l2ce1:
                         C      
  2C86    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2C89    E5             C      	push	hl
                         C      
  2C8A    F5             C      	push	af
                         C      
  2C8B                   C      l2ce6:
                         C      
  2C8B    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-136


                         C      
  2C8E    01 0000        C      	ld	bc,0
                         C      
  2C91    3E 36          C      	ld	a,36h
                         C      
  2C93    ED B1          C      	cpir			; Find end of line
                         C      
  2C95    2B             C      	dec	hl
                         C      
  2C96    36 3B          C      	ld	(hl),';'	; .. insert -$-2 ???????
                         C      
  2C98    23             C      	inc	hl
                         C      
  2C99    36 58          C      	ld	(hl),'X'
                         C      
  2C9B    23             C      	inc	hl
                         C      
  2C9C    36 3B          C      	ld	(hl),';'
                         C      
  2C9E    23             C      	inc	hl
                         C      
  2C9F    36 5E          C      	ld	(hl),'^'	;; 5eh
                         C      
  2CA1    23             C      	inc	hl
                         C      
  2CA2    77             C      	ld	(hl),a
                         C      
  2CA3    F1             C      	pop	af
                         C      
  2CA4    E1             C      	pop	hl
                         C      
  2CA5    CD 3590        C      	call	l35eb
                         C      
  2CA8    C3 3B83        C      	jp	l3bde
                         C      
  2CAB                   C      l2d06:
                         C      
  2CAB    E5             C      	push	hl
                         C      
  2CAC    F5             C      	push	af
                         C      
  2CAD    3E 18          C      	ld	a,18h
                         C      
  2CAF    CD 6328        C      	call	Con$Put		; Put JR to file
                         C      
  2CB2    18 D7          C      	jr	l2ce6
                         C      
  2CB4                   C      l2d0f:
                         C      
  2CB4    CD 3590        C      	call	l35eb
                         C      
  2CB7    3A 660C        C      	ld	a,(l667f)
                         C      
  2CBA    FE 03          C      	cp	3
                         C      
  2CBC    20 69          C      	jr	nz,l2d82
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-137


                         C      
  2CBE    CD 2F8E        C      	call	l2fe9
                         C      
  2CC1    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2CC4    0E 32          C      	ld	c,32h
                         C      
  2CC6    FE 17          C      	cp	17h		; .. A
                         C      
  2CC8    28 2E          C      	jr	z,l2d53
                         C      
  2CCA    0E 22          C      	ld	c,22h
                         C      
  2CCC    FE 1C          C      	cp	1ch		; .. HL
                         C      
  2CCE    28 28          C      	jr	z,l2d53
                         C      
  2CD0    FE 21          C      	cp	21h
                         C      
  2CD2    30 0C          C      	jr	nc,l2d3b
                         C      
  2CD4    FE 1F          C      	cp	1fh		; Test range
                         C      
  2CD6    38 08          C      	jr	c,l2d3b		; .. other regs
                         C      
  2CD8    CC 2FE7        C      	call	z,IXprefix	; .. IX
                         C      
  2CDB    C4 2FEF        C      	call	nz,IYprefix	; .. IY
                         C      
  2CDE    18 18          C      	jr	l2d53
                         C      
  2CE0                   C      l2d3b:
                         C      
  2CE0    47             C      	ld	b,a
                         C      
  2CE1    CD 2FF9        C      	call	l3054
                         C      
  2CE4    78             C      	ld	a,b
                         C      
  2CE5    FE 1A          C      	cp	1ah		; .. BC
                         C      
  2CE7    0E 43          C      	ld	c,43h
                         C      
  2CE9    28 0D          C      	jr	z,l2d53
                         C      
  2CEB    FE 1B          C      	cp	1bh		; .. DE
                         C      
  2CED    0E 53          C      	ld	c,53h
                         C      
  2CEF    28 07          C      	jr	z,l2d53
                         C      
  2CF1    FE 1E          C      	cp	1eh		; .. SP
                         C      
  2CF3    0E 73          C      	ld	c,73h
                         C      
  2CF5    C2 0903        C      	jp	nz,SyntaxErr
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-138


                         C      
  2CF8                   C      l2d53:
                         C      
  2CF8    79             C      	ld	a,c
                         C      
  2CF9    CD 6328        C      	call	Con$Put		; Put code to file
                         C      
  2CFC    C3 6349        C      	jp	l63bc
                         C      
  2CFF                   C      l2d5a:
                         C      
  2CFF    FE 15          C      	cp	2fh-1ah		; Test (BC)
                         C      
  2D01    0E 02          C      	ld	c,2
                         C      
  2D03    28 15          C      	jr	z,l2d75
                         C      
  2D05    FE 16          C      	cp	30h-1ah		; .. (DE)
                         C      
  2D07    0E 12          C      	ld	c,12h
                         C      
  2D09    28 0F          C      	jr	z,l2d75
                         C      
  2D0B    FE FE          C      	cp	18h-1ah		; .. I
                         C      
  2D0D    0E 47          C      	ld	c,47h
                         C      
  2D0F    28 06          C      	jr	z,l2d72
                         C      
  2D11    FE FF          C      	cp	19h-1ah		; .. R
                         C      
  2D13    0E 4F          C      	ld	c,4fh
                         C      
  2D15    20 10          C      	jr	nz,l2d82
                         C      
  2D17                   C      l2d72:
                         C      
  2D17    CD 2FF9        C      	call	l3054
                         C      
  2D1A                   C      l2d75:
                         C      
  2D1A    79             C      	ld	a,c
                         C      
  2D1B    CD 6328        C      	call	Con$Put		; Put code to file
                         C      
  2D1E    CD 2F8E        C      	call	l2fe9
                         C      
  2D21    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2D24    FE 17          C      	cp	17h		; Verify A
                         C      
  2D26    C8             C      	ret	z
                         C      
  2D27                   C      l2d82:
                         C      
  2D27    C3 0903        C      	jp	SyntaxErr
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-139


                         C      
  2D2A                   C      l2d85:
                         C      
  2D2A    FE 55          C      	cp	55h		; Test ( [ {
                         C      
  2D2C    CA 2CB4        C      	jp	z,l2d0f
                         C      
  2D2F    D6 1A          C      	sub	1ah		; Strip off BC
                         C      
  2D31    38 CC          C      	jr	c,l2d5a
                         C      
  2D33    FE 07          C      	cp	21h-1ah		; Test registers
                         C      
  2D35    30 C8          C      	jr	nc,l2d5a	; .. nope
                         C      
  2D37    FE 02          C      	cp	1ch-1ah
                         C      
  2D39    38 4A          C      	jr	c,l2de0		; .. BC..DE
                         C      
  2D3B    28 10          C      	jr	z,l2da8		; .. HL
                         C      
  2D3D    FE 03          C      	cp	1dh-1ah
                         C      
  2D3F    28 BE          C      	jr	z,l2d5a		; .. AF
                         C      
  2D41    FE 04          C      	cp	1eh-1ah
                         C      
  2D43    28 21          C      	jr	z,l2dc1		; .. SP
                         C      
  2D45    FE 05          C      	cp	1fh-1ah
                         C      
  2D47    CC 2FE7        C      	call	z,IXprefix	; .. IX
                         C      
  2D4A    C4 2FEF        C      	call	nz,IYprefix	; .. IY
                         C      
  2D4D                   C      l2da8:
                         C      
  2D4D    CD 2F8E        C      	call	l2fe9
                         C      
  2D50    CD 358D        C      	call	l35e8
                         C      
  2D53    3A 660C        C      	ld	a,(l667f)
                         C      
  2D56    FE 03          C      	cp	3
                         C      
  2D58    28 08          C      	jr	z,l2dbd
                         C      
  2D5A    3E 21          C      	ld	a,21h
                         C      
  2D5C                   C      l2db7:
                         C      
  2D5C    CD 6328        C      	call	Con$Put		; Put code to file
                         C      
  2D5F    C3 6349        C      	jp	l63bc
                         C      
  2D62                   C      l2dbd:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-140


                         C      
  2D62    3E 2A          C      	ld	a,2ah
                         C      
  2D64    18 F6          C      	jr	l2db7
                         C      
  2D66                   C      l2dc1:
                         C      
  2D66    CD 2F8E        C      	call	l2fe9
                         C      
  2D69    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2D6C    FE 1C          C      	cp	1ch		; Test HL
                         C      
  2D6E    20 05          C      	jr	nz,l2dd0
                         C      
  2D70                   C      l2dcb:
                         C      
  2D70    3E F9          C      	ld	a,0f9h
                         C      
  2D72    C3 6328        C      	jp	Con$Put		; Put LD SP,HL to file
                         C      
  2D75                   C      l2dd0:
                         C      
  2D75    FE 21          C      	cp	21h
                         C      
  2D77    30 1A          C      	jr	nc,l2dee	; .. no reg
                         C      
  2D79    FE 1F          C      	cp	1fh
                         C      
  2D7B    38 16          C      	jr	c,l2dee		; .. normal regs
                         C      
  2D7D    CC 2FE7        C      	call	z,IXprefix	; .. IX
                         C      
  2D80    C4 2FEF        C      	call	nz,IYprefix	; .. IY
                         C      
  2D83    18 EB          C      	jr	l2dcb
                         C      
  2D85                   C      l2de0:
                         C      
  2D85    87             C      	add	a,a
                         C      
  2D86    87             C      	add	a,a
                         C      
  2D87    87             C      	add	a,a
                         C      
  2D88    87             C      	add	a,a
                         C      
  2D89    47             C      	ld	b,a
                         C      
  2D8A    C5             C      	push	bc
                         C      
  2D8B    CD 2F8E        C      	call	l2fe9
                         C      
  2D8E    CD 358D        C      	call	l35e8
                         C      
  2D91    18 06          C      	jr	l2df4
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-141


                         C      
  2D93                   C      l2dee:
                         C      
  2D93    06 30          C      	ld	b,30h
                         C      
  2D95    C5             C      	push	bc
                         C      
  2D96    CD 3590        C      	call	l35eb
                         C      
  2D99                   C      l2df4:
                         C      
  2D99    C1             C      	pop	bc
                         C      
  2D9A    3A 660C        C      	ld	a,(l667f)
                         C      
  2D9D    FE 03          C      	cp	3
                         C      
  2D9F    28 09          C      	jr	z,l2e05
                         C      
  2DA1    3E 01          C      	ld	a,1
                         C      
  2DA3    B0             C      	or	b
                         C      
  2DA4    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  2DA7    C3 6349        C      	jp	l63bc
                         C      
  2DAA                   C      l2e05:
                         C      
  2DAA    CD 2FF9        C      	call	l3054
                         C      
  2DAD    3E 4B          C      	ld	a,4bh
                         C      
  2DAF    B0             C      	or	b
                         C      
  2DB0    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  2DB3    C3 6349        C      	jp	l63bc
                         C      
                         C      ;
                         C      
                         C      ; Opcode : LD
                         C      
                         C      ;
                         C      
  2DB6                   C      l2e11:
                         C      
  2DB6    CD 3D07        C      	call	GetReg		; Get register
                         C      
  2DB9    DA 2D2A        C      	jp	c,l2d85		; .. nope
                         C      
  2DBC    4F             C      	ld	c,a
                         C      
  2DBD    FE 07          C      	cp	17h-10h
                         C      
  2DBF    28 68          C      	jr	z,l2e84		; .. A
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-142


                         C      
  2DC1    FE 08          C      	cp	2dh-25h
                         C      
  2DC3    38 0D          C      	jr	c,l2e2d		; .. normal regs
                         C      
  2DC5    CC 2FE7        C      	call	z,IXprefix
                         C      
  2DC8    C4 2FEF        C      	call	nz,IYprefix
                         C      
  2DCB    C5             C      	push	bc
                         C      
  2DCC    CD 302E        C      	call	l3089
                         C      
  2DCF    C1             C      	pop	bc
                         C      
  2DD0    3E 06          C      	ld	a,16h-10h	; Map to HL
                         C      
  2DD2                   C      l2e2d:
                         C      
  2DD2    87             C      	add	a,a
                         C      
  2DD3    87             C      	add	a,a
                         C      
  2DD4    87             C      	add	a,a
                         C      
  2DD5    47             C      	ld	b,a
                         C      
  2DD6    C5             C      	push	bc
                         C      
  2DD7    CD 2F8E        C      	call	l2fe9
                         C      
  2DDA    CD 3D52        C      	call	l3dad
                         C      
  2DDD    DA 0903        C      	jp	c,SyntaxErr
                         C      
  2DE0                   C      l2e3b:
                         C      
  2DE0    C1             C      	pop	bc
                         C      
  2DE1    FE 08          C      	cp	8
                         C      
  2DE3    30 11          C      	jr	nc,l2e51
                         C      
  2DE5    B0             C      	or	b
                         C      
  2DE6    F6 40          C      	or	40h
                         C      
  2DE8    CB 59          C      	bit	3,c
                         C      
  2DEA    CA 6328        C      	jp	z,Con$Put	; Put to file
                         C      
  2DED    CD 6328        C      	call	Con$Put		; .. more
                         C      
  2DF0    CD 3026        C      	call	l3081
                         C      
  2DF3    C3 3B83        C      	jp	l3bde
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-143


                         C      
  2DF6                   C      l2e51:
                         C      
  2DF6    FE 0A          C      	cp	0ah
                         C      
  2DF8    20 17          C      	jr	nz,l2e6c
                         C      
  2DFA    3E 06          C      	ld	a,6
                         C      
  2DFC    B0             C      	or	b
                         C      
  2DFD    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  2E00    CB 59          C      	bit	3,c
                         C      
  2E02    CA 3B96        C      	jp	z,l3bf1
                         C      
  2E05    CD 2FFE        C      	call	l3059
                         C      
  2E08    CD 3B83        C      	call	l3bde
                         C      
  2E0B    CD 3026        C      	call	l3081
                         C      
  2E0E    C3 3B96        C      	jp	l3bf1
                         C      
  2E11                   C      l2e6c:
                         C      
  2E11    CB 59          C      	bit	3,c
                         C      
  2E13    20 50          C      	jr	nz,l2ec0
                         C      
  2E15    4F             C      	ld	c,a
                         C      
  2E16    FE 08          C      	cp	8
                         C      
  2E18    CC 2FE7        C      	call	z,IXprefix
                         C      
  2E1B    C4 2FEF        C      	call	nz,IYprefix
                         C      
  2E1E    3E 06          C      	ld	a,6
                         C      
  2E20    F6 40          C      	or	40h
                         C      
  2E22    B0             C      	or	b
                         C      
  2E23    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  2E26    C3 3B83        C      	jp	l3bde
                         C      
  2E29                   C      l2e84:
                         C      
  2E29    CD 2F8E        C      	call	l2fe9
                         C      
  2E2C    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2E2F    FE 18          C      	cp	18h		; Test regs
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-144


                         C      
  2E31    0E 57          C      	ld	c,57h		; .. nope
                         C      
  2E33    28 21          C      	jr	z,l2eb1		; .. I
                         C      
  2E35    FE 19          C      	cp	19h
                         C      
  2E37    28 1B          C      	jr	z,l2eaf		; .. R
                         C      
  2E39    CD 3D55        C      	call	l3db0
                         C      
  2E3C    38 08          C      	jr	c,l2ea1
                         C      
  2E3E    28 1D          C      	jr	z,l2eb8
                         C      
                         C      	ld.bc	00111000b,00000111b
  2E40    01 3807        C+     	ld	bc,00111000b*256+00000111b
                         C      
  2E43    C5             C      	push	bc
                         C      
  2E44    18 9A          C      	jr	l2e3b
                         C      
  2E46                   C      l2ea1:
                         C      
  2E46    FE 2F          C      	cp	2fh
                         C      
  2E48    0E 0A          C      	ld	c,0ah
                         C      
  2E4A    28 0D          C      	jr	z,l2eb4		; .. (BC)
                         C      
  2E4C    FE 30          C      	cp	30h
                         C      
  2E4E    0E 1A          C      	ld	c,1ah
                         C      
  2E50    28 07          C      	jr	z,l2eb4		; .. (DE)
                         C      
  2E52    18 11          C      	jr	l2ec0
                         C      
  2E54                   C      l2eaf:
                         C      
  2E54    0E 5F          C      	ld	c,5fh
                         C      
  2E56                   C      l2eb1:
                         C      
  2E56    CD 2FF9        C      	call	l3054
                         C      
  2E59                   C      l2eb4:
                         C      
  2E59    79             C      	ld	a,c
                         C      
  2E5A    C3 6328        C      	jp	Con$Put		; Put code to file
                         C      
  2E5D                   C      l2eb8:
                         C      
  2E5D    3E 3A          C      	ld	a,3ah
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-145


  2E5F    CD 6328        C      	call	Con$Put		; Put LD A,() to file
                         C      
  2E62    C3 6349        C      	jp	l63bc
                         C      
  2E65                   C      l2ec0:
                         C      
  2E65    C3 0903        C      	jp	SyntaxErr
                         C      
                         C      ;
                         C      
                         C      ; Opcode : RET <cond>
                         C      
                         C      ;
                         C      
  2E68                   C      l2ec3:
                         C      
  2E68    CD 3E06        C      	call	GetCC		; Get condition
                         C      
  2E6B    38 05          C      	jr	c,l2ecd		; .. nope
                         C      
  2E6D    F6 C0          C      	or	0c0h		; Combine code
                         C      
  2E6F    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
  2E72                   C      l2ecd:
                         C      
  2E72    3E C9          C      	ld	a,0c9h
                         C      
  2E74    C3 6328        C      	jp	Con$Put		; Put RET to file
                         C      
                         C      ;
                         C      
                         C      ; Opcode : IN0
                         C      
                         C      ;
                         C      
  2E77                   C      l2ed2:
                         C      
  2E77    CD 2F29        C      	call	l2f84
                         C      
  2E7A    F5             C      	push	af
                         C      
  2E7B    CD 2F8E        C      	call	l2fe9
                         C      
  2E7E    CD 358D        C      	call	l35e8
                         C      
  2E81                   C      l2edc:
                         C      
  2E81    CD 2FF9        C      	call	l3054
                         C      
  2E84    F1             C      	pop	af
                         C      
  2E85    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  2E88    C3 3B96        C      	jp	l3bf1
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-146


                         C      ;
                         C      
                         C      ; Opcode : OUT0
                         C      
                         C      ;
                         C      
  2E8B                   C      l2ee6:
                         C      
  2E8B    CD 358D        C      	call	l35e8
                         C      
  2E8E    CD 2F8E        C      	call	l2fe9
                         C      
  2E91    CD 2F29        C      	call	l2f84
                         C      
  2E94    3C             C      	inc	a
                         C      
  2E95    FE 31          C      	cp	31h		; Test (DE) ????
                         C      
  2E97    28 CC          C      	jr	z,l2ec0
                         C      
  2E99    F5             C      	push	af
                         C      
  2E9A    18 E5          C      	jr	l2edc
                         C      
                         C      ;
                         C      
                         C      ; Opcode : MLT
                         C      
                         C      ;
                         C      
  2E9C                   C      l2ef7:
                         C      
  2E9C    CD 2FF9        C      	call	l3054
                         C      
  2E9F    CD 3DF0        C      	call	l3e4b
                         C      
  2EA2    38 C1          C      	jr	c,l2ec0
                         C      
  2EA4    F6 4C          C      	or	4ch
                         C      
  2EA6    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
  2EA9                   C      l2f04:
                         C      
  2EA9    CD 2FF9        C      	call	l3054
                         C      
  2EAC    CD 3D52        C      	call	l3dad
                         C      
  2EAF    38 B4          C      	jr	c,l2ec0
                         C      
  2EB1    FE 08          C      	cp	8
                         C      
  2EB3    30 08          C      	jr	nc,l2f18
                         C      
  2EB5    87             C      	add	a,a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-147


  2EB6    87             C      	add	a,a
                         C      
  2EB7    87             C      	add	a,a
                         C      
  2EB8    F6 04          C      	or	4
                         C      
  2EBA    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
  2EBD                   C      l2f18:
                         C      
  2EBD    FE 0A          C      	cp	10
                         C      
  2EBF    20 A4          C      	jr	nz,l2ec0
                         C      
  2EC1    3E 64          C      	ld	a,64h
                         C      
  2EC3    CD 6328        C      	call	Con$Put		; Put LD H,H to file ?????
                         C      
  2EC6    C3 3B96        C      	jp	l3bf1
                         C      
  2EC9                   C      l2f24:
                         C      
  2EC9    CD 2FF9        C      	call	l3054
                         C      
  2ECC    3E 74          C      	ld	a,74h
                         C      
  2ECE    CD 6328        C      	call	Con$Put		; Put LD (HL),H to file ????
                         C      
  2ED1    CD 358D        C      	call	l35e8
                         C      
  2ED4    C3 3B96        C      	jp	l3bf1
                         C      
                         C      ;
                         C      
                         C      ; Opcode : IN
                         C      
                         C      ;
                         C      
  2ED7                   C      l2f32:
                         C      
  2ED7    CD 2F29        C      	call	l2f84
                         C      
  2EDA    F5             C      	push	af
                         C      
  2EDB    CD 2F8E        C      	call	l2fe9
                         C      
  2EDE    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2EE1    FE 31          C      	cp	31h		; Test (C)
                         C      
  2EE3    20 0A          C      	jr	nz,l2f4a
                         C      
  2EE5    CD 2FF9        C      	call	l3054
                         C      
  2EE8    3E 40          C      	ld	a,40h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-148


  2EEA    C1             C      	pop	bc
                         C      
  2EEB    B0             C      	or	b
                         C      
  2EEC    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
  2EEF                   C      l2f4a:
                         C      
  2EEF    CD 3590        C      	call	l35eb
                         C      
  2EF2    F1             C      	pop	af
                         C      
  2EF3    FE 38          C      	cp	38h
                         C      
  2EF5    20 3F          C      	jr	nz,l2f91
                         C      
  2EF7    3E DB          C      	ld	a,0dbh
                         C      
  2EF9    CD 6328        C      	call	Con$Put		; Put IN A,port to file
                         C      
  2EFC    C3 3B96        C      	jp	l3bf1
                         C      
                         C      ;
                         C      
                         C      ; Opcode : OUT
                         C      
                         C      ;
                         C      
  2EFF                   C      l2f5a:
                         C      
  2EFF    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2F02    FE 31          C      	cp	31h		; Test (C)
                         C      
  2F04    20 0E          C      	jr	nz,l2f6f
                         C      
  2F06    CD 2F8E        C      	call	l2fe9
                         C      
  2F09    CD 2FF9        C      	call	l3054
                         C      
  2F0C    CD 2F29        C      	call	l2f84
                         C      
  2F0F    F6 41          C      	or	41h
                         C      
  2F11    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
  2F14                   C      l2f6f:
                         C      
  2F14    CD 3590        C      	call	l35eb
                         C      
  2F17    CD 2F8E        C      	call	l2fe9
                         C      
  2F1A    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2F1D    FE 17          C      	cp	17h		; Test ACCU
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-149


  2F1F    20 15          C      	jr	nz,l2f91
                         C      
  2F21    3E D3          C      	ld	a,0d3h
                         C      
  2F23    CD 6328        C      	call	Con$Put		; Put OUT port,A to file
                         C      
  2F26    C3 3B96        C      	jp	l3bf1
                         C      
  2F29                   C      l2f84:
                         C      
  2F29    CD 3D07        C      	call	GetReg		; Get register
                         C      
  2F2C    38 08          C      	jr	c,l2f91		; .. should be
                         C      
  2F2E    FE 08          C      	cp	2dh-25h		; Test index regs
                         C      
  2F30    30 04          C      	jr	nc,l2f91	; .. should not be
                         C      
  2F32    87             C      	add	a,a
                         C      
  2F33    87             C      	add	a,a
                         C      
  2F34    87             C      	add	a,a
                         C      
  2F35    C9             C      	ret
                         C      
  2F36                   C      l2f91:
                         C      
  2F36    C3 0903        C      	jp	SyntaxErr
                         C      
                         C      ;
                         C      
                         C      ; Opcode : EX
                         C      
                         C      ;
                         C      
  2F39                   C      l2f94:
                         C      
  2F39    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2F3C    FE 2C          C      	cp	2ch		; Test (SP)
                         C      
  2F3E    20 22          C      	jr	nz,l2fbd
                         C      
  2F40    CD 2F8E        C      	call	l2fe9
                         C      
  2F43    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2F46    FE 1C          C      	cp	1ch		; Test HL
                         C      
  2F48    20 05          C      	jr	nz,l2faa
                         C      
  2F4A                   C      l2fa5:
                         C      
  2F4A    3E E3          C      	ld	a,0e3h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-150


  2F4C    C3 6328        C      	jp	Con$Put		; Put EX (SP),HL to file
                         C      
  2F4F                   C      l2faa:
                         C      
  2F4F    FE 1F          C      	cp	1fh		; Test IX
                         C      
  2F51    20 07          C      	jr	nz,l2fb5
                         C      
  2F53    3E DD          C      	ld	a,0ddh		; .. give prefix
                         C      
  2F55                   C      l2fb0:
                         C      
  2F55    CD 6328        C      	call	Con$Put		; .. put to file
                         C      
  2F58    18 F0          C      	jr	l2fa5
                         C      
  2F5A                   C      l2fb5:
                         C      
  2F5A    FE 20          C      	cp	20h		; Test IY
                         C      
  2F5C    20 D8          C      	jr	nz,l2f91
                         C      
  2F5E    3E FD          C      	ld	a,0fdh		; .. give prefis
                         C      
  2F60    18 F3          C      	jr	l2fb0
                         C      
  2F62                   C      l2fbd:
                         C      
  2F62    FE 1D          C      	cp	1dh		; Test PSW
                         C      
  2F64    20 0F          C      	jr	nz,l2fd0
                         C      
  2F66    CD 2F8E        C      	call	l2fe9
                         C      
  2F69    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2F6C    FE 29          C      	cp	29h		; Test AF'
                         C      
  2F6E    20 C6          C      	jr	nz,l2f91
                         C      
  2F70    3E 08          C      	ld	a,08h
                         C      
  2F72    C3 6328        C      	jp	Con$Put		; Put EX Af,AF' to file
                         C      
  2F75                   C      l2fd0:
                         C      
  2F75    FE 1B          C      	cp	1bh		; Test DE
                         C      
  2F77    20 BD          C      	jr	nz,l2f91
                         C      
  2F79    CD 2F8E        C      	call	l2fe9
                         C      
  2F7C    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2F7F    FE 1C          C      	cp	1ch		; Test HL
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-151


  2F81    20 B3          C      	jr	nz,l2f91
                         C      
  2F83    3E EB          C      	ld	a,0ebh
                         C      
  2F85    C3 6328        C      	jp	Con$Put		; Put EX DE,HL to file
                         C      
                         C      ;
                         C      
                         C      ; Opcode : RST adr
                         C      
                         C      ;
                         C      
  2F88                   C      l2fe3:
                         C      
  2F88    CD 358D        C      	call	l35e8
                         C      
  2F8B    C3 3C11        C      	jp	l3c6c
                         C      
  2F8E                   C      l2fe9:
                         C      
  2F8E    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  2F91                   C      l2fec:
                         C      
  2F91    FE 50          C      	cp	50h
                         C      
  2F93    C8             C      	ret	z
                         C      
  2F94    0E 17          C      	ld	c,23
                         C      
  2F96    C3 0905        C      	jp	ERROR
                         C      
  2F99                   C      l2ff4:
                         C      
  2F99    CD 634C        C      	call	l63bf
                         C      
  2F9C                   C      l2ff7:
                         C      
  2F9C    D9             C      	exx
                         C      
  2F9D    10 05          C      	djnz	l2fff
                         C      
  2F9F    F5             C      	push	af
                         C      
  2FA0    CD 2FD7        C      	call	l3032
                         C      
  2FA3    F1             C      	pop	af
                         C      
  2FA4                   C      l2fff:
                         C      
  2FA4    12             C      	ld	(de),a
                         C      
  2FA5    13             C      	inc	de
                         C      
  2FA6    0C             C      	inc	c
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-152


  2FA7    D9             C      	exx
                         C      
  2FA8    E0             C      	ret	po
                         C      
  2FA9    D9             C      	exx
                         C      
  2FAA    0D             C      	dec	c
                         C      
  2FAB    71             C      	ld	(hl),c
                         C      
  2FAC    10 03          C      	djnz	l300c
                         C      
  2FAE    CD 2FD7        C      	call	l3032
                         C      
  2FB1                   C      l300c:
                         C      
  2FB1    62             C      	ld	h,d
                         C      
  2FB2    6B             C      	ld	l,e
                         C      
  2FB3    13             C      	inc	de
                         C      
  2FB4    0E 00          C      	ld	c,0
                         C      
  2FB6    D9             C      	exx
                         C      
  2FB7    C9             C      	ret
                         C      
  2FB8                   C      l3013:
                         C      
  2FB8    D9             C      	exx
                         C      
  2FB9    0C             C      	inc	c
                         C      
  2FBA    0D             C      	dec	c
                         C      
  2FBB    28 0C          C      	jr	z,l3024
                         C      
  2FBD    0D             C      	dec	c
                         C      
  2FBE    71             C      	ld	(hl),c
                         C      
  2FBF    0E 00          C      	ld	c,0
                         C      
  2FC1    10 05          C      	djnz	l3023
                         C      
  2FC3    F5             C      	push	af
                         C      
  2FC4    CD 2FD7        C      	call	l3032
                         C      
  2FC7    F1             C      	pop	af
                         C      
  2FC8                   C      l3023:
                         C      
  2FC8    EB             C      	ex	de,hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-153


  2FC9                   C      l3024:
                         C      
  2FC9    77             C      	ld	(hl),a
                         C      
  2FCA    23             C      	inc	hl
                         C      
  2FCB    54             C      	ld	d,h
                         C      
  2FCC    5D             C      	ld	e,l
                         C      
  2FCD    10 05          C      	djnz	l302f
                         C      
  2FCF    CD 2FD7        C      	call	l3032
                         C      
  2FD2    62             C      	ld	h,d
                         C      
  2FD3    6B             C      	ld	l,e
                         C      
  2FD4                   C      l302f:
                         C      
  2FD4    13             C      	inc	de
                         C      
  2FD5    D9             C      	exx
                         C      
  2FD6    C9             C      	ret
                         C      
  2FD7                   C      l3032:
                         C      
  2FD7    D9             C      	exx
                         C      
  2FD8    E5             C      	push	hl
                         C      
  2FD9    D5             C      	push	de
                         C      
  2FDA    C5             C      	push	bc
                         C      
  2FDB    01 0100        C      	ld	bc,l0100
                         C      
  2FDE    CD 22BA        C      	call	u.alloc_	; Allocate memory
                         C      
  2FE1    C1             C      	pop	bc
                         C      
  2FE2    D1             C      	pop	de
                         C      
  2FE3    E3             C      	ex	(sp),hl
                         C      
  2FE4    D9             C      	exx
                         C      
  2FE5    D1             C      	pop	de
                         C      
  2FE6    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Process IX prefix
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-154


                         C      ;
                         C      
  2FE7                   C      IXprefix:
                         C      
  2FE7    F5             C      	push	af
                         C      
  2FE8    3E DD          C      	ld	a,_IXprfx	; Set prefix
                         C      
  2FEA                   C      l3045:
                         C      
  2FEA    CD 6328        C      	call	Con$Put		; .. to file
                         C      
  2FED    F1             C      	pop	af
                         C      
  2FEE    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Process IY prefix
                         C      
                         C      ;
                         C      
  2FEF                   C      IYprefix:
                         C      
  2FEF    F5             C      	push	af
                         C      
  2FF0    3E FD          C      	ld	a,_IYprfx	; Set prefix
                         C      
  2FF2    18 F6          C      	jr	l3045
                         C      
  2FF4                   C      l304f:
                         C      
  2FF4    F5             C      	push	af
                         C      
  2FF5    3E CB          C      	ld	a,0cbh
                         C      
  2FF7    18 F1          C      	jr	l3045
                         C      
  2FF9                   C      l3054:
                         C      
  2FF9    F5             C      	push	af
                         C      
  2FFA    3E ED          C      	ld	a,0edh
                         C      
  2FFC    18 EC          C      	jr	l3045
                         C      
  2FFE                   C      l3059:
                         C      
  2FFE    21 6406        C      	ld	hl,l6479
                         C      
  3001    11 650C        C      	ld	de,l657f
                         C      
  3004                   C      l305f:
                         C      
  3004    3E FF          C      	ld	a,0ffh
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-155


  3006    BE             C      	cp	(hl)
                         C      
  3007    EB             C      	ex	de,hl
                         C      
  3008    28 11          C      	jr	z,l3076
                         C      
  300A    BE             C      	cp	(hl)
                         C      
  300B    EB             C      	ex	de,hl
                         C      
  300C    28 0D          C      	jr	z,l3076
                         C      
  300E    06 03          C      	ld	b,3
                         C      
  3010                   C      l306b:
                         C      
  3010    4E             C      	ld	c,(hl)
                         C      
  3011    1A             C      	ld	a,(de)
                         C      
  3012    77             C      	ld	(hl),a
                         C      
  3013    79             C      	ld	a,c
                         C      
  3014    12             C      	ld	(de),a
                         C      
  3015    23             C      	inc	hl
                         C      
  3016    13             C      	inc	de
                         C      
  3017    10 F7          C      	djnz	l306b
                         C      
  3019    18 E9          C      	jr	l305f
                         C      
  301B                   C      l3076:
                         C      
  301B    4E             C      	ld	c,(hl)
                         C      
  301C    77             C      	ld	(hl),a
                         C      
  301D    B9             C      	cp	c
                         C      
  301E    C8             C      	ret	z
                         C      
  301F    EB             C      	ex	de,hl
                         C      
  3020    71             C      	ld	(hl),c
                         C      
  3021    EB             C      	ex	de,hl
                         C      
  3022    23             C      	inc	hl
                         C      
  3023    13             C      	inc	de
                         C      
  3024    18 14          C      	jr	l3095
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-156


  3026                   C      l3081:
                         C      
  3026    11 6406        C      	ld	de,l6479
                         C      
  3029    21 650C        C      	ld	hl,l657f
                         C      
  302C    18 06          C      	jr	l308f
                         C      
  302E                   C      l3089:
                         C      
  302E    21 6406        C      	ld	hl,l6479
                         C      
  3031    11 650C        C      	ld	de,l657f
                         C      
  3034                   C      l308f:
                         C      
  3034    3E FF          C      	ld	a,0ffh
                         C      
  3036    18 06          C      	jr	l3099
                         C      
  3038                   C      l3093:
                         C      
  3038    ED A0          C      	ldi
                         C      
  303A                   C      l3095:
                         C      
  303A    ED A0          C      	ldi
                         C      
  303C    ED A0          C      	ldi
                         C      
  303E                   C      l3099:
                         C      
  303E    BE             C      	cp	(hl)
                         C      
  303F    20 F7          C      	jr	nz,l3093
                         C      
  3041    12             C      	ld	(de),a
                         C      
  3042    C9             C      	ret
                         C      
  3043                   C      l309e:
                         C      
  3043    3A 6809        C      	ld	a,(l687c)
                         C      
  3046    B7             C      	or	a
                         C      
  3047    C2 07A5        C      	jp	nz,l07bf
                         C      
  304A    E5             C      	push	hl
                         C      
  304B    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
                         C      
  304E    E5             C      	push	hl
                         C      
  304F    21 62F1        C      	ld	hl,l6364
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-157


  3052    22 62F5        C      	ld	(TokPtr),hl	; .. set new
                         C      
  3055    CD 07D1        C      	call	l07eb
                         C      
  3058    01 00C7        C      	ld	bc,199		;;l00c7
                         C      
  305B    CD 2247        C      	call	malloc_		; Allocate memory
                         C      
  305E    E1             C      	pop	hl
                         C      
  305F    22 62F5        C      	ld	(TokPtr),hl	; .. reset token pointer
                         C      
  3062    2A 67F4        C      	ld	hl,(l6867)
                         C      
  3065    36 FF          C      	ld	(hl),-1
                         C      
  3067    23             C      	inc	hl
                         C      
  3068    D1             C      	pop	de
                         C      
  3069    D5             C      	push	de
                         C      
  306A    13             C      	inc	de
                         C      
  306B    13             C      	inc	de
                         C      
  306C    3A 6819        C      	ld	a,(l688c)
                         C      
  306F    B7             C      	or	a
                         C      
  3070    28 02          C      	jr	z,l30cf
                         C      
  3072    13             C      	inc	de
                         C      
  3073    13             C      	inc	de
                         C      
  3074                   C      l30cf:
                         C      
  3074    73             C      	ld	(hl),e
                         C      
  3075    23             C      	inc	hl
                         C      
  3076    72             C      	ld	(hl),d
                         C      
  3077    23             C      	inc	hl
                         C      
  3078    AF             C      	xor	a
                         C      
  3079    32 313A        C      	ld	(l3195),a
                         C      
  307C    77             C      	ld	(hl),a
                         C      
  307D    23             C      	inc	hl
                         C      
  307E    77             C      	ld	(hl),a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-158


  307F    23             C      	inc	hl
                         C      
  3080    77             C      	ld	(hl),a
                         C      
  3081    E5             C      	push	hl
                         C      
  3082    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  3085    FE 36          C      	cp	36h		; Test end of line
                         C      
  3087    CA 3150        C      	jp	z,l31ab
                         C      
  308A    CD 3346        C      	call	l33a1
                         C      
  308D    21 6ADD        C      	ld	hl,$TOKEN$	; Init token pointer
                         C      
  3090    22 62F5        C      	ld	(TokPtr),hl
                         C      
  3093    D1             C      	pop	de
                         C      
  3094    D5             C      	push	de
                         C      
  3095    13             C      	inc	de
                         C      
  3096    21 0040        C      	ld	hl,l0040
                         C      
  3099    19             C      	add	hl,de
                         C      
  309A    EB             C      	ex	de,hl
                         C      
  309B                   C      l30f6:
                         C      
  309B    CD 30DF        C      	call	IsEOL?		; Test end of line
                         C      
  309E    DA 3150        C      	jp	c,l31ab		; .. yeap
                         C      
  30A1    E3             C      	ex	(sp),hl		; Get pointer
                         C      
  30A2    34             C      	inc	(hl)		; .. count
                         C      
  30A3    E3             C      	ex	(sp),hl
                         C      
  30A4    18 F5          C      	jr	l30f6
                         C      
                         C      ;
                         C      
                         C      ; Found string delimiter '
                         C      
                         C      ;
                         C      
  30A6                   C      l3101:
                         C      
  30A6    12             C      	ld	(de),a		; Save character
                         C      
  30A7    13             C      	inc	de
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-159


  30A8    03             C      	inc	bc
                         C      
  30A9    0A             C      	ld	a,(bc)		; Get next
                         C      
  30AA    FE 0D          C      	cp	cr		; Test end of line
                         C      
  30AC    CA 3138        C      	jp	z,l3193
                         C      
  30AF    FE 57          C      	cp	'W'		; .. special
                         C      
  30B1    CC 31CD        C      	call	z,l3228
                         C      
  30B4    FE 27          C      	cp	''''		; Check end
                         C      
  30B6    20 EE          C      	jr	nz,l3101
                         C      
  30B8    03             C      	inc	bc
                         C      
  30B9    0A             C      	ld	a,(bc)
                         C      
  30BA    FE 27          C      	cp	''''		; .. or 2nd
                         C      
  30BC    28 E8          C      	jr	z,l3101
                         C      
  30BE    0B             C      	dec	bc
                         C      
  30BF    3E 27          C      	ld	a,''''
                         C      
  30C1    18 47          C      	jr	l3165
                         C      
                         C      ;
                         C      
                         C      ; Found string delimiter "
                         C      
                         C      ;
                         C      
  30C3                   C      l311e:
                         C      
  30C3    12             C      	ld	(de),a		; Save character
                         C      
  30C4    13             C      	inc	de
                         C      
  30C5    03             C      	inc	bc
                         C      
  30C6    0A             C      	ld	a,(bc)
                         C      
  30C7    FE 0D          C      	cp	cr		; Test end of line
                         C      
  30C9    28 6D          C      	jr	z,l3193
                         C      
  30CB    FE 57          C      	cp	'W'		; Test special
                         C      
  30CD    CC 31CD        C      	call	z,l3228
                         C      
  30D0    FE 22          C      	cp	'"'		; Test end of string
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-160


  30D2    20 EF          C      	jr	nz,l311e
                         C      
  30D4    03             C      	inc	bc
                         C      
  30D5    0A             C      	ld	a,(bc)
                         C      
  30D6    FE 22          C      	cp	'"'		; .. or 2nd
                         C      
  30D8    28 E9          C      	jr	z,l311e
                         C      
  30DA    0B             C      	dec	bc
                         C      
  30DB    3E 22          C      	ld	a,'"'
                         C      
  30DD    18 2B          C      	jr	l3165
                         C      
                         C      ;
                         C      
                         C      ; Test character end of line delimiter
                         C      
                         C      ; ENTRY	Reg BC points to source
                         C      
                         C      ;	Reg DE points to destination
                         C      
                         C      ; EXIT	Carry set if end
                         C      
                         C      ;
                         C      
  30DF                   C      IsEOL?:
                         C      
  30DF    03             C      	inc	bc
                         C      
  30E0    0A             C      	ld	a,(bc)		; Get character
                         C      
  30E1    FE 3B          C      	cp	';'		; Test comment
                         C      
  30E3    28 15          C      	jr	z,l3155		; .. yeap
                         C      
  30E5    FE 0D          C      	cp	cr		; .. new line
                         C      
  30E7    28 11          C      	jr	z,l3155
                         C      
  30E9    FE 0A          C      	cp	lf
                         C      
  30EB    28 0D          C      	jr	z,l3155
                         C      
  30ED    FE 09          C      	cp	tab		; Test white space
                         C      
  30EF    28 EE          C      	jr	z,IsEOL?	; .. skip
                         C      
  30F1    FE 20          C      	cp	' '
                         C      
  30F3    28 EA          C      	jr	z,IsEOL?
                         C      
  30F5    CD 31BB        C      	call	l3216		; Fix pointer
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-161


  30F8    18 14          C      	jr	l3169		; .. process
                         C      
  30FA                   C      l3155:
                         C      
  30FA    37             C      	scf			; Set end
                         C      
  30FB    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Found operator >
                         C      
                         C      ;
                         C      
  30FC                   C      l3157:
                         C      
  30FC    3A 313A        C      	ld	a,(l3195)
                         C      
  30FF    B7             C      	or	a		; Test < count
                         C      
  3100    28 06          C      	jr	z,l3163		; .. empty
                         C      
  3102    3D             C      	dec	a
                         C      
  3103    32 313A        C      	ld	(l3195),a
                         C      
  3106    28 04          C      	jr	z,l3167		; .. 1st one
                         C      
  3108                   C      l3163:
                         C      
  3108    3E 3E          C      	ld	a,'>'		; Set closure
                         C      
  310A                   C      l3165:
                         C      
  310A    12             C      	ld	(de),a		; Unpack character
                         C      
  310B    13             C      	inc	de
                         C      
  310C                   C      l3167:
                         C      
  310C    03             C      	inc	bc
                         C      
  310D    0A             C      	ld	a,(bc)
                         C      
  310E                   C      l3169:
                         C      
  310E    FE 27          C      	cp	''''		; Test string delimiter
                         C      
  3110    28 94          C      	jr	z,l3101
                         C      
  3112    FE 22          C      	cp	'"'
                         C      
  3114    28 AD          C      	jr	z,l311e
                         C      
  3116    FE 3C          C      	cp	'<'		; .. operator
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-162


  3118    28 76          C      	jr	z,l31eb
                         C      
  311A    FE 3E          C      	cp	'>'
                         C      
  311C    28 DE          C      	jr	z,l3157
                         C      
  311E    FE 25          C      	cp	'%'
                         C      
  3120    28 7E          C      	jr	z,l31fb
                         C      
  3122    FE 21          C      	cp	' '+1		; Test control
                         C      
  3124    38 12          C      	jr	c,l3193		; .. yeap
                         C      
  3126    FE 2C          C      	cp	','		; .. or delimiter
                         C      
  3128    28 0E          C      	jr	z,l3193
                         C      
  312A    FE 3B          C      	cp	';'
                         C      
  312C    28 0A          C      	jr	z,l3193
                         C      
  312E    FE 5E          C      	cp	'^'
                         C      
  3130    20 D8          C      	jr	nz,l3165
                         C      
  3132    03             C      	inc	bc
                         C      
  3133    0A             C      	ld	a,(bc)
                         C      
  3134    FE 0D          C      	cp	cr
                         C      
  3136    20 D2          C      	jr	nz,l3165
                         C      
  3138                   C      l3193:
                         C      
  3138    08             C      	ex	af,af'
                         C      
  3139    3E 00          C      	ld	a,$-$
                         C      
  313A                   C      l3195	equ	$-1
                         C      
  313B    B7             C      	or	a
                         C      
  313C    28 05          C      	jr	z,l319e
                         C      
  313E    08             C      	ex	af,af'
                         C      
  313F    FE 0D          C      	cp	cr
                         C      
  3141    20 C7          C      	jr	nz,l3165
                         C      
  3143                   C      l319e:
                         C      
  3143    EB             C      	ex	de,hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-163


  3144    36 00          C      	ld	(hl),0
                         C      
  3146    23             C      	inc	hl
                         C      
  3147    EB             C      	ex	de,hl
                         C      
  3148    08             C      	ex	af,af'
                         C      
  3149    FE 2C          C      	cp	','
                         C      
  314B    28 01          C      	jr	z,l31a9
                         C      
  314D    0B             C      	dec	bc
                         C      
  314E                   C      l31a9:
                         C      
  314E    AF             C      	xor	a
                         C      
  314F    C9             C      	ret
                         C      
  3150                   C      l31ab:
                         C      
  3150    E1             C      	pop	hl
                         C      
  3151    E1             C      	pop	hl
                         C      
  3152    23             C      	inc	hl
                         C      
  3153    5E             C      	ld	e,(hl)
                         C      
  3154    23             C      	inc	hl
                         C      
  3155    56             C      	ld	d,(hl)
                         C      
  3156    21 0003        C      	ld	hl,l0003
                         C      
  3159    19             C      	add	hl,de
                         C      
  315A    3A 6819        C      	ld	a,(l688c)
                         C      
  315D    B7             C      	or	a
                         C      
  315E    4F             C      	ld	c,a
                         C      
  315F    20 01          C      	jr	nz,l31bd
                         C      
  3161    23             C      	inc	hl
                         C      
  3162                   C      l31bd:
                         C      
  3162    5E             C      	ld	e,(hl)
                         C      
  3163    23             C      	inc	hl
                         C      
  3164    56             C      	ld	d,(hl)
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-164


  3165    23             C      	inc	hl
                         C      
  3166    7B             C      	ld	a,e
                         C      
  3167    B2             C      	or	d
                         C      
  3168    20 0F          C      	jr	nz,l31d4
                         C      
  316A    B1             C      	or	c
                         C      
  316B    28 01          C      	jr	z,l31c9
                         C      
  316D    23             C      	inc	hl
                         C      
  316E                   C      l31c9:
                         C      
  316E    5E             C      	ld	e,(hl)
                         C      
  316F    23             C      	inc	hl
                         C      
  3170    56             C      	ld	d,(hl)
                         C      
  3171    28 01          C      	jr	z,l31cf
                         C      
  3173    2B             C      	dec	hl
                         C      
  3174                   C      l31cf:
                         C      
  3174    2B             C      	dec	hl
                         C      
  3175    2B             C      	dec	hl
                         C      
  3176    72             C      	ld	(hl),d
                         C      
  3177    2B             C      	dec	hl
                         C      
  3178    73             C      	ld	(hl),e
                         C      
  3179                   C      l31d4:
                         C      
  3179    3A 313A        C      	ld	a,(l3195)
                         C      
  317C    3C             C      	inc	a
                         C      
  317D    20 03          C      	jr	nz,l31dd
                         C      
  317F    11 427E        C      	ld	de,l42d9
                         C      
  3182                   C      l31dd:
                         C      
  3182    1B             C      	dec	de
                         C      
  3183    ED 53 67FD     C      	ld	(l6870),de
                         C      
  3187    21 31E1        C      	ld	hl,l323c
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-165


  318A    22 14C3        C      	ld	($LinVec),hl	; Change vector
                         C      
  318D    C3 0681        C      	jp	.ProcSRC	; .. process file
                         C      
                         C      ;
                         C      
                         C      ; Found operator <
                         C      
                         C      ;
                         C      
  3190                   C      l31eb:
                         C      
  3190    3A 313A        C      	ld	a,(l3195)
                         C      
  3193    3C             C      	inc	a		; Bump < count
                         C      
  3194    32 313A        C      	ld	(l3195),a
                         C      
  3197    3D             C      	dec	a		; Test 1st one
                         C      
  3198    CA 310C        C      	jp	z,l3167		; .. yeap
                         C      
  319B    3E 3C          C      	ld	a,'<'		; .. set operator
                         C      
  319D    C3 310A        C      	jp	l3165
                         C      
                         C      ;
                         C      
                         C      ; Found operator %
                         C      
                         C      ;
                         C      
  31A0                   C      l31fb:
                         C      
  31A0    E5             C      	push	hl
                         C      
  31A1    D5             C      	push	de
                         C      
  31A2    CD 31CD        C      	call	l3228
                         C      
  31A5    CD 4187        C      	call	l41e2
                         C      
  31A8    D1             C      	pop	de
                         C      
  31A9    CD 31B8        C      	call	l3213
                         C      
  31AC    D5             C      	push	de
                         C      
  31AD    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  31B0    CD 3346        C      	call	l33a1
                         C      
  31B3    D1             C      	pop	de
                         C      
  31B4    E1             C      	pop	hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-166


  31B5    C3 310C        C      	jp	l3167
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  31B8                   C      l3213:
                         C      
  31B8    C3 34A2        C      	jp	Out$DEC
                         C      
  31B9                   C      l3214	equ	$-2
                         C      
  31BB                   C      l3216:
                         C      
  31BB    D5             C      	push	de
                         C      
  31BC    C5             C      	push	bc
                         C      
  31BD    ED 4B 67F4     C      	ld	bc,(l6867)
                         C      
  31C1    EB             C      	ex	de,hl
                         C      
  31C2    B7             C      	or	a
                         C      
  31C3    ED 42          C      	sbc	hl,bc
                         C      
  31C5    EB             C      	ex	de,hl
                         C      
  31C6    73             C      	ld	(hl),e
                         C      
  31C7    23             C      	inc	hl
                         C      
  31C8    72             C      	ld	(hl),d
                         C      
  31C9    23             C      	inc	hl
                         C      
  31CA    C1             C      	pop	bc
                         C      
  31CB    D1             C      	pop	de
                         C      
  31CC    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Found combination 'W
                         C      
                         C      ;
                         C      
  31CD                   C      l3228:
                         C      
  31CD    E5             C      	push	hl
                         C      
  31CE    C5             C      	push	bc
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-167


  31CF    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
                         C      
  31D2    23             C      	inc	hl
                         C      
  31D3    3E 57          C      	ld	a,'W'
                         C      
  31D5    01 0000        C      	ld	bc,0
                         C      
  31D8    ED B1          C      	cpir
                         C      
  31DA    2B             C      	dec	hl
                         C      
  31DB    22 62F5        C      	ld	(TokPtr),hl	; .. save
                         C      
  31DE    C1             C      	pop	bc
                         C      
  31DF    E1             C      	pop	hl
                         C      
  31E0    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Alternate read from file ??????????????
                         C      
                         C      ;
                         C      
  31E1                   C      l323c::
                         C      
  31E1    3A 6314        C      	ld	a,(l6387)
                         C      
  31E4    FE 04          C      	cp	4
                         C      
  31E6    C4 6352        C      	call	nz,l63c5
                         C      
  31E9    3E C3          C      	ld	a,_JP
                         C      
  31EB    32 07D7        C      	ld	(l07f1),a	; Set jump
                         C      
  31EE    21 6802        C      	ld	hl,l6875
                         C      
  31F1    35             C      	dec	(hl)
                         C      
  31F2    20 05          C      	jr	nz,l3254
                         C      
  31F4    36 64          C      	ld	(hl),100
                         C      
  31F6    CD 5F5B        C      	call	IsChar		; Process keyboard
                         C      
  31F9                   C      l3254:
                         C      
  31F9    21 67FC        C      	ld	hl,CurLine+2
                         C      
  31FC    CD 0CAA        C      	call	IncBCD		; Increment line
                         C      
  31FF    2A 67F4        C      	ld	hl,(l6867)
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-168


  3202    11 0005        C      	ld	de,l0005
                         C      
  3205    19             C      	add	hl,de
                         C      
  3206    7E             C      	ld	a,(hl)
                         C      
  3207    32 3218        C      	ld	(l3273),a
                         C      
  320A    2A 67FD        C      	ld	hl,(l6870)
                         C      
  320D    11 026D        C      	ld	de,$SRCline$	; Init line
                         C      
  3210                   C      l326b:
                         C      
  3210    7E             C      	ld	a,(hl)		; Get value
                         C      
  3211    B7             C      	or	a		; Test bit
                         C      
  3212    F2 3240        C      	jp	p,l329b
                         C      
  3215    E6 7F          C      	and	NoMSB		; .. mask
                         C      
  3217    FE 00          C      	cp	$-$		; Test range
                         C      
  3218                   C      l3273	equ	$-1
                         C      
  3219    30 22          C      	jr	nc,l3298
                         C      
  321B    87             C      	add	a,a
                         C      
  321C    C6 06          C      	add	a,6
                         C      
  321E    E5             C      	push	hl
                         C      
  321F    C5             C      	push	bc
                         C      
  3220    ED 4B 67F4     C      	ld	bc,(l6867)
                         C      
  3224    6F             C      	ld	l,a
                         C      
  3225    26 00          C      	ld	h,0
                         C      
  3227    09             C      	add	hl,bc
                         C      
  3228    7E             C      	ld	a,(hl)
                         C      
  3229    23             C      	inc	hl
                         C      
  322A    66             C      	ld	h,(hl)
                         C      
  322B    6F             C      	ld	l,a
                         C      
  322C    B4             C      	or	h
                         C      
  322D    28 0C          C      	jr	z,l3296
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-169


  322F    09             C      	add	hl,bc
                         C      
  3230                   C      l328b:
                         C      
  3230    7E             C      	ld	a,(hl)
                         C      
  3231    B7             C      	or	a
                         C      
  3232    28 07          C      	jr	z,l3296
                         C      
  3234    12             C      	ld	(de),a
                         C      
  3235    23             C      	inc	hl
                         C      
  3236    1C             C      	inc	e
                         C      
  3237    20 F7          C      	jr	nz,l328b
                         C      
  3239    18 12          C      	jr	l32a8
                         C      
  323B                   C      l3296:
                         C      
  323B    C1             C      	pop	bc
                         C      
  323C    E1             C      	pop	hl
                         C      
  323D                   C      l3298:
                         C      
  323D    2B             C      	dec	hl
                         C      
  323E    18 D0          C      	jr	l326b
                         C      
  3240                   C      l329b:
                         C      
  3240    FE 1A          C      	cp	eof
                         C      
  3242    28 0E          C      	jr	z,l32ad
                         C      
  3244    2B             C      	dec	hl
                         C      
  3245    12             C      	ld	(de),a		; Unpack
                         C      
  3246    FE 0A          C      	cp	lf
                         C      
  3248    28 41          C      	jr	z,l32e6
                         C      
  324A    1C             C      	inc	e
                         C      
  324B    20 C3          C      	jr	nz,l326b
                         C      
  324D                   C      l32a8:
                         C      
  324D    0E 1C          C      	ld	c,28
                         C      
  324F    C3 0905        C      	jp	ERROR
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-170


  3252                   C      l32ad:
                         C      
  3252    2A 67F4        C      	ld	hl,(l6867)
                         C      
  3255    E5             C      	push	hl
                         C      
  3256    11 FFF2        C      	ld	de,lfff2
                         C      
  3259    19             C      	add	hl,de
                         C      
  325A    5E             C      	ld	e,(hl)
                         C      
  325B    23             C      	inc	hl
                         C      
  325C    56             C      	ld	d,(hl)
                         C      
  325D    CD 1624        C      	call	l163e
                         C      
  3260    E1             C      	pop	hl
                         C      
  3261    7E             C      	ld	a,(hl)
                         C      
  3262    3C             C      	inc	a
                         C      
  3263    28 23          C      	jr	z,l32e3
                         C      
  3265    3C             C      	inc	a
                         C      
  3266    28 15          C      	jr	z,l32d8
                         C      
  3268    11 0008        C      	ld	de,l0008
                         C      
  326B    19             C      	add	hl,de
                         C      
  326C    5E             C      	ld	e,(hl)
                         C      
  326D    23             C      	inc	hl
                         C      
  326E    56             C      	ld	d,(hl)
                         C      
  326F    19             C      	add	hl,de
                         C      
  3270    3C             C      	inc	a
                         C      
  3271    28 05          C      	jr	z,l32d3
                         C      
  3273    CD 466B        C      	call	l46c6
                         C      
  3276    18 10          C      	jr	l32e3
                         C      
  3278                   C      l32d3:
                         C      
  3278    CD 4743        C      	call	l479e
                         C      
  327B    18 0B          C      	jr	l32e3
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-171


  327D                   C      l32d8:
                         C      
  327D    11 0006        C      	ld	de,l0006
                         C      
  3280    19             C      	add	hl,de
                         C      
  3281    5E             C      	ld	e,(hl)
                         C      
  3282    23             C      	inc	hl
                         C      
  3283    56             C      	ld	d,(hl)
                         C      
  3284    EB             C      	ex	de,hl
                         C      
  3285    CD 4BC9        C      	call	l4c24
                         C      
  3288                   C      l32e3:
                         C      
  3288    C3 14C2        C      	jp	RdLine		; Read from file
                         C      
  328B                   C      l32e6:
                         C      
  328B    22 67FD        C      	ld	(l6870),hl
                         C      
  328E    EB             C      	ex	de,hl
                         C      
  328F    77             C      	ld	(hl),a
                         C      
  3290    23             C      	inc	hl
                         C      
  3291    36 FF          C      	ld	(hl),0ffh
                         C      
  3293    2A 67F4        C      	ld	hl,(l6867)
                         C      
  3296    44             C      	ld	b,h
                         C      
  3297    4D             C      	ld	c,l
                         C      
  3298    23             C      	inc	hl
                         C      
  3299    23             C      	inc	hl
                         C      
  329A    23             C      	inc	hl
                         C      
  329B    5E             C      	ld	e,(hl)
                         C      
  329C    23             C      	inc	hl
                         C      
  329D    56             C      	ld	d,(hl)
                         C      
  329E    7A             C      	ld	a,d
                         C      
  329F    B3             C      	or	e
                         C      
  32A0    C8             C      	ret	z
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-172


  32A1    EB             C      	ex	de,hl
                         C      
  32A2    09             C      	add	hl,bc
                         C      
  32A3    22 3343        C      	ld	(l339e),hl
                         C      
  32A6    AF             C      	xor	a
                         C      
  32A7    32 3345        C      	ld	(l33a0),a
                         C      
  32AA    21 026D        C      	ld	hl,$SRCline$	; Get source
                         C      
  32AD    11 6ADD        C      	ld	de,$TOKEN$	; .. destination
                         C      
  32B0    06 01          C      	ld	b,HIGH CtrlArr	; Set control page
                         C      
  32B2    18 04          C      	jr	l3313
                         C      
  32B4                   C      l330f:
                         C      
  32B4    79             C      	ld	a,c		; Get character
                         C      
  32B5    12             C      	ld	(de),a		; .. save
                         C      
  32B6    13             C      	inc	de
                         C      
  32B7    23             C      	inc	hl
                         C      
  32B8                   C      l3313:
                         C      
  32B8    4E             C      	ld	c,(hl)		; Get index
                         C      
  32B9    0A             C      	ld	a,(bc)		; .. get control
                         C      
  32BA    FE 57          C      	cp	57h		; Test it
                         C      
  32BC    38 F6          C      	jr	c,l330f		; .. normal
                         C      
  32BE    FE 9B          C      	cp	9bh		; Test special
                         C      
  32C0    38 28          C      	jr	c,l3345
                         C      
  32C2                   C      l331d:
                         C      
  32C2    FE 9D          C      	cp	9dh		; Test new line
                         C      
  32C4    20 EE          C      	jr	nz,l330f
                         C      
  32C6    3A 3345        C      	ld	a,(l33a0)
                         C      
  32C9    B7             C      	or	a
                         C      
  32CA    C8             C      	ret	z
                         C      
  32CB    3E 0A          C      	ld	a,0ah
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-173


  32CD    B9             C      	cp	c
                         C      
  32CE    28 05          C      	jr	z,l3330
                         C      
  32D0                   C      l332b:
                         C      
  32D0    ED A0          C      	ldi
                         C      
  32D2    BE             C      	cp	(hl)
                         C      
  32D3    20 FB          C      	jr	nz,l332b
                         C      
  32D5                   C      l3330:
                         C      
  32D5    EB             C      	ex	de,hl
                         C      
  32D6    36 0A          C      	ld	(hl),lf
                         C      
  32D8    23             C      	inc	hl
                         C      
  32D9    36 FF          C      	ld	(hl),eot
                         C      
  32DB    11 6ADC        C      	ld	de,l6b4f
                         C      
  32DE    ED 52          C      	sbc	hl,de
                         C      
  32E0    44             C      	ld	b,h
                         C      
  32E1    4D             C      	ld	c,l
                         C      
  32E2    EB             C      	ex	de,hl
                         C      
  32E3    23             C      	inc	hl
                         C      
  32E4    11 026D        C      	ld	de,$SRCline$	; Unpack to line
                         C      
  32E7    ED B0          C      	ldir
                         C      
  32E9    C9             C      	ret
                         C      
  32EA                   C      l3345:
                         C      
  32EA    D5             C      	push	de
                         C      
  32EB    EB             C      	ex	de,hl
                         C      
  32EC    2A 3343        C      	ld	hl,(l339e)
                         C      
  32EF                   C      l334a:
                         C      
  32EF    D5             C      	push	de
                         C      
  32F0    06 02          C      	ld	b,2
                         C      
  32F2    18 02          C      	jr	l3351
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-174


  32F4                   C      l334f:
                         C      
  32F4    2B             C      	dec	hl
                         C      
  32F5    13             C      	inc	de
                         C      
  32F6                   C      l3351:
                         C      
  32F6    1A             C      	ld	a,(de)
                         C      
  32F7    4F             C      	ld	c,a
                         C      
  32F8    0A             C      	ld	a,(bc)
                         C      
  32F9    BE             C      	cp	(hl)
                         C      
  32FA    28 F8          C      	jr	z,l334f
                         C      
  32FC    FE 57          C      	cp	57h
                         C      
  32FE    38 04          C      	jr	c,l335f
                         C      
  3300    FE 9B          C      	cp	9bh
                         C      
  3302    38 04          C      	jr	c,l3363
                         C      
  3304                   C      l335f:
                         C      
  3304    7E             C      	ld	a,(hl)
                         C      
  3305    B7             C      	or	a
                         C      
  3306    28 20          C      	jr	z,l3383
                         C      
  3308                   C      l3363:
                         C      
  3308    AF             C      	xor	a
                         C      
  3309    ED B9          C      	cpdr
                         C      
  330B    D1             C      	pop	de
                         C      
  330C    2B             C      	dec	hl
                         C      
  330D    2B             C      	dec	hl
                         C      
  330E    7E             C      	ld	a,(hl)
                         C      
  330F    B7             C      	or	a
                         C      
  3310    20 DD          C      	jr	nz,l334a
                         C      
  3312    EB             C      	ex	de,hl
                         C      
  3313    D1             C      	pop	de
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-175


  3314    06 02          C      	ld	b,2
                         C      
  3316    18 04          C      	jr	l3377
                         C      
  3318                   C      l3373:
                         C      
  3318    79             C      	ld	a,c
                         C      
  3319    12             C      	ld	(de),a
                         C      
  331A    23             C      	inc	hl
                         C      
  331B    13             C      	inc	de
                         C      
  331C                   C      l3377:
                         C      
  331C    4E             C      	ld	c,(hl)
                         C      
  331D    0A             C      	ld	a,(bc)
                         C      
  331E    FE 57          C      	cp	57h
                         C      
  3320    38 92          C      	jr	c,l330f
                         C      
  3322    FE 9B          C      	cp	9bh
                         C      
  3324    38 F2          C      	jr	c,l3373
                         C      
  3326    18 9A          C      	jr	l331d
                         C      
  3328                   C      l3383:
                         C      
  3328    C1             C      	pop	bc
                         C      
  3329    EB             C      	ex	de,hl
                         C      
  332A    E3             C      	ex	(sp),hl
                         C      
  332B    EB             C      	ex	de,hl
                         C      
  332C    2B             C      	dec	hl
                         C      
  332D    3E 3F          C      	ld	a,3fh
                         C      
  332F    32 3345        C      	ld	(l33a0),a
                         C      
  3332    12             C      	ld	(de),a
                         C      
  3333    13             C      	inc	de
                         C      
  3334    12             C      	ld	(de),a
                         C      
  3335    13             C      	inc	de
                         C      
  3336    7E             C      	ld	a,(hl)
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-176


  3337    2B             C      	dec	hl
                         C      
  3338    66             C      	ld	h,(hl)
                         C      
  3339    6F             C      	ld	l,a
                         C      
  333A    CD 340B        C      	call	l3466
                         C      
  333D    E1             C      	pop	hl
                         C      
  333E    06 02          C      	ld	b,2
                         C      
  3340    C3 32B8        C      	jp	l3313
                         C      
  3343                   C      l339e:
                         C      
  3343    0000           C      	dw	0
                         C      
  3345                   C      l33a0:
                         C      
  3345    00             C      	db	0
                         C      
  3346                   C      l33a1:
                         C      
  3346    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
                         C      
  3349    11 94B0        C      	ld	de,l94b0
                         C      
  334C    19             C      	add	hl,de
                         C      
  334D    45             C      	ld	b,l
                         C      
  334E    16 01          C      	ld	d,HIGH CtrlArr	; Set control page
                         C      
  3350    21 026D        C      	ld	hl,$SRCline$	; Get line
                         C      
  3353                   C      l33ae:
                         C      
  3353    5E             C      	ld	e,(hl)		; Get index
                         C      
  3354    1A             C      	ld	a,(de)		; .. get control
                         C      
  3355    23             C      	inc	hl
                         C      
  3356    D6 9B          C      	sub	9bh		; Check range
                         C      
  3358    30 06          C      	jr	nc,l33bb
                         C      
  335A                   C      l33b5:
                         C      
  335A    10 F7          C      	djnz	l33ae
                         C      
  335C                   C      l33b7:
                         C      
  335C    44             C      	ld	b,h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-177


  335D    4D             C      	ld	c,l
                         C      
  335E    0B             C      	dec	bc
                         C      
  335F    C9             C      	ret
                         C      
  3360                   C      l33bb:
                         C      
  3360    28 FA          C      	jr	z,l33b7
                         C      
  3362    3D             C      	dec	a
                         C      
  3363    28 1C          C      	jr	z,l33dc
                         C      
  3365    3D             C      	dec	a
                         C      
  3366    28 F4          C      	jr	z,l33b7
                         C      
  3368    3D             C      	dec	a
                         C      
  3369    28 20          C      	jr	z,l33e6
                         C      
  336B    3D             C      	dec	a
                         C      
  336C    20 EC          C      	jr	nz,l33b5
                         C      
  336E                   C      l33c9:
                         C      
  336E    05             C      	dec	b
                         C      
  336F    5E             C      	ld	e,(hl)
                         C      
  3370    23             C      	inc	hl
                         C      
  3371    1A             C      	ld	a,(de)
                         C      
  3372    FE 9F          C      	cp	9fh
                         C      
  3374    20 F8          C      	jr	nz,l33c9
                         C      
  3376    5E             C      	ld	e,(hl)
                         C      
  3377    23             C      	inc	hl
                         C      
  3378    1A             C      	ld	a,(de)
                         C      
  3379    FE 9F          C      	cp	9fh
                         C      
  337B    28 F1          C      	jr	z,l33c9
                         C      
  337D    2B             C      	dec	hl
                         C      
  337E    05             C      	dec	b
                         C      
  337F    18 D9          C      	jr	l33b5
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-178


  3381                   C      l33dc:
                         C      
  3381    5E             C      	ld	e,(hl)
                         C      
  3382    23             C      	inc	hl
                         C      
  3383    1A             C      	ld	a,(de)
                         C      
  3384    FE 9C          C      	cp	9ch
                         C      
  3386    28 F9          C      	jr	z,l33dc
                         C      
  3388    2B             C      	dec	hl
                         C      
  3389    18 CF          C      	jr	l33b5
                         C      
  338B                   C      l33e6:
                         C      
  338B    05             C      	dec	b
                         C      
  338C    5E             C      	ld	e,(hl)
                         C      
  338D    23             C      	inc	hl
                         C      
  338E    1A             C      	ld	a,(de)
                         C      
  338F    FE 9E          C      	cp	9eh
                         C      
  3391    20 F8          C      	jr	nz,l33e6
                         C      
  3393    5E             C      	ld	e,(hl)
                         C      
  3394    23             C      	inc	hl
                         C      
  3395    1A             C      	ld	a,(de)
                         C      
  3396    FE 9E          C      	cp	9eh
                         C      
  3398    28 F1          C      	jr	z,l33e6
                         C      
  339A    2B             C      	dec	hl
                         C      
  339B    05             C      	dec	b
                         C      
  339C    18 BC          C      	jr	l33b5
                         C      
                         C      ;
                         C      
                         C      ; Convert BCD to ASCII with leading zeroes
                         C      
                         C      ; ENTRY	Accu holds number of digits
                         C      
                         C      ;	Reg HL points to BCD
                         C      
                         C      ;	Reg DE points to ASCII
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-179


                         C      ;
                         C      
  339E                   C      BCDtoASC.0:
                         C      
  339E    0E 30          C      	ld	c,'0'		; Init leader
                         C      
  33A0    18 02          C      	jr	l33ff
                         C      
                         C      ;
                         C      
                         C      ; Convert BCD to ASCII suppressing leading zeroes
                         C      
                         C      ; ENTRY	Accu holds number of digits
                         C      
                         C      ;	Reg HL points to BCD
                         C      
                         C      ;	Reg DE points to ASCII
                         C      
                         C      ;
                         C      
  33A2                   C      BCDtoASC.:
                         C      
  33A2    0E 20          C      	ld	c,' '
                         C      
  33A4                   C      l33ff:
                         C      
  33A4    47             C      	ld	b,a		; Unpack count
                         C      
  33A5    3E 30          C      	ld	a,'0'		; .. set ASCII
                         C      
  33A7    04             C      	inc	b		; Fix
                         C      
  33A8    CB 38          C      	srl	b		; Test even
                         C      
  33AA    38 04          C      	jr	c,l340b		; .. yeap
                         C      
  33AC    ED 6F          C      	rld			; .. pre-swap
                         C      
  33AE    18 03          C      	jr	l340e
                         C      
  33B0                   C      l340b:
                         C      
  33B0    CD 33BC        C      	call	l3417		; Convert 1st
                         C      
  33B3                   C      l340e:
                         C      
  33B3    CD 33BC        C      	call	l3417		; .. 2nd
                         C      
  33B6    ED 6F          C      	rld			; .. bring back ole state ?????
                         C      
  33B8    23             C      	inc	hl
                         C      
  33B9    10 F5          C      	djnz	l340b
                         C      
  33BB    C9             C      	ret
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-180


                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  33BC                   C      l3417:
                         C      
  33BC    ED 6F          C      	rld			; Swap memory
                         C      
  33BE    FE 30          C      	cp	'0'		; Test leading zero
                         C      
  33C0    28 05          C      	jr	z,l3422		; .. yeap
                         C      
  33C2    12             C      	ld	(de),a		; Save digit
                         C      
  33C3    13             C      	inc	de
                         C      
  33C4    0E 30          C      	ld	c,'0'		; Set prefix
                         C      
  33C6    C9             C      	ret
                         C      
  33C7                   C      l3422:
                         C      
  33C7    79             C      	ld	a,c
                         C      
  33C8    12             C      	ld	(de),a		; Set filler
                         C      
  33C9    13             C      	inc	de
                         C      
  33CA    3E 30          C      	ld	a,'0'		; .. set leading zero again
                         C      
  33CC    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Convert BCD to ASCII
                         C      
                         C      ; ENTRY	Reg HL points to  BCD  number
                         C      
                         C      ;	Reg DE points to ASCII buffer
                         C      
                         C      ;	Accu   holds length of BCD to be converted
                         C      
                         C      ;
                         C      
                         C      ; NOTE	BCD numbers will be cleared to zero
                         C      
                         C      ;
                         C      
  33CD                   C      BCDtoASC:
                         C      
  33CD    47             C      	ld	b,a		; Save count
                         C      
  33CE    0E 30          C      	ld	c,'0'		; Init number
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-181


  33D0    04             C      	inc	b		; Fix count
                         C      
  33D1    CB 38          C      	srl	b		; Get half
                         C      
  33D3    38 04          C      	jr	c,l3434		; .. odd count
                         C      
  33D5    ED 6F          C      	rld			; Skip upper part
                         C      
  33D7    18 0B          C      	jr	l343f
                         C      
  33D9                   C      l3434:
                         C      
  33D9    79             C      	ld	a,c		; Init ASCII
                         C      
  33DA    ED 6F          C      	rld			; Get upper nibble from BCD
                         C      
  33DC    FE 3A          C      	cp	'9'+1		; Test range
                         C      
  33DE    38 02          C      	jr	c,l343d
                         C      
  33E0    C6 07          C      	add	a,7		; Fix for hex ASCII
                         C      
  33E2                   C      l343d:
                         C      
  33E2    12             C      	ld	(de),a		; .. store
                         C      
  33E3    13             C      	inc	de
                         C      
  33E4                   C      l343f:
                         C      
  33E4    79             C      	ld	a,c		; .. same for lower nibble
                         C      
  33E5    ED 6F          C      	rld
                         C      
  33E7    FE 3A          C      	cp	'9'+1
                         C      
  33E9    38 02          C      	jr	c,l3448
                         C      
  33EB    C6 07          C      	add	a,7
                         C      
  33ED                   C      l3448:
                         C      
  33ED    12             C      	ld	(de),a
                         C      
  33EE    13             C      	inc	de
                         C      
  33EF    23             C      	inc	hl
                         C      
  33F0    10 E7          C      	djnz	l3434
                         C      
  33F2    C9             C      	ret
                         C      
  33F3                   C      l344e:
                         C      
  33F3    01 39D5        C      	ld	bc,l3a30
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-182


  33F6    79             C      	ld	a,c
                         C      
  33F7    ED 6F          C      	rld
                         C      
  33F9    B8             C      	cp	b
                         C      
  33FA    38 02          C      	jr	c,l3459
                         C      
  33FC    C6 07          C      	add	a,7
                         C      
  33FE                   C      l3459:
                         C      
  33FE    12             C      	ld	(de),a
                         C      
  33FF    13             C      	inc	de
                         C      
  3400    79             C      	ld	a,c
                         C      
  3401    ED 6F          C      	rld
                         C      
  3403    B8             C      	cp	b
                         C      
  3404    38 02          C      	jr	c,l3463
                         C      
  3406    C6 07          C      	add	a,7
                         C      
  3408                   C      l3463:
                         C      
  3408    12             C      	ld	(de),a
                         C      
  3409    13             C      	inc	de
                         C      
  340A    C9             C      	ret
                         C      
  340B                   C      l3466:
                         C      
  340B    0E 30          C      	ld	c,'0'
                         C      
  340D    18 02          C      	jr	l346c
                         C      
                         C      ;
                         C      
                         C      ; Convert hexadecimal number to ASCII
                         C      
                         C      ; ENTRY	Reg HL holds number
                         C      
                         C      ;	Reg DE points to buffer
                         C      
                         C      ;
                         C      
  340F                   C      Out$HEX:
                         C      
  340F    0E 00          C      	ld	c,0		; Init zero flag
                         C      
  3411                   C      l346c:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-183


  3411    7C             C      	ld	a,h		; Get hi
                         C      
  3412    CD 3421        C      	call	Out$HexByte	; .. convert
                         C      
  3415    7D             C      	ld	a,l		; .. then low
                         C      
  3416    CD 3421        C      	call	Out$HexByte
                         C      
  3419                   C      l3474:
                         C      
  3419    0C             C      	inc	c		; Test any converted
                         C      
  341A    0D             C      	dec	c
                         C      
  341B    C0             C      	ret	nz		; .. yeap
                         C      
  341C    3E 30          C      	ld	a,'0'
                         C      
  341E    12             C      	ld	(de),a		; Set zero if not
                         C      
  341F    13             C      	inc	de
                         C      
  3420    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Convert hex byte to ASCII
                         C      
                         C      ; ENTRY	Accu holds byte
                         C      
                         C      ;
                         C      
  3421                   C      Out$HexByte:
                         C      
  3421    F5             C      	push	af
                         C      
  3422    1F             C      	rra
                         C      
  3423    1F             C      	rra
                         C      
  3424    1F             C      	rra
                         C      
  3425    1F             C      	rra
                         C      
  3426    CD 342A        C      	call	l3485
                         C      
  3429    F1             C      	pop	af
                         C      
  342A                   C      l3485:
                         C      
  342A    E6 0F          C      	and	0fh		; Mask bits
                         C      
  342C    28 15          C      	jr	z,l349e		; .. zero
                         C      
  342E    FE 0A          C      	cp	10		; Test range
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-184


  3430    38 0B          C      	jr	c,l3498		; .. normal digit
                         C      
  3432    0C             C      	inc	c		; Test 1st hex digit
                         C      
  3433    0D             C      	dec	c
                         C      
  3434    20 05          C      	jr	nz,l3496	; .. nope
                         C      
  3436    EB             C      	ex	de,hl
                         C      
  3437    36 30          C      	ld	(hl),'0'	; Else set prefix zero
                         C      
  3439    EB             C      	ex	de,hl
                         C      
  343A    13             C      	inc	de
                         C      
  343B                   C      l3496:
                         C      
  343B    C6 07          C      	add	a,7		; Make hex ASCII
                         C      
  343D                   C      l3498:
                         C      
  343D    0E 30          C      	ld	c,'0'		; Indicate not 1st
                         C      
  343F    81             C      	add	a,c
                         C      
  3440    12             C      	ld	(de),a		; .. store ASCII
                         C      
  3441    13             C      	inc	de
                         C      
  3442    C9             C      	ret
                         C      
  3443                   C      l349e:
                         C      
  3443    0C             C      	inc	c		; Test any input
                         C      
  3444    0D             C      	dec	c
                         C      
  3445    C8             C      	ret	z		; .. nope
                         C      
  3446    79             C      	ld	a,c
                         C      
  3447    12             C      	ld	(de),a		; Set zero
                         C      
  3448    13             C      	inc	de
                         C      
  3449    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Convert octal number to ASCII
                         C      
                         C      ; ENTRY	Reg HL holds number
                         C      
                         C      ;	Reg DE points to buffer
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-185


                         C      ;
                         C      
  344A                   C      Out$OCT:
                         C      
  344A    AF             C      	xor	a
                         C      
  344B    4F             C      	ld	c,a		; Clear flag
                         C      
  344C    29             C      	add	hl,hl		; .. double value
                         C      
  344D    17             C      	rla			; .. get MSB
                         C      
  344E    06 06          C      	ld	b,5+1		; Set bit count
                         C      
  3450    18 07          C      	jr	l34b4		; .. start
                         C      
  3452                   C      l34ad:
                         C      
  3452    AF             C      	xor	a
                         C      
  3453    29             C      	add	hl,hl		; Get next three bits
                         C      
  3454    17             C      	rla
                         C      
  3455    29             C      	add	hl,hl
                         C      
  3456    17             C      	rla
                         C      
  3457    29             C      	add	hl,hl
                         C      
  3458    17             C      	rla
                         C      
  3459                   C      l34b4:
                         C      
  3459    CD 3460        C      	call	l34bb		; Convert bits
                         C      
  345C    10 F4          C      	djnz	l34ad
                         C      
  345E    18 B9          C      	jr	l3474
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  3460                   C      l34bb:
                         C      
  3460    B7             C      	or	a		; Test zero
                         C      
  3461    28 06          C      	jr	z,l34c4		; .. yeap
                         C      
  3463    0E 30          C      	ld	c,'0'		; Mark not 1st
                         C      
  3465    B1             C      	or	c
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-186


  3466    12             C      	ld	(de),a		; .. save character
                         C      
  3467    13             C      	inc	de
                         C      
  3468    C9             C      	ret
                         C      
  3469                   C      l34c4:
                         C      
  3469    0C             C      	inc	c		; Test any output
                         C      
  346A    0D             C      	dec	c
                         C      
  346B    C8             C      	ret	z		; .. nope
                         C      
  346C    79             C      	ld	a,c
                         C      
  346D    12             C      	ld	(de),a		; Set zero
                         C      
  346E    13             C      	inc	de
                         C      
  346F    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Convert binary or any based number to ASCII
                         C      
                         C      ; ENTRY	Reg HL holds number
                         C      
                         C      ;	Reg DE points to buffer
                         C      
                         C      ;
                         C      
  3470                   C      Out$BIN:
                         C      
  3470    D5             C      	push	de
                         C      
  3471    11 682A        C      	ld	de,l689d	; Swap buffer
                         C      
  3474    01 0000        C      	ld	bc,0		; Clear a bit
                         C      
  3477                   C      l34d2:
                         C      
  3477    0C             C      	inc	c
                         C      
  3478    D5             C      	push	de
                         C      
  3479    C5             C      	push	bc
                         C      
  347A    ED 5B 6615     C      	ld	de,(Radix)	; Get radix
                         C      
  347E    CD 3A1A        C      	call	Divide		; .. divide number
                         C      
  3481    7D             C      	ld	a,l		; Get quotient
                         C      
  3482    F6 30          C      	or	'0'		; .. add ASCII
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-187


  3484    FE 3A          C      	cp	'9'+1		; Test range
                         C      
  3486    38 02          C      	jr	c,l34e5
                         C      
  3488    C6 07          C      	add	a,7		; .. make hex
                         C      
  348A                   C      l34e5:
                         C      
  348A    60             C      	ld	h,b		; Get modulo
                         C      
  348B    69             C      	ld	l,c
                         C      
  348C    C1             C      	pop	bc
                         C      
  348D    D1             C      	pop	de
                         C      
  348E    1B             C      	dec	de
                         C      
  348F    12             C      	ld	(de),a		; Store digit
                         C      
  3490    7C             C      	ld	a,h		; .. test more
                         C      
  3491    B5             C      	or	l
                         C      
  3492    20 E3          C      	jr	nz,l34d2
                         C      
  3494    EB             C      	ex	de,hl
                         C      
  3495    D1             C      	pop	de
                         C      
  3496    7E             C      	ld	a,(hl)
                         C      
  3497    FE 3A          C      	cp	'9'+1
                         C      
  3499    38 04          C      	jr	c,l34fa
                         C      
  349B    3E 30          C      	ld	a,'0'
                         C      
  349D    12             C      	ld	(de),a		; Fix entry
                         C      
  349E    13             C      	inc	de
                         C      
  349F                   C      l34fa:
                         C      
  349F    ED B0          C      	ldir
                         C      
  34A1    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Convert decimal number to ASCII
                         C      
                         C      ; ENTRY	Reg HL holds number
                         C      
                         C      ;	Reg DE points to buffer
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-188


                         C      ;
                         C      
  34A2                   C      Out$DEC:
                         C      
  34A2    0E 00          C      	ld	c,0		; Clear digit flag
                         C      
  34A4    D5             C      	push	de
                         C      
  34A5    11 D8F0        C      	ld	de,-10000
                         C      
  34A8    CD 34DC        C      	call	DivCon		; Divide step by step
                         C      
  34AB    28 04          C      	jr	z,l350c		; .. ignore zeroes
                         C      
  34AD    D1             C      	pop	de
                         C      
  34AE    12             C      	ld	(de),a		; .. store
                         C      
  34AF    13             C      	inc	de
                         C      
  34B0    D5             C      	push	de
                         C      
  34B1                   C      l350c:
                         C      
  34B1    11 FC18        C      	ld	de,-1000
                         C      
  34B4    CD 34DC        C      	call	DivCon
                         C      
  34B7    28 04          C      	jr	z,l3518
                         C      
  34B9    D1             C      	pop	de
                         C      
  34BA    12             C      	ld	(de),a
                         C      
  34BB    13             C      	inc	de
                         C      
  34BC    D5             C      	push	de
                         C      
  34BD                   C      l3518:
                         C      
  34BD    11 FF9C        C      	ld	de,-100
                         C      
  34C0    CD 34DC        C      	call	DivCon
                         C      
  34C3    28 04          C      	jr	z,l3524
                         C      
  34C5    D1             C      	pop	de
                         C      
  34C6    12             C      	ld	(de),a
                         C      
  34C7    13             C      	inc	de
                         C      
  34C8    D5             C      	push	de
                         C      
  34C9                   C      l3524:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-189


  34C9    11 FFF6        C      	ld	de,-10
                         C      
  34CC    CD 34DC        C      	call	DivCon
                         C      
  34CF    28 04          C      	jr	z,l3530
                         C      
  34D1    D1             C      	pop	de
                         C      
  34D2    12             C      	ld	(de),a
                         C      
  34D3    13             C      	inc	de
                         C      
  34D4    D5             C      	push	de
                         C      
  34D5                   C      l3530:
                         C      
  34D5    7D             C      	ld	a,l		; Get remainder
                         C      
  34D6    C6 30          C      	add	a,'0'
                         C      
  34D8    D1             C      	pop	de
                         C      
  34D9    12             C      	ld	(de),a		; .. store
                         C      
  34DA    13             C      	inc	de
                         C      
  34DB    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Divide number by constant
                         C      
                         C      ; ENTRY	Reg HL holds number
                         C      
                         C      ;	Reg DE holds divisor (less zero)
                         C      
                         C      ; EXIT	Accu holds digit
                         C      
                         C      ;	Zero indicates zero
                         C      
                         C      ;
                         C      
  34DC                   C      DivCon:
                         C      
  34DC    AF             C      	xor	a		; Clear quotient
                         C      
  34DD                   C      l3538:
                         C      
  34DD    19             C      	add	hl,de		; Divide
                         C      
  34DE    3C             C      	inc	a		; .. bump quotient
                         C      
  34DF    38 FC          C      	jr	c,l3538
                         C      
  34E1    ED 52          C      	sbc	hl,de
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-190


  34E3    3D             C      	dec	a
                         C      
  34E4    B1             C      	or	c		; .. test zero
                         C      
  34E5    C8             C      	ret	z		; .. yeap
                         C      
  34E6    0E 30          C      	ld	c,'0'
                         C      
  34E8    B1             C      	or	c		; Make not zero
                         C      
  34E9    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Input decimal number from ASCII stream
                         C      
                         C      ; ENTRY	Accu holds length of string
                         C      
                         C      ;	Reg DE points to buffer
                         C      
                         C      ; EXIT	Reg HL holds number
                         C      
                         C      ;	Carry set indicates conversion error
                         C      
                         C      ;
                         C      
  34EA                   C      In$DEC:
                         C      
  34EA    D5             C      	push	de
                         C      
  34EB    C5             C      	push	bc
                         C      
  34EC    EB             C      	ex	de,hl
                         C      
  34ED    21 0000        C      	ld	hl,0		; Init result
                         C      
  34F0    18 07          C      	jr	l3554
                         C      
  34F2                   C      l354d:
                         C      
  34F2    78             C      	ld	a,b
                         C      
  34F3    29             C      	add	hl,hl		; * 2
                         C      
  34F4    44             C      	ld	b,h
                         C      
  34F5    4D             C      	ld	c,l
                         C      
  34F6    29             C      	add	hl,hl		; * 4
                         C      
  34F7    29             C      	add	hl,hl		; * 5
                         C      
  34F8    09             C      	add	hl,bc		; *10
                         C      
  34F9                   C      l3554:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-191


  34F9    47             C      	ld	b,a		; Get back length
                         C      
  34FA    1A             C      	ld	a,(de)		; Get character
                         C      
  34FB    13             C      	inc	de
                         C      
  34FC    D6 5C          C      	sub	5ch		; Strip off offset ('0')
                         C      
  34FE    FE 0A          C      	cp	10		; Test range
                         C      
  3500    30 0D          C      	jr	nc,l356a	; .. overflow
                         C      
  3502    85             C      	add	a,l		; Insert digit
                         C      
  3503    6F             C      	ld	l,a
                         C      
  3504    38 06          C      	jr	c,l3567		; .. remember hi
                         C      
  3506                   C      l3561:
                         C      
  3506    10 EA          C      	djnz	l354d
                         C      
  3508    B7             C      	or	a
                         C      
  3509    C1             C      	pop	bc
                         C      
  350A    D1             C      	pop	de
                         C      
  350B    C9             C      	ret
                         C      
  350C                   C      l3567:
                         C      
  350C    24             C      	inc	h
                         C      
  350D    18 F7          C      	jr	l3561
                         C      
  350F                   C      l356a:
                         C      
  350F    37             C      	scf
                         C      
  3510    C1             C      	pop	bc
                         C      
  3511    D1             C      	pop	de
                         C      
  3512    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Input hexadecimal number from ASCII stream
                         C      
                         C      ; ENTRY	Accu holds length of string
                         C      
                         C      ;	Reg DE points to buffer
                         C      
                         C      ; EXIT	Reg HL holds number
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-192


                         C      ;	Carry set indicates conversion error
                         C      
                         C      ;
                         C      
  3513                   C      In$HEX:
                         C      
  3513    D5             C      	push	de
                         C      
  3514    C5             C      	push	bc
                         C      
  3515    EB             C      	ex	de,hl
                         C      
  3516    47             C      	ld	b,a		; Get length
                         C      
  3517    21 0000        C      	ld	hl,0		; Init result
                         C      
  351A    18 05          C      	jr	l357c
                         C      
  351C                   C      l3577:
                         C      
  351C    29             C      	add	hl,hl		; * 2
                         C      
  351D    29             C      	add	hl,hl		; * 4
                         C      
  351E    29             C      	add	hl,hl		; * 8
                         C      
  351F    29             C      	add	hl,hl		; *16
                         C      
  3520    13             C      	inc	de
                         C      
  3521                   C      l357c:
                         C      
  3521    1A             C      	ld	a,(de)		; Get character
                         C      
  3522    D6 5C          C      	sub	5ch		; .. less offset
                         C      
  3524    FE 10          C      	cp	16		; Test range
                         C      
  3526    30 E7          C      	jr	nc,l356a	; .. overflow
                         C      
  3528    B5             C      	or	l		; Insert digit
                         C      
  3529    6F             C      	ld	l,a
                         C      
  352A    10 F0          C      	djnz	l3577
                         C      
  352C    B7             C      	or	a
                         C      
  352D    C1             C      	pop	bc
                         C      
  352E    D1             C      	pop	de
                         C      
  352F    C9             C      	ret
                         C      
                         C      ;
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-193


                         C      ; Input octal number from ASCII stream
                         C      
                         C      ; ENTRY	Accu holds length of string
                         C      
                         C      ;	Reg DE points to buffer
                         C      
                         C      ; EXIT	Reg HL holds number
                         C      
                         C      ;	Carry set indicates conversion error
                         C      
                         C      ;
                         C      
  3530                   C      In$OCT:
                         C      
  3530    D5             C      	push	de
                         C      
  3531    C5             C      	push	bc
                         C      
  3532    EB             C      	ex	de,hl
                         C      
  3533    47             C      	ld	b,a		; Get length
                         C      
  3534    21 0000        C      	ld	hl,0		; Init result
                         C      
  3537    18 04          C      	jr	l3598
                         C      
  3539                   C      l3594:
                         C      
  3539    29             C      	add	hl,hl		; *2
                         C      
  353A    29             C      	add	hl,hl		; *4
                         C      
  353B    29             C      	add	hl,hl		; *8
                         C      
  353C    13             C      	inc	de
                         C      
  353D                   C      l3598:
                         C      
  353D    1A             C      	ld	a,(de)		; Get character
                         C      
  353E    D6 5C          C      	sub	5ch		; .. less offset
                         C      
  3540    FE 08          C      	cp	8		; Test range
                         C      
  3542    30 CB          C      	jr	nc,l356a	; .. overflow
                         C      
  3544    B5             C      	or	l		; Insert digit
                         C      
  3545    6F             C      	ld	l,a
                         C      
  3546    10 F1          C      	djnz	l3594
                         C      
  3548    B7             C      	or	a
                         C      
  3549    C1             C      	pop	bc
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-194


  354A    D1             C      	pop	de
                         C      
  354B    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Input binary number from ASCII stream
                         C      
                         C      ; ENTRY	Accu holds length of string
                         C      
                         C      ;	Reg DE points to buffer
                         C      
                         C      ; EXIT	Reg HL holds number
                         C      
                         C      ;	Carry set indicates conversion error
                         C      
                         C      ;
                         C      
  354C                   C      In$BIN:
                         C      
  354C    D5             C      	push	de
                         C      
  354D    C5             C      	push	bc
                         C      
  354E    EB             C      	ex	de,hl
                         C      
  354F    47             C      	ld	b,a		; Set length
                         C      
  3550    0E 5C          C      	ld	c,5ch		; .. and offset
                         C      
  3552    21 0000        C      	ld	hl,0		; Init result
                         C      
  3555                   C      l35b0:
                         C      
  3555    1A             C      	ld	a,(de)		; Get character
                         C      
  3556    13             C      	inc	de
                         C      
  3557    91             C      	sub	c		; .. less offset
                         C      
  3558    CB 1F          C      	rr	a		; Get bit
                         C      
  355A    20 B3          C      	jr	nz,l356a	; .. invalid range
                         C      
  355C    ED 6A          C      	adc	hl,hl		; *2
                         C      
  355E    10 F5          C      	djnz	l35b0
                         C      
  3560    B7             C      	or	a
                         C      
  3561    C1             C      	pop	bc
                         C      
  3562    D1             C      	pop	de
                         C      
  3563    C9             C      	ret
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-195


                         C      ;
                         C      
                         C      ; Input any based number from ASCII stream
                         C      
                         C      ; ENTRY	Accu holds length of string
                         C      
                         C      ;	Reg DE points to buffer
                         C      
                         C      ; EXIT	Reg HL holds number
                         C      
                         C      ;	Carry set indicates conversion error
                         C      
                         C      ;
                         C      
  3564                   C      In$NUM:
                         C      
  3564    D5             C      	push	de
                         C      
  3565    C5             C      	push	bc
                         C      
  3566    EB             C      	ex	de,hl
                         C      
  3567    47             C      	ld	b,a		; Get length
                         C      
  3568    3A 6615        C      	ld	a,(Radix)	; .. radix
                         C      
  356B    4F             C      	ld	c,a
                         C      
  356C    21 0000        C      	ld	hl,0		; Init number
                         C      
  356F    18 0B          C      	jr	l35d7
                         C      
  3571                   C      l35cc:
                         C      
  3571    D5             C      	push	de
                         C      
  3572    C5             C      	push	bc
                         C      
  3573    16 00          C      	ld	d,0
                         C      
  3575    59             C      	ld	e,c
                         C      
  3576    CD 39CE        C      	call	Multiply	; Multiply by radix
                         C      
  3579    C1             C      	pop	bc
                         C      
  357A    D1             C      	pop	de
                         C      
  357B    13             C      	inc	de
                         C      
  357C                   C      l35d7:
                         C      
  357C    1A             C      	ld	a,(de)		; Get character
                         C      
  357D    D6 5C          C      	sub	5ch		; .. less offset
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-196


  357F    B9             C      	cp	c		; Test range
                         C      
  3580    30 8D          C      	jr	nc,l356a	; .. overflow
                         C      
  3582    85             C      	add	a,l		; Insert digit
                         C      
  3583    6F             C      	ld	l,a
                         C      
  3584    30 01          C      	jr	nc,l35e2	; .. remember hi
                         C      
  3586    24             C      	inc	h
                         C      
  3587                   C      l35e2:
                         C      
  3587    10 E8          C      	djnz	l35cc
                         C      
  3589    B7             C      	or	a
                         C      
  358A    C1             C      	pop	bc
                         C      
  358B    D1             C      	pop	de
                         C      
  358C    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  358D                   C      l35e8:
                         C      
  358D    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3590                   C      l35eb:
                         C      
  3590    FE 39          C      	cp	39h
                         C      
  3592    20 21          C      	jr	nz,l3610
                         C      
  3594    CD 42DD        C      	call	l4338
                         C      
  3597    ED 5B 62F5     C      	ld	de,(TokPtr)	; Get token pointer
                         C      
  359B    13             C      	inc	de
                         C      
  359C    1A             C      	ld	a,(de)
                         C      
  359D    FE 34          C      	cp	34h		; Test #
                         C      
  359F    3E 39          C      	ld	a,39h
                         C      
  35A1    28 46          C      	jr	z,l3644		; .. yeap
                         C      
  35A3    7E             C      	ld	a,(hl)
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-197


  35A4                   C      l35ff:
                         C      
  35A4    47             C      	ld	b,a
                         C      
  35A5    E6 0F          C      	and	0fh
                         C      
  35A7    FE 0F          C      	cp	0fh
                         C      
  35A9    28 19          C      	jr	z,l361f
                         C      
  35AB    78             C      	ld	a,b
                         C      
  35AC    B7             C      	or	a
                         C      
  35AD    FA 35BC        C      	jp	m,l3617
                         C      
  35B0    CD 633D        C      	call	l63b0
                         C      
  35B3    18 EF          C      	jr	l35ff
                         C      
  35B5                   C      l3610:
                         C      
  35B5    FE 38          C      	cp	38h
                         C      
  35B7    20 30          C      	jr	nz,l3644
                         C      
  35B9    AF             C      	xor	a
                         C      
  35BA    18 08          C      	jr	l361f
                         C      
  35BC                   C      l3617:
                         C      
  35BC    7E             C      	ld	a,(hl)
                         C      
  35BD    23             C      	inc	hl
                         C      
  35BE    5E             C      	ld	e,(hl)
                         C      
  35BF    23             C      	inc	hl
                         C      
  35C0                   C      l361b:
                         C      
  35C0    56             C      	ld	d,(hl)
                         C      
  35C1    EB             C      	ex	de,hl
                         C      
  35C2    E6 0F          C      	and	0fh
                         C      
  35C4                   C      l361f:
                         C      
  35C4    22 6407        C      	ld	(l647a),hl
                         C      
  35C7    32 6406        C      	ld	(l6479),a
                         C      
  35CA    CD 0DE2        C      	call	GetToken	; Get token
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-198


  35CD    FE 36          C      	cp	36h
                         C      
  35CF    28 08          C      	jr	z,l3634
                         C      
  35D1    FE 50          C      	cp	50h
                         C      
  35D3    28 04          C      	jr	z,l3634
                         C      
  35D5    FE 52          C      	cp	52h
                         C      
  35D7    20 21          C      	jr	nz,l3655
                         C      
  35D9                   C      l3634:
                         C      
  35D9    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
                         C      
  35DC    2B             C      	dec	hl
                         C      
  35DD    22 62F5        C      	ld	(TokPtr),hl	; .. to token pointer
                         C      
  35E0    AF             C      	xor	a
                         C      
  35E1    32 660C        C      	ld	(l667f),a
                         C      
  35E4    3D             C      	dec	a
                         C      
  35E5    32 6409        C      	ld	(l647c),a
                         C      
  35E8    C9             C      	ret
                         C      
  35E9                   C      l3644:
                         C      
  35E9    DD 22 36F2     C      	ld	(l374d),ix
                         C      
  35ED    DD 21 6406     C      	ld	ix,l6479
                         C      
  35F1    ED 73 3BB7     C      	ld	(l3c12),sp
                         C      
  35F5    CD 3A66        C      	call	l3ac1
                         C      
  35F8    18 28          C      	jr	l367d
                         C      
  35FA                   C      l3655:
                         C      
  35FA    DD 22 36F2     C      	ld	(l374d),ix
                         C      
  35FE    DD 21 6409     C      	ld	ix,l647c
                         C      
  3602    ED 73 3BB7     C      	ld	(l3c12),sp
                         C      
  3606    11 3634        C      	ld	de,l368f
                         C      
  3609    D5             C      	push	de
                         C      
  360A    F5             C      	push	af
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-199


  360B    3A 6406        C      	ld	a,(l6479)
                         C      
  360E    F6 90          C      	or	90h
                         C      
  3610    32 6406        C      	ld	(l6479),a
                         C      
  3613    AF             C      	xor	a
                         C      
  3614    32 3709        C      	ld	(l3764),a
                         C      
  3617    32 660C        C      	ld	(l667f),a
                         C      
  361A    C1             C      	pop	bc
                         C      
  361B    F5             C      	push	af
                         C      
  361C    78             C      	ld	a,b
                         C      
  361D    CD 3B2F        C      	call	l3b8a
                         C      
  3620    18 58          C      	jr	l36d5
                         C      
  3622                   C      l367d:
                         C      
  3622    47             C      	ld	b,a
                         C      
  3623    AF             C      	xor	a
                         C      
  3624    32 3709        C      	ld	(l3764),a
                         C      
  3627    32 660C        C      	ld	(l667f),a
                         C      
  362A    78             C      	ld	a,b
                         C      
  362B    FE 55          C      	cp	55h
                         C      
  362D    20 05          C      	jr	nz,l368f
                         C      
  362F    21 660C        C      	ld	hl,l667f
                         C      
  3632    CB C6          C      	set	0,(hl)
                         C      
  3634                   C      l368f:
                         C      
  3634    11 3634        C      	ld	de,l368f
                         C      
  3637    D5             C      	push	de
                         C      
  3638    11 3673        C      	ld	de,l36ce
                         C      
  363B                   C      l3696:
                         C      
  363B    D5             C      	push	de
                         C      
  363C    FE 10          C      	cp	10h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-200


  363E    D8             C      	ret	c
                         C      
  363F    E1             C      	pop	hl
                         C      
  3640    FE 55          C      	cp	55h
                         C      
  3642    28 0F          C      	jr	z,l36ae
                         C      
  3644    C6 76          C      	add	a,76h
                         C      
  3646    F5             C      	push	af
                         C      
  3647    CD 3A63        C      	call	l3abe
                         C      
  364A                   C      l36a5:
                         C      
  364A    11 364A        C      	ld	de,l36a5
                         C      
  364D    D5             C      	push	de
                         C      
  364E    11 370A        C      	ld	de,l3765
                         C      
  3651    18 E8          C      	jr	l3696
                         C      
  3653                   C      l36ae:
                         C      
  3653    21 3709        C      	ld	hl,l3764
                         C      
  3656    7E             C      	ld	a,(hl)
                         C      
  3657    F5             C      	push	af
                         C      
  3658    36 00          C      	ld	(hl),0
                         C      
  365A    CD 3A63        C      	call	l3abe
                         C      
  365D                   C      l36b8:
                         C      
  365D    11 365D        C      	ld	de,l36b8
                         C      
  3660    D5             C      	push	de
                         C      
  3661    11 369D        C      	ld	de,l36f8
                         C      
  3664    18 D5          C      	jr	l3696
                         C      
  3666                   C      l36c1:
                         C      
  3666    F5             C      	push	af
                         C      
  3667    CD 3A63        C      	call	l3abe
                         C      
  366A                   C      l36c5:
                         C      
  366A    11 366A        C      	ld	de,l36c5
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-201


  366D    D5             C      	push	de
                         C      
  366E    11 3673        C      	ld	de,l36ce
                         C      
  3671    18 C8          C      	jr	l3696
                         C      
  3673                   C      l36ce:
                         C      
  3673    3A 3709        C      	ld	a,(l3764)
                         C      
  3676                   C      l36d1:
                         C      
  3676    F5             C      	push	af
                         C      
  3677    CD 3B2C        C      	call	l3b87
                         C      
  367A                   C      l36d5:
                         C      
  367A    FE 50          C      	cp	50h
                         C      
  367C    28 3D          C      	jr	z,l3716
                         C      
  367E    FE 52          C      	cp	52h
                         C      
  3680    28 39          C      	jr	z,l3716
                         C      
  3682    11 3676        C      	ld	de,l36d1
                         C      
  3685    D5             C      	push	de
                         C      
  3686                   C      l36e1:
                         C      
  3686    D6 3A          C      	sub	3ah		; Strip off offset
                         C      
  3688    21 36F4        C      	ld	hl,l374f
                         C      
  368B    5F             C      	ld	e,a
                         C      
  368C    16 00          C      	ld	d,0
                         C      
  368E    19             C      	add	hl,de		; Point to table
                         C      
  368F    4E             C      	ld	c,(hl)
                         C      
  3690    21 3709        C      	ld	hl,l3764
                         C      
  3693    7E             C      	ld	a,(hl)
                         C      
  3694    71             C      	ld	(hl),c
                         C      
  3695    B9             C      	cp	c
                         C      
  3696    30 22          C      	jr	nc,l3715
                         C      
  3698    7B             C      	ld	a,e
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-202


  3699    C6 3A          C      	add	a,3ah		; .. get old
                         C      
  369B    18 C9          C      	jr	l36c1
                         C      
  369D                   C      l36f8:
                         C      
  369D    3A 3709        C      	ld	a,(l3764)
                         C      
  36A0                   C      l36fb:
                         C      
  36A0    F5             C      	push	af
                         C      
  36A1    CD 3B2C        C      	call	l3b87
                         C      
  36A4    FE 52          C      	cp	52h		; Test ]
                         C      
  36A6    28 0B          C      	jr	z,l370e
                         C      
  36A8    FE 50          C      	cp	50h		; .. ,
                         C      
  36AA    CA 3B33        C      	jp	z,l3b8e
                         C      
  36AD    11 36A0        C      	ld	de,l36fb
                         C      
  36B0    D5             C      	push	de
                         C      
  36B1    18 D3          C      	jr	l36e1
                         C      
  36B3                   C      l370e:
                         C      
  36B3    F1             C      	pop	af
                         C      
  36B4    D1             C      	pop	de
                         C      
  36B5    F1             C      	pop	af
                         C      
  36B6    32 3709        C      	ld	(l3764),a
                         C      
  36B9    C9             C      	ret
                         C      
  36BA                   C      l3715:
                         C      
  36BA    D1             C      	pop	de
                         C      
  36BB                   C      l3716:
                         C      
  36BB    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
                         C      
  36BE    2B             C      	dec	hl
                         C      
  36BF    22 62F5        C      	ld	(TokPtr),hl	; .. to token pointer
                         C      
  36C2    F1             C      	pop	af
                         C      
  36C3    B7             C      	or	a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-203


  36C4    D1             C      	pop	de
                         C      
  36C5    28 0C          C      	jr	z,l372e
                         C      
  36C7    F1             C      	pop	af
                         C      
  36C8    C6 76          C      	add	a,76h
                         C      
  36CA    CD 37A5        C      	call	l3800
                         C      
  36CD    E1             C      	pop	hl
                         C      
  36CE    F1             C      	pop	af
                         C      
  36CF    32 3709        C      	ld	(l3764),a
                         C      
  36D2    E9             C      	jp	(hl)
                         C      
  36D3                   C      l372e:
                         C      
  36D3    7E             C      	ld	a,(hl)
                         C      
  36D4    FE 52          C      	cp	52h		; Test ]
                         C      
  36D6    20 05          C      	jr	nz,l3738
                         C      
  36D8    21 660C        C      	ld	hl,l667f
                         C      
  36DB    CB CE          C      	set	1,(hl)
                         C      
  36DD                   C      l3738:
                         C      
  36DD    DD 36 00 FF    C      	ld	(ix+0),0ffh
                         C      
  36E1    DD 2A 36F2     C      	ld	ix,(l374d)
                         C      
  36E5    3A 6409        C      	ld	a,(l647c)
                         C      
  36E8    3C             C      	inc	a
                         C      
  36E9    C0             C      	ret	nz
                         C      
  36EA    21 6406        C      	ld	hl,l6479
                         C      
  36ED    7E             C      	ld	a,(hl)
                         C      
  36EE    E6 0F          C      	and	0fh
                         C      
  36F0    77             C      	ld	(hl),a
                         C      
  36F1    C9             C      	ret
                         C      
  36F2                   C      l374d:
                         C      
  36F2    0000           C      	dw	0
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-204


  36F4                   C      l374f:
                         C      
  36F4    04             C      	db	4		; 3A : +
                         C      
  36F5    04             C      	db	4		; 3B : -
                         C      
  36F6    05             C      	db	5		; 3C : *
                         C      
  36F7    05             C      	db	5		; 3D : /
                         C      
  36F8    05             C      	db	5		; 3E
                         C      
  36F9    02             C      	db	2		; 3F : &
                         C      
  36FA    01             C      	db	1		; 40 : |
                         C      
  36FB    01             C      	db	1		; 41
                         C      
  36FC    05             C      	db	5		; 42
                         C      
  36FD    05             C      	db	5		; 43
                         C      
  36FE    00             C      	db	0		; 44 : ~
                         C      
  36FF    00             C      	db	0		; 45
                         C      
  3700    00             C      	db	0		; 46
                         C      
  3701    00             C      	db	0		; 47
                         C      
  3702    00             C      	db	0		; 48
                         C      
  3703    03             C      	db	3		; 49 : <
                         C      
  3704    03             C      	db	3		; 4A
                         C      
  3705    03             C      	db	3		; 4B
                         C      
  3706    03             C      	db	3		; 4C
                         C      
  3707    03             C      	db	3		; 4D
                         C      
  3708    03             C      	db	3		; 4E
                         C      
  3709                   C      l3764:
                         C      
  3709    00             C      	db	0
                         C      
  370A                   C      l3765:
                         C      
  370A    F1             C      	pop	af
                         C      
  370B    F1             C      	pop	af
                         C      
  370C    CD 37A5        C      	call	l3800
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-205


  370F    AF             C      	xor	a
                         C      
  3710    C9             C      	ret
                         C      
  3711                   C      l376c:
                         C      
  3711    4F             C      	ld	c,a
                         C      
  3712    3A 6305        C      	ld	a,(l6378)
                         C      
  3715    B7             C      	or	a
                         C      
  3716    20 23          C      	jr	nz,l3796
                         C      
  3718    2A 6306        C      	ld	hl,(l6379)
                         C      
  371B    79             C      	ld	a,c
                         C      
  371C    D6 BA          C      	sub	0bah
                         C      
  371E    28 0C          C      	jr	z,l3787
                         C      
  3720    3D             C      	dec	a
                         C      
  3721    28 08          C      	jr	z,l3786
                         C      
  3723    3D             C      	dec	a
                         C      
  3724    20 01          C      	jr	nz,l3782
                         C      
  3726    6C             C      	ld	l,h
                         C      
  3727                   C      l3782:
                         C      
  3727    26 00          C      	ld	h,0
                         C      
  3729    18 07          C      	jr	l378d
                         C      
  372B                   C      l3786:
                         C      
  372B    2B             C      	dec	hl
                         C      
  372C                   C      l3787:
                         C      
  372C    7C             C      	ld	a,h
                         C      
  372D    2F             C      	cpl
                         C      
  372E    67             C      	ld	h,a
                         C      
  372F    7D             C      	ld	a,l
                         C      
  3730    2F             C      	cpl
                         C      
  3731    6F             C      	ld	l,a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-206


  3732                   C      l378d:
                         C      
  3732    22 6306        C      	ld	(l6379),hl
                         C      
  3735                   C      l3790:
                         C      
  3735    21 6305        C      	ld	hl,l6378
                         C      
  3738    C3 3921        C      	jp	l397c
                         C      
  373B                   C      l3796:
                         C      
  373B    79             C      	ld	a,c
                         C      
  373C    F5             C      	push	af
                         C      
  373D    C3 3918        C      	jp	l3973
                         C      
  3740                   C      l379b:
                         C      
  3740    11 6305        C      	ld	de,l6378
                         C      
  3743    CD 385E        C      	call	l38b9
                         C      
  3746    38 2C          C      	jr	c,l37cf
                         C      
  3748    3A 6305        C      	ld	a,(l6378)
                         C      
  374B    FE 0F          C      	cp	0fh
                         C      
  374D    20 11          C      	jr	nz,l37bb
                         C      
  374F    2A 6306        C      	ld	hl,(l6379)
                         C      
  3752    CD 4302        C      	call	l435d
                         C      
  3755    7E             C      	ld	a,(hl)
                         C      
  3756    E6 0F          C      	and	0fh
                         C      
  3758    FE 0F          C      	cp	0fh
                         C      
  375A    20 28          C      	jr	nz,l37df
                         C      
  375C    3E 80          C      	ld	a,80h
                         C      
  375E    18 08          C      	jr	l37c3
                         C      
  3760                   C      l37bb:
                         C      
  3760    FE 04          C      	cp	4
                         C      
  3762    38 02          C      	jr	c,l37c1
                         C      
  3764    3E 03          C      	ld	a,3
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-207


  3766                   C      l37c1:
                         C      
  3766    F6 20          C      	or	20h
                         C      
  3768                   C      l37c3:
                         C      
  3768    6F             C      	ld	l,a
                         C      
  3769    AF             C      	xor	a
                         C      
  376A    67             C      	ld	h,a
                         C      
  376B    32 6305        C      	ld	(l6378),a
                         C      
  376E    AF             C      	xor	a
                         C      
  376F    32 6790        C      	ld	(l6803),a
                         C      
  3772    18 BE          C      	jr	l378d
                         C      
  3774                   C      l37cf:
                         C      
  3774    06 01          C      	ld	b,1
                         C      
  3776    18 0F          C      	jr	l37e2
                         C      
  3778                   C      l37d3:
                         C      
  3778    C5             C      	push	bc
                         C      
  3779    11 6305        C      	ld	de,l6378
                         C      
  377C    CD 385E        C      	call	l38b9
                         C      
  377F    C1             C      	pop	bc
                         C      
  3780    38 05          C      	jr	c,l37e2
                         C      
  3782    10 F4          C      	djnz	l37d3
                         C      
  3784                   C      l37df:
                         C      
  3784    AF             C      	xor	a
                         C      
  3785    18 E1          C      	jr	l37c3
                         C      
  3787                   C      l37e2:
                         C      
  3787    FE BA          C      	cp	0bah
                         C      
  3789    38 05          C      	jr	c,l37eb
                         C      
  378B    FE BE          C      	cp	0beh
                         C      
  378D    30 01          C      	jr	nc,l37eb
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-208


  378F    05             C      	dec	b
                         C      
  3790                   C      l37eb:
                         C      
  3790    04             C      	inc	b
                         C      
  3791    11 FFFD        C      	ld	de,lfffd
                         C      
  3794    DD 19          C      	add	ix,de
                         C      
  3796    18 E0          C      	jr	l37d3
                         C      
  3798                   C      l37f3:
                         C      
  3798    CD 3735        C      	call	l3790
                         C      
  379B                   C      l37f6:
                         C      
  379B    F1             C      	pop	af
                         C      
  379C                   C      l37f7:
                         C      
  379C    DD 77 00       C      	ld	(ix+0),a
                         C      
  379F    01 0003        C      	ld	bc,l0003
                         C      
  37A2    DD 09          C      	add	ix,bc
                         C      
  37A4    C9             C      	ret
                         C      
  37A5                   C      l3800:
                         C      
  37A5    FE C5          C      	cp	0c5h
                         C      
  37A7    28 97          C      	jr	z,l379b
                         C      
  37A9    F5             C      	push	af
                         C      
  37AA    11 6305        C      	ld	de,l6378
                         C      
  37AD    CD 385E        C      	call	l38b9
                         C      
  37B0    38 E9          C      	jr	c,l37f6
                         C      
  37B2    F1             C      	pop	af
                         C      
  37B3    FE BA          C      	cp	0bah
                         C      
  37B5    38 05          C      	jr	c,l3817
                         C      
  37B7    FE BE          C      	cp	0beh
                         C      
  37B9    DA 3711        C      	jp	c,l376c
                         C      
  37BC                   C      l3817:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-209


  37BC    F5             C      	push	af
                         C      
  37BD    11 62FC        C      	ld	de,l636f
                         C      
  37C0    CD 385E        C      	call	l38b9
                         C      
  37C3    38 D3          C      	jr	c,l37f3
                         C      
  37C5    2A 62FD        C      	ld	hl,(l6370)
                         C      
  37C8    3A 62FC        C      	ld	a,(l636f)
                         C      
  37CB    47             C      	ld	b,a
                         C      
  37CC    ED 5B 6306     C      	ld	de,(l6379)
                         C      
  37D0    3A 6305        C      	ld	a,(l6378)
                         C      
  37D3    4F             C      	ld	c,a
                         C      
  37D4    F1             C      	pop	af
                         C      
  37D5    D6 B0          C      	sub	0b0h
                         C      
  37D7    C2 38AD        C      	jp	nz,l3908
                         C      
  37DA    79             C      	ld	a,c
                         C      
  37DB    FE 0F          C      	cp	0fh
                         C      
  37DD    28 1F          C      	jr	z,l3859
                         C      
  37DF    78             C      	ld	a,b
                         C      
  37E0    FE 0F          C      	cp	0fh
                         C      
  37E2    28 2F          C      	jr	z,l386e
                         C      
  37E4    B7             C      	or	a
                         C      
  37E5    79             C      	ld	a,c
                         C      
  37E6    28 04          C      	jr	z,l3847
                         C      
  37E8    B7             C      	or	a
                         C      
  37E9    20 6E          C      	jr	nz,l38b4
                         C      
  37EB    78             C      	ld	a,b
                         C      
  37EC                   C      l3847:
                         C      
  37EC    19             C      	add	hl,de
                         C      
  37ED                   C      l3848:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-210


  37ED    F6 90          C      	or	90h
                         C      
  37EF    DD 77 00       C      	ld	(ix+0),a
                         C      
  37F2    DD 75 01       C      	ld	(ix+1),l
                         C      
  37F5    DD 74 02       C      	ld	(ix+2),h
                         C      
  37F8    01 0003        C      	ld	bc,l0003
                         C      
  37FB    DD 09          C      	add	ix,bc
                         C      
  37FD    C9             C      	ret
                         C      
  37FE                   C      l3859:
                         C      
  37FE    78             C      	ld	a,b
                         C      
  37FF    FE 0F          C      	cp	0fh
                         C      
  3801    30 51          C      	jr	nc,l38af
                         C      
  3803    E5             C      	push	hl
                         C      
  3804    C5             C      	push	bc
                         C      
  3805    21 6305        C      	ld	hl,l6378
                         C      
  3808    11 62FC        C      	ld	de,l636f
                         C      
  380B    01 0009        C      	ld	bc,l0009
                         C      
  380E    ED B0          C      	ldir
                         C      
  3810    C1             C      	pop	bc
                         C      
  3811    D1             C      	pop	de
                         C      
  3812    48             C      	ld	c,b
                         C      
  3813                   C      l386e:
                         C      
  3813    79             C      	ld	a,c
                         C      
  3814    B7             C      	or	a
                         C      
  3815    20 0D          C      	jr	nz,l387f
                         C      
  3817                   C      l3872:
                         C      
  3817    2A 6300        C      	ld	hl,(l6373)
                         C      
  381A    19             C      	add	hl,de
                         C      
  381B                   C      l3876:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-211


  381B    22 6300        C      	ld	(l6373),hl
                         C      
  381E                   C      l3879:
                         C      
  381E    21 62FC        C      	ld	hl,l636f
                         C      
  3821    C3 3921        C      	jp	l397c
                         C      
  3824                   C      l387f:
                         C      
  3824    3A 62FF        C      	ld	a,(l6372)
                         C      
  3827    B7             C      	or	a
                         C      
  3828    20 06          C      	jr	nz,l388b
                         C      
  382A    79             C      	ld	a,c
                         C      
  382B    32 62FF        C      	ld	(l6372),a
                         C      
  382E    18 E7          C      	jr	l3872
                         C      
  3830                   C      l388b:
                         C      
  3830    3A 6302        C      	ld	a,(l6375)
                         C      
  3833    91             C      	sub	c
                         C      
  3834    20 0D          C      	jr	nz,l389e
                         C      
  3836    2A 6303        C      	ld	hl,(l6376)
                         C      
  3839    ED 52          C      	sbc	hl,de
                         C      
  383B                   C      l3896:
                         C      
  383B    32 6302        C      	ld	(l6375),a
                         C      
  383E    22 6303        C      	ld	(l6376),hl
                         C      
  3841    18 DB          C      	jr	l3879
                         C      
  3843                   C      l389e:
                         C      
  3843    21 6305        C      	ld	hl,l6378
                         C      
  3846    CD 3921        C      	call	l397c
                         C      
  3849    21 62FC        C      	ld	hl,l636f
                         C      
  384C    CD 3921        C      	call	l397c
                         C      
  384F    3E B0          C      	ld	a,0b0h
                         C      
  3851    C3 379C        C      	jp	l37f7
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-212


  3854                   C      l38af:
                         C      
  3854    3E B0          C      	ld	a,0b0h
                         C      
  3856    C3 3911        C      	jp	l396c
                         C      
  3859                   C      l38b4:
                         C      
  3859    3E B0          C      	ld	a,0b0h
                         C      
  385B    C3 3911        C      	jp	l396c
                         C      
  385E                   C      l38b9:
                         C      
  385E    62             C      	ld	h,d
                         C      
  385F    6B             C      	ld	l,e
                         C      
  3860    01 0008        C      	ld	bc,l0009-1
                         C      
  3863    36 00          C      	ld	(hl),0
                         C      
  3865    D5             C      	push	de
                         C      
  3866    13             C      	inc	de
                         C      
  3867    ED B0          C      	ldir
                         C      
  3869    D1             C      	pop	de
                         C      
  386A    DD E5          C      	push	ix
                         C      
  386C    E1             C      	pop	hl
                         C      
  386D    CD 3883        C      	call	l38de
                         C      
  3870    D8             C      	ret	c
                         C      
  3871                   C      l38cc:
                         C      
  3871    FE 90          C      	cp	90h
                         C      
  3873    38 04          C      	jr	c,l38d4
                         C      
  3875    FE A0          C      	cp	0a0h
                         C      
  3877    38 05          C      	jr	c,l38d9
                         C      
  3879                   C      l38d4:
                         C      
  3879    CD 3883        C      	call	l38de
                         C      
  387C    18 F3          C      	jr	l38cc
                         C      
  387E                   C      l38d9:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-213


  387E    E5             C      	push	hl
                         C      
  387F    DD E1          C      	pop	ix
                         C      
  3881    B7             C      	or	a
                         C      
  3882    C9             C      	ret
                         C      
  3883                   C      l38de:
                         C      
  3883    D5             C      	push	de
                         C      
  3884    2B             C      	dec	hl
                         C      
  3885    2B             C      	dec	hl
                         C      
  3886    2B             C      	dec	hl
                         C      
  3887    7E             C      	ld	a,(hl)
                         C      
  3888    FE 90          C      	cp	90h
                         C      
  388A    38 0E          C      	jr	c,l38f5
                         C      
  388C    FE A0          C      	cp	0a0h
                         C      
  388E    38 0D          C      	jr	c,l38f8
                         C      
  3890    FE B0          C      	cp	0b0h
                         C      
  3892    38 03          C      	jr	c,l38f2
                         C      
  3894    D1             C      	pop	de
                         C      
  3895    37             C      	scf
                         C      
  3896    C9             C      	ret
                         C      
  3897                   C      l38f2:
                         C      
  3897    13             C      	inc	de
                         C      
  3898    13             C      	inc	de
                         C      
  3899    13             C      	inc	de
                         C      
  389A                   C      l38f5:
                         C      
  389A    13             C      	inc	de
                         C      
  389B    13             C      	inc	de
                         C      
  389C    13             C      	inc	de
                         C      
  389D                   C      l38f8:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-214


  389D    F5             C      	push	af
                         C      
  389E    E6 0F          C      	and	0fh
                         C      
  38A0    12             C      	ld	(de),a
                         C      
  38A1    E5             C      	push	hl
                         C      
  38A2    23             C      	inc	hl
                         C      
  38A3    13             C      	inc	de
                         C      
  38A4    ED A0          C      	ldi
                         C      
  38A6    ED A0          C      	ldi
                         C      
  38A8    E1             C      	pop	hl
                         C      
  38A9    F1             C      	pop	af
                         C      
  38AA    D1             C      	pop	de
                         C      
  38AB    B7             C      	or	a
                         C      
  38AC    C9             C      	ret
                         C      
  38AD                   C      l3908:
                         C      
  38AD    3D             C      	dec	a
                         C      
  38AE    20 45          C      	jr	nz,l3950
                         C      
  38B0    78             C      	ld	a,b
                         C      
  38B1    FE 0F          C      	cp	0fh
                         C      
  38B3    30 17          C      	jr	nc,l3927
                         C      
  38B5    79             C      	ld	a,c
                         C      
  38B6    B7             C      	or	a
                         C      
  38B7    20 07          C      	jr	nz,l391b
                         C      
  38B9    78             C      	ld	a,b
                         C      
  38BA    B7             C      	or	a
                         C      
  38BB                   C      l3916:
                         C      
  38BB    ED 52          C      	sbc	hl,de
                         C      
  38BD    C3 37ED        C      	jp	l3848
                         C      
  38C0                   C      l391b:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-215


  38C0    FE 0F          C      	cp	0fh
                         C      
  38C2    30 03          C      	jr	nc,l3922
                         C      
  38C4    90             C      	sub	b
                         C      
  38C5    28 F4          C      	jr	z,l3916
                         C      
  38C7                   C      l3922:
                         C      
  38C7    3E B1          C      	ld	a,0b1h
                         C      
  38C9    C3 3911        C      	jp	l396c
                         C      
  38CC                   C      l3927:
                         C      
  38CC    79             C      	ld	a,c
                         C      
  38CD    FE 0F          C      	cp	0fh
                         C      
  38CF    30 F6          C      	jr	nc,l3922
                         C      
  38D1    B7             C      	or	a
                         C      
  38D2    20 08          C      	jr	nz,l3937
                         C      
  38D4                   C      l392f:
                         C      
  38D4    2A 6300        C      	ld	hl,(l6373)
                         C      
  38D7    ED 52          C      	sbc	hl,de
                         C      
  38D9    C3 381B        C      	jp	l3876
                         C      
  38DC                   C      l3937:
                         C      
  38DC    3A 62FF        C      	ld	a,(l6372)
                         C      
  38DF    91             C      	sub	c
                         C      
  38E0    20 05          C      	jr	nz,l3942
                         C      
  38E2    32 62FF        C      	ld	(l6372),a
                         C      
  38E5    18 ED          C      	jr	l392f
                         C      
  38E7                   C      l3942:
                         C      
  38E7    3A 6302        C      	ld	a,(l6375)
                         C      
  38EA    B7             C      	or	a
                         C      
  38EB    20 DA          C      	jr	nz,l3922
                         C      
  38ED    79             C      	ld	a,c
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-216


  38EE    2A 6303        C      	ld	hl,(l6376)
                         C      
  38F1    19             C      	add	hl,de
                         C      
  38F2    C3 383B        C      	jp	l3896
                         C      
  38F5                   C      l3950:
                         C      
  38F5    F5             C      	push	af
                         C      
  38F6    78             C      	ld	a,b
                         C      
  38F7    B1             C      	or	c		; Test zero ???
                         C      
  38F8    20 14          C      	jr	nz,l3969	; .. nope
                         C      
  38FA    F1             C      	pop	af
                         C      
  38FB    87             C      	add	a,a		; Double index
                         C      
  38FC    CD 3902        C      	call	l395d		; .. do math
                         C      
  38FF    C3 37ED        C      	jp	l3848
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  3902                   C      l395d:
                         C      
  3902    E5             C      	push	hl		; Save entry
                         C      
  3903    4F             C      	ld	c,a		; Get index
                         C      
  3904    21 396B        C      	ld	hl,l39c8-2
                         C      
  3907    09             C      	add	hl,bc
                         C      
  3908    7E             C      	ld	a,(hl)		; Fetch address
                         C      
  3909    23             C      	inc	hl
                         C      
  390A    66             C      	ld	h,(hl)
                         C      
  390B    6F             C      	ld	l,a
                         C      
  390C    E3             C      	ex	(sp),hl		; .. as return
                         C      
  390D    C9             C      	ret			; .. go
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-217


                         C      ;
                         C      
  390E                   C      l3969:
                         C      
  390E    F1             C      	pop	af
                         C      
  390F    C6 B1          C      	add	a,0b1h
                         C      
  3911                   C      l396c:
                         C      
  3911    F5             C      	push	af
                         C      
  3912    21 62FC        C      	ld	hl,l636f
                         C      
  3915    CD 3921        C      	call	l397c
                         C      
  3918                   C      l3973:
                         C      
  3918    21 6305        C      	ld	hl,l6378
                         C      
  391B    CD 3921        C      	call	l397c
                         C      
  391E    C3 379B        C      	jp	l37f6
                         C      
  3921                   C      l397c:
                         C      
  3921    DD E5          C      	push	ix
                         C      
  3923    D1             C      	pop	de
                         C      
  3924    7E             C      	ld	a,(hl)
                         C      
  3925    F6 90          C      	or	90h
                         C      
  3927    12             C      	ld	(de),a
                         C      
  3928    23             C      	inc	hl
                         C      
  3929    13             C      	inc	de
                         C      
  392A    ED A0          C      	ldi
                         C      
  392C    ED A0          C      	ldi
                         C      
  392E    FE 9F          C      	cp	9fh
                         C      
  3930    20 2F          C      	jr	nz,l39bc
                         C      
  3932    7E             C      	ld	a,(hl)
                         C      
  3933    23             C      	inc	hl
                         C      
  3934    4E             C      	ld	c,(hl)
                         C      
  3935    23             C      	inc	hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-218


  3936    46             C      	ld	b,(hl)
                         C      
  3937    B7             C      	or	a
                         C      
  3938    23             C      	inc	hl
                         C      
  3939    20 05          C      	jr	nz,l399b
                         C      
  393B    B0             C      	or	b
                         C      
  393C    B1             C      	or	c
                         C      
  393D    28 0B          C      	jr	z,l39a5
                         C      
  393F    AF             C      	xor	a
                         C      
  3940                   C      l399b:
                         C      
  3940    F6 80          C      	or	80h
                         C      
  3942    12             C      	ld	(de),a
                         C      
  3943    13             C      	inc	de
                         C      
  3944    79             C      	ld	a,c
                         C      
  3945    12             C      	ld	(de),a
                         C      
  3946    13             C      	inc	de
                         C      
  3947    78             C      	ld	a,b
                         C      
  3948    12             C      	ld	(de),a
                         C      
  3949    13             C      	inc	de
                         C      
  394A                   C      l39a5:
                         C      
  394A    7E             C      	ld	a,(hl)
                         C      
  394B    23             C      	inc	hl
                         C      
  394C    4E             C      	ld	c,(hl)
                         C      
  394D    23             C      	inc	hl
                         C      
  394E    46             C      	ld	b,(hl)
                         C      
  394F    B7             C      	or	a
                         C      
  3950    20 05          C      	jr	nz,l39b2
                         C      
  3952    B0             C      	or	b
                         C      
  3953    B1             C      	or	c
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-219


  3954    28 0B          C      	jr	z,l39bc
                         C      
  3956    AF             C      	xor	a
                         C      
  3957                   C      l39b2:
                         C      
  3957    F6 A0          C      	or	0a0h
                         C      
  3959    12             C      	ld	(de),a
                         C      
  395A    13             C      	inc	de
                         C      
  395B    79             C      	ld	a,c
                         C      
  395C    12             C      	ld	(de),a
                         C      
  395D    13             C      	inc	de
                         C      
  395E    78             C      	ld	a,b
                         C      
  395F    12             C      	ld	(de),a
                         C      
  3960    13             C      	inc	de
                         C      
  3961                   C      l39bc:
                         C      
  3961    D5             C      	push	de
                         C      
  3962    DD E1          C      	pop	ix
                         C      
  3964    C9             C      	ret
                         C      
  3965                   C      l39c0:
                         C      
  3965    7D             C      	ld	a,l
                         C      
  3966    CD 6322        C      	call	l6395
                         C      
  3969    7C             C      	ld	a,h
                         C      
  396A    C3 6322        C      	jp	l6395
                         C      
                         C      ;
                         C      
                         C      ; Math and boolean table
                         C      
                         C      ;
                         C      
  396D                   C      l39c8:
                         C      
  396D    39CE           C      	dw	Multiply	; *
                         C      
  396F    3A14           C      	dw	l3a6f		; MOD
                         C      
  3971    3A1A           C      	dw	Divide		; /
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-220


  3973    39BE           C      	dw	l3a19		; AND or &
                         C      
  3975    39B6           C      	dw	l3a11		; OR  or |
                         C      
  3977    39C6           C      	dw	l3a21		; XOR
                         C      
  3979    39EB           C      	dw	l3a46		; SHR or >>
                         C      
  397B    3A03           C      	dw	l3a5e		; SHL or <<
                         C      
  397D    399B           C      	dw	l39f6		; ??
                         C      
  397F    399B           C      	dw	l39f6		; ??
                         C      
  3981    399B           C      	dw	l39f6		; ??
                         C      
  3983    399B           C      	dw	l39f6		; ??
                         C      
  3985    399B           C      	dw	l39f6		; ??
                         C      
  3987    3993           C      	dw	l39ee		; EQ  or =
                         C      
  3989    39A0           C      	dw	l39fb		; NE  or <>
                         C      
  398B    39A8           C      	dw	l3a03		; LT  or <
                         C      
  398D    39AE           C      	dw	l3a09		; LE  or <
                         C      
  398F    39A7           C      	dw	l3a02		; GT  or >
                         C      
  3991    39AF           C      	dw	l3a0a		; GE  or >=
                         C      
                         C      ;
                         C      
                         C      ; Comparision EQ
                         C      
                         C      ;
                         C      
  3993                   C      l39ee:
                         C      
  3993    AF             C      	xor	a
                         C      
  3994    ED 52          C      	sbc	hl,de
                         C      
  3996    28 04          C      	jr	z,l39f7
                         C      
  3998                   C      l39f3:
                         C      
  3998    21 0000        C      	ld	hl,FALSE
                         C      
  399B                   C      l39f6:
                         C      
  399B    C9             C      	ret
                         C      
  399C                   C      l39f7:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-221


  399C    21 FFFF        C      	ld	hl,TRUE
                         C      
  399F    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Comparision NE
                         C      
                         C      ;
                         C      
  39A0                   C      l39fb:
                         C      
  39A0    AF             C      	xor	a
                         C      
  39A1    ED 52          C      	sbc	hl,de
                         C      
  39A3    28 F3          C      	jr	z,l39f3
                         C      
  39A5    18 F5          C      	jr	l39f7
                         C      
                         C      ;
                         C      
                         C      ; Comparision GT
                         C      
                         C      ;
                         C      
  39A7                   C      l3a02:
                         C      
  39A7    EB             C      	ex	de,hl
                         C      
                         C      ;
                         C      
                         C      ; Comparision LT
                         C      
                         C      ;
                         C      
  39A8                   C      l3a03:
                         C      
  39A8    AF             C      	xor	a
                         C      
  39A9    ED 52          C      	sbc	hl,de
                         C      
  39AB    ED 62          C      	sbc	hl,hl
                         C      
  39AD    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Comparision LE
                         C      
                         C      ;
                         C      
  39AE                   C      l3a09:
                         C      
  39AE    EB             C      	ex	de,hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-222


                         C      ;
                         C      
                         C      ; Comparision GE
                         C      
                         C      ;
                         C      
  39AF                   C      l3a0a:
                         C      
  39AF    ED 52          C      	sbc	hl,de
                         C      
  39B1    3F             C      	ccf
                         C      
  39B2    ED 62          C      	sbc	hl,hl
                         C      
  39B4    AF             C      	xor	a
                         C      
  39B5    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Perform logical OR
                         C      
                         C      ; HL:=HL OR DE
                         C      
                         C      ;
                         C      
  39B6                   C      l3a11:
                         C      
  39B6    7C             C      	ld	a,h
                         C      
  39B7    B2             C      	or	d
                         C      
  39B8    67             C      	ld	h,a
                         C      
  39B9    7D             C      	ld	a,l
                         C      
  39BA    B3             C      	or	e
                         C      
  39BB    6F             C      	ld	l,a
                         C      
  39BC    AF             C      	xor	a
                         C      
  39BD    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Perform logical AND
                         C      
                         C      ; HL:=HL AND DE
                         C      
                         C      ;
                         C      
  39BE                   C      l3a19:
                         C      
  39BE    7C             C      	ld	a,h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-223


  39BF    A2             C      	and	d
                         C      
  39C0    67             C      	ld	h,a
                         C      
  39C1    7D             C      	ld	a,l
                         C      
  39C2    A3             C      	and	e
                         C      
  39C3    6F             C      	ld	l,a
                         C      
  39C4    AF             C      	xor	a
                         C      
  39C5    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Perform logical XOR
                         C      
                         C      ; HL:=HL XOR DE
                         C      
                         C      ;
                         C      
  39C6                   C      l3a21:
                         C      
  39C6    7C             C      	ld	a,h
                         C      
  39C7    AA             C      	xor	d
                         C      
  39C8    67             C      	ld	h,a
                         C      
  39C9    7D             C      	ld	a,l
                         C      
  39CA    AB             C      	xor	e
                         C      
  39CB    6F             C      	ld	l,a
                         C      
  39CC    AF             C      	xor	a
                         C      
  39CD    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Multiply numbers
                         C      
                         C      ; ENTRY	Reg HL holds 1st number
                         C      
                         C      ;	Reg DE holds 2nd number
                         C      
                         C      ; EXIT	Reg HL holds product
                         C      
                         C      ;
                         C      
  39CE                   C      Multiply:
                         C      
  39CE    E5             C      	push	hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-224


  39CF    ED 52          C      	sbc	hl,de
                         C      
  39D1    E1             C      	pop	hl
                         C      
  39D2    30 01          C      	jr	nc,l3a30
                         C      
  39D4    EB             C      	ex	de,hl
                         C      
  39D5                   C      l3a30:
                         C      
  39D5    42             C      	ld	b,d
                         C      
  39D6    4B             C      	ld	c,e
                         C      
  39D7    11 0000        C      	ld	de,0		; Init result
                         C      
  39DA                   C      l3a35:
                         C      
  39DA    CB 38          C      	srl	b
                         C      
  39DC    CB 19          C      	rr	c
                         C      
  39DE    30 03          C      	jr	nc,l3a3e
                         C      
  39E0    EB             C      	ex	de,hl
                         C      
  39E1    19             C      	add	hl,de
                         C      
  39E2    EB             C      	ex	de,hl
                         C      
  39E3                   C      l3a3e:
                         C      
  39E3    29             C      	add	hl,hl
                         C      
  39E4    78             C      	ld	a,b
                         C      
  39E5    B1             C      	or	c
                         C      
  39E6    C2 39DA        C      	jp	nz,l3a35
                         C      
  39E9    EB             C      	ex	de,hl		; Get result
                         C      
  39EA    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Shift right
                         C      
                         C      ; HL:=HL SHR DE
                         C      
                         C      ;
                         C      
  39EB                   C      l3a46:
                         C      
  39EB    7A             C      	ld	a,d
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-225


  39EC    B7             C      	or	a
                         C      
  39ED    20 10          C      	jr	nz,l3a5a
                         C      
  39EF    7B             C      	ld	a,e
                         C      
  39F0    FE 10          C      	cp	16
                         C      
  39F2    30 0B          C      	jr	nc,l3a5a
                         C      
  39F4    B7             C      	or	a
                         C      
  39F5    C8             C      	ret	z
                         C      
  39F6    47             C      	ld	b,a
                         C      
  39F7                   C      l3a52:
                         C      
  39F7    CB 3C          C      	srl	h
                         C      
  39F9    CB 1D          C      	rr	l
                         C      
  39FB    10 FA          C      	djnz	l3a52
                         C      
  39FD    AF             C      	xor	a
                         C      
  39FE    C9             C      	ret
                         C      
  39FF                   C      l3a5a:
                         C      
  39FF    AF             C      	xor	a
                         C      
  3A00    67             C      	ld	h,a
                         C      
  3A01    6F             C      	ld	l,a
                         C      
  3A02    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Shift left
                         C      
                         C      ; HL:=HL SHL DE
                         C      
                         C      ;
                         C      
  3A03                   C      l3a5e:
                         C      
  3A03    7A             C      	ld	a,d
                         C      
  3A04    B7             C      	or	a
                         C      
  3A05    20 F8          C      	jr	nz,l3a5a
                         C      
  3A07    7B             C      	ld	a,e
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-226


  3A08    FE 10          C      	cp	16
                         C      
  3A0A    30 F3          C      	jr	nc,l3a5a
                         C      
  3A0C    B7             C      	or	a
                         C      
  3A0D    C8             C      	ret	z
                         C      
  3A0E    47             C      	ld	b,a
                         C      
  3A0F                   C      l3a6a:
                         C      
  3A0F    29             C      	add	hl,hl
                         C      
  3A10    10 FD          C      	djnz	l3a6a
                         C      
  3A12    AF             C      	xor	a
                         C      
  3A13    C9             C      	ret
                         C      
  3A14                   C      l3a6f:
                         C      
  3A14    CD 3A1A        C      	call	Divide		; Divide
                         C      
  3A17    60             C      	ld	h,b		; .. get remainder
                         C      
  3A18    69             C      	ld	l,c
                         C      
  3A19    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Divide numbers
                         C      
                         C      ; ENTRY	Reg HL holds dividend
                         C      
                         C      ;	Reg DE holds divisor
                         C      
                         C      ; EXIT	Reg HL holds quotient
                         C      
                         C      ;	Reg BC holds remainder
                         C      
                         C      ;
                         C      
  3A1A                   C      Divide:
                         C      
  3A1A    7C             C      	ld	a,h		; Unpack number
                         C      
  3A1B    4D             C      	ld	c,l
                         C      
  3A1C    21 0000        C      	ld	hl,0		; Set result
                         C      
  3A1F    B7             C      	or	a
                         C      
  3A20    06 10          C      	ld	b,16		; .. and bit count
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-227


  3A22    CB 11          C      	rl	c
                         C      
  3A24    17             C      	rla
                         C      
  3A25                   C      l3a80:
                         C      
  3A25    ED 6A          C      	adc	hl,hl
                         C      
  3A27    ED 52          C      	sbc	hl,de
                         C      
  3A29    30 01          C      	jr	nc,l3a87
                         C      
  3A2B    19             C      	add	hl,de
                         C      
  3A2C                   C      l3a87:
                         C      
  3A2C    3F             C      	ccf
                         C      
  3A2D    CB 11          C      	rl	c
                         C      
  3A2F    17             C      	rla
                         C      
  3A30    10 F3          C      	djnz	l3a80
                         C      
  3A32    47             C      	ld	b,a
                         C      
  3A33    AF             C      	xor	a
                         C      
  3A34    C9             C      	ret
                         C      
  3A35                   C      l3a90:
                         C      
  3A35    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
                         C      
  3A38    E5             C      	push	hl
                         C      
  3A39    F5             C      	push	af
                         C      
  3A3A    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  3A3D    2A 6376        C      	ld	hl,(TokStrt)
                         C      
  3A40    2B             C      	dec	hl
                         C      
  3A41    22 62F5        C      	ld	(TokPtr),hl	; Set token pointer
                         C      
  3A44    CD 3B37        C      	call	l3b92
                         C      
  3A47    20 07          C      	jr	nz,l3aab
                         C      
  3A49    F1             C      	pop	af
                         C      
  3A4A    E1             C      	pop	hl
                         C      
  3A4B    22 6376        C      	ld	(TokStrt),hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-228


  3A4E    18 61          C      	jr	l3b0c
                         C      
  3A50                   C      l3aab:
                         C      
  3A50    F1             C      	pop	af
                         C      
  3A51    E1             C      	pop	hl
                         C      
  3A52    FE 4F          C      	cp	4fh
                         C      
  3A54    C0             C      	ret	nz
                         C      
  3A55    3A 6617        C      	ld	a,(Pass)	; Get pass
                         C      
  3A58    3D             C      	dec	a
                         C      
  3A59    20 05          C      	jr	nz,l3abb
                         C      
  3A5B    3E FF          C      	ld	a,0ffh		; .. 2nd pass
                         C      
  3A5D    32 6790        C      	ld	(l6803),a
                         C      
  3A60                   C      l3abb:
                         C      
  3A60    3E 4F          C      	ld	a,4fh
                         C      
  3A62    C9             C      	ret
                         C      
  3A63                   C      l3abe:
                         C      
  3A63    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3A66                   C      l3ac1:
                         C      
  3A66    FE 55          C      	cp	55h		; Test [
                         C      
  3A68    C8             C      	ret	z
                         C      
  3A69    FE 38          C      	cp	38h
                         C      
  3A6B    CA 3B00        C      	jp	z,l3b5b
                         C      
  3A6E    FE 39          C      	cp	39h
                         C      
  3A70    28 3B          C      	jr	z,l3b08
                         C      
  3A72    FE 3A          C      	cp	3ah
                         C      
  3A74    28 ED          C      	jr	z,l3abe		; .. +
                         C      
  3A76    FE 3B          C      	cp	3bh
                         C      
  3A78    28 2B          C      	jr	z,l3b00		; .. -
                         C      
  3A7A    FE 44          C      	cp	44h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-229


  3A7C    38 2F          C      	jr	c,l3b08		; .. operators
                         C      
  3A7E    FE 48          C      	cp	48h
                         C      
  3A80    38 B3          C      	jr	c,l3a90		; .. pseudo operators
                         C      
  3A82    20 24          C      	jr	nz,l3b03	; .. not NUL
                         C      
  3A84    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  3A87    FE 36          C      	cp	36h		; Test end of line
                         C      
  3A89    28 15          C      	jr	z,l3afb
                         C      
  3A8B                   C      l3ae6:
                         C      
  3A8B    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  3A8E    FE 36          C      	cp	36h		; .. wait for end of line
                         C      
  3A90    20 F9          C      	jr	nz,l3ae6
                         C      
  3A92    11 0000        C      	ld	de,0
                         C      
  3A95                   C      l3af0:
                         C      
  3A95    2A 6376        C      	ld	hl,(TokStrt)
                         C      
  3A98    2B             C      	dec	hl
                         C      
  3A99    22 62F5        C      	ld	(TokPtr),hl	; Set token pointer
                         C      
  3A9C    EB             C      	ex	de,hl
                         C      
  3A9D    AF             C      	xor	a
                         C      
  3A9E    18 5A          C      	jr	l3b55
                         C      
  3AA0                   C      l3afb:
                         C      
  3AA0    11 FFFF        C      	ld	de,-1
                         C      
  3AA3    18 F0          C      	jr	l3af0
                         C      
  3AA5                   C      l3b00:
                         C      
  3AA5    3E 45          C      	ld	a,45h
                         C      
  3AA7    C9             C      	ret
                         C      
  3AA8                   C      l3b03:
                         C      
  3AA8    FE 4F          C      	cp	4fh
                         C      
  3AAA    CA 3A35        C      	jp	z,l3a90
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-230


  3AAD                   C      l3b08:
                         C      
  3AAD    FE 36          C      	cp	36h
                         C      
  3AAF    28 52          C      	jr	z,l3b5e
                         C      
  3AB1                   C      l3b0c:
                         C      
  3AB1    CD 42DD        C      	call	l4338
                         C      
  3AB4    28 4D          C      	jr	z,l3b5e
                         C      
  3AB6    ED 5B 62F5     C      	ld	de,(TokPtr)	; Get token pointer
                         C      
  3ABA    13             C      	inc	de
                         C      
  3ABB    1A             C      	ld	a,(de)
                         C      
  3ABC    FE 34          C      	cp	34h		; Fine #
                         C      
  3ABE    20 14          C      	jr	nz,l3b2f
                         C      
  3AC0    13             C      	inc	de
                         C      
  3AC1    1A             C      	ld	a,(de)
                         C      
  3AC2    FE 34          C      	cp	34h		; .. 2nd #
                         C      
  3AC4    20 0E          C      	jr	nz,l3b2f
                         C      
  3AC6    3A 62C3        C      	ld	a,(_OPT_)	; Get option
                         C      
  3AC9    87             C      	add	a,a		; Test relocatable
                         C      
  3ACA    7E             C      	ld	a,(hl)
                         C      
  3ACB    30 08          C      	jr	nc,l3b30	; .. nope
                         C      
  3ACD    ED 53 62F5     C      	ld	(TokPtr),de	; .. save ppinter
                         C      
  3AD1    CD 43C1        C      	call	l441c
                         C      
  3AD4                   C      l3b2f:
                         C      
  3AD4    7E             C      	ld	a,(hl)
                         C      
  3AD5                   C      l3b30:
                         C      
  3AD5    47             C      	ld	b,a
                         C      
  3AD6    E6 0F          C      	and	0fh
                         C      
  3AD8    FE 0F          C      	cp	0fh
                         C      
  3ADA    28 1E          C      	jr	z,l3b55
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-231


  3ADC    3A 6790        C      	ld	a,(l6803)
                         C      
  3ADF    B7             C      	or	a
                         C      
  3AE0    28 06          C      	jr	z,l3b43
                         C      
  3AE2    CB 66          C      	bit	4,(hl)
                         C      
  3AE4    3E 0F          C      	ld	a,0fh
                         C      
  3AE6    28 12          C      	jr	z,l3b55
                         C      
  3AE8                   C      l3b43:
                         C      
  3AE8    78             C      	ld	a,b
                         C      
  3AE9    B7             C      	or	a
                         C      
  3AEA    FA 3AF2        C      	jp	m,l3b4d
                         C      
  3AED    CD 633D        C      	call	l63b0
                         C      
  3AF0    18 E3          C      	jr	l3b30
                         C      
  3AF2                   C      l3b4d:
                         C      
  3AF2    7E             C      	ld	a,(hl)
                         C      
  3AF3    23             C      	inc	hl
                         C      
  3AF4    5E             C      	ld	e,(hl)
                         C      
  3AF5    23             C      	inc	hl
                         C      
  3AF6    56             C      	ld	d,(hl)
                         C      
  3AF7    EB             C      	ex	de,hl
                         C      
  3AF8    E6 0F          C      	and	0fh
                         C      
  3AFA                   C      l3b55:
                         C      
  3AFA    CD 37ED        C      	call	l3848
                         C      
  3AFD    E6 0F          C      	and	0fh
                         C      
  3AFF    C9             C      	ret
                         C      
  3B00                   C      l3b5b:
                         C      
  3B00    AF             C      	xor	a
                         C      
  3B01    18 F7          C      	jr	l3b55
                         C      
  3B03                   C      l3b5e:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-232


  3B03    0E 1E          C      	ld	c,30
                         C      
  3B05                   C      l3b60:
                         C      
  3B05    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
                         C      
  3B08    7E             C      	ld	a,(hl)
                         C      
  3B09    FE 36          C      	cp	36h
                         C      
  3B0B    20 04          C      	jr	nz,l3b6c
                         C      
  3B0D    2B             C      	dec	hl
                         C      
  3B0E    22 62F5        C      	ld	(TokPtr),hl	; .. save
                         C      
  3B11                   C      l3b6c:
                         C      
  3B11    AF             C      	xor	a
                         C      
  3B12    32 6790        C      	ld	(l6803),a
                         C      
  3B15    DD 2A 36F2     C      	ld	ix,(l374d)
                         C      
  3B19    ED 7B 3BB7     C      	ld	sp,(l3c12)
                         C      
  3B1D    67             C      	ld	h,a
                         C      
  3B1E    6F             C      	ld	l,a
                         C      
  3B1F    22 6407        C      	ld	(l647a),hl
                         C      
  3B22    32 6406        C      	ld	(l6479),a
                         C      
  3B25    3D             C      	dec	a
                         C      
  3B26    32 6409        C      	ld	(l647c),a
                         C      
  3B29    C3 08F5        C      	jp	.ERROR
                         C      
  3B2C                   C      l3b87:
                         C      
  3B2C    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3B2F                   C      l3b8a:
                         C      
  3B2F    CD 3B37        C      	call	l3b92
                         C      
  3B32    C8             C      	ret	z
                         C      
  3B33                   C      l3b8e:
                         C      
  3B33    0E 1D          C      	ld	c,29
                         C      
  3B35    18 CE          C      	jr	l3b60
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-233


  3B37                   C      l3b92:
                         C      
  3B37    FE 52          C      	cp	52h		; .. ]
                         C      
  3B39    C8             C      	ret	z
                         C      
  3B3A    FE 3A          C      	cp	3ah
                         C      
  3B3C    38 21          C      	jr	c,l3bba
                         C      
  3B3E    FE 44          C      	cp	44h
                         C      
  3B40    38 1B          C      	jr	c,l3bb8
                         C      
  3B42    FE 49          C      	cp	49h
                         C      
  3B44    38 19          C      	jr	c,l3bba
                         C      
  3B46    FE 4F          C      	cp	4fh
                         C      
  3B48    38 13          C      	jr	c,l3bb8
                         C      
  3B4A    FE 5A          C      	cp	5ah
                         C      
  3B4C    0E 3F          C      	ld	c,3fh
                         C      
  3B4E    28 0C          C      	jr	z,l3bb7
                         C      
  3B50    0E 40          C      	ld	c,40h
                         C      
  3B52    FE 7E          C      	cp	7eh
                         C      
  3B54    28 06          C      	jr	z,l3bb7
                         C      
  3B56    0E 41          C      	ld	c,41h
                         C      
  3B58    FE A4          C      	cp	0a4h
                         C      
  3B5A    20 03          C      	jr	nz,l3bba
                         C      
  3B5C                   C      l3bb7:
                         C      
  3B5C    79             C      	ld	a,c
                         C      
  3B5D                   C      l3bb8:
                         C      
  3B5D    BF             C      	cp	a
                         C      
  3B5E    C9             C      	ret
                         C      
  3B5F                   C      l3bba:
                         C      
  3B5F    FE 50          C      	cp	50h
                         C      
  3B61    C8             C      	ret	z
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-234


  3B62    FE 36          C      	cp	36h		; Test form feed ??
                         C      
  3B64    C0             C      	ret	nz		; .. nope
                         C      
  3B65    3E 50          C      	ld	a,50h		; Map
                         C      
  3B67    C9             C      	ret
                         C      
  3B68                   C      l3bc3:
                         C      
  3B68    E5             C      	push	hl
                         C      
  3B69    CD 5513        C      	call	l556e
                         C      
  3B6C    E1             C      	pop	hl
                         C      
  3B6D    7E             C      	ld	a,(hl)
                         C      
  3B6E    C9             C      	ret
                         C      
  3B6F                   C      l3bca:
                         C      
  3B6F    D5             C      	push	de
                         C      
  3B70    CD 3C44        C      	call	l3c9f
                         C      
  3B73    D1             C      	pop	de
                         C      
  3B74    FE 10          C      	cp	10h
                         C      
  3B76    DC 6346        C      	call	c,l63b9
                         C      
  3B79    7B             C      	ld	a,e
                         C      
  3B7A    CD 631F        C      	call	l6392
                         C      
  3B7D    2A 67D8        C      	ld	hl,(l684b)
                         C      
  3B80    C3 3965        C      	jp	l39c0
                         C      
  3B83                   C      l3bde:
                         C      
  3B83    CD 3C44        C      	call	l3c9f
                         C      
  3B86    1E E2          C      	ld	e,0e2h
                         C      
  3B88    20 21          C      	jr	nz,l3c06
                         C      
  3B8A    7D             C      	ld	a,l
                         C      
  3B8B    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  3B8E    29             C      	add	hl,hl
                         C      
  3B8F    24             C      	inc	h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-235


  3B90    38 01          C      	jr	c,l3bee
                         C      
  3B92    25             C      	dec	h
                         C      
  3B93                   C      l3bee:
                         C      
  3B93    C8             C      	ret	z
                         C      
  3B94    18 0E          C      	jr	l3bff
                         C      
  3B96                   C      l3bf1:
                         C      
  3B96    CD 3C44        C      	call	l3c9f
                         C      
  3B99    20 0E          C      	jr	nz,l3c04
                         C      
  3B9B    7D             C      	ld	a,l
                         C      
  3B9C    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  3B9F    7C             C      	ld	a,h
                         C      
  3BA0    B7             C      	or	a
                         C      
  3BA1    C8             C      	ret	z
                         C      
  3BA2    3C             C      	inc	a
                         C      
  3BA3    C8             C      	ret	z
                         C      
  3BA4                   C      l3bff:
                         C      
  3BA4    0E 08          C      	ld	c,8
                         C      
  3BA6    C3 08F5        C      	jp	.ERROR
                         C      
  3BA9                   C      l3c04:
                         C      
  3BA9    1E E1          C      	ld	e,0e1h
                         C      
  3BAB                   C      l3c06:
                         C      
  3BAB    FE 10          C      	cp	10h
                         C      
  3BAD    DC 6346        C      	call	c,l63b9
                         C      
  3BB0    CD 6358        C      	call	l63cb
                         C      
  3BB3    7B             C      	ld	a,e
                         C      
  3BB4    C3 631F        C      	jp	l6392
                         C      
  3BB7                   C      l3c12:
                         C      
  3BB7    0000           C      	dw	0
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-236


  3BB9                   C      l3c14:
                         C      
  3BB9    0E 08          C      	ld	c,8
                         C      
  3BBB    CD 08F5        C      	call	.ERROR
                         C      
  3BBE    AF             C      	xor	a
                         C      
  3BBF    6F             C      	ld	l,a
                         C      
  3BC0    C9             C      	ret
                         C      
  3BC1                   C      l3c1c:
                         C      
  3BC1    F5             C      	push	af
                         C      
  3BC2    CD 3C44        C      	call	l3c9f
                         C      
  3BC5    20 12          C      	jr	nz,l3c34
                         C      
  3BC7    24             C      	inc	h
                         C      
  3BC8    25             C      	dec	h
                         C      
  3BC9    20 03          C      	jr	nz,l3c29
                         C      
  3BCB    7D             C      	ld	a,l
                         C      
  3BCC    FE 08          C      	cp	8
                         C      
  3BCE                   C      l3c29:
                         C      
  3BCE    D4 3BB9        C      	call	nc,l3c14
                         C      
  3BD1    87             C      	add	a,a
                         C      
  3BD2    87             C      	add	a,a
                         C      
  3BD3    87             C      	add	a,a
                         C      
  3BD4    C1             C      	pop	bc
                         C      
  3BD5    B0             C      	or	b
                         C      
  3BD6    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
  3BD9                   C      l3c34:
                         C      
  3BD9    CD 6358        C      	call	l63cb
                         C      
  3BDC    FE 10          C      	cp	10h
                         C      
  3BDE    DC 6346        C      	call	c,l63b9
                         C      
  3BE1    3E E8          C      	ld	a,0e8h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-237


  3BE3    CD 631F        C      	call	l6392
                         C      
  3BE6    F1             C      	pop	af
                         C      
  3BE7    C3 6322        C      	jp	l6395
                         C      
  3BEA                   C      l3c45:
                         C      
  3BEA    1E EA          C      	ld	e,0eah
                         C      
  3BEC    18 BD          C      	jr	l3c06
                         C      
  3BEE                   C      l3c49:
                         C      
  3BEE    1E E9          C      	ld	e,0e9h
                         C      
  3BF0    18 B9          C      	jr	l3c06
                         C      
  3BF2                   C      l3c4d:
                         C      
  3BF2    CD 3C44        C      	call	l3c9f
                         C      
  3BF5    20 F3          C      	jr	nz,l3c45
                         C      
  3BF7    24             C      	inc	h
                         C      
  3BF8    25             C      	dec	h
                         C      
  3BF9    20 03          C      	jr	nz,l3c59
                         C      
  3BFB    7D             C      	ld	a,l
                         C      
  3BFC    FE 03          C      	cp	3
                         C      
  3BFE                   C      l3c59:
                         C      
  3BFE    D4 3BB9        C      	call	nc,l3c14
                         C      
  3C01    0E 46          C      	ld	c,46h
                         C      
  3C03    B7             C      	or	a
                         C      
  3C04    28 07          C      	jr	z,l3c68
                         C      
  3C06    0E 56          C      	ld	c,56h
                         C      
  3C08    3D             C      	dec	a
                         C      
  3C09    28 02          C      	jr	z,l3c68
                         C      
  3C0B    0E 5E          C      	ld	c,5eh
                         C      
  3C0D                   C      l3c68:
                         C      
  3C0D    79             C      	ld	a,c
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-238


  3C0E    C3 6328        C      	jp	Con$Put		; Put to file
                         C      
  3C11                   C      l3c6c:
                         C      
  3C11    CD 3C44        C      	call	l3c9f
                         C      
  3C14    20 D8          C      	jr	nz,l3c49
                         C      
  3C16    7C             C      	ld	a,h
                         C      
  3C17    B7             C      	or	a
                         C      
  3C18    20 0D          C      	jr	nz,l3c82
                         C      
  3C1A    3A 01A2        C      	ld	a,(l01b5)
                         C      
  3C1D    B7             C      	or	a
                         C      
  3C1E    7D             C      	ld	a,l
                         C      
  3C1F    20 04          C      	jr	nz,l3c80
                         C      
  3C21    07             C      	rlca
                         C      
  3C22    07             C      	rlca
                         C      
  3C23    07             C      	rlca
                         C      
  3C24    6F             C      	ld	l,a
                         C      
  3C25                   C      l3c80:
                         C      
  3C25    E6 C7          C      	and	0c7h
                         C      
  3C27                   C      l3c82:
                         C      
  3C27    C4 3BB9        C      	call	nz,l3c14
                         C      
  3C2A    7D             C      	ld	a,l
                         C      
  3C2B    F6 C7          C      	or	0c7h
                         C      
  3C2D    C3 6328        C      	jp	Con$Put		; Give RST to file
                         C      
  3C30                   C      l3c8b:
                         C      
  3C30    AF             C      	xor	a
                         C      
  3C31    32 67C8        C      	ld	(l683b),a
                         C      
  3C34                   C      l3c8f:
                         C      
  3C34    CD 3C44        C      	call	l3c9f
                         C      
  3C37    FE 11          C      	cp	11h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-239


  3C39    DA 51BF        C      	jp	c,l521a
                         C      
  3C3C    CD 6355        C      	call	l63c8
                         C      
  3C3F    3E E0          C      	ld	a,0e0h
                         C      
  3C41    C3 631F        C      	jp	l6392
                         C      
  3C44                   C      l3c9f:
                         C      
  3C44    3A 6409        C      	ld	a,(l647c)
                         C      
  3C47    3C             C      	inc	a
                         C      
  3C48    20 0D          C      	jr	nz,l3cb2
                         C      
  3C4A    3D             C      	dec	a
                         C      
  3C4B    32 67C8        C      	ld	(l683b),a
                         C      
  3C4E    2A 6407        C      	ld	hl,(l647a)
                         C      
  3C51    3A 6406        C      	ld	a,(l6479)
                         C      
  3C54    E6 0F          C      	and	0fh
                         C      
  3C56    C9             C      	ret
                         C      
  3C57                   C      l3cb2:
                         C      
  3C57    21 6406        C      	ld	hl,l6479
                         C      
  3C5A    7E             C      	ld	a,(hl)
                         C      
  3C5B    E6 0F          C      	and	0fh
                         C      
  3C5D    FE 0F          C      	cp	0fh
                         C      
  3C5F    28 44          C      	jr	z,l3d00
                         C      
  3C61                   C      l3cbc:
                         C      
  3C61    7E             C      	ld	a,(hl)
                         C      
  3C62    23             C      	inc	hl
                         C      
  3C63    5E             C      	ld	e,(hl)
                         C      
  3C64    23             C      	inc	hl
                         C      
  3C65    56             C      	ld	d,(hl)
                         C      
  3C66    23             C      	inc	hl
                         C      
  3C67    EB             C      	ex	de,hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-240


  3C68    FE 80          C      	cp	80h
                         C      
  3C6A    38 31          C      	jr	c,l3cf8
                         C      
  3C6C    FE 90          C      	cp	90h
                         C      
  3C6E    38 15          C      	jr	c,l3ce0
                         C      
  3C70    FE A0          C      	cp	0a0h
                         C      
  3C72    38 1C          C      	jr	c,l3ceb
                         C      
  3C74    FE B0          C      	cp	0b0h
                         C      
  3C76    38 1E          C      	jr	c,l3cf1
                         C      
  3C78    FE D0          C      	cp	0d0h
                         C      
  3C7A    38 0E          C      	jr	c,l3ce5
                         C      
  3C7C    FE FF          C      	cp	0ffh
                         C      
  3C7E    20 1D          C      	jr	nz,l3cf8
                         C      
  3C80    32 67C8        C      	ld	(l683b),a
                         C      
  3C83    B7             C      	or	a
                         C      
  3C84    C9             C      	ret
                         C      
  3C85                   C      l3ce0:
                         C      
  3C85    CD 3CFA        C      	call	l3d55
                         C      
  3C88    3E B0          C      	ld	a,0b0h
                         C      
  3C8A                   C      l3ce5:
                         C      
  3C8A    CD 631F        C      	call	l6392
                         C      
  3C8D    EB             C      	ex	de,hl
                         C      
  3C8E    18 D1          C      	jr	l3cbc
                         C      
  3C90                   C      l3ceb:
                         C      
  3C90    CD 3CFA        C      	call	l3d55
                         C      
  3C93    EB             C      	ex	de,hl
                         C      
  3C94    18 CB          C      	jr	l3cbc
                         C      
  3C96                   C      l3cf1:
                         C      
  3C96    CD 3CFA        C      	call	l3d55
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-241


  3C99    3E B1          C      	ld	a,0b1h
                         C      
  3C9B    18 ED          C      	jr	l3ce5
                         C      
  3C9D                   C      l3cf8:
                         C      
  3C9D    C3 5F39        C      	jp	l5f94
                         C      
  3CA0                   C      l3cfb:
                         C      
  3CA0    21 6406        C      	ld	hl,l6479
                         C      
  3CA3    18 BC          C      	jr	l3cbc
                         C      
  3CA5                   C      l3d00:
                         C      
  3CA5    3A 67C8        C      	ld	a,(l683b)
                         C      
  3CA8    B7             C      	or	a
                         C      
  3CA9    20 B6          C      	jr	nz,l3cbc
                         C      
  3CAB                   C      l3d06:
                         C      
  3CAB    23             C      	inc	hl
                         C      
  3CAC    23             C      	inc	hl
                         C      
  3CAD    23             C      	inc	hl
                         C      
  3CAE    7E             C      	ld	a,(hl)
                         C      
  3CAF    FE 90          C      	cp	90h
                         C      
  3CB1    38 F8          C      	jr	c,l3d06
                         C      
  3CB3    FE A0          C      	cp	0a0h
                         C      
  3CB5    38 E9          C      	jr	c,l3cfb
                         C      
  3CB7    FE B0          C      	cp	0b0h
                         C      
  3CB9    38 F0          C      	jr	c,l3d06
                         C      
  3CBB    3C             C      	inc	a
                         C      
  3CBC    20 E2          C      	jr	nz,l3cfb
                         C      
  3CBE    21 6406        C      	ld	hl,l6479
                         C      
  3CC1    36 0F          C      	ld	(hl),0fh
                         C      
  3CC3    21 6409        C      	ld	hl,l647c
                         C      
  3CC6                   C      l3d21:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-242


  3CC6    7E             C      	ld	a,(hl)
                         C      
  3CC7    23             C      	inc	hl
                         C      
  3CC8    5E             C      	ld	e,(hl)
                         C      
  3CC9    23             C      	inc	hl
                         C      
  3CCA    56             C      	ld	d,(hl)
                         C      
  3CCB    23             C      	inc	hl
                         C      
  3CCC    EB             C      	ex	de,hl
                         C      
  3CCD    FE 90          C      	cp	90h
                         C      
  3CCF    38 14          C      	jr	c,l3d40
                         C      
  3CD1    FE B0          C      	cp	0b0h
                         C      
  3CD3    30 05          C      	jr	nc,l3d35
                         C      
  3CD5    E6 0F          C      	and	LoMask
                         C      
  3CD7    CD 6343        C      	call	l63b6
                         C      
  3CDA                   C      l3d35:
                         C      
  3CDA    2A 6407        C      	ld	hl,(l647a)
                         C      
  3CDD    3A 6406        C      	ld	a,(l6479)
                         C      
  3CE0    32 67C8        C      	ld	(l683b),a
                         C      
  3CE3    B7             C      	or	a
                         C      
  3CE4    C9             C      	ret
                         C      
  3CE5                   C      l3d40:
                         C      
  3CE5    E6 0F          C      	and	LoMask
                         C      
  3CE7    E5             C      	push	hl
                         C      
  3CE8    21 6406        C      	ld	hl,l6479
                         C      
  3CEB    34             C      	inc	(hl)
                         C      
  3CEC    E1             C      	pop	hl
                         C      
  3CED    F5             C      	push	af
                         C      
  3CEE    3E 0F          C      	ld	a,0fh
                         C      
  3CF0    CD 634F        C      	call	l63c2
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-243


  3CF3    F1             C      	pop	af
                         C      
  3CF4    CD 6340        C      	call	l63b3
                         C      
  3CF7    EB             C      	ex	de,hl
                         C      
  3CF8    18 CC          C      	jr	l3d21
                         C      
                         C      
                         C      
                                
                         C      	include	slr180.004
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  3CFA                   C      l3d55:
                         C      
  3CFA    E6 0F          C      	and	0fh
                         C      
  3CFC    C3 6346        C      	jp	l63b9
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  3CFF                   C      l3d5a:
                         C      
  3CFF    F6 90          C      	or	90h
                         C      
  3D01    CD 6322        C      	call	l6395
                         C      
  3D04    C3 3965        C      	jp	l39c0
                         C      
                         C      ;
                         C      
                         C      ; Get register
                         C      
                         C      ; EXIT	Carry set if not a register
                         C      
                         C      ;	Accu holds mapped registers
                         C      
                         C      ;	0..7	->	B,C,..,A
                         C      
                         C      ;	8,9	->	IX,IY
                         C      
                         C      ;
                         C      
  3D07                   C      GetReg:
                         C      
  3D07    CD 0DE2        C      	call	GetToken	; Get token
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-244


  3D0A    D6 10          C      	sub	10h		; Strip off reg offset
                         C      
  3D0C    FE 08          C      	cp	18h-10h		; Test single regs
                         C      
  3D0E    3F             C      	ccf
                         C      
  3D0F    D0             C      	ret	nc		; .. yeap
                         C      
  3D10    C6 10          C      	add	a,10h		; .. bring back old
                         C      
  3D12                   C      l3d6d:
                         C      
  3D12    FE 2C          C      	cp	2ch		; Test range
                         C      
  3D14    30 24          C      	jr	nc,l3d95
                         C      
  3D16    FE 2A          C      	cp	2ah
                         C      
  3D18    38 20          C      	jr	c,l3d95
                         C      
  3D1A    D6 22          C      	sub	2ah-8		; Strip off offset for (IX, (IY
                         C      
  3D1C    F5             C      	push	af
                         C      
  3D1D    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3D20    FE 3A          C      	cp	3ah		; Test +
                         C      
  3D22    28 05          C      	jr	z,l3d84
                         C      
  3D24    FE 3B          C      	cp	3bh		; .. should be -
                         C      
  3D26    C2 0903        C      	jp	nz,SyntaxErr
                         C      
  3D29                   C      l3d84:
                         C      
  3D29    CD 3590        C      	call	l35eb		; Get offset
                         C      
  3D2C    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3D2F    FE 52          C      	cp	52h		; Test ) ] }
                         C      
  3D31    20 02          C      	jr	nz,l3d90	; .. should be
                         C      
  3D33    F1             C      	pop	af
                         C      
  3D34    C9             C      	ret
                         C      
  3D35                   C      l3d90:
                         C      
  3D35    0E 18          C      	ld	c,24
                         C      
  3D37    C3 0905        C      	jp	ERROR
                         C      
  3D3A                   C      l3d95:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-245


  3D3A    FE 2D          C      	cp	2dh		; Test range IX, IY
                         C      
  3D3C    38 75          C      	jr	c,l3e0e
                         C      
  3D3E    FE 2F          C      	cp	2fh
                         C      
  3D40    30 71          C      	jr	nc,l3e0e
                         C      
  3D42    D6 25          C      	sub	2dh-8		; Strip off offset
                         C      
  3D44    21 6406        C      	ld	hl,l6479
                         C      
  3D47    0E 00          C      	ld	c,0
                         C      
  3D49    71             C      	ld	(hl),c
                         C      
  3D4A    23             C      	inc	hl
                         C      
  3D4B    71             C      	ld	(hl),c
                         C      
  3D4C    23             C      	inc	hl
                         C      
  3D4D    71             C      	ld	(hl),c
                         C      
  3D4E    23             C      	inc	hl
                         C      
  3D4F    36 FF          C      	ld	(hl),0ffh
                         C      
  3D51    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  3D52                   C      l3dad:
                         C      
  3D52    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3D55                   C      l3db0:
                         C      
  3D55    D6 10          C      	sub	10h		; Strip off register
                         C      
  3D57    FE 08          C      	cp	18h-10h		; Test valid range
                         C      
  3D59    3F             C      	ccf
                         C      
  3D5A    D0             C      	ret	nc		; .. yeap
                         C      
  3D5B    C6 10          C      	add	a,10h		; Fix for old value
                         C      
  3D5D    FE 38          C      	cp	38h
                         C      
  3D5F    28 28          C      	jr	z,l3de4		; .. ??
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-246


  3D61    38 10          C      	jr	c,l3dce
                         C      
  3D63    FE 39          C      	cp	39h
                         C      
  3D65    28 22          C      	jr	z,l3de4		; .. ??
                         C      
  3D67    FE 55          C      	cp	55h
                         C      
  3D69    28 1E          C      	jr	z,l3de4		; .. ([{
                         C      
  3D6B    FE 49          C      	cp	49h
                         C      
  3D6D    38 1A          C      	jr	c,l3de4
                         C      
  3D6F    FE 4F          C      	cp	4fh		; .. TYPE
                         C      
  3D71    28 16          C      	jr	z,l3de4
                         C      
  3D73                   C      l3dce:
                         C      
  3D73    6F             C      	ld	l,a
                         C      
  3D74    26 03          C      	ld	h,HIGH l0400
                         C      
  3D76    CB 7E          C      	bit	7,(hl)
                         C      
  3D78    28 98          C      	jr	z,l3d6d
                         C      
  3D7A    ED 5B 6376     C      	ld	de,(TokStrt)	; Get start of token
                         C      
  3D7E    1A             C      	ld	a,(de)
                         C      
  3D7F    FE 57          C      	cp	57h		; Test range
                         C      
  3D81    38 8F          C      	jr	c,l3d6d
                         C      
  3D83    CB F6          C      	set	6,(hl)
                         C      
  3D85    EB             C      	ex	de,hl
                         C      
  3D86    CD 0FBE        C      	call	GetLabel	; Get label
                         C      
  3D89                   C      l3de4:
                         C      
  3D89    CD 3590        C      	call	l35eb
                         C      
  3D8C    3A 660C        C      	ld	a,(l667f)
                         C      
  3D8F    FE 03          C      	cp	3
                         C      
  3D91    3E 0A          C      	ld	a,0ah
                         C      
  3D93    37             C      	scf
                         C      
  3D94    3F             C      	ccf
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-247


  3D95    C9             C      	ret
                         C      
  3D96                   C      l3df1:
                         C      
  3D96    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3D99    D6 1A          C      	sub	1ah		; Strip off reg pairs
                         C      
  3D9B    38 14          C      	jr	c,l3e0c		; .. normal regs
                         C      
  3D9D    FE 02          C      	cp	1ch-1ah
                         C      
  3D9F    38 2F          C      	jr	c,l3e2b		; .. BC or DE
                         C      
  3DA1    FE 04          C      	cp	1eh-1ah
                         C      
  3DA3    38 0C          C      	jr	c,l3e0c		; .. HL or AF
                         C      
  3DA5    20 03          C      	jr	nz,l3e05	; .. not SP
                         C      
  3DA7    3E 30          C      	ld	a,30h		; Map to (DE) ?????
                         C      
  3DA9    C9             C      	ret
                         C      
  3DAA                   C      l3e05:
                         C      
  3DAA    FE 05          C      	cp	1fh-1ah
                         C      
  3DAC    20 03          C      	jr	nz,l3e0c	; .. not IX
                         C      
  3DAE    3E 20          C      	ld	a,20h		; .. map to IY ?????
                         C      
  3DB0    C9             C      	ret
                         C      
  3DB1                   C      l3e0c:
                         C      
  3DB1    C6 1A          C      	add	a,1ah		; Add to original
                         C      
  3DB3                   C      l3e0e:
                         C      
  3DB3    22 6407        C      	ld	(l647a),hl
                         C      
  3DB6    32 6406        C      	ld	(l6479),a
                         C      
  3DB9    FE 36          C      	cp	36h		; Test new line
                         C      
  3DBB    37             C      	scf
                         C      
  3DBC    C0             C      	ret	nz		; .. nope
                         C      
  3DBD    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
                         C      
  3DC0    2B             C      	dec	hl
                         C      
  3DC1    22 62F5        C      	ld	(TokPtr),hl	; .. to token pointer
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-248


  3DC4    C9             C      	ret
                         C      
  3DC5                   C      l3e20:
                         C      
  3DC5    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3DC8    D6 1A          C      	sub	1ah		; Test range BC 
                         C      
  3DCA    38 E5          C      	jr	c,l3e0c
                         C      
  3DCC    FE 04          C      	cp	1dh-1ah+1	; .. to ACCU
                         C      
  3DCE    30 E1          C      	jr	nc,l3e0c
                         C      
  3DD0                   C      l3e2b:
                         C      
  3DD0    87             C      	add	a,a
                         C      
  3DD1    87             C      	add	a,a
                         C      
  3DD2    87             C      	add	a,a
                         C      
  3DD3    87             C      	add	a,a
                         C      
  3DD4    C9             C      	ret
                         C      
  3DD5                   C      l3e30:
                         C      
  3DD5    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3DD8    D6 1A          C      	sub	1ah		; Test range BC
                         C      
  3DDA    38 D5          C      	jr	c,l3e0c
                         C      
  3DDC    FE 02          C      	cp	1bh-1ah+1	; .. to DE
                         C      
  3DDE    38 F0          C      	jr	c,l3e2b
                         C      
  3DE0    FE 04          C      	cp	1eh-1ah		; .. SP is allowed
                         C      
  3DE2    38 CD          C      	jr	c,l3e0c
                         C      
  3DE4    20 03          C      	jr	nz,l3e44
                         C      
  3DE6    3E 30          C      	ld	a,30h		; .. set stack
                         C      
  3DE8    C9             C      	ret
                         C      
  3DE9                   C      l3e44:
                         C      
  3DE9    FE 06          C      	cp	20h-1ah		; IY is allowed, too
                         C      
  3DEB    20 C4          C      	jr	nz,l3e0c
                         C      
  3DED    3E 20          C      	ld	a,' '
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-249


  3DEF    C9             C      	ret
                         C      
  3DF0                   C      l3e4b:
                         C      
  3DF0    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3DF3                   C      l3e4e:
                         C      
  3DF3    D6 1A          C      	sub	1ah		; Strip off offset
                         C      
  3DF5    38 BA          C      	jr	c,l3e0c		; .. simple regs
                         C      
  3DF7    FE 03          C      	cp	1dh-1ah
                         C      
  3DF9    38 D5          C      	jr	c,l3e2b		; .. normal reg pairs
                         C      
  3DFB    FE 04          C      	cp	1eh-1ah
                         C      
  3DFD    20 B2          C      	jr	nz,l3e0c	; .. not SP
                         C      
  3DFF    3E 30          C      	ld	a,30h		; .. map to (DE) ?????
                         C      
  3E01    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  3E02                   C      l3e5d:
                         C      
  3E02    C6 21          C      	add	a,21h		; .. add C.C. offset
                         C      
  3E04    18 AD          C      	jr	l3e0e
                         C      
                         C      ;
                         C      
                         C      ; Process condition code
                         C      
                         C      ; EXIT	Carry set if no C.C. found
                         C      
                         C      ;	Accu holds code on its right place
                         C      
                         C      ;
                         C      
  3E06                   C      GetCC:
                         C      
  3E06    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3E09                   C      l3e64:
                         C      
  3E09    FE 11          C      	cp	11h		; Test reg C
                         C      
  3E0B    28 0C          C      	jr	z,l3e74		; .. map it
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-250


  3E0D    D6 21          C      	sub	21h		; Subtract offset
                         C      
  3E0F    38 F1          C      	jr	c,l3e5d		; .. no condition code
                         C      
  3E11    FE 08          C      	cp	29h-21h
                         C      
  3E13    30 ED          C      	jr	nc,l3e5d	; .. dtto.
                         C      
  3E15    87             C      	add	a,a		; Shift into right position
                         C      
  3E16    87             C      	add	a,a
                         C      
  3E17    87             C      	add	a,a
                         C      
  3E18    C9             C      	ret
                         C      
  3E19                   C      l3e74:
                         C      
  3E19    3E 18          C      	ld	a,8*(24h-21h)	; Return condition CARRY
                         C      
  3E1B    C9             C      	ret
                         C      
  3E1C                   C      l3e77:
                         C      
  3E1C    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3E1F                   C      l3e7a:
                         C      
  3E1F    FE 1F          C      	cp	1fh		; Test IX
                         C      
  3E21    DA 3DB3        C      	jp	c,l3e0e
                         C      
  3E24    FE 21          C      	cp	21h
                         C      
  3E26    D2 3DB3        C      	jp	nc,l3e0e
                         C      
  3E29    B7             C      	or	a
                         C      
  3E2A    C9             C      	ret
                         C      
  3E2B                   C      l3e86:
                         C      
  3E2B    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3E2E    FE 16          C      	cp	16h		; Test (HL)
                         C      
  3E30    C8             C      	ret	z
                         C      
  3E31    FE 2D          C      	cp	2dh		; .. (IX)
                         C      
  3E33    C8             C      	ret	z
                         C      
  3E34    FE 2E          C      	cp	2eh		; .. (IY)
                         C      
  3E36    C8             C      	ret	z
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-251


  3E37    C3 3DB3        C      	jp	l3e0e
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : ASEG
                         C      
                         C      ;
                         C      
  3E3A                   C      l3e95:
                         C      
  3E3A    CD 4B25        C      	call	l4b80
                         C      
  3E3D    CD 3FE6        C      	call	l4041
                         C      
  3E40    AF             C      	xor	a
                         C      
  3E41    2A 6754        C      	ld	hl,(l67c7)
                         C      
  3E44    C3 4D41        C      	jp	l4d9c
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .LALL
                         C      
                         C      ;
                         C      
  3E47                   C      l3ea2:
                         C      
  3E47    3E 01          C      	ld	a,1		; .LALL
                         C      
  3E49    18 06          C      	jr	l3eac
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .SALL
                         C      
                         C      ;
                         C      
  3E4B                   C      l3ea6:
                         C      
  3E4B    3E 04          C      	ld	a,4		; .SALL
                         C      
  3E4D    18 02          C      	jr	l3eac
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .XALL
                         C      
                         C      ;
                         C      
  3E4F                   C      l3eaa:
                         C      
  3E4F    3E 02          C      	ld	a,2		; .XALL
                         C      
  3E51                   C      l3eac:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-252


  3E51    32 62C7        C      	ld	(_MACRO_),a	; Set macro list
                         C      
  3E54    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .ACCEPT
                         C      
                         C      ;
                         C      
  3E55                   C      l3eb0:
                         C      
  3E55    3E FF          C      	ld	a,0ffh
                         C      
  3E57    32 6818        C      	ld	(l688b),a
                         C      
  3E5A    32 6A35        C      	ld	(l6aa8),a
                         C      
  3E5D    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3E60    FE 56          C      	cp	56h		; Test string
                         C      
  3E62    20 0F          C      	jr	nz,l3ece	; .. nope
                         C      
  3E64    11 6A35        C      	ld	de,l6aa8
                         C      
  3E67    CD 5E9C        C      	call	ldir.8		; Copy message
                         C      
  3E6A    3E FF          C      	ld	a,eot
                         C      
  3E6C    12             C      	ld	(de),a		; .. set end
                         C      
  3E6D    CD 2F8E        C      	call	l2fe9
                         C      
  3E70    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  3E73                   C      l3ece:
                         C      
  3E73    CD 42D6        C      	call	l4331
                         C      
  3E76    22 67D8        C      	ld	(l684b),hl
                         C      
  3E79    7E             C      	ld	a,(hl)
                         C      
  3E7A    E6 0F          C      	and	0fh
                         C      
  3E7C    4F             C      	ld	c,a
                         C      
  3E7D    23             C      	inc	hl
                         C      
  3E7E    5E             C      	ld	e,(hl)
                         C      
  3E7F    23             C      	inc	hl
                         C      
  3E80    56             C      	ld	d,(hl)
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-253


  3E81    EB             C      	ex	de,hl
                         C      
  3E82    3A 6617        C      	ld	a,(Pass)
                         C      
  3E85    E6 01          C      	and	1		; Test pass
                         C      
  3E87    79             C      	ld	a,c
                         C      
  3E88    C2 4362        C      	jp	nz,l43bd	; .. 2nd pass
                         C      
  3E8B    EB             C      	ex	de,hl
                         C      
  3E8C    2B             C      	dec	hl
                         C      
  3E8D    2B             C      	dec	hl
                         C      
  3E8E    7E             C      	ld	a,(hl)
                         C      
  3E8F    B7             C      	or	a
                         C      
  3E90    FA 42CE        C      	jp	m,l4329
                         C      
  3E93    E6 0F          C      	and	0fh
                         C      
  3E95    FE 0F          C      	cp	0fh
                         C      
  3E97    CA 42CE        C      	jp	z,l4329
                         C      
  3E9A    3A 6A35        C      	ld	a,(l6aa8)
                         C      
  3E9D    3C             C      	inc	a
                         C      
  3E9E    20 0F          C      	jr	nz,l3f0a
                         C      
  3EA0    11 6A35        C      	ld	de,l6aa8
                         C      
  3EA3    CD 5549        C      	call	l55a4
                         C      
  3EA6    EB             C      	ex	de,hl
                         C      
  3EA7    36 20          C      	ld	(hl),' '
                         C      
  3EA9    23             C      	inc	hl
                         C      
  3EAA                   C      l3f05:
                         C      
  3EAA    36 3F          C      	ld	(hl),'?'
                         C      
  3EAC    23             C      	inc	hl
                         C      
  3EAD    36 FF          C      	ld	(hl),-1
                         C      
  3EAF                   C      l3f0a:
                         C      
  3EAF    21 6A35        C      	ld	hl,l6aa8
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-254


  3EB2    CD 6134        C      	call	PutStr		; Print string
                         C      
  3EB5    21 6A35        C      	ld	hl,l6aa8
                         C      
  3EB8    36 32          C      	ld	(hl),50
                         C      
  3EBA    EB             C      	ex	de,hl
                         C      
  3EBB    0E 0A          C      	ld	c,.rdcon
                         C      
  3EBD    CD 5EA9        C      	call	.BDOS		; Read console buffer
                         C      
  3EC0    21 08F1        C      	ld	hl,l090b
                         C      
  3EC3    CD 6134        C      	call	PutStr		; .. close input
                         C      
  3EC6    21 6A36        C      	ld	hl,l6aa9
                         C      
  3EC9    7E             C      	ld	a,(hl)		; Get length
                         C      
  3ECA    B7             C      	or	a
                         C      
  3ECB    2B             C      	dec	hl
                         C      
  3ECC    28 DC          C      	jr	z,l3f05
                         C      
  3ECE    36 09          C      	ld	(hl),tab	; Overwrite 1st
                         C      
  3ED0    23             C      	inc	hl
                         C      
  3ED1    36 09          C      	ld	(hl),tab
                         C      
  3ED3    23             C      	inc	hl
                         C      
  3ED4    4F             C      	ld	c,a
                         C      
  3ED5    06 00          C      	ld	b,0
                         C      
  3ED7    09             C      	add	hl,bc
                         C      
  3ED8    36 0D          C      	ld	(hl),cr
                         C      
  3EDA    23             C      	inc	hl
                         C      
  3EDB    36 0A          C      	ld	(hl),lf
                         C      
  3EDD    23             C      	inc	hl
                         C      
  3EDE    36 FF          C      	ld	(hl),-1
                         C      
  3EE0    21 6A35        C      	ld	hl,l6aa8
                         C      
  3EE3    CD 1665        C      	call	.CnvToken	; Convert to token
                         C      
  3EE6    CD 41BA        C      	call	l4215
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-255


  3EE9    C3 4362        C      	jp	l43bd
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : COMMON
                         C      
                         C      ;
                         C      
  3EEC                   C      l3f47:
                         C      
  3EEC    CD 4006        C      	call	l4061
                         C      
  3EEF    CD 3FE6        C      	call	l4041
                         C      
  3EF2    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  3EF5    FE 3D          C      	cp	3dh		; Test /
                         C      
  3EF7    C2 3F8C        C      	jp	nz,l3fe7
                         C      
  3EFA    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
                         C      
  3EFD    E5             C      	push	hl
                         C      
  3EFE    06 11          C      	ld	b,17
                         C      
  3F00    3E 56          C      	ld	a,56h		; Set search for string
                         C      
  3F02                   C      l3f5d:
                         C      
  3F02    23             C      	inc	hl
                         C      
  3F03    BE             C      	cp	(hl)
                         C      
  3F04    30 15          C      	jr	nc,l3f76
                         C      
  3F06    10 FA          C      	djnz	l3f5d
                         C      
  3F08    36 00          C      	ld	(hl),0
                         C      
  3F0A    E5             C      	push	hl
                         C      
  3F0B                   C      l3f66:
                         C      
  3F0B    23             C      	inc	hl
                         C      
  3F0C    BE             C      	cp	(hl)
                         C      
  3F0D    38 FC          C      	jr	c,l3f66
                         C      
  3F0F    7E             C      	ld	a,(hl)
                         C      
  3F10    FE 3D          C      	cp	3dh		; Test /
                         C      
  3F12    20 78          C      	jr	nz,l3fe7
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-256


  3F14    22 62F5        C      	ld	(TokPtr),hl	; Set pointer
                         C      
  3F17    E1             C      	pop	hl
                         C      
  3F18    04             C      	inc	b
                         C      
  3F19    18 0A          C      	jr	l3f80
                         C      
  3F1B                   C      l3f76:
                         C      
  3F1B    7E             C      	ld	a,(hl)
                         C      
  3F1C    FE 3D          C      	cp	'='
                         C      
  3F1E    20 6C          C      	jr	nz,l3fe7
                         C      
  3F20    36 00          C      	ld	(hl),0		; Set end
                         C      
  3F22    22 62F5        C      	ld	(TokPtr),hl	; .. save pointer
                         C      
  3F25                   C      l3f80:
                         C      
  3F25    3E 11          C      	ld	a,11h
                         C      
  3F27    90             C      	sub	b
                         C      
  3F28    32 3F91        C      	ld	(l3fec),a
                         C      
  3F2B    C1             C      	pop	bc
                         C      
  3F2C    03             C      	inc	bc
                         C      
  3F2D    21 67A0        C      	ld	hl,l6813
                         C      
  3F30                   C      l3f8b:
                         C      
  3F30    5E             C      	ld	e,(hl)
                         C      
  3F31    23             C      	inc	hl
                         C      
  3F32    56             C      	ld	d,(hl)
                         C      
  3F33    23             C      	inc	hl
                         C      
  3F34    EB             C      	ex	de,hl
                         C      
  3F35    7C             C      	ld	a,h
                         C      
  3F36    B5             C      	or	l
                         C      
  3F37    28 3C          C      	jr	z,l3fd0
                         C      
  3F39    C5             C      	push	bc
                         C      
  3F3A                   C      l3f95:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-257


  3F3A    0A             C      	ld	a,(bc)
                         C      
  3F3B    BE             C      	cp	(hl)
                         C      
  3F3C    23             C      	inc	hl
                         C      
  3F3D    03             C      	inc	bc
                         C      
  3F3E    20 31          C      	jr	nz,l3fcc
                         C      
  3F40    B7             C      	or	a
                         C      
  3F41    20 F7          C      	jr	nz,l3f95
                         C      
  3F43    C1             C      	pop	bc
                         C      
  3F44                   C      l3f9f:
                         C      
  3F44    EB             C      	ex	de,hl
                         C      
  3F45    11 679C        C      	ld	de,l680f
                         C      
  3F48    ED 52          C      	sbc	hl,de
                         C      
  3F4A    E5             C      	push	hl
                         C      
  3F4B    29             C      	add	hl,hl
                         C      
  3F4C    11 6754        C      	ld	de,l67c7
                         C      
  3F4F    19             C      	add	hl,de
                         C      
  3F50    5E             C      	ld	e,(hl)
                         C      
  3F51    23             C      	inc	hl
                         C      
  3F52    56             C      	ld	d,(hl)
                         C      
  3F53    EB             C      	ex	de,hl
                         C      
  3F54    3A 0135        C      	ld	a,($COMM.0$)	; Test COMMON back 0000
                         C      
  3F57    B7             C      	or	a
                         C      
  3F58    28 03          C      	jr	z,l3fb8		; ..nope
                         C      
  3F5A    21 0000        C      	ld	hl,0		; .. set 0
                         C      
  3F5D                   C      l3fb8:
                         C      
  3F5D    D1             C      	pop	de
                         C      
  3F5E    7B             C      	ld	a,e
                         C      
  3F5F    1F             C      	rra
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-258


  3F60    FE 0F          C      	cp	0fh
                         C      
  3F62    DA 4D41        C      	jp	c,l4d9c
                         C      
  3F65    21 67B8        C      	ld	hl,l682b
                         C      
  3F68    AF             C      	xor	a
                         C      
  3F69    77             C      	ld	(hl),a
                         C      
  3F6A    23             C      	inc	hl
                         C      
  3F6B    77             C      	ld	(hl),a
                         C      
  3F6C    0E 0D          C      	ld	c,13
                         C      
  3F6E    C3 0905        C      	jp	ERROR
                         C      
  3F71                   C      l3fcc:
                         C      
  3F71    C1             C      	pop	bc
                         C      
  3F72    EB             C      	ex	de,hl
                         C      
  3F73    18 BB          C      	jr	l3f8b
                         C      
  3F75                   C      l3fd0:
                         C      
  3F75    D5             C      	push	de
                         C      
  3F76    C5             C      	push	bc
                         C      
  3F77    3A 3F91        C      	ld	a,(l3fec)
                         C      
  3F7A    4F             C      	ld	c,a
                         C      
  3F7B    0C             C      	inc	c
                         C      
  3F7C    06 00          C      	ld	b,0
                         C      
  3F7E    CD 229A        C      	call	d.alloc_	; Allocate memory
                         C      
  3F81    EB             C      	ex	de,hl
                         C      
  3F82    2B             C      	dec	hl
                         C      
  3F83    72             C      	ld	(hl),d
                         C      
  3F84    2B             C      	dec	hl
                         C      
  3F85    73             C      	ld	(hl),e
                         C      
  3F86    E1             C      	pop	hl
                         C      
  3F87    ED B0          C      	ldir
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-259


  3F89    D1             C      	pop	de
                         C      
  3F8A    18 B8          C      	jr	l3f9f
                         C      
  3F8C                   C      l3fe7:
                         C      
  3F8C    0E 1A          C      	ld	c,26
                         C      
  3F8E    C3 0905        C      	jp	ERROR
                         C      
  3F91                   C      l3fec:
                         C      
  3F91    00             C      	db	0
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .COMMENT
                         C      
                         C      ;
                         C      
  3F92                   C      l3fed:
                         C      
  3F92    CD 07D4        C      	call	l07ee
                         C      
  3F95    CD 0DCB        C      	call	.PartToken
                         C      
  3F98    FE 36          C      	cp	36h		; Test empty line
                         C      
  3F9A    C8             C      	ret	z		; .. skip
                         C      
  3F9B    CD 3346        C      	call	l33a1
                         C      
  3F9E    03             C      	inc	bc
                         C      
  3F9F    0A             C      	ld	a,(bc)
                         C      
  3FA0    5F             C      	ld	e,a
                         C      
  3FA1                   C      l3ffc:
                         C      
  3FA1    03             C      	inc	bc
                         C      
  3FA2    0A             C      	ld	a,(bc)		; Get character
                         C      
  3FA3    BB             C      	cp	e		; .. compare
                         C      
  3FA4    CA 4BC5        C      	jp	z,l4c20		; .. end of .COMMENT
                         C      
  3FA7    FE 0D          C      	cp	cr
                         C      
  3FA9    20 F6          C      	jr	nz,l3ffc	; .. skip line
                         C      
  3FAB    D5             C      	push	de
                         C      
  3FAC    CD 14C2        C      	call	RdLine		; Read next line
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-260


  3FAF    CD 07D7        C      	call	l07f1
                         C      
  3FB2    D1             C      	pop	de
                         C      
  3FB3    01 026D        C      	ld	bc,$SRCline$	; Get line
                         C      
  3FB6    0A             C      	ld	a,(bc)
                         C      
  3FB7    FE 1A          C      	cp	eof		; Test end of file
                         C      
  3FB9    0B             C      	dec	bc
                         C      
  3FBA    20 E5          C      	jr	nz,l3ffc	; .. nope, try next
                         C      
  3FBC    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .CREF
                         C      
                         C      ;
                         C      
  3FBD                   C      l4018:
                         C      
  3FBD    3A 62C3        C      	ld	a,(_OPT_)
                         C      
  3FC0    E6 08          C      	and	1 SHL _CROSS	; Test cross reference
                         C      
  3FC2    C8             C      	ret	z		; .. nope
                         C      
  3FC3    21 1479        C      	ld	hl,l1493
                         C      
  3FC6    3A 6617        C      	ld	a,(Pass)	; Test pass
                         C      
  3FC9    B7             C      	or	a
                         C      
  3FCA    28 03          C      	jr	z,l402a		; .. 1st pass
                         C      
  3FCC    21 1488        C      	ld	hl,l14a2
                         C      
  3FCF                   C      l402a:
                         C      
  3FCF    22 1465        C      	ld	($CrsVec),hl	; Set address
                         C      
  3FD2    3E C3          C      	ld	a,_JP
                         C      
  3FD4    32 1464        C      	ld	($CrsEna),a	; Enable cross ref
                         C      
  3FD7    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : DSEG
                         C      
                         C      ;
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-261


  3FD8                   C      l4033:
                         C      
  3FD8    CD 4006        C      	call	l4061
                         C      
  3FDB    CD 3FE6        C      	call	l4041
                         C      
  3FDE    3E 02          C      	ld	a,2
                         C      
  3FE0    2A 675C        C      	ld	hl,(l67cf)
                         C      
  3FE3    C3 4D41        C      	jp	l4d9c
                         C      
  3FE6                   C      l4041:
                         C      
  3FE6    3A 67F1        C      	ld	a,($REL$)	; Get mode
                         C      
  3FE9    87             C      	add	a,a		; .. as index
                         C      
  3FEA    87             C      	add	a,a
                         C      
  3FEB    21 6754        C      	ld	hl,l67c7
                         C      
  3FEE    4F             C      	ld	c,a
                         C      
  3FEF    06 00          C      	ld	b,0
                         C      
  3FF1    09             C      	add	hl,bc
                         C      
  3FF2    FD E5          C      	push	iy
                         C      
  3FF4    C1             C      	pop	bc
                         C      
  3FF5    71             C      	ld	(hl),c
                         C      
  3FF6    23             C      	inc	hl
                         C      
  3FF7    70             C      	ld	(hl),b
                         C      
  3FF8    23             C      	inc	hl
                         C      
  3FF9    5E             C      	ld	e,(hl)
                         C      
  3FFA    23             C      	inc	hl
                         C      
  3FFB    56             C      	ld	d,(hl)
                         C      
  3FFC    EB             C      	ex	de,hl
                         C      
  3FFD    B7             C      	or	a
                         C      
  3FFE    ED 42          C      	sbc	hl,bc
                         C      
  4000    D0             C      	ret	nc
                         C      
  4001    EB             C      	ex	de,hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-262


  4002    70             C      	ld	(hl),b
                         C      
  4003    2B             C      	dec	hl
                         C      
  4004    71             C      	ld	(hl),c
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .Z80 -- Dummy
                         C      
                         C      ;
                         C      
  4005                   C      l4060:
                         C      
  4005    C9             C      	ret
                         C      
  4006                   C      l4061:
                         C      
  4006    CD 4B25        C      	call	l4b80
                         C      
  4009                   C      l4064:
                         C      
  4009    3A 62C3        C      	ld	a,(_OPT_)
                         C      
  400C    B7             C      	or	a		; Test relocatable
                         C      
  400D    F8             C      	ret	m		; .. yeap
                         C      
  400E    0E 0C          C      	ld	c,12
                         C      
  4010    C3 0905        C      	jp	ERROR
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : DC
                         C      
                         C      ;
                         C      
  4013                   C      l406e:
                         C      
  4013    21 40EF        C      	ld	hl,l414a
                         C      
  4016    3E 02          C      	ld	a,2		; Set mode
                         C      
  4018    18 08          C      	jr	l407d
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : DEFZ
                         C      
                         C      ;
                         C      
  401A                   C      l4075:
                         C      
  401A    3E 01          C      	ld	a,1
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-263


  401C    18 01          C      	jr	l407a
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : DB
                         C      
                         C      ;
                         C      
  401E                   C      l4079:
                         C      
  401E    AF             C      	xor	a
                         C      
  401F                   C      l407a:
                         C      
  401F    21 6328        C      	ld	hl,Con$Put	; Set code
                         C      
  4022                   C      l407d:
                         C      
  4022    22 40ED        C      	ld	(l4148),hl
                         C      
  4025    32 679B        C      	ld	(ConPag),a	; Init console page
                         C      
  4028    21 0100        C      	ld	hl,l0100
                         C      
  402B    22 679C        C      	ld	(l680f),hl
                         C      
  402E    3A 6806        C      	ld	a,(l6879)
                         C      
  4031    B7             C      	or	a
                         C      
  4032    28 0B          C      	jr	z,l409a
                         C      
  4034    AF             C      	xor	a
                         C      
  4035    32 6806        C      	ld	(l6879),a
                         C      
  4038    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
                         C      
  403B    2B             C      	dec	hl
                         C      
  403C    22 62F5        C      	ld	(TokPtr),hl	; .. to token pointer
                         C      
  403F                   C      l409a:
                         C      
  403F    3E FF          C      	ld	a,0ffh
                         C      
  4041    32 679A        C      	ld	(l680d),a
                         C      
  4044                   C      l409f:
                         C      
  4044    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  4047    FE 50          C      	cp	50h		; Test ,
                         C      
  4049    20 06          C      	jr	nz,l40ac	; .. nope
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-264


  404B    FD 22 67F2     C      	ld	(l6865),iy
                         C      
  404F    18 F3          C      	jr	l409f
                         C      
  4051                   C      l40ac:
                         C      
  4051    FE 36          C      	cp	36h		; Test end of line
                         C      
  4053    28 1A          C      	jr	z,l40ca
                         C      
  4055    FE 56          C      	cp	56h		; .. string
                         C      
  4057    20 0E          C      	jr	nz,l40c2
                         C      
  4059    46             C      	ld	b,(hl)
                         C      
  405A                   C      l40b5:
                         C      
  405A    23             C      	inc	hl
                         C      
  405B    7E             C      	ld	a,(hl)
                         C      
  405C    CD 40EC        C      	call	l4147
                         C      
  405F    10 F9          C      	djnz	l40b5
                         C      
  4061    23             C      	inc	hl
                         C      
  4062    22 62F5        C      	ld	(TokPtr),hl	; Set token pointer
                         C      
  4065    18 DD          C      	jr	l409f
                         C      
  4067                   C      l40c2:
                         C      
  4067    CD 3590        C      	call	l35eb
                         C      
  406A    CD 40C5        C      	call	l4120
                         C      
  406D    18 D5          C      	jr	l409f
                         C      
  406F                   C      l40ca:
                         C      
  406F    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
                         C      
  4072    2B             C      	dec	hl
                         C      
  4073    22 62F5        C      	ld	(TokPtr),hl	; .. to token pointer
                         C      
  4076    AF             C      	xor	a
                         C      
  4077    32 679A        C      	ld	(l680d),a
                         C      
  407A    21 679B        C      	ld	hl,ConPag
                         C      
  407D    7E             C      	ld	a,(hl)		; Get console page
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-265


  407E    36 00          C      	ld	(hl),0		; .. clear
                         C      
  4080    B7             C      	or	a		; Test any line
                         C      
  4081    C8             C      	ret	z		; .. nope
                         C      
  4082    3D             C      	dec	a
                         C      
  4083    CA 6328        C      	jp	z,Con$Put	; Put 00 to file
                         C      
  4086    2A 679C        C      	ld	hl,(l680f)
                         C      
  4089    25             C      	dec	h
                         C      
  408A    C8             C      	ret	z
                         C      
  408B    7D             C      	ld	a,l
                         C      
  408C    F6 80          C      	or	80h
                         C      
  408E    25             C      	dec	h
                         C      
  408F    C2 6328        C      	jp	nz,Con$Put	; Put to file
                         C      
  4092    CD 3026        C      	call	l3081
                         C      
  4095    3A 6409        C      	ld	a,(l647c)
                         C      
  4098    3C             C      	inc	a
                         C      
  4099    20 11          C      	jr	nz,l4107
                         C      
  409B    3A 6406        C      	ld	a,(l6479)
                         C      
  409E    B7             C      	or	a
                         C      
  409F    20 0B          C      	jr	nz,l4107
                         C      
  40A1    3A 6407        C      	ld	a,(l647a)
                         C      
  40A4    F6 80          C      	or	80h
                         C      
  40A6    32 6407        C      	ld	(l647a),a
                         C      
  40A9    C3 3B96        C      	jp	l3bf1
                         C      
  40AC                   C      l4107:
                         C      
  40AC    21 40BE        C      	ld	hl,l4119
                         C      
  40AF    01 0007        C      	ld	bc,l4120-l4119
                         C      
  40B2    ED B0          C      	ldir
                         C      
  40B4    21 6406        C      	ld	hl,l6479
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-266


  40B7    7E             C      	ld	a,(hl)
                         C      
  40B8    F6 90          C      	or	90h
                         C      
  40BA    77             C      	ld	(hl),a
                         C      
  40BB    C3 3B96        C      	jp	l3bf1
                         C      
  40BE                   C      l4119:
                         C      
  40BE    90 80 00 B6    C      	db	90h,80h,0,0b6h,0,0,0ffh
  40C2    00 00 FF       C      
                         C      
  40C5                   C      l4120:
                         C      
  40C5    3A 679B        C      	ld	a,(ConPag)	; Get console page
                         C      
  40C8    FE 02          C      	cp	2		; Test two lines
                         C      
  40CA    C2 3B96        C      	jp	nz,l3bf1	; .. nope
                         C      
  40CD    2A 679C        C      	ld	hl,(l680f)
                         C      
  40D0    25             C      	dec	h
                         C      
  40D1    28 0F          C      	jr	z,l413d
                         C      
  40D3    25             C      	dec	h
                         C      
  40D4    28 06          C      	jr	z,l4137
                         C      
  40D6    7D             C      	ld	a,l
                         C      
  40D7    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  40DA    18 06          C      	jr	l413d
                         C      
  40DC                   C      l4137:
                         C      
  40DC    CD 2FFE        C      	call	l3059
                         C      
  40DF    C3 3B96        C      	jp	l3bf1
                         C      
  40E2                   C      l413d:
                         C      
  40E2    CD 302E        C      	call	l3089
                         C      
  40E5    21 01ED        C      	ld	hl,CtrlArr	; Init control l0200 ????
                         C      
  40E8    22 679C        C      	ld	(l680f),hl
                         C      
  40EB    C9             C      	ret
                         C      
  40EC                   C      l4147:
                         C      
  40EC    C3 6328        C      	jp	Con$Put		; Put to file
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-267


                         C      
  40ED                   C      l4148	equ	$-2
                         C      
  40EF                   C      l414a:
                         C      
  40EF    4F             C      	ld	c,a
                         C      
  40F0    E5             C      	push	hl
                         C      
  40F1    C5             C      	push	bc
                         C      
  40F2    2A 679C        C      	ld	hl,(l680f)
                         C      
  40F5    06 00          C      	ld	b,0
                         C      
  40F7    ED 43 679C     C      	ld	(l680f),bc
                         C      
  40FB    25             C      	dec	h
                         C      
  40FC    7D             C      	ld	a,l
                         C      
  40FD    28 03          C      	jr	z,l415d
                         C      
  40FF    25             C      	dec	h
                         C      
  4100    28 06          C      	jr	z,l4163
                         C      
  4102                   C      l415d:
                         C      
  4102    C1             C      	pop	bc
                         C      
  4103    E1             C      	pop	hl
                         C      
  4104    C8             C      	ret	z
                         C      
  4105    C3 6328        C      	jp	Con$Put		; .. put to file
                         C      
  4108                   C      l4163:
                         C      
  4108    CD 3026        C      	call	l3081
                         C      
  410B    CD 3B96        C      	call	l3bf1
                         C      
  410E    C1             C      	pop	bc
                         C      
  410F    E1             C      	pop	hl
                         C      
  4110    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : DS
                         C      
                         C      ;
                         C      
  4111                   C      l416c:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-268


                         C      
  4111    CD 4187        C      	call	l41e2
                         C      
  4114    E5             C      	push	hl
                         C      
  4115    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  4118    FE 50          C      	cp	50h		; Test comma
                         C      
  411A    20 41          C      	jr	nz,l41b8
                         C      
  411C    CD 358D        C      	call	l35e8
                         C      
  411F    3A 6617        C      	ld	a,(Pass)	; Test pass
                         C      
  4122    B7             C      	or	a
                         C      
  4123    28 38          C      	jr	z,l41b8		; .. 1st pass
                         C      
  4125    E1             C      	pop	hl
                         C      
  4126    7C             C      	ld	a,h
                         C      
  4127    B5             C      	or	l
                         C      
  4128    28 34          C      	jr	z,l41b9
                         C      
  412A    45             C      	ld	b,l
                         C      
  412B    4C             C      	ld	c,h
                         C      
  412C    04             C      	inc	b
                         C      
  412D    05             C      	dec	b
                         C      
  412E    28 01          C      	jr	z,l418c
                         C      
  4130    0C             C      	inc	c
                         C      
  4131                   C      l418c:
                         C      
  4131    3A 6409        C      	ld	a,(l647c)
                         C      
  4134    3C             C      	inc	a
                         C      
  4135    20 1B          C      	jr	nz,l41ad
                         C      
  4137    3A 6406        C      	ld	a,(l6479)
                         C      
  413A    E6 0F          C      	and	0fh
                         C      
  413C    20 14          C      	jr	nz,l41ad
                         C      
  413E    2A 6407        C      	ld	hl,(l647a)
                         C      
  4141    24             C      	inc	h
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-269


                         C      
  4142    28 04          C      	jr	z,l41a3
                         C      
  4144    25             C      	dec	h
                         C      
  4145    C4 3BA4        C      	call	nz,l3bff
                         C      
  4148                   C      l41a3:
                         C      
  4148    7D             C      	ld	a,l
                         C      
  4149    CD 6328        C      	call	Con$Put		; Put to file
                         C      
  414C    10 FA          C      	djnz	l41a3
                         C      
  414E    0D             C      	dec	c
                         C      
  414F    20 F7          C      	jr	nz,l41a3
                         C      
  4151    C9             C      	ret
                         C      
  4152                   C      l41ad:
                         C      
  4152    C5             C      	push	bc
                         C      
  4153    CD 3B96        C      	call	l3bf1
                         C      
  4156    C1             C      	pop	bc
                         C      
  4157    10 F9          C      	djnz	l41ad
                         C      
  4159    0D             C      	dec	c
                         C      
  415A    20 F6          C      	jr	nz,l41ad
                         C      
  415C    C9             C      	ret
                         C      
  415D                   C      l41b8:
                         C      
  415D    E1             C      	pop	hl
                         C      
  415E                   C      l41b9:
                         C      
  415E    3E FF          C      	ld	a,0ffh
                         C      
  4160    32 679A        C      	ld	(l680d),a
                         C      
  4163    AF             C      	xor	a
                         C      
  4164    CD 635E        C      	call	l63d1
                         C      
  4167    AF             C      	xor	a
                         C      
  4168    32 679A        C      	ld	(l680d),a
                         C      
  416B    FD E5          C      	push	iy
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-270


                         C      
  416D    D1             C      	pop	de
                         C      
  416E    19             C      	add	hl,de
                         C      
  416F    3A 67F1        C      	ld	a,($REL$)	; Get mode
                         C      
  4172    C3 4D41        C      	jp	l4d9c
                         C      
  4175                   C      l41d0:
                         C      
  4175    3E FF          C      	ld	a,0ffh
                         C      
  4177    32 6791        C      	ld	(l6804),a
                         C      
  417A    CD 4187        C      	call	l41e2
                         C      
  417D    AF             C      	xor	a
                         C      
  417E    32 6791        C      	ld	(l6804),a
                         C      
  4181    C9             C      	ret
                         C      
  4182                   C      l41dd:
                         C      
  4182    CD 3590        C      	call	l35eb
                         C      
  4185    18 03          C      	jr	l41e5
                         C      
  4187                   C      l41e2:
                         C      
  4187    CD 358D        C      	call	l35e8
                         C      
  418A                   C      l41e5:
                         C      
  418A    3A 6409        C      	ld	a,(l647c)
                         C      
  418D    3C             C      	inc	a
                         C      
  418E    20 06          C      	jr	nz,l41f1
                         C      
  4190    3A 6406        C      	ld	a,(l6479)
                         C      
  4193    B7             C      	or	a
                         C      
  4194    28 1B          C      	jr	z,l420c
                         C      
  4196                   C      l41f1:
                         C      
  4196    3A 6791        C      	ld	a,(l6804)
                         C      
  4199    B7             C      	or	a
                         C      
  419A    28 0D          C      	jr	z,l4204
                         C      
  419C    3A 012F        C      	ld	a,($NO.IF1$)	; Test IF errors in pass 1
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-271


                         C      
  419F    B7             C      	or	a
                         C      
  41A0    28 07          C      	jr	z,l4204		; .. nope
                         C      
  41A2    3A 6617        C      	ld	a,(Pass)	; Test pass
                         C      
  41A5    E6 01          C      	and	1
                         C      
  41A7    EE 01          C      	xor	1		; .. zero is 2nd pass
                         C      
  41A9                   C      l4204:
                         C      
  41A9    CC 43E3        C      	call	z,l443e
                         C      
  41AC    37             C      	scf
                         C      
  41AD    21 0000        C      	ld	hl,0
                         C      
  41B0    C9             C      	ret
                         C      
  41B1                   C      l420c:
                         C      
  41B1    2A 6407        C      	ld	hl,(l647a)
                         C      
  41B4    C9             C      	ret
                         C      
  41B5                   C      l4210:
                         C      
  41B5    CD 3590        C      	call	l35eb
                         C      
  41B8    18 03          C      	jr	l4218
                         C      
  41BA                   C      l4215:
                         C      
  41BA    CD 358D        C      	call	l35e8
                         C      
  41BD                   C      l4218:
                         C      
  41BD    3A 6409        C      	ld	a,(l647c)
                         C      
  41C0    3C             C      	inc	a
                         C      
  41C1    20 D3          C      	jr	nz,l41f1
                         C      
  41C3    3A 6406        C      	ld	a,(l6479)
                         C      
  41C6    FE 0F          C      	cp	0fh
                         C      
  41C8    30 CC          C      	jr	nc,l41f1
                         C      
  41CA    B7             C      	or	a
                         C      
  41CB    18 E4          C      	jr	l420c
                         C      
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-272


                         C      
                         C      ; Pseudo code : DW
                         C      
                         C      ;
                         C      
  41CD                   C      l4228:
                         C      
  41CD    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  41D0    FE 56          C      	cp	56h
                         C      
  41D2    20 17          C      	jr	nz,l4246
                         C      
  41D4    46             C      	ld	b,(hl)
                         C      
  41D5    04             C      	inc	b
                         C      
  41D6    CB 38          C      	srl	b
                         C      
  41D8                   C      l4233:
                         C      
  41D8    23             C      	inc	hl
                         C      
  41D9    4E             C      	ld	c,(hl)
                         C      
  41DA    23             C      	inc	hl
                         C      
  41DB    7E             C      	ld	a,(hl)
                         C      
  41DC    CD 6328        C      	call	Con$Put		; Put word to file
                         C      
  41DF    79             C      	ld	a,c
                         C      
  41E0    CD 6328        C      	call	Con$Put		; .. lo part
                         C      
  41E3    10 F3          C      	djnz	l4233
                         C      
  41E5    23             C      	inc	hl
                         C      
  41E6    22 62F5        C      	ld	(TokPtr),hl	; Set token pointer
                         C      
  41E9    18 06          C      	jr	l424c
                         C      
  41EB                   C      l4246:
                         C      
  41EB    CD 3590        C      	call	l35eb
                         C      
  41EE    CD 6349        C      	call	l63bc
                         C      
  41F1                   C      l424c:
                         C      
  41F1    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  41F4    FE 50          C      	cp	50h		; Test comma
                         C      
  41F6    C2 406F        C      	jp	nz,l40ca
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-273


                         C      
  41F9    FD 22 67F2     C      	ld	(l6865),iy
                         C      
  41FD    18 CE          C      	jr	l4228
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .DEPHASE
                         C      
                         C      ;
                         C      
  41FF                   C      l425a:
                         C      
  41FF    21 679E        C      	ld	hl,l6811
                         C      
  4202    7E             C      	ld	a,(hl)
                         C      
  4203    B7             C      	or	a
                         C      
  4204    28 1D          C      	jr	z,l427e
                         C      
  4206    36 00          C      	ld	(hl),0
                         C      
  4208    FD E5          C      	push	iy
                         C      
  420A    D1             C      	pop	de
                         C      
  420B    2A 6610        C      	ld	hl,(l6683)
                         C      
  420E    19             C      	add	hl,de
                         C      
  420F    ED 5B 6613     C      	ld	de,(l6686)
                         C      
  4213    B7             C      	or	a
                         C      
  4214    ED 52          C      	sbc	hl,de
                         C      
  4216    E5             C      	push	hl
                         C      
  4217    FD E1          C      	pop	iy
                         C      
  4219    22 67F2        C      	ld	(l6865),hl
                         C      
  421C    3A 660F        C      	ld	a,(l6682)
                         C      
  421F    32 67F1        C      	ld	($REL$),a	; Set mode
                         C      
  4222    C9             C      	ret
                         C      
  4223                   C      l427e:
                         C      
  4223    0E 0F          C      	ld	c,15
                         C      
  4225    C3 08F5        C      	jp	.ERROR
                         C      
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-274


                         C      
                         C      ; Pseudo code : ?????
                         C      
                         C      ;
                         C      
  4228                   C      l4283:
                         C      
  4228    3A 6809        C      	ld	a,(l687c)
                         C      
  422B    B7             C      	or	a
                         C      
  422C    20 0E          C      	jr	nz,l4297
                         C      
  422E    2A 67F8        C      	ld	hl,(l686b)
                         C      
  4231    7C             C      	ld	a,h
                         C      
  4232    B5             C      	or	l
                         C      
  4233    28 56          C      	jr	z,l42e6
                         C      
  4235    2B             C      	dec	hl
                         C      
  4236    22 67F8        C      	ld	(l686b),hl
                         C      
  4239    C3 450C        C      	jp	l4567
                         C      
  423C                   C      l4297:
                         C      
  423C    2A 67D1        C      	ld	hl,(l6844)
                         C      
  423F    2B             C      	dec	hl
                         C      
  4240    7C             C      	ld	a,h
                         C      
  4241    B5             C      	or	l
                         C      
  4242    C0             C      	ret	nz
                         C      
  4243    22 67D1        C      	ld	(l6844),hl
                         C      
  4246    C3 44F4        C      	jp	l454f
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : END
                         C      
                         C      ;
                         C      
  4249                   C      l42a4:
                         C      
  4249    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  424C    FE 36          C      	cp	36h		; Test new line
                         C      
  424E    28 09          C      	jr	z,l42b4		; .. yeap
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-275


                         C      
  4250    CD 41B5        C      	call	l4210
                         C      
  4253    22 67C0        C      	ld	(XFER),hl	; Set transfer address
                         C      
  4256    32 67BF        C      	ld	(l6832),a
                         C      
  4259                   C      l42b4:
                         C      
  4259    2A 67F4        C      	ld	hl,(l6867)
                         C      
  425C    11 FFF2        C      	ld	de,lfff2
                         C      
  425F    19             C      	add	hl,de
                         C      
  4260    5E             C      	ld	e,(hl)
                         C      
  4261    23             C      	inc	hl
                         C      
  4262    56             C      	ld	d,(hl)
                         C      
  4263    7B             C      	ld	a,e
                         C      
  4264    B2             C      	or	d
                         C      
  4265    28 05          C      	jr	z,l42c7
                         C      
  4267    CD 1624        C      	call	l163e
                         C      
  426A    18 ED          C      	jr	l42b4
                         C      
  426C                   C      l42c7:
                         C      
  426C    21 427D        C      	ld	hl,l42d8
                         C      
  426F    22 67FD        C      	ld	(l6870),hl
                         C      
                         C      	ld.hl	1,3
  4272    21 0103        C+     	ld	hl,1*256+3
                         C      
  4275    22 67FF        C      	ld	(_rPage_),hl	; Init read pages
                         C      
  4278    C3 4B25        C      	jp	l4b80
                         C      
                         C      
                         C      
  427B    1A 1A          C      	db	1ah,1ah
                         C      
  427D                   C      l42d8:
                         C      
  427D    1A             C      	db	1ah
                         C      
  427E                   C      l42d9:
                         C      
  427E    1A 1A          C      	db	1ah,1ah
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-276


                         C      
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : ENDIF
                         C      
                         C      ;
                         C      
  4280                   C      l42db:
                         C      
  4280    3A 6809        C      	ld	a,(l687c)
                         C      
  4283    B7             C      	or	a
                         C      
  4284    20 0F          C      	jr	nz,l42f0
                         C      
  4286    2A 67F8        C      	ld	hl,(l686b)
                         C      
  4289    7C             C      	ld	a,h
                         C      
  428A    B5             C      	or	l
                         C      
  428B                   C      l42e6:
                         C      
  428B    0E 13          C      	ld	c,19
                         C      
  428D    CA 0905        C      	jp	z,ERROR
                         C      
  4290    2B             C      	dec	hl
                         C      
  4291    22 67F8        C      	ld	(l686b),hl
                         C      
  4294    C9             C      	ret
                         C      
  4295                   C      l42f0:
                         C      
  4295    2A 67D1        C      	ld	hl,(l6844)
                         C      
  4298    2B             C      	dec	hl
                         C      
  4299    22 67D1        C      	ld	(l6844),hl
                         C      
  429C    7C             C      	ld	a,h
                         C      
  429D    B5             C      	or	l
                         C      
  429E    C0             C      	ret	nz
                         C      
  429F    C3 44FB        C      	jp	l4556
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : ENDM	??????
                         C      
                         C      ;
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-277


  42A2                   C      l42fd:
                         C      
  42A2    0E 12          C      	ld	c,18
                         C      
  42A4    C3 0905        C      	jp	ERROR
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : ENTRY
                         C      
                         C      ;
                         C      
  42A7                   C      l4302:
                         C      
  42A7    CD 4009        C      	call	l4064
                         C      
  42AA                   C      l4305:
                         C      
  42AA    CD 42D3        C      	call	l432e
                         C      
  42AD    CD 42BF        C      	call	l431a
                         C      
  42B0    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  42B3    FE 50          C      	cp	50h		; Test comma
                         C      
  42B5    28 F3          C      	jr	z,l4305		; .. yeap
                         C      
  42B7    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
                         C      
  42BA    2B             C      	dec	hl
                         C      
  42BB    22 62F5        C      	ld	(TokPtr),hl	; .. to token pointer
                         C      
  42BE    C9             C      	ret
                         C      
  42BF                   C      l431a:
                         C      
  42BF    7E             C      	ld	a,(hl)
                         C      
  42C0    E6 0F          C      	and	0fh
                         C      
  42C2    FE 0F          C      	cp	0fh
                         C      
  42C4    28 03          C      	jr	z,l4324
                         C      
  42C6    CB EE          C      	set	5,(hl)
                         C      
  42C8    C9             C      	ret
                         C      
  42C9                   C      l4324:
                         C      
  42C9    0E 02          C      	ld	c,2
                         C      
  42CB    C3 08F5        C      	jp	.ERROR
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-278


  42CE                   C      l4329:
                         C      
  42CE    0E 02          C      	ld	c,2		; *** UNUSED IN SMM.001 ***
                         C      
  42D0    C3 0905        C      	jp	ERROR
                         C      
  42D3                   C      l432e:
                         C      
  42D3    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  42D6                   C      l4331:
                         C      
  42D6    CD 42DD        C      	call	l4338
                         C      
  42D9    C0             C      	ret	nz
                         C      
  42DA    C3 0908        C      	jp	l0922
                         C      
  42DD                   C      l4338:
                         C      
  42DD    FE 39          C      	cp	39h		; Test ???
                         C      
  42DF    28 21          C      	jr	z,l435d
                         C      
  42E1    26 03          C      	ld	h,HIGH l0400
                         C      
  42E3    6F             C      	ld	l,a
                         C      
  42E4    3A 01A2        C      	ld	a,(l01b5)
                         C      
  42E7    B7             C      	or	a
                         C      
  42E8    20 05          C      	jr	nz,l434a
                         C      
  42EA    04             C      	inc	b
                         C      
  42EB    05             C      	dec	b
                         C      
  42EC    28 01          C      	jr	z,l434a
                         C      
  42EE    24             C      	inc	h
                         C      
  42EF                   C      l434a:
                         C      
  42EF    CB 7E          C      	bit	7,(hl)
                         C      
  42F1    28 1B          C      	jr	z,l4369
                         C      
  42F3    ED 5B 6376     C      	ld	de,(TokStrt)	; Get start of token
                         C      
  42F7    1A             C      	ld	a,(de)
                         C      
  42F8    FE 57          C      	cp	57h		; .. test range
                         C      
  42FA    38 12          C      	jr	c,l4369
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-279


  42FC    CB F6          C      	set	6,(hl)
                         C      
  42FE    EB             C      	ex	de,hl
                         C      
  42FF    CD 0FBE        C      	call	GetLabel	; Get label
                         C      
  4302                   C      l435d:
                         C      
  4302    7E             C      	ld	a,(hl)
                         C      
  4303    FE F0          C      	cp	0f0h
                         C      
  4305    C0             C      	ret	nz
                         C      
  4306    23             C      	inc	hl
                         C      
  4307    5E             C      	ld	e,(hl)
                         C      
  4308    23             C      	inc	hl
                         C      
  4309    56             C      	ld	d,(hl)
                         C      
  430A    EB             C      	ex	de,hl
                         C      
  430B    3D             C      	dec	a
                         C      
  430C    7E             C      	ld	a,(hl)
                         C      
  430D    C9             C      	ret
                         C      
  430E                   C      l4369:
                         C      
  430E    0E 03          C      	ld	c,3
                         C      
  4310    CD 08F5        C      	call	.ERROR
                         C      
  4313    AF             C      	xor	a
                         C      
  4314    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : ASET
                         C      
                         C      ;
                         C      
  4315                   C      l4370:
                         C      
  4315    3E FF          C      	ld	a,TRUE
                         C      
  4317    18 01          C      	jr	l4375
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : EQU
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-280


                         C      ;
                         C      
  4319                   C      l4374:
                         C      
  4319    AF             C      	xor	a
                         C      
  431A                   C      l4375:
                         C      
  431A    32 6817        C      	ld	(SetFlg),a	; Set flag
                         C      
  431D    3E FF          C      	ld	a,0ffh
                         C      
  431F    32 6818        C      	ld	(l688b),a
                         C      
  4322    2A 67D8        C      	ld	hl,(l684b)
                         C      
  4325    7C             C      	ld	a,h
                         C      
  4326    B5             C      	or	l
                         C      
  4327    28 A5          C      	jr	z,l4329
                         C      
  4329    CD 358D        C      	call	l35e8
                         C      
  432C    3A 6817        C      	ld	a,(SetFlg)	; Test flag
                         C      
  432F    B7             C      	or	a
                         C      
  4330    28 09          C      	jr	z,l4396		; .. EQU
                         C      
  4332    2A 67D8        C      	ld	hl,(l684b)
                         C      
  4335    CD 4302        C      	call	l435d
                         C      
  4338    E6 70          C      	and	70h
                         C      
  433A    77             C      	ld	(hl),a
                         C      
  433B                   C      l4396:
                         C      
  433B    3A 6406        C      	ld	a,(l6479)
                         C      
  433E    2A 6407        C      	ld	hl,(l647a)
                         C      
  4341    FE 0F          C      	cp	0fh
                         C      
  4343    38 1D          C      	jr	c,l43bd
                         C      
  4345    3A 6617        C      	ld	a,(Pass)
                         C      
  4348    B7             C      	or	a
                         C      
  4349    28 10          C      	jr	z,l43b6		; .. 1st pass
                         C      
  434B    3D             C      	dec	a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-281


  434C    28 1D          C      	jr	z,l43c6
                         C      
  434E    1E E6          C      	ld	e,0e6h
                         C      
  4350    3A 6817        C      	ld	a,(SetFlg)	; Get flag
                         C      
  4353    B7             C      	or	a
                         C      
  4354    28 02          C      	jr	z,l43b3		; .. EQU
                         C      
  4356    1E E7          C      	ld	e,0e7h
                         C      
  4358                   C      l43b3:
                         C      
  4358    CD 3B6F        C      	call	l3bca
                         C      
  435B                   C      l43b6:
                         C      
  435B    21 0000        C      	ld	hl,0
                         C      
  435E    22 67D8        C      	ld	(l684b),hl
                         C      
  4361    C9             C      	ret
                         C      
  4362                   C      l43bd:
                         C      
  4362    22 67DB        C      	ld	(l684e),hl
                         C      
  4365    32 67DA        C      	ld	(l684d),a
                         C      
  4368    C3 635E        C      	jp	l63d1
                         C      
  436B                   C      l43c6:
                         C      
  436B    CD 43E3        C      	call	l443e
                         C      
  436E    C3 635E        C      	jp	l63d1
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : EXITM
                         C      
                         C      ;
                         C      
  4371                   C      l43cc:
                         C      
  4371    3A 67BA        C      	ld	a,(l682d)
                         C      
  4374    B7             C      	or	a
                         C      
  4375    CA 42A2        C      	jp	z,l42fd
                         C      
  4378    21 427D        C      	ld	hl,l42d8
                         C      
  437B    22 67FD        C      	ld	(l6870),hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-282


  437E    2A 67F4        C      	ld	hl,(l6867)
                         C      
  4381    7E             C      	ld	a,(hl)
                         C      
  4382    B7             C      	or	a
                         C      
  4383    F0             C      	ret	p
                         C      
  4384    3C             C      	inc	a
                         C      
  4385    C8             C      	ret	z
                         C      
  4386    11 0006        C      	ld	de,l0006
                         C      
  4389    19             C      	add	hl,de
                         C      
  438A    3C             C      	inc	a
                         C      
  438B    20 05          C      	jr	nz,l43ed
                         C      
  438D    AF             C      	xor	a
                         C      
  438E    77             C      	ld	(hl),a
                         C      
  438F    23             C      	inc	hl
                         C      
  4390    77             C      	ld	(hl),a
                         C      
  4391    C9             C      	ret
                         C      
  4392                   C      l43ed:
                         C      
  4392    23             C      	inc	hl
                         C      
  4393    23             C      	inc	hl
                         C      
  4394    11 439D        C      	ld	de,l43f8
                         C      
  4397    EB             C      	ex	de,hl
                         C      
  4398    ED 52          C      	sbc	hl,de
                         C      
  439A    EB             C      	ex	de,hl
                         C      
  439B    73             C      	ld	(hl),e
                         C      
  439C    23             C      	inc	hl
                         C      
  439D                   C      l43f8:
                         C      
  439D    72             C      	ld	(hl),d
                         C      
  439E    C9             C      	ret
                         C      
                         C      
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-283


  439F    FFFF           C      	dw	-1
                         C      
                         C      
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : BYTE
                         C      
                         C      ;
                         C      
  43A1                   C      l43fc:
                         C      
  43A1    CD 0DCB        C      	call	.PartToken
                         C      
  43A4    FE B4          C      	cp	0b4h		; Test EXTERN
                         C      
  43A6    C2 0903        C      	jp	nz,SyntaxErr	; .. should be
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : EXTRN
                         C      
                         C      ;
                         C      
  43A9                   C      l4404:
                         C      
  43A9    CD 4009        C      	call	l4064
                         C      
  43AC                   C      l4407:
                         C      
  43AC    CD 42D3        C      	call	l432e
                         C      
  43AF    CD 43C1        C      	call	l441c
                         C      
  43B2    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  43B5    FE 50          C      	cp	50h		; Test ,
                         C      
  43B7    28 F3          C      	jr	z,l4407
                         C      
  43B9    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
                         C      
  43BC    2B             C      	dec	hl
                         C      
  43BD    22 62F5        C      	ld	(TokPtr),hl	; .. to token pointer
                         C      
  43C0    C9             C      	ret
                         C      
  43C1                   C      l441c:
                         C      
  43C1    B7             C      	or	a
                         C      
  43C2    FA 43CD        C      	jp	m,l4428
                         C      
  43C5    CB 6F          C      	bit	5,a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-284


  43C7    20 04          C      	jr	nz,l4428
                         C      
  43C9    F6 0F          C      	or	0fh
                         C      
  43CB    77             C      	ld	(hl),a
                         C      
  43CC    C9             C      	ret
                         C      
  43CD                   C      l4428:
                         C      
  43CD    3A 6617        C      	ld	a,(Pass)
                         C      
  43D0    3D             C      	dec	a
                         C      
  43D1    C8             C      	ret	z		; .. end on pass 2
                         C      
  43D2    3D             C      	dec	a
                         C      
  43D3    20 06          C      	jr	nz,l4436	; .. 1st pass
                         C      
  43D5    7E             C      	ld	a,(hl)
                         C      
  43D6    E6 0F          C      	and	0fh
                         C      
  43D8    FE 0F          C      	cp	0fh
                         C      
  43DA    C8             C      	ret	z
                         C      
  43DB                   C      l4436:
                         C      
  43DB    E5             C      	push	hl
                         C      
  43DC    0E 02          C      	ld	c,2
                         C      
  43DE    CD 08F5        C      	call	.ERROR
                         C      
  43E1    E1             C      	pop	hl
                         C      
  43E2    C9             C      	ret
                         C      
  43E3                   C      l443e:
                         C      
  43E3    0E 06          C      	ld	c,6
                         C      
  43E5    CD 08F5        C      	call	.ERROR
                         C      
  43E8    AF             C      	xor	a
                         C      
  43E9    67             C      	ld	h,a
                         C      
  43EA    6F             C      	ld	l,a
                         C      
  43EB    32 6406        C      	ld	(l6479),a
                         C      
  43EE    22 6407        C      	ld	(l647a),hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-285


  43F1    3D             C      	dec	a
                         C      
  43F2    32 6409        C      	ld	(l647c),a
                         C      
  43F5    3C             C      	inc	a
                         C      
  43F6    C9             C      	ret
                         C      
  43F7                   C      l4452:
                         C      
  43F7    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  43FA    ED 4B 6376     C      	ld	bc,(TokStrt)	; Get start of token
                         C      
  43FE    0B             C      	dec	bc
                         C      
  43FF    CD 3346        C      	call	l33a1
                         C      
  4402    21 62F1        C      	ld	hl,l6364
                         C      
  4405    22 62F5        C      	ld	(TokPtr),hl	; Init token pointer
                         C      
  4408    60             C      	ld	h,b
                         C      
  4409    69             C      	ld	l,c
                         C      
  440A    23             C      	inc	hl
                         C      
  440B    C9             C      	ret
                         C      
  440C                   C      l4467:
                         C      
  440C    CD 43F7        C      	call	l4452
                         C      
  440F    CD 442D        C      	call	l4488
                         C      
  4412    D5             C      	push	de
                         C      
  4413    41             C      	ld	b,c
                         C      
  4414    C5             C      	push	bc
                         C      
  4415    FE 2C          C      	cp	','
                         C      
  4417    20 52          C      	jr	nz,l44c6
                         C      
  4419    CD 4462        C      	call	l44bd
                         C      
  441C    F1             C      	pop	af
                         C      
  441D    E1             C      	pop	hl
                         C      
  441E    B9             C      	cp	c
                         C      
  441F    C0             C      	ret	nz
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-286


  4420    B7             C      	or	a
                         C      
  4421    C8             C      	ret	z
                         C      
  4422    06 00          C      	ld	b,0
                         C      
  4424                   C      l447f:
                         C      
  4424    1A             C      	ld	a,(de)
                         C      
  4425    13             C      	inc	de
                         C      
  4426    ED A1          C      	cpi
                         C      
  4428    C0             C      	ret	nz
                         C      
  4429    EA 4424        C      	jp	pe,l447f
                         C      
  442C    C9             C      	ret
                         C      
  442D                   C      l4488:
                         C      
  442D    CD 446E        C      	call	l44c9
                         C      
  4430    FE 3C          C      	cp	'<'
                         C      
  4432    20 37          C      	jr	nz,l44c6
                         C      
  4434    3A 0130        C      	ld	a,($IF.SPC$)	; Test white space in IF
                         C      
  4437    B7             C      	or	a
                         C      
  4438    28 04          C      	jr	z,l4499		; .. nope
                         C      
  443A    CD 446E        C      	call	l44c9
                         C      
  443D    2B             C      	dec	hl
                         C      
  443E                   C      l4499:
                         C      
  443E    E5             C      	push	hl
                         C      
  443F    0E FF          C      	ld	c,0ffh
                         C      
  4441                   C      l449c:
                         C      
  4441    11 0D24        C      	ld	de,l0d3e
                         C      
  4444                   C      l449f:
                         C      
  4444    7E             C      	ld	a,(hl)
                         C      
  4445    23             C      	inc	hl
                         C      
  4446    BA             C      	cp	d
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-287


  4447    28 22          C      	jr	z,l44c6
                         C      
  4449    0C             C      	inc	c
                         C      
  444A    BB             C      	cp	e
                         C      
  444B    20 F7          C      	jr	nz,l449f
                         C      
  444D    CD 446E        C      	call	l44c9
                         C      
  4450    D1             C      	pop	de
                         C      
  4451    FE 0D          C      	cp	cr
                         C      
  4453    C8             C      	ret	z
                         C      
  4454    FE 3B          C      	cp	';'
                         C      
  4456    C8             C      	ret	z
                         C      
  4457    FE 2C          C      	cp	','
                         C      
  4459    C8             C      	ret	z
                         C      
  445A    D5             C      	push	de
                         C      
  445B    B7             C      	or	a
                         C      
  445C    ED 52          C      	sbc	hl,de
                         C      
  445E    4D             C      	ld	c,l
                         C      
  445F    19             C      	add	hl,de
                         C      
  4460    18 DF          C      	jr	l449c
                         C      
  4462                   C      l44bd:
                         C      
  4462    CD 442D        C      	call	l4488
                         C      
  4465    FE 0D          C      	cp	cr
                         C      
  4467    C8             C      	ret	z
                         C      
  4468    FE 3B          C      	cp	';'
                         C      
  446A    C8             C      	ret	z
                         C      
  446B                   C      l44c6:
                         C      
  446B    C3 0903        C      	jp	SyntaxErr
                         C      
  446E                   C      l44c9:
                         C      
  446E    7E             C      	ld	a,(hl)
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-288


  446F    23             C      	inc	hl
                         C      
  4470    FE 20          C      	cp	' '
                         C      
  4472    28 FA          C      	jr	z,l44c9
                         C      
  4474    FE 09          C      	cp	tab
                         C      
  4476    C0             C      	ret	nz
                         C      
  4477    18 F5          C      	jr	l44c9
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IFIDN
                         C      
                         C      ;
                         C      
  4479                   C      l44d4:
                         C      
  4479    CD 440C        C      	call	l4467
                         C      
  447C    18 3B          C      	jr	l4514
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IFDIF
                         C      
                         C      ;
                         C      
  447E                   C      l44d9:
                         C      
  447E    CD 440C        C      	call	l4467
                         C      
  4481    18 45          C      	jr	l4523
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IFB
                         C      
                         C      ;
                         C      
  4483                   C      l44de:
                         C      
  4483    CD 43F7        C      	call	l4452
                         C      
  4486    CD 4462        C      	call	l44bd
                         C      
  4489    79             C      	ld	a,c
                         C      
  448A    B7             C      	or	a
                         C      
  448B    18 2C          C      	jr	l4514
                         C      
                         C      ;
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-289


                         C      ; Pseudo code : IFNB
                         C      
                         C      ;
                         C      
  448D                   C      l44e8:
                         C      
  448D    CD 43F7        C      	call	l4452
                         C      
  4490    CD 4462        C      	call	l44bd
                         C      
  4493    79             C      	ld	a,c
                         C      
  4494    B7             C      	or	a
                         C      
  4495    18 31          C      	jr	l4523
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IF0
                         C      
                         C      ;
                         C      
  4497                   C      l44f2:
                         C      
  4497    3E 02          C      	ld	a,2		; One pass
                         C      
  4499    18 05          C      	jr	l44fb
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IF1
                         C      
                         C      ;
                         C      
  449B                   C      l44f6:
                         C      
  449B    AF             C      	xor	a		; .. 1st pass
                         C      
  449C    18 02          C      	jr	l44fb
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IF2
                         C      
                         C      ;
                         C      
  449E                   C      l44f9:
                         C      
  449E    3E 01          C      	ld	a,1		; .. 2nd pass
                         C      
  44A0                   C      l44fb:
                         C      
  44A0    21 6617        C      	ld	hl,Pass
                         C      
  44A3    BE             C      	cp	(hl)		; Test same pass
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-290


  44A4    18 13          C      	jr	l4514
                         C      
  44A6                   C      l4501:
                         C      
  44A6    CD 0DDB        C      	call	l0df5
                         C      
  44A9    3E 00          C      	ld	a,0
                         C      
  44AB    D8             C      	ret	c
                         C      
  44AC    7E             C      	ld	a,(hl)
                         C      
  44AD    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IFDEF
                         C      
                         C      ;
                         C      
  44AE                   C      l4509:
                         C      
  44AE    CD 44A6        C      	call	l4501
                         C      
  44B1    CB 7F          C      	bit	7,a
                         C      
  44B3    20 3F          C      	jr	nz,l454f
                         C      
  44B5    E6 0F          C      	and	0fh
                         C      
  44B7    FE 0F          C      	cp	0fh
                         C      
  44B9                   C      l4514:
                         C      
  44B9    28 39          C      	jr	z,l454f
                         C      
  44BB    18 4F          C      	jr	l4567
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IFNDEF
                         C      
                         C      ;
                         C      
  44BD                   C      l4518:
                         C      
  44BD    CD 44A6        C      	call	l4501
                         C      
  44C0    CB 7F          C      	bit	7,a
                         C      
  44C2    20 48          C      	jr	nz,l4567
                         C      
  44C4    E6 0F          C      	and	0fh
                         C      
  44C6    FE 0F          C      	cp	0fh
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-291


  44C8                   C      l4523:
                         C      
  44C8    28 42          C      	jr	z,l4567
                         C      
  44CA    18 28          C      	jr	l454f
                         C      
  44CC                   C      l4527:
                         C      
  44CC    3A 012E        C      	ld	a,($COND$)	; Test bit for TRUE FALSE
                         C      
  44CF    B7             C      	or	a
                         C      
  44D0    C8             C      	ret	z		; .. yeap
                         C      
  44D1    CB 1D          C      	rr	l
                         C      
  44D3    ED 62          C      	sbc	hl,hl		; Fix
                         C      
  44D5    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IFF
                         C      
                         C      ;
                         C      
  44D6                   C      l4531:
                         C      
  44D6    CD 4175        C      	call	l41d0
                         C      
  44D9    AF             C      	xor	a
                         C      
  44DA    CD 635E        C      	call	l63d1
                         C      
  44DD    CD 44CC        C      	call	l4527
                         C      
  44E0    7C             C      	ld	a,h
                         C      
  44E1    B5             C      	or	l
                         C      
  44E2    28 10          C      	jr	z,l454f
                         C      
  44E4    18 26          C      	jr	l4567
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IF
                         C      
                         C      ;
                         C      
  44E6                   C      l4541:
                         C      
  44E6    CD 4175        C      	call	l41d0
                         C      
  44E9    AF             C      	xor	a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-292


  44EA    CD 635E        C      	call	l63d1
                         C      
  44ED    CD 44CC        C      	call	l4527
                         C      
  44F0    7C             C      	ld	a,h
                         C      
  44F1    B5             C      	or	l
                         C      
  44F2    28 18          C      	jr	z,l4567
                         C      
  44F4                   C      l454f:
                         C      
  44F4    2A 67F8        C      	ld	hl,(l686b)
                         C      
  44F7    23             C      	inc	hl
                         C      
  44F8    22 67F8        C      	ld	(l686b),hl
                         C      
  44FB                   C      l4556:
                         C      
  44FB    AF             C      	xor	a
                         C      
  44FC    32 6809        C      	ld	(l687c),a
                         C      
  44FF    21 0DE5        C      	ld	hl,.FullToken
                         C      
  4502    22 0DE3        C      	ld	($GetVec),hl	; Set token vector
                         C      
  4505    CD 07D1        C      	call	l07eb
                         C      
  4508                   C      l4563:
                         C      
  4508    E1             C      	pop	hl
                         C      
  4509    C3 0681        C      	jp	.ProcSRC	; Process line
                         C      
  450C                   C      l4567:
                         C      
  450C    2A 67D1        C      	ld	hl,(l6844)
                         C      
  450F    23             C      	inc	hl
                         C      
  4510    22 67D1        C      	ld	(l6844),hl
                         C      
  4513    CD 07D1        C      	call	l07eb
                         C      
  4516    3E FF          C      	ld	a,0ffh
                         C      
  4518    32 6809        C      	ld	(l687c),a
                         C      
  451B    21 0DCB        C      	ld	hl,.PartToken
                         C      
  451E    22 0DE3        C      	ld	($GetVec),hl	; Set token vector
                         C      
  4521    18 E5          C      	jr	l4563
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-293


                         C      ;
                         C      
                         C      ; Pseudo code : MACLIB
                         C      
                         C      ;
                         C      
  4523                   C      l457e:
                         C      
  4523    3A 6617        C      	ld	a,(Pass)
                         C      
  4526    FE 01          C      	cp	1		; Test 2nd pass
                         C      
  4528    20 0B          C      	jr	nz,l4590	; .. nope, load file
                         C      
  452A                   C      l4585:
                         C      
  452A    AF             C      	xor	a
                         C      
  452B    32 6806        C      	ld	(l6879),a
                         C      
  452E    21 62F1        C      	ld	hl,l6364
                         C      
  4531    22 62F5        C      	ld	(TokPtr),hl	; Init token pointer
                         C      
  4534    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : INCLUDE
                         C      
                         C      ;
                         C      
  4535                   C      l4590:
                         C      
  4535    CD 4567        C      	call	l45c2
                         C      
  4538    3A 01A2        C      	ld	a,(l01b5)
                         C      
  453B    B7             C      	or	a
                         C      
  453C    20 1A          C      	jr	nz,l45b3
                         C      
  453E    21 6AB7        C      	ld	hl,SrcFCB+@drv	; Point to source name
                         C      
  4541    11 4554        C      	ld	de,l45af
                         C      
  4544    06 04          C      	ld	b,4
                         C      
  4546                   C      l45a1:
                         C      
  4546    1A             C      	ld	a,(de)
                         C      
  4547    13             C      	inc	de
                         C      
  4548    BE             C      	cp	(hl)
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-294


  4549    23             C      	inc	hl
                         C      
  454A    20 0C          C      	jr	nz,l45b3
                         C      
  454C    10 F8          C      	djnz	l45a1
                         C      
  454E    3E FF          C      	ld	a,0ffh
                         C      
  4550    32 6793        C      	ld	(l6806),a
                         C      
  4553    C9             C      	ret
                         C      
  4554                   C      l45af:
                         C      
  4554    5A 38 30 20    C      	db	'Z80 '
                         C      
  4558                   C      l45b3:
                         C      
  4558    CD 07D1        C      	call	l07eb
                         C      
  455B    E1             C      	pop	hl
                         C      
  455C    CD 2148        C      	call	ResetF		; Reset files
                         C      
  455F    C3 0681        C      	jp	.ProcSRC	; .. go process line
                         C      
  4562                   C      l45bd:
                         C      
  4562    0E 16          C      	ld	c,22
                         C      
  4564    C3 0905        C      	jp	ERROR
                         C      
  4567                   C      l45c2:
                         C      
  4567    21 0152        C      	ld	hl,$$MAC
                         C      
  456A    11 6ABF        C      	ld	de,SrcFCB+@drv+@nam
                         C      
  456D    ED A0          C      	ldi			; Set extension .MAC
                         C      
  456F    ED A0          C      	ldi
                         C      
  4571    ED A0          C      	ldi
                         C      
  4573    CD 43F7        C      	call	l4452
                         C      
  4576                   C      l45d1:
                         C      
  4576    AF             C      	xor	a
                         C      
  4577    32 6AB6        C      	ld	(SrcFCB),a	; Clear drive
                         C      
  457A    11 6AB7        C      	ld	de,SrcFCB+@drv
                         C      
  457D    06 08          C      	ld	b,@nam
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-295


  457F    23             C      	inc	hl
                         C      
  4580    7E             C      	ld	a,(hl)
                         C      
  4581    FE 3A          C      	cp	':'
                         C      
  4583    2B             C      	dec	hl
                         C      
  4584    2B             C      	dec	hl
                         C      
  4585    20 12          C      	jr	nz,l45f4
                         C      
  4587    1B             C      	dec	de
                         C      
  4588    23             C      	inc	hl
                         C      
  4589    7E             C      	ld	a,(hl)
                         C      
  458A    D6 40          C      	sub	'A'-1
                         C      
  458C    FE 10          C      	cp	'P'-'A'+1
                         C      
  458E    38 06          C      	jr	c,l45f1		; .. regular drive
                         C      
  4590    D6 20          C      	sub	'a'-'A'
                         C      
  4592    FE 10          C      	cp	'p'-'a'+1
                         C      
  4594    30 CC          C      	jr	nc,l45bd
                         C      
  4596                   C      l45f1:
                         C      
  4596    12             C      	ld	(de),a
                         C      
  4597    13             C      	inc	de
                         C      
  4598    23             C      	inc	hl
                         C      
  4599                   C      l45f4:
                         C      
  4599    CD 45D1        C      	call	l462c
                         C      
  459C    28 0A          C      	jr	z,l4603
                         C      
  459E    FE 2E          C      	cp	'.'
                         C      
  45A0    28 06          C      	jr	z,l4603
                         C      
  45A2    12             C      	ld	(de),a
                         C      
  45A3    13             C      	inc	de
                         C      
  45A4    10 F3          C      	djnz	l45f4
                         C      
  45A6    18 07          C      	jr	l460a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-296


  45A8                   C      l4603:
                         C      
  45A8    3E 20          C      	ld	a,' '
                         C      
  45AA                   C      l4605:
                         C      
  45AA    12             C      	ld	(de),a
                         C      
  45AB    13             C      	inc	de
                         C      
  45AC    10 FC          C      	djnz	l4605
                         C      
  45AE    2B             C      	dec	hl
                         C      
  45AF                   C      l460a:
                         C      
  45AF    CD 45D1        C      	call	l462c
                         C      
  45B2    28 17          C      	jr	z,l4626
                         C      
  45B4    FE 2E          C      	cp	'.'
                         C      
  45B6    20 AA          C      	jr	nz,l45bd
                         C      
  45B8    06 03          C      	ld	b,3
                         C      
  45BA                   C      l4615:
                         C      
  45BA    CD 45D1        C      	call	l462c
                         C      
  45BD    28 06          C      	jr	z,l4620
                         C      
  45BF    12             C      	ld	(de),a
                         C      
  45C0    13             C      	inc	de
                         C      
  45C1    10 F7          C      	djnz	l4615
                         C      
  45C3    18 07          C      	jr	l4627
                         C      
  45C5                   C      l4620:
                         C      
  45C5    3E 20          C      	ld	a,' '
                         C      
  45C7                   C      l4622:
                         C      
  45C7    12             C      	ld	(de),a
                         C      
  45C8    13             C      	inc	de
                         C      
  45C9    10 FC          C      	djnz	l4622
                         C      
  45CB                   C      l4626:
                         C      
  45CB    2B             C      	dec	hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-297


  45CC                   C      l4627:
                         C      
  45CC    AF             C      	xor	a
                         C      
  45CD    32 6806        C      	ld	(l6879),a
                         C      
  45D0    C9             C      	ret
                         C      
  45D1                   C      l462c:
                         C      
  45D1    23             C      	inc	hl
                         C      
  45D2    7E             C      	ld	a,(hl)
                         C      
  45D3    FE 61          C      	cp	61h
                         C      
  45D5    38 06          C      	jr	c,l4638
                         C      
  45D7    FE 7B          C      	cp	7bh
                         C      
  45D9    D0             C      	ret	nc
                         C      
  45DA    D6 20          C      	sub	' '
                         C      
  45DC    C9             C      	ret
                         C      
  45DD                   C      l4638:
                         C      
  45DD    FE 21          C      	cp	'!'
                         C      
  45DF    38 38          C      	jr	c,l4674
                         C      
  45E1    FE 2C          C      	cp	','
                         C      
  45E3    C8             C      	ret	z
                         C      
  45E4    FE 3B          C      	cp	';'
                         C      
  45E6    C9             C      	ret
                         C      
  45E7                   C      l4642:
                         C      
  45E7    23             C      	inc	hl
                         C      
  45E8    7E             C      	ld	a,(hl)
                         C      
  45E9    FE 5C          C      	cp	5ch
                         C      
  45EB    38 18          C      	jr	c,l4660
                         C      
  45ED    FE 9B          C      	cp	9bh
                         C      
  45EF    30 28          C      	jr	nc,l4674
                         C      
  45F1    C6 D4          C      	add	a,0d4h
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-298


  45F3    FE 3A          C      	cp	':'
                         C      
  45F5    38 02          C      	jr	c,l4654
                         C      
  45F7    C6 07          C      	add	a,7
                         C      
  45F9                   C      l4654:
                         C      
  45F9    FE 5B          C      	cp	5bh
                         C      
  45FB    D8             C      	ret	c
                         C      
  45FC    C6 06          C      	add	a,6
                         C      
  45FE    FE 7B          C      	cp	7bh
                         C      
  4600    C0             C      	ret	nz
                         C      
  4601    3E 5F          C      	ld	a,5fh
                         C      
  4603    B7             C      	or	a
                         C      
  4604    C9             C      	ret
                         C      
  4605                   C      l4660:
                         C      
  4605    FE 58          C      	cp	'X'
                         C      
  4607    28 12          C      	jr	z,l4676
                         C      
  4609    FE 5B          C      	cp	5bh
                         C      
  460B    28 11          C      	jr	z,l4679
                         C      
  460D    FE 59          C      	cp	'Y'
                         C      
  460F    28 10          C      	jr	z,l467c
                         C      
  4611    FE 5A          C      	cp	'Z'
                         C      
  4613    28 0F          C      	jr	z,l467f
                         C      
  4615    FE 57          C      	cp	'W'
                         C      
  4617    28 0E          C      	jr	z,l4682
                         C      
  4619                   C      l4674:
                         C      
  4619    BF             C      	cp	a
                         C      
  461A    C9             C      	ret
                         C      
  461B                   C      l4676:
                         C      
  461B    C6 CC          C      	add	a,0cch
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-299


  461D    C9             C      	ret
                         C      
  461E                   C      l4679:
                         C      
  461E    C6 E5          C      	add	a,0e5h
                         C      
  4620    C9             C      	ret
                         C      
  4621                   C      l467c:
                         C      
  4621    C6 E6          C      	add	a,0e6h
                         C      
  4623    C9             C      	ret
                         C      
  4624                   C      l467f:
                         C      
  4624    C6 D4          C      	add	a,0d4h
                         C      
  4626    C9             C      	ret
                         C      
  4627                   C      l4682:
                         C      
  4627    C6 CE          C      	add	a,0ceh
                         C      
  4629    C9             C      	ret
                         C      
  462A                   C      l4685:
                         C      
  462A    21 22D9        C      	ld	hl,alloc_	; Allocate memory
                         C      
  462D    22 4EA6        C      	ld	(l4f01),hl
                         C      
  4630    21 631B        C      	ld	hl,DynPtr2	; Set base
                         C      
  4633    22 4F8A        C      	ld	(l4fe5),hl
                         C      
  4636    CD 07D1        C      	call	l07eb
                         C      
  4639    18 03          C      	jr	l4699
                         C      
  463B                   C      l4696:
                         C      
  463B    CD 07D7        C      	call	l07f1
                         C      
  463E                   C      l4699:
                         C      
  463E    CD 14C2        C      	call	RdLine		; Read line
                         C      
  4641    CD 4EA0        C      	call	l4efb
                         C      
  4644    30 F5          C      	jr	nc,l4696
                         C      
  4646    CD 07D7        C      	call	l07f1
                         C      
  4649    21 229A        C      	ld	hl,d.alloc_	; Save allocation vector
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-300


  464C    22 4EA6        C      	ld	(l4f01),hl
                         C      
  464F    21 631D        C      	ld	hl,SymPtr	; Init pointer
                         C      
  4652    22 4F8A        C      	ld	(l4fe5),hl
                         C      
  4655    01 0002        C      	ld	bc,2
                         C      
  4658    CD 22D9        C      	call	alloc_		; Allocate memory
                         C      
  465B    EB             C      	ex	de,hl
                         C      
  465C    2A 660D        C      	ld	hl,(l6680)
                         C      
  465F    B7             C      	or	a
                         C      
  4660    ED 52          C      	sbc	hl,de
                         C      
  4662    EB             C      	ex	de,hl
                         C      
  4663    73             C      	ld	(hl),e
                         C      
  4664    23             C      	inc	hl
                         C      
  4665    72             C      	ld	(hl),d
                         C      
  4666    C9             C      	ret
                         C      
  4667                   C      l46c2:
                         C      
  4667    CD 4BFD        C      	call	l4c58
                         C      
  466A    C9             C      	ret
                         C      
  466B                   C      l46c6:
                         C      
  466B    23             C      	inc	hl
                         C      
  466C    7E             C      	ld	a,(hl)
                         C      
  466D    3C             C      	inc	a
                         C      
  466E    28 F7          C      	jr	z,l46c2
                         C      
  4670    2B             C      	dec	hl
                         C      
  4671                   C      l46cc:
                         C      
  4671    7E             C      	ld	a,(hl)
                         C      
  4672    3C             C      	inc	a
                         C      
  4673    28 F2          C      	jr	z,l46c2
                         C      
  4675    22 660D        C      	ld	(l6680),hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-301


  4678    21 31E1        C      	ld	hl,l323c
                         C      
  467B    22 14C3        C      	ld	($LinVec),hl	; Change vector
                         C      
  467E    01 008E        C      	ld	bc,142		;;l008e
                         C      
  4681    CD 2247        C      	call	malloc_		; Allocate memory
                         C      
  4684    2A 67F4        C      	ld	hl,(l6867)
                         C      
  4687    36 FC          C      	ld	(hl),0fch	; Set IRPC opcode
                         C      
  4689    23             C      	inc	hl
                         C      
  468A    36 C6          C      	ld	(hl),LOW  (l4722-1)
                         C      
  468C    23             C      	inc	hl
                         C      
  468D    36 46          C      	ld	(hl),HIGH (l4722-1)
                         C      
  468F    23             C      	inc	hl
                         C      
  4690    AF             C      	xor	a
                         C      
  4691    77             C      	ld	(hl),a
                         C      
  4692    23             C      	inc	hl
                         C      
  4693    77             C      	ld	(hl),a
                         C      
  4694    23             C      	inc	hl
                         C      
  4695    36 01          C      	ld	(hl),1
                         C      
  4697    23             C      	inc	hl
                         C      
  4698    54             C      	ld	d,h
                         C      
  4699    5D             C      	ld	e,l
                         C      
  469A    13             C      	inc	de
                         C      
  469B    13             C      	inc	de
                         C      
  469C    13             C      	inc	de
                         C      
  469D    13             C      	inc	de
                         C      
  469E    ED 4B 660D     C      	ld	bc,(l6680)
                         C      
  46A2    CD 31BB        C      	call	l3216
                         C      
  46A5    0A             C      	ld	a,(bc)
                         C      
  46A6    12             C      	ld	(de),a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-302


  46A7    13             C      	inc	de
                         C      
  46A8    AF             C      	xor	a
                         C      
  46A9    12             C      	ld	(de),a
                         C      
  46AA    EB             C      	ex	de,hl
                         C      
  46AB    60             C      	ld	h,b
                         C      
  46AC    69             C      	ld	l,c
                         C      
  46AD    B7             C      	or	a
                         C      
  46AE    ED 52          C      	sbc	hl,de
                         C      
  46B0    EB             C      	ex	de,hl
                         C      
  46B1    73             C      	ld	(hl),e
                         C      
  46B2    23             C      	inc	hl
                         C      
  46B3    72             C      	ld	(hl),d
                         C      
  46B4    11 0077        C      	ld	de,l0077
                         C      
  46B7    19             C      	add	hl,de
                         C      
  46B8    5E             C      	ld	e,(hl)
                         C      
  46B9    23             C      	inc	hl
                         C      
  46BA    56             C      	ld	d,(hl)
                         C      
  46BB    19             C      	add	hl,de
                         C      
  46BC    2B             C      	dec	hl
                         C      
  46BD    2B             C      	dec	hl
                         C      
  46BE    2B             C      	dec	hl
                         C      
  46BF    2B             C      	dec	hl
                         C      
  46C0    AF             C      	xor	a
                         C      
  46C1    ED B9          C      	cpdr
                         C      
  46C3    22 67FD        C      	ld	(l6870),hl
                         C      
  46C6    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Coded IRPC
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-303


                         C      ;
                         C      
  46C7                   C      l4722:
                         C      
  46C7    6E 77 75 68    C      	db	6eh,77h,75h,68h,null
  46CB    00             C      
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IRPC
                         C      
                         C      ;
                         C      
  46CC                   C      l4727:
                         C      
  46CC    21 4671        C      	ld	hl,l46cc
                         C      
  46CF    18 03          C      	jr	l472f
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : IRP
                         C      
                         C      ;
                         C      
  46D1                   C      l472c:
                         C      
  46D1    21 4749        C      	ld	hl,l47a4
                         C      
  46D4                   C      l472f:
                         C      
  46D4    CD 46DB        C      	call	l4736
                         C      
  46D7    E1             C      	pop	hl
                         C      
  46D8    C3 0681        C      	jp	.ProcSRC	; Process line
                         C      
  46DB                   C      l4736:
                         C      
  46DB    E5             C      	push	hl
                         C      
  46DC    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  46DF    21 0001        C      	ld	hl,1
                         C      
  46E2    22 67CB        C      	ld	(l683e),hl
                         C      
  46E5    ED 4B 6376     C      	ld	bc,(TokStrt)	; Get start of token
                         C      
  46E9    0B             C      	dec	bc
                         C      
  46EA    21 6634        C      	ld	hl,l66a7
                         C      
  46ED    11 6674        C      	ld	de,l66e7
                         C      
  46F0    CD 499F        C      	call	l49fa
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-304


                         C      
  46F3    AF             C      	xor	a
                         C      
  46F4    77             C      	ld	(hl),a
                         C      
  46F5    23             C      	inc	hl
                         C      
  46F6    77             C      	ld	(hl),a
                         C      
  46F7    23             C      	inc	hl
                         C      
  46F8    03             C      	inc	bc
                         C      
  46F9    ED 43 6376     C      	ld	(TokStrt),bc	; Get start of token
                         C      
  46FD    0A             C      	ld	a,(bc)
                         C      
  46FE    FE 36          C      	cp	36h		; Test new line
                         C      
  4700    20 05          C      	jr	nz,l4762
                         C      
  4702    01 473F        C      	ld	bc,l479a
                         C      
  4705    18 07          C      	jr	l4769
                         C      
  4707                   C      l4762:
                         C      
  4707    E5             C      	push	hl
                         C      
  4708    D5             C      	push	de
                         C      
  4709    CD 3346        C      	call	l33a1
                         C      
  470C    D1             C      	pop	de
                         C      
  470D    E1             C      	pop	hl
                         C      
  470E                   C      l4769:
                         C      
  470E    D5             C      	push	de
                         C      
  470F    CD 30DF        C      	call	IsEOL?		; Check line
                         C      
  4712    3E FF          C      	ld	a,-1
                         C      
  4714    12             C      	ld	(de),a
                         C      
  4715    13             C      	inc	de
                         C      
  4716    2A 631B        C      	ld	hl,(DynPtr2)	; Get pointer
                         C      
  4719    22 660D        C      	ld	(l6680),hl	; .. save
                         C      
  471C    EB             C      	ex	de,hl
                         C      
  471D    D1             C      	pop	de
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-305


                         C      
  471E    B7             C      	or	a
                         C      
  471F    ED 52          C      	sbc	hl,de
                         C      
  4721    44             C      	ld	b,h
                         C      
  4722    4D             C      	ld	c,l
                         C      
  4723    C5             C      	push	bc
                         C      
  4724    03             C      	inc	bc
                         C      
  4725    CD 22D9        C      	call	alloc_		; Allocate memory
                         C      
  4728    36 00          C      	ld	(hl),0
                         C      
  472A    23             C      	inc	hl
                         C      
  472B    EB             C      	ex	de,hl
                         C      
  472C    0B             C      	dec	bc
                         C      
  472D    ED B0          C      	ldir
                         C      
  472F    21 62F1        C      	ld	hl,l6364
                         C      
  4732    22 62F5        C      	ld	(TokPtr),hl	; Init token pointer
                         C      
  4735    CD 462A        C      	call	l4685
                         C      
  4738    2A 660D        C      	ld	hl,(l6680)
                         C      
  473B    C1             C      	pop	bc
                         C      
  473C    B7             C      	or	a
                         C      
  473D    ED 42          C      	sbc	hl,bc
                         C      
  473F                   C      l479a:
                         C      
  473F    C9             C      	ret
                         C      
  4740    3C             C      	inc	a
                         C      
  4741    3E 2C          C      	ld	a,','
                         C      
  4743                   C      l479e:
                         C      
  4743    23             C      	inc	hl
                         C      
  4744    7E             C      	ld	a,(hl)
                         C      
  4745    3C             C      	inc	a
                         C      
  4746    28 4F          C      	jr	z,l47f2
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-306


                         C      
  4748    2B             C      	dec	hl
                         C      
  4749                   C      l47a4:
                         C      
  4749    22 660D        C      	ld	(l6680),hl
                         C      
  474C    21 31E1        C      	ld	hl,l323c
                         C      
  474F    22 14C3        C      	ld	($LinVec),hl	; Change vector
                         C      
  4752    01 008E        C      	ld	bc,142		;;l008e
                         C      
  4755    CD 2247        C      	call	malloc_		; Allocate memory
                         C      
  4758    2A 67F4        C      	ld	hl,(l6867)
                         C      
  475B    36 FD          C      	ld	(hl),0fdh	; Set IRP opcode
                         C      
  475D    23             C      	inc	hl
                         C      
  475E    36 9A          C      	ld	(hl),LOW  (l47f6-1)
                         C      
  4760    23             C      	inc	hl
                         C      
  4761    36 47          C      	ld	(hl),HIGH (l47f6-1)
                         C      
  4763    23             C      	inc	hl
                         C      
  4764    AF             C      	xor	a
                         C      
  4765    77             C      	ld	(hl),a
                         C      
  4766    23             C      	inc	hl
                         C      
  4767    77             C      	ld	(hl),a
                         C      
  4768    23             C      	inc	hl
                         C      
  4769    36 01          C      	ld	(hl),1
                         C      
  476B    23             C      	inc	hl
                         C      
  476C    54             C      	ld	d,h
                         C      
  476D    5D             C      	ld	e,l
                         C      
  476E    13             C      	inc	de
                         C      
  476F    13             C      	inc	de
                         C      
  4770    13             C      	inc	de
                         C      
  4771    13             C      	inc	de
                         C      
  4772    ED 4B 660D     C      	ld	bc,(l6680)
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-307


                         C      
  4776    0B             C      	dec	bc
                         C      
  4777    CD 30DF        C      	call	IsEOL?		; Check line
                         C      
  477A    EB             C      	ex	de,hl
                         C      
  477B    60             C      	ld	h,b
                         C      
  477C    69             C      	ld	l,c
                         C      
  477D    B7             C      	or	a
                         C      
  477E    ED 52          C      	sbc	hl,de
                         C      
  4780    EB             C      	ex	de,hl
                         C      
  4781    73             C      	ld	(hl),e
                         C      
  4782    23             C      	inc	hl
                         C      
  4783    72             C      	ld	(hl),d
                         C      
  4784    11 0077        C      	ld	de,l0077
                         C      
  4787    19             C      	add	hl,de
                         C      
  4788    5E             C      	ld	e,(hl)
                         C      
  4789    23             C      	inc	hl
                         C      
  478A    56             C      	ld	d,(hl)
                         C      
  478B    19             C      	add	hl,de
                         C      
  478C    2B             C      	dec	hl
                         C      
  478D    2B             C      	dec	hl
                         C      
  478E    2B             C      	dec	hl
                         C      
  478F    2B             C      	dec	hl
                         C      
  4790    AF             C      	xor	a
                         C      
  4791    ED B9          C      	cpdr
                         C      
  4793    22 67FD        C      	ld	(l6870),hl
                         C      
  4796    C9             C      	ret
                         C      
  4797                   C      l47f2:
                         C      
  4797    CD 4BFD        C      	call	l4c58
                         C      
  479A    C9             C      	ret
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-308


                         C      
                         C      ;
                         C      
                         C      ; Coded IRP
                         C      
                         C      ;
                         C      
  479B                   C      l47f6:
                         C      
  479B    6E 77 75 00    C      	db	6eh,77h,75h,null
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .LIST
                         C      
                         C      ;
                         C      
  479F                   C      l47fa:
                         C      
  479F    21 661A        C      	ld	hl,l668d
                         C      
  47A2    7E             C      	ld	a,(hl)
                         C      
  47A3    3C             C      	inc	a
                         C      
  47A4    C8             C      	ret	z
                         C      
  47A5    36 FF          C      	ld	(hl),-1
                         C      
  47A7    21 6361        C      	ld	hl,l63d4
                         C      
  47AA    11 634C        C      	ld	de,l63bf
                         C      
  47AD    01 0015        C      	ld	bc,TokStrt-l63d4		;;l0015
                         C      
  47B0    ED B0          C      	ldir
                         C      
  47B2    AF             C      	xor	a
                         C      
  47B3    32 0895        C      	ld	(l08af),a
                         C      
  47B6    C9             C      	ret
                         C      
  47B7                   C      l4812:
                         C      
  47B7    2B             C      	dec	hl
                         C      
  47B8    22 62F5        C      	ld	(TokPtr),hl	; Save token pointer
                         C      
  47BB    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : LOCAL
                         C      
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-309


                         C      
  47BC                   C      l4817:
                         C      
  47BC    2A 67F4        C      	ld	hl,(l6867)
                         C      
  47BF    CB 7E          C      	bit	7,(hl)
                         C      
  47C1    CA 42A2        C      	jp	z,l42fd
                         C      
  47C4    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  47C7    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token 
                         C      
  47CA    2B             C      	dec	hl
                         C      
  47CB    22 62F5        C      	ld	(TokPtr),hl	; .. to token pointer
                         C      
  47CE                   C      l4829:
                         C      
  47CE    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
                         C      
  47D1                   C      l482c:
                         C      
  47D1    23             C      	inc	hl
                         C      
  47D2    7E             C      	ld	a,(hl)
                         C      
  47D3    FE 35          C      	cp	35h		; Skip spaces
                         C      
  47D5    28 FA          C      	jr	z,l482c
                         C      
  47D7    FE 50          C      	cp	50h		; .. commas
                         C      
  47D9    28 F6          C      	jr	z,l482c
                         C      
  47DB    FE 36          C      	cp	36h		; Test new line
                         C      
  47DD    28 D8          C      	jr	z,l4812
                         C      
  47DF    FE 57          C      	cp	57h		; Test range
                         C      
  47E1    DA 0903        C      	jp	c,SyntaxErr
                         C      
  47E4    3E 56          C      	ld	a,56h		; Set string
                         C      
  47E6    22 6376        C      	ld	(TokStrt),hl	; .. set start
                         C      
  47E9    54             C      	ld	d,h
                         C      
  47EA    5D             C      	ld	e,l
                         C      
  47EB                   C      l4846:
                         C      
  47EB    23             C      	inc	hl
                         C      
  47EC    BE             C      	cp	(hl)
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-310


                         C      
  47ED    DA 47EB        C      	jp	c,l4846
                         C      
  47F0    2B             C      	dec	hl
                         C      
  47F1    22 62F5        C      	ld	(TokPtr),hl	; Set token pointer
                         C      
  47F4    23             C      	inc	hl
                         C      
  47F5    ED 52          C      	sbc	hl,de
                         C      
  47F7    7D             C      	ld	a,l
                         C      
  47F8    32 6831        C      	ld	(l68a4),a
                         C      
  47FB    01 0014        C      	ld	bc,20		;; l0014
                         C      
  47FE    CD 22D9        C      	call	alloc_		; Allocate memory
                         C      
  4801    2A 67F4        C      	ld	hl,(l6867)
                         C      
  4804    44             C      	ld	b,h
                         C      
  4805    4D             C      	ld	c,l
                         C      
  4806    23             C      	inc	hl
                         C      
  4807    23             C      	inc	hl
                         C      
  4808    23             C      	inc	hl
                         C      
  4809    5E             C      	ld	e,(hl)
                         C      
  480A    23             C      	inc	hl
                         C      
  480B    56             C      	ld	d,(hl)
                         C      
  480C    7A             C      	ld	a,d
                         C      
  480D    B3             C      	or	e
                         C      
  480E    20 10          C      	jr	nz,l487b
                         C      
  4810    E5             C      	push	hl
                         C      
  4811    2A 631B        C      	ld	hl,(DynPtr2)	; Get pointer
                         C      
  4814    11 0013        C      	ld	de,l0013
                         C      
  4817    19             C      	add	hl,de
                         C      
  4818    77             C      	ld	(hl),a
                         C      
  4819    ED 42          C      	sbc	hl,bc
                         C      
  481B    EB             C      	ex	de,hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-311


                         C      
  481C    E1             C      	pop	hl
                         C      
  481D    72             C      	ld	(hl),d
                         C      
  481E    2B             C      	dec	hl
                         C      
  481F    73             C      	ld	(hl),e
                         C      
  4820                   C      l487b:
                         C      
  4820    EB             C      	ex	de,hl
                         C      
  4821    09             C      	add	hl,bc
                         C      
  4822    AF             C      	xor	a
                         C      
  4823    47             C      	ld	b,a
                         C      
  4824    4F             C      	ld	c,a
                         C      
  4825    18 04          C      	jr	l4886
                         C      
  4827                   C      l4882:
                         C      
  4827    ED B9          C      	cpdr
                         C      
  4829    2B             C      	dec	hl
                         C      
  482A    2B             C      	dec	hl
                         C      
  482B                   C      l4886:
                         C      
  482B    BE             C      	cp	(hl)
                         C      
  482C    20 F9          C      	jr	nz,l4882
                         C      
  482E    EB             C      	ex	de,hl
                         C      
  482F    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
                         C      
  4832    3A 6831        C      	ld	a,(l68a4)
                         C      
  4835    47             C      	ld	b,a
                         C      
  4836                   C      l4891:
                         C      
  4836    7E             C      	ld	a,(hl)
                         C      
  4837    23             C      	inc	hl
                         C      
  4838    12             C      	ld	(de),a
                         C      
  4839    1B             C      	dec	de
                         C      
  483A    10 FA          C      	djnz	l4891
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-312


                         C      
  483C    AF             C      	xor	a
                         C      
  483D    12             C      	ld	(de),a
                         C      
  483E    1B             C      	dec	de
                         C      
  483F    2A 680C        C      	ld	hl,(l687f)
                         C      
  4842    23             C      	inc	hl
                         C      
  4843    22 680C        C      	ld	(l687f),hl
                         C      
  4846    EB             C      	ex	de,hl
                         C      
  4847    73             C      	ld	(hl),e
                         C      
  4848    2B             C      	dec	hl
                         C      
  4849    72             C      	ld	(hl),d
                         C      
  484A    2B             C      	dec	hl
                         C      
  484B    36 00          C      	ld	(hl),0
                         C      
  484D    22 631B        C      	ld	(DynPtr2),hl	; .. save top
                         C      
  4850    C3 47CE        C      	jp	l4829
                         C      
  4853                   C      l48ae:
                         C      
  4853    23             C      	inc	hl
                         C      
  4854    5E             C      	ld	e,(hl)
                         C      
  4855    23             C      	inc	hl
                         C      
  4856    56             C      	ld	d,(hl)
                         C      
  4857    EB             C      	ex	de,hl
                         C      
  4858    22 67DB        C      	ld	(l684e),hl
                         C      
  485B    23             C      	inc	hl
                         C      
  485C    23             C      	inc	hl
                         C      
  485D    23             C      	inc	hl
                         C      
  485E    3A 6819        C      	ld	a,(l688c)
                         C      
  4861    B7             C      	or	a
                         C      
  4862    20 01          C      	jr	nz,l48c0
                         C      
  4864    23             C      	inc	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-313


                         C      
  4865                   C      l48c0:
                         C      
  4865    5E             C      	ld	e,(hl)
                         C      
  4866    23             C      	inc	hl
                         C      
  4867    56             C      	ld	d,(hl)
                         C      
  4868    E5             C      	push	hl
                         C      
  4869    13             C      	inc	de
                         C      
  486A    13             C      	inc	de
                         C      
  486B    2A 631D        C      	ld	hl,(SymPtr)	; Get pointer
                         C      
  486E    AF             C      	xor	a
                         C      
  486F    2B             C      	dec	hl
                         C      
  4870    77             C      	ld	(hl),a
                         C      
  4871    2B             C      	dec	hl
                         C      
  4872    77             C      	ld	(hl),a
                         C      
  4873    2B             C      	dec	hl
                         C      
  4874    2B             C      	dec	hl
                         C      
  4875    EB             C      	ex	de,hl
                         C      
  4876    73             C      	ld	(hl),e
                         C      
  4877    23             C      	inc	hl
                         C      
  4878    72             C      	ld	(hl),d
                         C      
  4879    E1             C      	pop	hl
                         C      
  487A    72             C      	ld	(hl),d
                         C      
  487B    2B             C      	dec	hl
                         C      
  487C    73             C      	ld	(hl),e
                         C      
  487D    D5             C      	push	de
                         C      
  487E    C3 4958        C      	jp	l49b3
                         C      
  4881                   C      l48dc:
                         C      
  4881    23             C      	inc	hl
                         C      
  4882    5E             C      	ld	e,(hl)
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-314


                         C      
  4883    23             C      	inc	hl
                         C      
  4884    56             C      	ld	d,(hl)
                         C      
  4885    EB             C      	ex	de,hl
                         C      
  4886    22 67DB        C      	ld	(l684e),hl
                         C      
  4889    23             C      	inc	hl
                         C      
  488A    23             C      	inc	hl
                         C      
  488B    23             C      	inc	hl
                         C      
  488C    3A 6819        C      	ld	a,(l688c)
                         C      
  488F    B7             C      	or	a
                         C      
  4890    4F             C      	ld	c,a
                         C      
  4891    20 01          C      	jr	nz,l48ef
                         C      
  4893    23             C      	inc	hl
                         C      
  4894                   C      l48ef:
                         C      
  4894    7E             C      	ld	a,(hl)
                         C      
  4895    23             C      	inc	hl
                         C      
  4896    B6             C      	or	(hl)
                         C      
  4897    20 39          C      	jr	nz,l492d
                         C      
  4899    B1             C      	or	c
                         C      
  489A    28 01          C      	jr	z,l48f8
                         C      
  489C    23             C      	inc	hl
                         C      
  489D                   C      l48f8:
                         C      
  489D    23             C      	inc	hl
                         C      
  489E    5E             C      	ld	e,(hl)
                         C      
  489F    23             C      	inc	hl
                         C      
  48A0    56             C      	ld	d,(hl)
                         C      
  48A1    2B             C      	dec	hl
                         C      
  48A2    2B             C      	dec	hl
                         C      
  48A3    28 01          C      	jr	z,l4901
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-315


                         C      
  48A5    2B             C      	dec	hl
                         C      
  48A6                   C      l4901:
                         C      
  48A6    72             C      	ld	(hl),d
                         C      
  48A7    2B             C      	dec	hl
                         C      
  48A8    73             C      	ld	(hl),e
                         C      
  48A9    EB             C      	ex	de,hl
                         C      
  48AA    5E             C      	ld	e,(hl)
                         C      
  48AB    23             C      	inc	hl
                         C      
  48AC    56             C      	ld	d,(hl)
                         C      
  48AD    13             C      	inc	de
                         C      
  48AE    D5             C      	push	de
                         C      
  48AF                   C      l490a:
                         C      
  48AF    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  48B2    FE 36          C      	cp	36h		; Test end of line
                         C      
  48B4    20 F9          C      	jr	nz,l490a	; .. wait for it
                         C      
  48B6    D1             C      	pop	de
                         C      
  48B7                   C      l4912:
                         C      
  48B7    D5             C      	push	de
                         C      
  48B8    CD 07D7        C      	call	l07f1
                         C      
  48BB    CD 14C2        C      	call	RdLine		; Read line
                         C      
  48BE    D1             C      	pop	de
                         C      
  48BF    1B             C      	dec	de
                         C      
  48C0    3A 026D        C      	ld	a,($SRCline$)	; Get start of line
                         C      
  48C3    FE 1A          C      	cp	eof		; Test end of file
                         C      
  48C5    28 04          C      	jr	z,l4926		; .. yeap
                         C      
  48C7    7A             C      	ld	a,d
                         C      
  48C8    B3             C      	or	e
                         C      
  48C9    20 EC          C      	jr	nz,l4912
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-316


                         C      
  48CB                   C      l4926:
                         C      
  48CB    21 0000        C      	ld	hl,0
                         C      
  48CE    22 67D8        C      	ld	(l684b),hl
                         C      
  48D1    C9             C      	ret
                         C      
  48D2                   C      l492d:
                         C      
  48D2    E5             C      	push	hl
                         C      
  48D3    56             C      	ld	d,(hl)
                         C      
  48D4    2B             C      	dec	hl
                         C      
  48D5    5E             C      	ld	e,(hl)
                         C      
  48D6    EB             C      	ex	de,hl
                         C      
  48D7    23             C      	inc	hl
                         C      
  48D8    23             C      	inc	hl
                         C      
  48D9    5E             C      	ld	e,(hl)
                         C      
  48DA    23             C      	inc	hl
                         C      
  48DB    56             C      	ld	d,(hl)
                         C      
  48DC    E1             C      	pop	hl
                         C      
  48DD    7A             C      	ld	a,d
                         C      
  48DE    B3             C      	or	e
                         C      
  48DF    20 C5          C      	jr	nz,l4901
                         C      
  48E1    0E 1F          C      	ld	c,31
                         C      
  48E3    CD 08F5        C      	call	.ERROR
                         C      
  48E6    18 E3          C      	jr	l4926
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : MACRO
                         C      
                         C      ;
                         C      
  48E8                   C      l4943:
                         C      
  48E8    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  48EB    22 6804        C      	ld	(l6877),hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-317


                         C      
  48EE    FE 39          C      	cp	39h		; Test ??
                         C      
  48F0    20 02          C      	jr	nz,l494f
                         C      
  48F2    3E FF          C      	ld	a,0ffh
                         C      
  48F4                   C      l494f:
                         C      
  48F4    32 6806        C      	ld	(l6879),a
                         C      
  48F7    AF             C      	xor	a
                         C      
  48F8    32 6807        C      	ld	(l687a),a
                         C      
  48FB    21 0001        C      	ld	hl,1
                         C      
  48FE    22 67CB        C      	ld	(l683e),hl
                         C      
  4901    2A 67D8        C      	ld	hl,(l684b)
                         C      
  4904    7C             C      	ld	a,h
                         C      
  4905    B5             C      	or	l
                         C      
  4906    CA 42CE        C      	jp	z,l4329
                         C      
  4909    3A 6617        C      	ld	a,(Pass)	; Get pass
                         C      
  490C    FE 01          C      	cp	1
                         C      
  490E    CA 4881        C      	jp	z,l48dc		; .. 2nd pass
                         C      
  4911    3E F0          C      	ld	a,0f0h
                         C      
  4913    32 67DA        C      	ld	(l684d),a
                         C      
  4916    7E             C      	ld	a,(hl)
                         C      
  4917    FE F0          C      	cp	0f0h
                         C      
  4919    CA 4853        C      	jp	z,l48ae
                         C      
  491C    E5             C      	push	hl
                         C      
  491D    01 000A        C      	ld	bc,l000a
                         C      
  4920    CD 229A        C      	call	d.alloc_	; Allocate memory
                         C      
  4923    22 67DB        C      	ld	(l684e),hl
                         C      
  4926    EB             C      	ex	de,hl
                         C      
  4927    E1             C      	pop	hl
                         C      
  4928    ED A0          C      	ldi
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-318


                         C      
  492A    ED A0          C      	ldi
                         C      
  492C    ED A0          C      	ldi
                         C      
  492E    EB             C      	ex	de,hl
                         C      
  492F    AF             C      	xor	a
                         C      
  4930    ED 5B 631D     C      	ld	de,(SymPtr)	; Get pointer
                         C      
  4934    1B             C      	dec	de
                         C      
  4935    12             C      	ld	(de),a
                         C      
  4936    1B             C      	dec	de
                         C      
  4937    12             C      	ld	(de),a
                         C      
  4938    1B             C      	dec	de
                         C      
  4939    1B             C      	dec	de
                         C      
  493A    D5             C      	push	de
                         C      
  493B    3A 6819        C      	ld	a,(l688c)
                         C      
  493E    B7             C      	or	a
                         C      
  493F    20 03          C      	jr	nz,l499f
                         C      
  4941    36 FF          C      	ld	(hl),0ffh
                         C      
  4943    23             C      	inc	hl
                         C      
  4944                   C      l499f:
                         C      
  4944    73             C      	ld	(hl),e
                         C      
  4945    23             C      	inc	hl
                         C      
  4946    72             C      	ld	(hl),d
                         C      
  4947    23             C      	inc	hl
                         C      
  4948    28 03          C      	jr	z,l49a8
                         C      
  494A    36 FF          C      	ld	(hl),0ffh
                         C      
  494C    23             C      	inc	hl
                         C      
  494D                   C      l49a8:
                         C      
  494D    73             C      	ld	(hl),e
                         C      
  494E    23             C      	inc	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-319


                         C      
  494F    72             C      	ld	(hl),d
                         C      
  4950    23             C      	inc	hl
                         C      
  4951    ED 5B 67D8     C      	ld	de,(l684b)
                         C      
  4955    73             C      	ld	(hl),e
                         C      
  4956    23             C      	inc	hl
                         C      
  4957    72             C      	ld	(hl),d
                         C      
  4958                   C      l49b3:
                         C      
  4958    21 0000        C      	ld	hl,0
                         C      
  495B    22 680A        C      	ld	(l687d),hl
                         C      
  495E    01 0004        C      	ld	bc,l0004
                         C      
  4961    CD 229A        C      	call	d.alloc_	; Allocate memory
                         C      
  4964    11 6674        C      	ld	de,l66e7
                         C      
  4967    21 6634        C      	ld	hl,l66a7
                         C      
  496A    ED 4B 6376     C      	ld	bc,(TokStrt)	; Get start of token
                         C      
  496E    0B             C      	dec	bc
                         C      
  496F                   C      l49ca:
                         C      
  496F    CD 499F        C      	call	l49fa
                         C      
  4972    20 FB          C      	jr	nz,l49ca
                         C      
  4974    AF             C      	xor	a
                         C      
  4975    77             C      	ld	(hl),a
                         C      
  4976    23             C      	inc	hl
                         C      
  4977    77             C      	ld	(hl),a
                         C      
  4978    ED 43 62F5     C      	ld	(TokPtr),bc	; Set token pointer
                         C      
  497C    CD 07D1        C      	call	l07eb
                         C      
  497F    18 03          C      	jr	l49df
                         C      
  4981                   C      l49dc:
                         C      
  4981    CD 07D7        C      	call	l07f1
                         C      
  4984                   C      l49df:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-320


                         C      
  4984    CD 14C2        C      	call	RdLine		; Read line
                         C      
  4987    CD 4EA0        C      	call	l4efb
                         C      
  498A    38 0A          C      	jr	c,l49f1
                         C      
  498C    21 680A        C      	ld	hl,l687d
                         C      
  498F    34             C      	inc	(hl)
                         C      
  4990    20 EF          C      	jr	nz,l49dc
                         C      
  4992    23             C      	inc	hl
                         C      
  4993    34             C      	inc	(hl)
                         C      
  4994    18 EB          C      	jr	l49dc
                         C      
  4996                   C      l49f1:
                         C      
  4996    E1             C      	pop	hl
                         C      
  4997    ED 5B 680A     C      	ld	de,(l687d)
                         C      
  499B    73             C      	ld	(hl),e
                         C      
  499C    23             C      	inc	hl
                         C      
  499D    72             C      	ld	(hl),d
                         C      
  499E    C9             C      	ret
                         C      
  499F                   C      l49fa:
                         C      
  499F    03             C      	inc	bc
                         C      
  49A0    0A             C      	ld	a,(bc)
                         C      
  49A1    FE 36          C      	cp	'6'
                         C      
  49A3    C8             C      	ret	z
                         C      
  49A4    FE 35          C      	cp	'5'
                         C      
  49A6    28 F7          C      	jr	z,l49fa
                         C      
  49A8    73             C      	ld	(hl),e
                         C      
  49A9    23             C      	inc	hl
                         C      
  49AA    72             C      	ld	(hl),d
                         C      
  49AB    23             C      	inc	hl
                         C      
  49AC    FE 57          C      	cp	'W'
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-321


                         C      
  49AE    38 15          C      	jr	c,l4a20
                         C      
  49B0                   C      l4a0b:
                         C      
  49B0    12             C      	ld	(de),a
                         C      
  49B1    13             C      	inc	de
                         C      
  49B2    03             C      	inc	bc
                         C      
  49B3    0A             C      	ld	a,(bc)
                         C      
  49B4    FE 57          C      	cp	'W'
                         C      
  49B6    30 F8          C      	jr	nc,l4a0b
                         C      
  49B8    EB             C      	ex	de,hl
                         C      
  49B9    36 00          C      	ld	(hl),0
                         C      
  49BB    23             C      	inc	hl
                         C      
  49BC    EB             C      	ex	de,hl
                         C      
  49BD    FE 50          C      	cp	50h		; Test comma
                         C      
  49BF    28 01          C      	jr	z,l4a1d
                         C      
  49C1    0B             C      	dec	bc
                         C      
  49C2                   C      l4a1d:
                         C      
  49C2    F6 FF          C      	or	ALL
                         C      
  49C4    C9             C      	ret
                         C      
  49C5                   C      l4a20:
                         C      
  49C5    0E 04          C      	ld	c,4
                         C      
  49C7    C3 0905        C      	jp	ERROR
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : NAME
                         C      
                         C      ;
                         C      
  49CA                   C      l4a25:
                         C      
  49CA    21 6832        C      	ld	hl,$$PRGN$$	; Point to name
                         C      
  49CD    3E 10          C      	ld	a,10h
                         C      
  49CF    CD 49D5        C      	call	l4a30
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-322


                         C      
  49D2    C3 4C81        C      	jp	l4cdc
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
  49D5                   C      l4a30:
                         C      
  49D5    E5             C      	push	hl
                         C      
  49D6    F5             C      	push	af
                         C      
  49D7    CD 0DCB        C      	call	.PartToken	; Get token
                         C      
  49DA    FE 55          C      	cp	55h		; Test ( [ {
                         C      
  49DC    28 0B          C      	jr	z,l4a44		; .. yeap
                         C      
  49DE    32 6806        C      	ld	(l6879),a
                         C      
  49E1    22 6804        C      	ld	(l6877),hl
                         C      
  49E4    F1             C      	pop	af
                         C      
  49E5    E1             C      	pop	hl
                         C      
  49E6    C3 4D07        C      	jp	l4d62
                         C      
  49E9                   C      l4a44:
                         C      
  49E9    2A 62F5        C      	ld	hl,(TokPtr)	; Get token pointer
                         C      
  49EC    23             C      	inc	hl
                         C      
  49ED    7E             C      	ld	a,(hl)
                         C      
  49EE    FE 56          C      	cp	56h		; Test string
                         C      
  49F0    20 20          C      	jr	nz,l4a6d
                         C      
  49F2    23             C      	inc	hl
                         C      
  49F3    7E             C      	ld	a,(hl)
                         C      
  49F4    06 00          C      	ld	b,0
                         C      
  49F6    4F             C      	ld	c,a
                         C      
  49F7    F1             C      	pop	af
                         C      
  49F8    B9             C      	cp	c
                         C      
  49F9    30 01          C      	jr	nc,l4a57
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-323


                         C      
  49FB    4F             C      	ld	c,a
                         C      
  49FC                   C      l4a57:
                         C      
  49FC    D1             C      	pop	de
                         C      
  49FD    23             C      	inc	hl
                         C      
  49FE    79             C      	ld	a,c
                         C      
  49FF    B7             C      	or	a
                         C      
  4A00    28 02          C      	jr	z,l4a5f
                         C      
  4A02    ED B0          C      	ldir
                         C      
  4A04                   C      l4a5f:
                         C      
  4A04    23             C      	inc	hl
                         C      
  4A05    3E FF          C      	ld	a,0ffh
                         C      
  4A07    12             C      	ld	(de),a
                         C      
  4A08    7E             C      	ld	a,(hl)
                         C      
  4A09    22 62F5        C      	ld	(TokPtr),hl	; Set token pointer
                         C      
  4A0C    FE 52          C      	cp	52h		; Test ) ] }
                         C      
  4A0E    C8             C      	ret	z
                         C      
  4A0F    C3 0903        C      	jp	SyntaxErr
                         C      
  4A12                   C      l4a6d:
                         C      
  4A12    F1             C      	pop	af
                         C      
  4A13    E1             C      	pop	hl
                         C      
  4A14    36 FF          C      	ld	(hl),0ffh
                         C      
  4A16    C3 0903        C      	jp	SyntaxErr
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .XLIST
                         C      
                         C      ;
                         C      
  4A19                   C      l4a74:
                         C      
  4A19    21 661A        C      	ld	hl,l668d
                         C      
  4A1C    7E             C      	ld	a,(hl)
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-324


                         C      
  4A1D    B7             C      	or	a
                         C      
  4A1E    C8             C      	ret	z
                         C      
  4A1F    3A 0895        C      	ld	a,(l08af)
                         C      
  4A22    B7             C      	or	a
                         C      
  4A23    C0             C      	ret	nz
                         C      
  4A24    34             C      	inc	(hl)
                         C      
  4A25    21 634C        C      	ld	hl,l63bf
                         C      
  4A28    11 6361        C      	ld	de,l63d4
                         C      
  4A2B    01 0015        C      	ld	bc,l63d4-l63bf	;;l0015
                         C      
  4A2E    ED B0          C      	ldir
                         C      
  4A30    C3 0969        C      	jp	DisXXX?		; Disable ???
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : ORG
                         C      
                         C      ;
                         C      
  4A33                   C      l4a8e:
                         C      
  4A33    CD 4B25        C      	call	l4b80
                         C      
  4A36    CD 3FE6        C      	call	l4041
                         C      
  4A39    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  4A3C    FE 36          C      	cp	36h		; Test end of line
                         C      
  4A3E    28 4E          C      	jr	z,l4ae9
                         C      
  4A40    FD 22 69F8     C      	ld	(l6a6b),iy
                         C      
  4A44    3A 67F1        C      	ld	a,($REL$)	; Get mode
                         C      
  4A47    32 69FA        C      	ld	(l6a6d),a
                         C      
  4A4A    79             C      	ld	a,c
                         C      
  4A4B    CD 41B5        C      	call	l4210
                         C      
  4A4E    B7             C      	or	a
                         C      
  4A4F    20 37          C      	jr	nz,l4ae3
                         C      
  4A51    3A 0134        C      	ld	a,($ORG.ABS$)	; Test ABS offset
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-325


                         C      
  4A54    B7             C      	or	a
                         C      
  4A55    28 06          C      	jr	z,l4ab8		; .. nope
                         C      
  4A57    3A 67F1        C      	ld	a,($REL$)	; Get mode
                         C      
  4A5A    B7             C      	or	a
                         C      
  4A5B    20 2B          C      	jr	nz,l4ae3
                         C      
  4A5D                   C      l4ab8:
                         C      
  4A5D    E5             C      	push	hl
                         C      
  4A5E    2A 6754        C      	ld	hl,(l67c7)
                         C      
  4A61    CD 0A1D        C      	call	l0a37
                         C      
  4A64    11 0100        C      	ld	de,TPA
                         C      
  4A67    28 01          C      	jr	z,l4ac5
                         C      
  4A69    15             C      	dec	d
                         C      
  4A6A                   C      l4ac5:
                         C      
  4A6A    ED 52          C      	sbc	hl,de
                         C      
  4A6C    28 0C          C      	jr	z,l4ad5
                         C      
  4A6E    2A 6618        C      	ld	hl,(ABS.ORG)	; Get origin
                         C      
  4A71    23             C      	inc	hl
                         C      
  4A72    7C             C      	ld	a,h
                         C      
  4A73    B5             C      	or	l
                         C      
  4A74    20 04          C      	jr	nz,l4ad5	; .. no wrap
                         C      
  4A76    ED 53 6618     C      	ld	(ABS.ORG),de	; .. set it
                         C      
  4A7A                   C      l4ad5:
                         C      
  4A7A    2A 6618        C      	ld	hl,(ABS.ORG)
                         C      
  4A7D    D1             C      	pop	de
                         C      
  4A7E    37             C      	scf
                         C      
  4A7F    ED 52          C      	sbc	hl,de
                         C      
  4A81    EB             C      	ex	de,hl
                         C      
  4A82    38 03          C      	jr	c,l4ae2
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-326


                         C      
  4A84    22 6618        C      	ld	(ABS.ORG),hl
                         C      
  4A87                   C      l4ae2:
                         C      
  4A87    AF             C      	xor	a
                         C      
  4A88                   C      l4ae3:
                         C      
  4A88    CD 635E        C      	call	l63d1
                         C      
  4A8B    C3 4D41        C      	jp	l4d9c
                         C      
  4A8E                   C      l4ae9:
                         C      
  4A8E    2A 69F8        C      	ld	hl,(l6a6b)
                         C      
  4A91    3A 69FA        C      	ld	a,(l6a6d)
                         C      
  4A94    18 F2          C      	jr	l4ae3
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : EJECT
                         C      
                         C      ;
                         C      
  4A96                   C      l4af1:
                         C      
  4A96    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  4A99    FE 36          C      	cp	36h		; Test new page only
                         C      
  4A9B    28 27          C      	jr	z,l4b1f		; .. yeap
                         C      
  4A9D    FE 50          C      	cp	50h		; Test comma
                         C      
  4A9F    28 12          C      	jr	z,l4b0e		; .. yeap, skip page length
                         C      
  4AA1    CD 4182        C      	call	l41dd
                         C      
  4AA4    38 1E          C      	jr	c,l4b1f
                         C      
  4AA6    7D             C      	ld	a,l
                         C      
  4AA7    32 62C2        C      	ld	(_LST.PAG_),a	; Set list page
                         C      
  4AAA    CD 0DE2        C      	call	GetToken	; Get token
                         C      
  4AAD    FE 36          C      	cp	36h		; Test more
                         C      
  4AAF    C8             C      	ret	z		; .. nope
                         C      
  4AB0    CD 2F91        C      	call	l2fec
                         C      
  4AB3                   C      l4b0e:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-327


                         C      
  4AB3    CD 4187        C      	call	l41e2
                         C      
  4AB6    38 0C          C      	jr	c,l4b1f
                         C      
  4AB8    7D             C      	ld	a,l
                         C      
  4AB9    32 62C1        C      	ld	(_CON.WID_),a	; Set width
                         C      
  4ABC    3E FF          C      	ld	a,0ffh
                         C      
  4ABE    32 6791        C      	ld	(l6804),a
                         C      
  4AC1    C3 4CA5        C      	jp	l4d00
                         C      
  4AC4                   C      l4b1f:
                         C      
  4AC4    3A 0895        C      	ld	a,(l08af)
                         C      
  4AC7    B7             C      	or	a
                         C      
  4AC8    C0             C      	ret	nz
                         C      
  4AC9    CD 4ACF        C      	call	l4b2a
                         C      
  4ACC    C3 4C81        C      	jp	l4cdc
                         C      
  4ACF                   C      l4b2a:
                         C      
  4ACF    3A 6617        C      	ld	a,(Pass)
                         C      
  4AD2    B7             C      	or	a
                         C      
  4AD3    C8             C      	ret	z		; .. 1st pass
                         C      
  4AD4    21 661C        C      	ld	hl,l668f
                         C      
  4AD7    3A 62C2        C      	ld	a,(_LST.PAG_)	; Get list page
                         C      
  4ADA    BE             C      	cp	(hl)
                         C      
  4ADB    C8             C      	ret	z
                         C      
  4ADC    3D             C      	dec	a
                         C      
  4ADD    77             C      	ld	(hl),a
                         C      
  4ADE    3A 011D        C      	ld	a,($SUPPR$)	; Suppress PAGE, TITLE
                         C      
  4AE1    B7             C      	or	a
                         C      
  4AE2    C8             C      	ret	z		; .. nope
                         C      
  4AE3    34             C      	inc	(hl)		; .. count up
                         C      
  4AE4    C9             C      	ret
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-328


                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .PHASE
                         C      
                         C      ;
                         C      
  4AE5                   C      l4b40:
                         C      
  4AE5    CD 4B25        C      	call	l4b80
                         C      
  4AE8    3A 67C2        C      	ld	a,(OS.Flg)	; Test warm vector saved
                         C      
  4AEB    B7             C      	or	a
                         C      
  4AEC    28 11          C      	jr	z,l4b5a		; .. nope
                         C      
  4AEE    2A 6329        C      	ld	hl,(l639c)
                         C      
  4AF1    E5             C      	push	hl
                         C      
  4AF2    21 4AFB        C      	ld	hl,l4b56
                         C      
  4AF5    22 6329        C      	ld	(l639c),hl
                         C      
  4AF8    C3 6328        C      	jp	Con$Put		; Put code to file
                         C      
  4AFB                   C      l4b56:
                         C      
  4AFB    E1             C      	pop	hl
                         C      
  4AFC    22 6329        C      	ld	(l639c),hl
                         C      
  4AFF                   C      l4b5a:
                         C      
  4AFF    CD 41BA        C      	call	l4215
                         C      
  4B02    2A 67F2        C      	ld	hl,(l6865)
                         C      
  4B05    22 6610        C      	ld	(l6683),hl
                         C      
  4B08    3A 67F1        C      	ld	a,($REL$)	; Get mode
                         C      
  4B0B    32 660F        C      	ld	(l6682),a
                         C      
  4B0E    FD 2A 6407     C      	ld	iy,(l647a)
                         C      
  4B12    FD 22 6613     C      	ld	(l6686),iy
                         C      
  4B16    3A 6406        C      	ld	a,(l6479)
                         C      
  4B19    32 6612        C      	ld	(l6685),a
                         C      
  4B1C    32 67F1        C      	ld	($REL$),a	; Set mode
                         C      
  4B1F    3E FF          C      	ld	a,0ffh
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-329


                         C      
  4B21    32 679E        C      	ld	(l6811),a
                         C      
  4B24    C9             C      	ret
                         C      
  4B25                   C      l4b80:
                         C      
  4B25    3A 679E        C      	ld	a,(l6811)
                         C      
  4B28    B7             C      	or	a
                         C      
  4B29    C8             C      	ret	z
                         C      
  4B2A    CD 41FF        C      	call	l425a
                         C      
  4B2D    0E 10          C      	ld	c,16
                         C      
  4B2F    C3 08F5        C      	jp	.ERROR
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : CSEG
                         C      
                         C      ;
                         C      
  4B32                   C      l4b8d:
                         C      
  4B32    CD 4006        C      	call	l4061
                         C      
  4B35    CD 3FE6        C      	call	l4041
                         C      
  4B38    3E 01          C      	ld	a,1
                         C      
  4B3A    2A 6758        C      	ld	hl,(l67cb)
                         C      
  4B3D    C3 4D41        C      	jp	l4d9c
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .RADIX
                         C      
                         C      ;
                         C      
  4B40                   C      l4b9b:
                         C      
  4B40    3A 6806        C      	ld	a,(l6879)
                         C      
  4B43    B7             C      	or	a
                         C      
  4B44    28 0B          C      	jr	z,l4bac
                         C      
  4B46    AF             C      	xor	a
                         C      
  4B47    32 6806        C      	ld	(l6879),a
                         C      
  4B4A    2A 6376        C      	ld	hl,(TokStrt)	; Get start of token
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-330


                         C      
  4B4D    2B             C      	dec	hl
                         C      
  4B4E    22 62F5        C      	ld	(TokPtr),hl	; .. to token pointer
                         C      
  4B51                   C      l4bac:
                         C      
  4B51    3E 0A          C      	ld	a,10
                         C      
  4B53    CD 4B71        C      	call	SetRadix	; Set default radix 10
                         C      
  4B56    CD 4187        C      	call	l41e2
                         C      
  4B59    CD 635E        C      	call	l63d1
                         C      
  4B5C    7C             C      	ld	a,h
                         C      
  4B5D    B7             C      	or	a
                         C      
  4B5E    20 0C          C      	jr	nz,l4bc7
                         C      
  4B60    7D             C      	ld	a,l
                         C      
  4B61    FE 11          C      	cp	16+1
                         C      
  4B63    30 07          C      	jr	nc,l4bc7
                         C      
  4B65    FE 02          C      	cp	2
                         C      
  4B67    38 03          C      	jr	c,l4bc7
                         C      
  4B69    C3 4B71        C      	jp	SetRadix	; Set radix
                         C      
  4B6C                   C      l4bc7:
                         C      
  4B6C    0E 08          C      	ld	c,8
                         C      
  4B6E    C3 08F5        C      	jp	.ERROR
                         C      
                         C      ;
                         C      
                         C      ; Set radix and prepare conversion
                         C      
                         C      ; ENTRY	Accu holds radix
                         C      
                         C      ;
                         C      
  4B71                   C      SetRadix:
                         C      
  4B71    32 6615        C      	ld	(Radix),a	; Save radix
                         C      
  4B74    FE 10          C      	cp	16		; Test hex
                         C      
  4B76    21 0F5E        C      	ld	hl,Get$HEX
                         C      
  4B79    11 340F        C      	ld	de,Out$HEX
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-331


                         C      
  4B7C    28 24          C      	jr	z,l4bfd
                         C      
  4B7E    FE 0A          C      	cp	10		; .. decimal
                         C      
  4B80    21 0F20        C      	ld	hl,Get$DEC
                         C      
  4B83    11 34A2        C      	ld	de,Out$DEC
                         C      
  4B86    28 1A          C      	jr	z,l4bfd
                         C      
  4B88    FE 08          C      	cp	8		; .. octal
                         C      
  4B8A    21 0F8C        C      	ld	hl,Get$OCT
                         C      
  4B8D    11 344A        C      	ld	de,Out$OCT
                         C      
  4B90    28 10          C      	jr	z,l4bfd
                         C      
  4B92    FE 02          C      	cp	2		; .. binary
                         C      
  4B94    21 0F75        C      	ld	hl,Get$BIN
                         C      
  4B97    11 3470        C      	ld	de,Out$BIN
                         C      
  4B9A    28 06          C      	jr	z,l4bfd
                         C      
  4B9C    21 0FA3        C      	ld	hl,Get$NUM
                         C      
  4B9F    11 3470        C      	ld	de,Out$BIN
                         C      
  4BA2                   C      l4bfd:
                         C      
  4BA2    22 0EE8        C      	ld	(l0f02),hl	; Set up addresses
                         C      
  4BA5    ED 53 31B9     C      	ld	(l3214),de
                         C      
  4BA9    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : REPT
                         C      
                         C      ;
                         C      
  4BAA                   C      l4c05:
                         C      
  4BAA    CD 4187        C      	call	l41e2
                         C      
  4BAD    E5             C      	push	hl
                         C      
  4BAE    21 0000        C      	ld	hl,0
                         C      
  4BB1    22 6634        C      	ld	(l66a7),hl
                         C      
  4BB4    23             C      	inc	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-332


                         C      
  4BB5    22 67CB        C      	ld	(l683e),hl
                         C      
  4BB8    2A 631B        C      	ld	hl,(DynPtr2)	; Get pointer
                         C      
  4BBB    22 660D        C      	ld	(l6680),hl	; .. save
                         C      
  4BBE    CD 462A        C      	call	l4685
                         C      
  4BC1    E1             C      	pop	hl
                         C      
  4BC2    CD 4BC9        C      	call	l4c24
                         C      
  4BC5                   C      l4c20:
                         C      
  4BC5    E1             C      	pop	hl
                         C      
  4BC6    C3 0681        C      	jp	.ProcSRC	; Process line
                         C      
  4BC9                   C      l4c24:
                         C      
  4BC9    7C             C      	ld	a,h
                         C      
  4BCA    B5             C      	or	l
                         C      
  4BCB    28 30          C      	jr	z,l4c58
                         C      
  4BCD    E5             C      	push	hl
                         C      
  4BCE    21 31E1        C      	ld	hl,l323c
                         C      
  4BD1    22 14C3        C      	ld	($LinVec),hl	; Change vector
                         C      
  4BD4    01 0016        C      	ld	bc,22		;;l0016
                         C      
  4BD7    CD 2247        C      	call	malloc_		; Allocate memory
                         C      
  4BDA    2A 67F4        C      	ld	hl,(l6867)
                         C      
  4BDD    36 FE          C      	ld	(hl),0feh	; Set REPT opcode
                         C      
  4BDF    D1             C      	pop	de
                         C      
  4BE0    23             C      	inc	hl
                         C      
  4BE1    36 08          C      	ld	(hl),LOW  (l4c64-1)
                         C      
  4BE3    23             C      	inc	hl
                         C      
  4BE4    36 4C          C      	ld	(hl),HIGH (l4c64-1)
                         C      
  4BE6    23             C      	inc	hl
                         C      
  4BE7    AF             C      	xor	a
                         C      
  4BE8    77             C      	ld	(hl),a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-333


                         C      
  4BE9    23             C      	inc	hl
                         C      
  4BEA    77             C      	ld	(hl),a
                         C      
  4BEB    23             C      	inc	hl
                         C      
  4BEC    77             C      	ld	(hl),a
                         C      
  4BED    23             C      	inc	hl
                         C      
  4BEE    1B             C      	dec	de
                         C      
  4BEF    73             C      	ld	(hl),e
                         C      
  4BF0    23             C      	inc	hl
                         C      
  4BF1    72             C      	ld	(hl),d
                         C      
  4BF2    23             C      	inc	hl
                         C      
  4BF3    5E             C      	ld	e,(hl)
                         C      
  4BF4    23             C      	inc	hl
                         C      
  4BF5    56             C      	ld	d,(hl)
                         C      
  4BF6    19             C      	add	hl,de
                         C      
  4BF7    2B             C      	dec	hl
                         C      
  4BF8    2B             C      	dec	hl
                         C      
  4BF9    22 67FD        C      	ld	(l6870),hl
                         C      
  4BFC    C9             C      	ret
                         C      
  4BFD                   C      l4c58:
                         C      
  4BFD    2A 631B        C      	ld	hl,(DynPtr2)	; Get pointer
                         C      
  4C00    5E             C      	ld	e,(hl)		; .. fetch length
                         C      
  4C01    23             C      	inc	hl
                         C      
  4C02    56             C      	ld	d,(hl)
                         C      
  4C03    2B             C      	dec	hl
                         C      
  4C04    19             C      	add	hl,de		; .. add
                         C      
  4C05    22 631B        C      	ld	(DynPtr2),hl	; .. set new top
                         C      
  4C08    C9             C      	ret
                         C      
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-334


                         C      
                         C      ; Coded REPT
                         C      
                         C      ;
                         C      
  4C09                   C      l4c64:
                         C      
  4C09    77 6A 75 79    C      	db	77h,6ah,75h,79h,null
  4C0D    00             C      
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .REQUEST
                         C      
                         C      ;
                         C      
  4C0E                   C      l4c69:
                         C      
  4C0E    CD 4009        C      	call	l4064
                         C      
  4C11    3A 6617        C      	ld	a,(Pass)
                         C      
  4C14    B7             C      	or	a
                         C      
  4C15    CA 452A        C      	jp	z,l4585		; .. 1st pass
                         C      
  4C18    CD 43F7        C      	call	l4452
                         C      
  4C1B                   C      l4c76:
                         C      
  4C1B    CD 4576        C      	call	l45d1
                         C      
  4C1E    E5             C      	push	hl
                         C      
  4C1F    01 000B        C      	ld	bc,l000b
                         C      
  4C22    CD 229A        C      	call	d.alloc_	; Allocate memory
                         C      
  4C25    ED 5B 6810     C      	ld	de,(l6883)
                         C      
  4C29    22 6810        C      	ld	(l6883),hl
                         C      
  4C2C    7A             C      	ld	a,d
                         C      
  4C2D    B7             C      	or	a
                         C      
  4C2E    20 03          C      	jr	nz,l4c8e
                         C      
  4C30    11 6805        C      	ld	de,l6878
                         C      
  4C33                   C      l4c8e:
                         C      
  4C33    EB             C      	ex	de,hl
                         C      
  4C34    01 0009        C      	ld	bc,@drv+@nam
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-335


  4C37    09             C      	add	hl,bc
                         C      
  4C38    73             C      	ld	(hl),e
                         C      
  4C39    23             C      	inc	hl
                         C      
  4C3A    72             C      	ld	(hl),d
                         C      
  4C3B    21 6AB6        C      	ld	hl,SrcFCB
                         C      
  4C3E    ED B0          C      	ldir			; Copy file name
                         C      
  4C40    AF             C      	xor	a
                         C      
  4C41    12             C      	ld	(de),a
                         C      
  4C42    13             C      	inc	de
                         C      
  4C43    12             C      	ld	(de),a
                         C      
  4C44    E1             C      	pop	hl
                         C      
  4C45    23             C      	inc	hl
                         C      
  4C46                   C      l4ca1:
                         C      
  4C46    7E             C      	ld	a,(hl)
                         C      
  4C47    23             C      	inc	hl
                         C      
  4C48    FE 20          C      	cp	' '
                         C      
  4C4A    28 FA          C      	jr	z,l4ca1
                         C      
  4C4C    FE 09          C      	cp	tab
                         C      
  4C4E    28 F6          C      	jr	z,l4ca1
                         C      
  4C50    FE 2C          C      	cp	','
                         C      
  4C52    C0             C      	ret	nz
                         C      
  4C53                   C      l4cae:
                         C      
  4C53    7E             C      	ld	a,(hl)
                         C      
  4C54    23             C      	inc	hl
                         C      
  4C55    FE 20          C      	cp	' '
                         C      
  4C57    28 FA          C      	jr	z,l4cae
                         C      
  4C59    FE 09          C      	cp	tab
                         C      
  4C5B    28 F6          C      	jr	z,l4cae
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-336


  4C5D    2B             C      	dec	hl
                         C      
  4C5E    18 BB          C      	jr	l4c76
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .PRINTX
                         C      
                         C      ;
                         C      
  4C60                   C      l4cbb:
                         C      
  4C60    21 6A35        C      	ld	hl,l6aa8
                         C      
  4C63    3E 78          C      	ld	a,120		;;78h
                         C      
  4C65    CD 4D07        C      	call	l4d62
                         C      
  4C68    EB             C      	ex	de,hl
                         C      
  4C69    36 0D          C      	ld	(hl),cr
                         C      
  4C6B    23             C      	inc	hl
                         C      
  4C6C    36 0A          C      	ld	(hl),lf
                         C      
  4C6E    23             C      	inc	hl
                         C      
  4C6F    36 FF          C      	ld	(hl),-1
                         C      
  4C71    21 6A35        C      	ld	hl,l6aa8
                         C      
  4C74    CD 6134        C      	call	PutStr		; Print
                         C      
  4C77    18 08          C      	jr	l4cdc
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : SUBTTL and $TTTLE
                         C      
                         C      ;
                         C      
  4C79                   C      l4cd4:
                         C      
  4C79    21 63C9        C      	ld	hl,@MES@	; Point to message
                         C      
  4C7C    3E 3C          C      	ld	a,60		;;;'<'
                         C      
  4C7E    CD 49D5        C      	call	l4a30
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-337


  4C81                   C      l4cdc:
                         C      
  4C81    21 62F1        C      	ld	hl,l6364
                         C      
  4C84    22 62F5        C      	ld	(TokPtr),hl	; Init token pointer
                         C      
  4C87    AF             C      	xor	a
                         C      
  4C88    32 67CD        C      	ld	(l6840),a
                         C      
  4C8B    3A 011D        C      	ld	a,($SUPPR$)	; Suppress PAGE, TITLE
                         C      
  4C8E    B7             C      	or	a
                         C      
  4C8F    C8             C      	ret	z		; .. nope
                         C      
  4C90    3E C9          C      	ld	a,_RET
                         C      
  4C92    32 07D7        C      	ld	(l07f1),a	; Set return
                         C      
  4C95    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .TFCOND
                         C      
                         C      ;
                         C      
  4C96                   C      l4cf1:
                         C      
  4C96    21 62C5        C      	ld	hl,_FALSE_
                         C      
  4C99    7E             C      	ld	a,(hl)
                         C      
  4C9A    2F             C      	cpl			; Toggle false conditionals
                         C      
  4C9B    77             C      	ld	(hl),a
                         C      
  4C9C    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : TITLE
                         C      
                         C      ;
                         C      
  4C9D                   C      l4cf8:
                         C      
  4C9D    3E FF          C      	ld	a,eot
                         C      
  4C9F    32 69FB        C      	ld	(l6a6e),a
                         C      
  4CA2    32 6378        C      	ld	(l63eb),a	; Set empty line
                         C      
  4CA5                   C      l4d00:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-338


  4CA5    3A 62C1        C      	ld	a,(_CON.WID_)	; Get console witdh
                         C      
  4CA8    D6 14          C      	sub	MinWid		; Test length
                         C      
  4CAA    38 D5          C      	jr	c,l4cdc		; .. too short to be filled
                         C      
  4CAC    F5             C      	push	af
                         C      
  4CAD    3A 0121        C      	ld	a,($TOD.ENA$)	; Test TOD to be inserted
                         C      
  4CB0    B7             C      	or	a
                         C      
  4CB1    28 06          C      	jr	z,l4d14		; .. nope
                         C      
  4CB3    F1             C      	pop	af
                         C      
  4CB4    D6 10          C      	sub	$TODlen		; Test room enough
                         C      
  4CB6    38 C9          C      	jr	c,l4cdc		; .. nope
                         C      
  4CB8    F5             C      	push	af
                         C      
  4CB9                   C      l4d14:
                         C      
  4CB9    F1             C      	pop	af
                         C      
  4CBA    F5             C      	push	af		; Get back width
                         C      
  4CBB    FE 50          C      	cp	MaxWid		; Test too long
                         C      
  4CBD    38 02          C      	jr	c,l4d1c
                         C      
  4CBF    3E 50          C      	ld	a,MaxWid	; .. truncate
                         C      
  4CC1                   C      l4d1c:
                         C      
  4CC1    21 6378        C      	ld	hl,l63eb
                         C      
  4CC4    CD 49D5        C      	call	l4a30
                         C      
  4CC7    21 6378        C      	ld	hl,l63eb
                         C      
  4CCA    EB             C      	ex	de,hl
                         C      
  4CCB    B7             C      	or	a
                         C      
  4CCC    ED 52          C      	sbc	hl,de		; Get length
                         C      
  4CCE    4D             C      	ld	c,l
                         C      
  4CCF    21 69FB        C      	ld	hl,l6a6e
                         C      
  4CD2    F1             C      	pop	af		; Get back terminal width
                         C      
  4CD3    47             C      	ld	b,a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-339


  4CD4    18 04          C      	jr	l4d35
                         C      
  4CD6                   C      l4d31:
                         C      
  4CD6    36 20          C      	ld	(hl),' '	; Blank position
                         C      
  4CD8    23             C      	inc	hl
                         C      
  4CD9    0C             C      	inc	c
                         C      
  4CDA                   C      l4d35:
                         C      
  4CDA    79             C      	ld	a,c		; Test end
                         C      
  4CDB    B8             C      	cp	b
                         C      
  4CDC    28 15          C      	jr	z,l4d4e		; .. yeap, got position
                         C      
  4CDE    E6 07          C      	and	ColMask		; Test column position
                         C      
  4CE0    20 F4          C      	jr	nz,l4d31	; .. nope, blank
                         C      
  4CE2    79             C      	ld	a,c
                         C      
  4CE3                   C      l4d3e:
                         C      
  4CE3    36 09          C      	ld	(hl),tab	; Set tab for column position
                         C      
  4CE5    23             C      	inc	hl
                         C      
  4CE6    C6 08          C      	add	a,ColTab	; Add for next column
                         C      
  4CE8    B8             C      	cp	b		; Test too long now
                         C      
  4CE9    38 F8          C      	jr	c,l4d3e		; .. nope, more tabs
                         C      
  4CEB    28 06          C      	jr	z,l4d4e		; .. got it
                         C      
  4CED    D6 08          C      	sub	ColTab		; .. fix
                         C      
  4CEF    4F             C      	ld	c,a
                         C      
  4CF0    2B             C      	dec	hl
                         C      
  4CF1    18 E3          C      	jr	l4d31		; .. more blanks
                         C      
  4CF3                   C      l4d4e:
                         C      
  4CF3    36 FF          C      	ld	(hl),eot	;Set end
                         C      
  4CF5    18 8A          C      	jr	l4cdc
                         C      
                         C      ;
                         C      
                         C      ;
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-340


                         C      ;
                         C      
  4CF7                   C      l4d52:
                         C      
  4CF7    F1             C      	pop	af
                         C      
  4CF8    4F             C      	ld	c,a
                         C      
  4CF9    06 00          C      	ld	b,0
                         C      
  4CFB    3E FF          C      	ld	a,0ffh
                         C      
  4CFD    ED B1          C      	cpir
                         C      
  4CFF    2B             C      	dec	hl
                         C      
  4D00    77             C      	ld	(hl),a
                         C      
  4D01    EB             C      	ex	de,hl
                         C      
  4D02    AF             C      	xor	a
                         C      
  4D03    32 6791        C      	ld	(l6804),a
                         C      
  4D06    C9             C      	ret
                         C      
  4D07                   C      l4d62:
                         C      
  4D07    F5             C      	push	af
                         C      
  4D08    3A 6791        C      	ld	a,(l6804)
                         C      
  4D0B    B7             C      	or	a
                         C      
  4D0C    20 E9          C      	jr	nz,l4d52
                         C      
  4D0E    36 FF          C      	ld	(hl),0ffh
                         C      
  4D10    E5             C      	push	hl
                         C      
  4D11    CD 0DCB        C      	call	.PartToken	; Get tiken
                         C      
  4D14    FE 36          C      	cp	36h		; Test end of line
                         C      
  4D16    D1             C      	pop	de
                         C      
  4D17    C1             C      	pop	bc
                         C      
  4D18    C8             C      	ret	z		; .. yeap
                         C      
  4D19    D5             C      	push	de
                         C      
  4D1A    C5             C      	push	bc
                         C      
  4D1B    CD 3346        C      	call	l33a1
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-341


  4D1E    60             C      	ld	h,b
                         C      
  4D1F    69             C      	ld	l,c
                         C      
  4D20    C1             C      	pop	bc
                         C      
  4D21    D1             C      	pop	de
                         C      
  4D22    0E 3B          C      	ld	c,';'
                         C      
  4D24                   C      l4d7f:
                         C      
  4D24    23             C      	inc	hl
                         C      
  4D25    7E             C      	ld	a,(hl)
                         C      
  4D26    B9             C      	cp	c
                         C      
  4D27    28 0E          C      	jr	z,l4d92
                         C      
  4D29    FE 0D          C      	cp	cr
                         C      
  4D2B    28 0A          C      	jr	z,l4d92
                         C      
  4D2D    FE 20          C      	cp	' '
                         C      
  4D2F    30 02          C      	jr	nc,l4d8e
                         C      
  4D31    3E 20          C      	ld	a,' '
                         C      
  4D33                   C      l4d8e:
                         C      
  4D33    12             C      	ld	(de),a
                         C      
  4D34    13             C      	inc	de
                         C      
  4D35    10 ED          C      	djnz	l4d7f
                         C      
  4D37                   C      l4d92:
                         C      
  4D37    3E FF          C      	ld	a,0ffh
                         C      
  4D39    12             C      	ld	(de),a
                         C      
  4D3A    C9             C      	ret
                         C      
                         C      ;
                         C      
                         C      ; Pseudo code : .XCREF
                         C      
                         C      ;
                         C      
  4D3B                   C      l4d96:
                         C      
  4D3B    3E C9          C      	ld	a,_RET
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-342


  4D3D    32 1464        C      	ld	($CrsEna),a	; Disable cross ref
                         C      
  4D40    C9             C      	ret
                         C      
  4D41                   C      l4d9c:
                         C      
  4D41    E5             C      	push	hl
                         C      
  4D42    47             C      	ld	b,a
                         C      
  4D43    3A 67C2        C      	ld	a,(OS.Flg)	; Test warm vector saved
                         C      
  4D46    B7             C      	or	a
                         C      
  4D47    20 2C          C      	jr	nz,l4dd0	; .. yeap
                         C      
  4D49    CD 509F        C      	call	l50fa
                         C      
  4D4C    2A 0001        C      	ld	hl,(OS+1)	; Get warm start
                         C      
  4D4F    22 4D7C        C      	ld	(OS.sav),hl	; .. save
                         C      
  4D52    21 4D7E        C      	ld	hl,SLR.OS
                         C      
  4D55    22 0001        C      	ld	(OS+1),hl	; .. set new
                         C      
  4D58    3E C7          C      	ld	a,_RST.0
                         C      
  4D5A    32 67C2        C      	ld	(OS.Flg),a	; Indicate vector saved
                         C      
  4D5D    32 631F        C      	ld	(l6392),a
                         C      
  4D60    32 6328        C      	ld	(Con$Put),a	; .. disable constant to file
                         C      
  4D63    32 6337        C      	ld	(l63aa),a
                         C      
  4D66    32 633A        C      	ld	(l63ad),a
                         C      
  4D69    32 6340        C      	ld	(l63b3),a
                         C      
  4D6C    32 6343        C      	ld	(l63b6),a
                         C      
  4D6F    32 6346        C      	ld	(l63b9),a
                         C      
  4D72    32 6349        C      	ld	(l63bc),a
                         C      
  4D75                   C      l4dd0:
                         C      
  4D75    FD E1          C      	pop	iy
                         C      
  4D77    78             C      	ld	a,b
                         C      
  4D78    32 67F1        C      	ld	($REL$),a	; Set mode
                         C      
  4D7B    C9             C      	ret
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-343


  4D7C                   C      OS.sav:
                         C      
  4D7C    0000           C      	dw	0
                         C      
                         C      ;
                         C      
                         C      ; New OS warm start
                         C      
                         C      ;
                         C      
  4D7E                   C      SLR.OS:
                         C      
  4D7E    E5             C      	push	hl
                         C      
  4D7F    D5             C      	push	de
                         C      
  4D80    C5             C      	push	bc
                         C      
  4D81    F5             C      	push	af
                         C      
  4D82    AF             C      	xor	a
                         C      
  4D83    32 67C2        C      	ld	(OS.Flg),a	; Clear indicator
                         C      
  4D86    2A 4D7C        C      	ld	hl,(OS.sav)	; Restore vector
                         C      
  4D89    22 0001        C      	ld	(OS+1),hl
                         C      
  4D8C    3E C3          C      	ld	a,_JP
                         C      
  4D8E    32 631F        C      	ld	(l6392),a	; Set jumps
                         C      
  4D91    32 6328        C      	ld	(Con$Put),a	; .. enable constant to file
                         C      
  4D94    32 6337        C      	ld	(l63aa),a
                         C      
  4D97    32 633A        C      	ld	(l63ad),a
                         C      
  4D9A    32 6340        C      	ld	(l63b3),a
                         C      
  4D9D    32 6343        C      	ld	(l63b6),a
                         C      
  4DA0    32 6346        C      	ld	(l63b9),a
                         C      
  4DA3    32 6349        C      	ld	(l63bc),a
                         C      
  4DA6    FD E5          C      	push	iy
                         C      
  4DA8    E1             C      	pop	hl
                         C      
  4DA9    3A 67F1        C      	ld	a,($REL$)	; Get mode
                         C      
  4DAC    F5             C      	push	af
                         C      
  4DAD    3A 679E        C      	ld	a,(l6811)
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-344


  4DB0    B7             C      	or	a
                         C      
  4DB1    28 10          C      	jr	z,l4e1e
                         C      
  4DB3    ED 5B 6613     C      	ld	de,(l6686)
                         C      
  4DB7    ED 52          C      	sbc	hl,de
                         C      
  4DB9    ED 5B 6610     C      	ld	de,(l6683)
                         C      
  4DBD    19             C      	add	hl,de
                         C      
  4DBE    F1             C      	pop	af
                         C      
  4DBF    3A 660F        C      	ld	a,(l6682)
                         C      
  4DC2    F5             C      	push	af
                         C      
  4DC3                   C      l4e1e:
                         C      
  4DC3    F1             C      	pop	af
                         C      
  4DC4    CD 6331        C      	call	l63a4
                         C      
  4DC7    F1             C      	pop	af
                         C      
  4DC8    C1             C      	pop	bc
                         C      
  4DC9    D1             C      	pop	de
                         C      
  4DCA    E1             C      	pop	hl
                         C      
  4DCB    E3             C      	ex	(sp),hl
                         C      
  4DCC    2B             C      	dec	hl
                         C      
  4DCD    E3             C      	ex	(sp),hl
                         C      
  4DCE    C9             C      	ret
                         C      
  4DCF                   C      l4e2a:
                         C      
  4DCF    E5             C      	push	hl
                         C      
  4DD0    D5             C      	push	de
                         C      
  4DD1    C5             C      	push	bc
                         C      
  4DD2    F5             C      	push	af
                         C      
  4DD3    EB             C      	ex	de,hl
                         C      
  4DD4    3A 679A        C      	ld	a,(l680d)
                         C      
  4DD7    B7             C      	or	a
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-345


  4DD8    28 0A          C      	jr	z,l4e3f
                         C      
  4DDA    3E 06          C      	ld	a,6
                         C      
  4DDC    32 6314        C      	ld	(l6387),a
                         C      
  4DDF    D5             C      	push	de
                         C      
  4DE0    CD 0CBA        C      	call	l0cd4
                         C      
  4DE3    D1             C      	pop	de
                         C      
  4DE4                   C      l4e3f:
                         C      
  4DE4    21 6AD3        C      	ld	hl,l6b46
                         C      
  4DE7    22 6317        C      	ld	(LinePtr),hl	; Init line pointer
                         C      
  4DEA    EB             C      	ex	de,hl
                         C      
  4DEB    F1             C      	pop	af
                         C      
  4DEC    F5             C      	push	af
                         C      
  4DED    CD 0D1C        C      	call	l0d36
                         C      
  4DF0    3E FF          C      	ld	a,0ffh
                         C      
  4DF2    32 67D3        C      	ld	(l6846),a
                         C      
  4DF5    F1             C      	pop	af
                         C      
  4DF6    C1             C      	pop	bc
                         C      
  4DF7    D1             C      	pop	de
                         C      
  4DF8    E1             C      	pop	hl
                         C      
  4DF9    C9             C      	ret
                         C      
  4DFA                   C      l4e55:
                         C      
  4DFA    13             C      	inc	de
                         C      
  4DFB    1A             C      	ld	a,(de)
                         C      
  4DFC    1B             C      	dec	de
                         C      
  4DFD    F6 20          C      	or	' '
                         C      
  4DFF    FE 61          C      	cp	61h
                         C      
  4E01    20 08          C      	jr	nz,l4e66
                         C      
  4E03    1A             C      	ld	a,(de)
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-346


  4E04    F6 20          C      	or	' '
                         C      
  4E06    FE 66          C      	cp	66h
                         C      
  4E08    CA 4EB4        C      	jp	z,l4f0f
                         C      
  4E0B                   C      l4e66:
                         C      
  4E0B    CD 500B        C      	call	l5066
                         C      
  4E0E                   C      l4e69:
                         C      
  4E0E    FE 9B          C      	cp	9bh
                         C      
  4E10    38 15          C      	jr	c,l4e82
                         C      
  4E12    FE 9E          C      	cp	9eh
                         C      
  4E14    CA 4EB4        C      	jp	z,l4f0f
                         C      
  4E17    FE 9F          C      	cp	9fh
                         C      
  4E19    28 F0          C      	jr	z,l4e66
                         C      
  4E1B    FE A1          C      	cp	0a1h
                         C      
  4E1D    28 EC          C      	jr	z,l4e66
                         C      
  4E1F    FE 9D          C      	cp	9dh
                         C      
  4E21    CA 4EDB        C      	jp	z,l4f36
                         C      
  4E24    C3 4ED3        C      	jp	l4f2e
                         C      
  4E27                   C      l4e82:
                         C      
  4E27    CD 4FEF        C      	call	l504a
                         C      
  4E2A    20 24          C      	jr	nz,l4eab
                         C      
  4E2C    2B             C      	dec	hl
                         C      
  4E2D    08             C      	ex	af,af'
                         C      
  4E2E    7E             C      	ld	a,(hl)
                         C      
  4E2F    23             C      	inc	hl
                         C      
  4E30    FE 26          C      	cp	'&'
                         C      
  4E32    20 17          C      	jr	nz,l4ea6
                         C      
  4E34    13             C      	inc	de
                         C      
  4E35                   C      l4e90:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-347


  4E35    08             C      	ex	af,af'
                         C      
  4E36    60             C      	ld	h,b
                         C      
  4E37    69             C      	ld	l,c
                         C      
  4E38    47             C      	ld	b,a
                         C      
  4E39    3E A0          C      	ld	a,0a0h
                         C      
  4E3B    90             C      	sub	b
                         C      
  4E3C    1B             C      	dec	de
                         C      
  4E3D    12             C      	ld	(de),a
                         C      
  4E3E    7E             C      	ld	a,(hl)
                         C      
  4E3F    FE 26          C      	cp	'&'
                         C      
  4E41    20 01          C      	jr	nz,l4e9f
                         C      
  4E43    23             C      	inc	hl
                         C      
  4E44                   C      l4e9f:
                         C      
  4E44    06 01          C      	ld	b,HIGH CtrlArr	; Set control page
                         C      
  4E46                   C      l4ea1:
                         C      
  4E46    CD 500F        C      	call	l506a
                         C      
  4E49    18 C3          C      	jr	l4e69
                         C      
  4E4B                   C      l4ea6:
                         C      
  4E4B    0A             C      	ld	a,(bc)
                         C      
  4E4C    FE 26          C      	cp	'&'
                         C      
  4E4E    28 E5          C      	jr	z,l4e90
                         C      
  4E50                   C      l4eab:
                         C      
  4E50    06 01          C      	ld	b,HIGH CtrlArr	; Set control page
                         C      
  4E52    CD 5021        C      	call	l507c
                         C      
  4E55    18 EF          C      	jr	l4ea1
                         C      
  4E57                   C      l4eb2:
                         C      
  4E57    CD 500B        C      	call	l5066
                         C      
  4E5A                   C      l4eb5:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-348


  4E5A    FE 9B          C      	cp	9bh
                         C      
  4E5C    38 12          C      	jr	c,l4ecb
                         C      
  4E5E    FE 9F          C      	cp	9fh
                         C      
  4E60    28 52          C      	jr	z,l4f0f
                         C      
  4E62    FE 9E          C      	cp	9eh
                         C      
  4E64    28 F1          C      	jr	z,l4eb2
                         C      
  4E66    FE A1          C      	cp	0a1h
                         C      
  4E68    28 ED          C      	jr	z,l4eb2
                         C      
  4E6A    FE 9D          C      	cp	9dh
                         C      
  4E6C    28 6D          C      	jr	z,l4f36
                         C      
  4E6E    18 63          C      	jr	l4f2e
                         C      
  4E70                   C      l4ecb:
                         C      
  4E70    CD 4FEF        C      	call	l504a
                         C      
  4E73    20 24          C      	jr	nz,l4ef4
                         C      
  4E75    2B             C      	dec	hl
                         C      
  4E76    08             C      	ex	af,af'
                         C      
  4E77    7E             C      	ld	a,(hl)
                         C      
  4E78    23             C      	inc	hl
                         C      
  4E79    FE 26          C      	cp	'&'
                         C      
  4E7B    20 17          C      	jr	nz,l4eef
                         C      
  4E7D    13             C      	inc	de
                         C      
  4E7E                   C      l4ed9:
                         C      
  4E7E    08             C      	ex	af,af'
                         C      
  4E7F    60             C      	ld	h,b
                         C      
  4E80    69             C      	ld	l,c
                         C      
  4E81    47             C      	ld	b,a
                         C      
  4E82    3E A0          C      	ld	a,0a0h
                         C      
  4E84    90             C      	sub	b
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-349


  4E85    1B             C      	dec	de
                         C      
  4E86    12             C      	ld	(de),a
                         C      
  4E87    7E             C      	ld	a,(hl)
                         C      
  4E88    FE 26          C      	cp	'&'
                         C      
  4E8A    20 01          C      	jr	nz,l4ee8
                         C      
  4E8C    23             C      	inc	hl
                         C      
  4E8D                   C      l4ee8:
                         C      
  4E8D    06 01          C      	ld	b,HIGH CtrlArr	; Set control page
                         C      
  4E8F                   C      l4eea:
                         C      
  4E8F    CD 500F        C      	call	l506a
                         C      
  4E92    18 C6          C      	jr	l4eb5
                         C      
  4E94                   C      l4eef:
                         C      
  4E94    0A             C      	ld	a,(bc)
                         C      
  4E95    FE 26          C      	cp	'&'
                         C      
  4E97    28 E5          C      	jr	z,l4ed9
                         C      
  4E99                   C      l4ef4:
                         C      
  4E99    06 01          C      	ld	b,HIGH CtrlArr	; Set control page
                         C      
  4E9B    CD 5021        C      	call	l507c
                         C      
  4E9E    18 EF          C      	jr	l4eea
                         C      
  4EA0                   C      l4efb:
                         C      
  4EA0    DD E5          C      	push	ix
                         C      
  4EA2    01 0080        C      	ld	bc,RecLng
                         C      
  4EA5    CD 229A        C      	call	d.alloc_	; Allocate memory
                         C      
  4EA6                   C      l4f01	equ	$-2
                         C      
  4EA8    09             C      	add	hl,bc
                         C      
  4EA9    EB             C      	ex	de,hl
                         C      
  4EAA    21 026D        C      	ld	hl,$SRCline$	; Init line
                         C      
  4EAD                   C      l4f08:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-350


  4EAD    06 01          C      	ld	b,HIGH CtrlArr	; Set control page
                         C      
  4EAF    CD 500F        C      	call	l506a
                         C      
  4EB2    18 03          C      	jr	l4f12
                         C      
  4EB4                   C      l4f0f:
                         C      
  4EB4    CD 500B        C      	call	l5066
                         C      
  4EB7                   C      l4f12:
                         C      
  4EB7    FE 9B          C      	cp	9bh
                         C      
  4EB9    38 3C          C      	jr	c,l4f52
                         C      
  4EBB    FE 9D          C      	cp	9dh
                         C      
  4EBD    28 1C          C      	jr	z,l4f36
                         C      
  4EBF    FE 9F          C      	cp	9fh
                         C      
  4EC1    28 94          C      	jr	z,l4eb2
                         C      
  4EC3    FE 9E          C      	cp	9eh
                         C      
  4EC5    CA 4DFA        C      	jp	z,l4e55
                         C      
  4EC8    FE A1          C      	cp	0a1h
                         C      
  4ECA    20 07          C      	jr	nz,l4f2e
                         C      
  4ECC    23             C      	inc	hl
                         C      
  4ECD                   C      l4f28:
                         C      
  4ECD    7E             C      	ld	a,(hl)
                         C      
  4ECE    1B             C      	dec	de
                         C      
  4ECF    12             C      	ld	(de),a
                         C      
  4ED0    23             C      	inc	hl
                         C      
  4ED1    18 DA          C      	jr	l4f08
                         C      
  4ED3                   C      l4f2e:
                         C      
  4ED3    0E 11          C      	ld	c,17
                         C      
  4ED5    CD 08F5        C      	call	.ERROR
                         C      
  4ED8    C3 4F40        C      	jp	l4f9b
                         C      
  4EDB                   C      l4f36:
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-351


  4EDB    C3 4F6C        C      	jp	l4fc7
                         C      
  4EDE                   C      l4f39:
                         C      
  4EDE    1A             C      	ld	a,(de)
                         C      
  4EDF    FE 26          C      	cp	'&'
                         C      
  4EE1    20 07          C      	jr	nz,l4f45
                         C      
  4EE3    13             C      	inc	de
                         C      
  4EE4    1A             C      	ld	a,(de)
                         C      
  4EE5    FE 5E          C      	cp	5eh
                         C      
  4EE7    20 01          C      	jr	nz,l4f45
                         C      
  4EE9    1B             C      	dec	de
                         C      
  4EEA                   C      l4f45:
                         C      
  4EEA    3E A0          C      	ld	a,0a0h
                         C      
  4EEC    90             C      	sub	b
                         C      
  4EED    1B             C      	dec	de
                         C      
  4EEE    12             C      	ld	(de),a
                         C      
  4EEF    7E             C      	ld	a,(hl)
                         C      
  4EF0    FE 26          C      	cp	'&'
                         C      
  4EF2    20 B9          C      	jr	nz,l4f08
                         C      
  4EF4    23             C      	inc	hl
                         C      
  4EF5    18 B6          C      	jr	l4f08
                         C      
  4EF7                   C      l4f52:
                         C      
  4EF7    DD 21 6628     C      	ld	ix,l669b	; Point to macro keys
                         C      
  4EFB    CD 4FAA        C      	call	l5005
                         C      
  4EFE    28 45          C      	jr	z,l4fa0		; .. ENDM
                         C      
  4F00    CD 4FAA        C      	call	l5005
                         C      
  4F03    28 2E          C      	jr	z,l4f8e		; .. MACRO
                         C      
  4F05    CD 4FAA        C      	call	l5005
                         C      
  4F08    28 3B          C      	jr	z,l4fa0		; .. MEND
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-352


  4F0A    CD 4FAA        C      	call	l5005
                         C      
  4F0D    28 24          C      	jr	z,l4f8e		; .. REPT
                         C      
  4F0F    CD 4FAA        C      	call	l5005
                         C      
  4F12    28 1F          C      	jr	z,l4f8e		; .. IRP
                         C      
  4F14    CD 4FAA        C      	call	l5005
                         C      
  4F17    28 1A          C      	jr	z,l4f8e		; .. IRPC
                         C      
  4F19    06 20          C      	ld	b,' '
                         C      
  4F1B                   C      l4f76:
                         C      
  4F1B    C5             C      	push	bc
                         C      
  4F1C    CD 4FA6        C      	call	l5001
                         C      
  4F1F    C1             C      	pop	bc
                         C      
  4F20    28 BC          C      	jr	z,l4f39
                         C      
  4F22    38 02          C      	jr	c,l4f81
                         C      
  4F24    10 F5          C      	djnz	l4f76
                         C      
  4F26                   C      l4f81:
                         C      
  4F26    7E             C      	ld	a,(hl)
                         C      
  4F27    FE 25          C      	cp	'%'
                         C      
  4F29    28 A2          C      	jr	z,l4f28
                         C      
  4F2B                   C      l4f86:
                         C      
  4F2B    06 01          C      	ld	b,HIGH CtrlArr	; Set control page
                         C      
  4F2D    CD 5021        C      	call	l507c
                         C      
  4F30    C3 4EAD        C      	jp	l4f08
                         C      
  4F33                   C      l4f8e:
                         C      
  4F33    E5             C      	push	hl
                         C      
  4F34    2A 67CB        C      	ld	hl,(l683e)
                         C      
  4F37    23             C      	inc	hl
                         C      
  4F38    22 67CB        C      	ld	(l683e),hl
                         C      
  4F3B    E1             C      	pop	hl
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-353


  4F3C                   C      l4f97:
                         C      
  4F3C    60             C      	ld	h,b
                         C      
  4F3D    69             C      	ld	l,c
                         C      
  4F3E    18 EB          C      	jr	l4f86
                         C      
  4F40                   C      l4f9b:
                         C      
  4F40    21 0000        C      	ld	hl,0
                         C      
  4F43    18 04          C      	jr	l4fa4
                         C      
  4F45                   C      l4fa0:
                         C      
  4F45    2A 67CB        C      	ld	hl,(l683e)
                         C      
  4F48    2B             C      	dec	hl
                         C      
  4F49                   C      l4fa4:
                         C      
  4F49    22 67CB        C      	ld	(l683e),hl
                         C      
  4F4C    7C             C      	ld	a,h
                         C      
  4F4D    B5             C      	or	l
                         C      
  4F4E    20 EC          C      	jr	nz,l4f97
                         C      
  4F50    21 62F1        C      	ld	hl,l6364
                         C      
  4F53    22 62F5        C      	ld	(TokPtr),hl	; Init token pointer
                         C      
  4F56    CD 4F9A        C      	call	l4ff5
                         C      
  4F59    FE 0A          C      	cp	lf
                         C      
  4F5B    28 08          C      	jr	z,l4fc0
                         C      
  4F5D    1B             C      	dec	de
                         C      
  4F5E    3E 0D          C      	ld	a,cr
                         C      
  4F60    12             C      	ld	(de),a
                         C      
  4F61    1B             C      	dec	de
                         C      
  4F62    3E 0A          C      	ld	a,lf
                         C      
  4F64    12             C      	ld	(de),a
                         C      
  4F65                   C      l4fc0:
                         C      
  4F65    1B             C      	dec	de
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-354


  4F66    3E 1A          C      	ld	a,eof
                         C      
  4F68    12             C      	ld	(de),a
                         C      
  4F69    37             C      	scf
                         C      
  4F6A    18 1C          C      	jr	l4fe3
                         C      
  4F6C                   C      l4fc7:
                         C      
  4F6C    79             C      	ld	a,c
                         C      
  4F6D    FE 0A          C      	cp	lf
                         C      
  4F6F    28 14          C      	jr	z,l4fe0
                         C      
  4F71    23             C      	inc	hl
                         C      
  4F72    7E             C      	ld	a,(hl)
                         C      
  4F73    2B             C      	dec	hl
                         C      
  4F74    FE 3B          C      	cp	';'
                         C      
  4F76    20 17          C      	jr	nz,l4fea
                         C      
  4F78    CD 4F9A        C      	call	l4ff5
                         C      
  4F7B    FE 0A          C      	cp	lf
                         C      
  4F7D    28 09          C      	jr	z,l4fe3
                         C      
  4F7F    3E 0D          C      	ld	a,cr
                         C      
  4F81    1B             C      	dec	de
                         C      
  4F82    12             C      	ld	(de),a
                         C      
  4F83    3E 0A          C      	ld	a,lf
                         C      
  4F85                   C      l4fe0:
                         C      
  4F85    1B             C      	dec	de
                         C      
  4F86    12             C      	ld	(de),a
                         C      
  4F87    B7             C      	or	a
                         C      
  4F88                   C      l4fe3:
                         C      
  4F88    ED 53 631D     C      	ld	(SymPtr),de	; Save pointer
                         C      
  4F8A                   C      l4fe5	equ	$-2
                         C      
  4F8C    DD E1          C      	pop	ix
                         C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-355


  4F8E    C9             C      	ret
                         C      
                         C      
                         C      
                                
                         C      	include	slr180.005
                         C      ;
                         C      ;
                         C      ;
  4F8F                   C      l4fea:
  4F8F    79             C      	ld	a,c
  4F90                   C      l4feb:
  4F90    1B             C      	dec	de
  4F91    12             C      	ld	(de),a
  4F92    23             C      	inc	hl
  4F93    7E             C      	ld	a,(hl)
  4F94    FE 0A          C      	cp	lf
  4F96    20 F8          C      	jr	nz,l4feb
  4F98    18 EB          C      	jr	l4fe0
  4F9A                   C      l4ff5:
  4F9A    1A             C      	ld	a,(de)
  4F9B    13             C      	inc	de
  4F9C    FE 20          C      	cp	' '
  4F9E    28 FA          C      	jr	z,l4ff5
  4FA0    FE 09          C      	cp	tab
  4FA2    28 F6          C      	jr	z,l4ff5
  4FA4    1B             C      	dec	de
  4FA5    C9             C      	ret
  4FA6                   C      l5001:
  4FA6    3E 18          C      	ld	a,18h
  4FA8    18 02          C      	jr	l5007
  4FAA                   C      l5005:
  4FAA    3E 38          C      	ld	a,38h
  4FAC                   C      l5007:
  4FAC    32 4FC9        C      	ld	(l5024),a
  4FAF    E5             C      	push	hl
  4FB0    D5             C      	push	de
  4FB1    DD 5E 00       C      	ld	e,(ix+0)
  4FB4    DD 56 01       C      	ld	d,(ix+1)
  4FB7    7B             C      	ld	a,e
  4FB8    B2             C      	or	d
  4FB9    28 2F          C      	jr	z,l5045
  4FBB    1B             C      	dec	de
  4FBC    2B             C      	dec	hl
  4FBD    DD 23          C      	inc	ix
  4FBF    DD 23          C      	inc	ix
  4FC1    06 02          C      	ld	b,2
  4FC3                   C      l501e:
  4FC3    13             C      	inc	de
  4FC4    23             C      	inc	hl
  4FC5    4E             C      	ld	c,(hl)
  4FC6    0A             C      	ld	a,(bc)
  4FC7    FE 80          C      	cp	80h
  4FC9                   C      l5024:
  4FC9    38 06          C      	jr	c,l502c
  4FCB    FE 9A          C      	cp	9ah
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-356


  4FCD    30 02          C      	jr	nc,l502c
  4FCF    D6 1A          C      	sub	1ah
  4FD1                   C      l502c:
  4FD1    EB             C      	ex	de,hl
  4FD2    BE             C      	cp	(hl)
  4FD3    EB             C      	ex	de,hl
  4FD4    28 ED          C      	jr	z,l501e
  4FD6    FE 57          C      	cp	'W'
  4FD8    38 04          C      	jr	c,l5039
  4FDA    FE 9B          C      	cp	9bh
  4FDC    38 07          C      	jr	c,l5040
  4FDE                   C      l5039:
  4FDE    1A             C      	ld	a,(de)
  4FDF    B7             C      	or	a
  4FE0    20 03          C      	jr	nz,l5040
  4FE2    D1             C      	pop	de
  4FE3    C1             C      	pop	bc
  4FE4    C9             C      	ret
  4FE5                   C      l5040:
  4FE5    AF             C      	xor	a
  4FE6    3D             C      	dec	a
  4FE7    D1             C      	pop	de
  4FE8    E1             C      	pop	hl
  4FE9    C9             C      	ret
  4FEA                   C      l5045:
  4FEA    D6 01          C      	sub	1
  4FEC    D1             C      	pop	de
  4FED    E1             C      	pop	hl
  4FEE    C9             C      	ret
  4FEF                   C      l504a:
  4FEF    DD 21 6634     C      	ld	ix,l66a7
  4FF3    06 20          C      	ld	b,' '
  4FF5                   C      l5050:
  4FF5    C5             C      	push	bc
  4FF6    CD 4FA6        C      	call	l5001
  4FF9    28 07          C      	jr	z,l505d
  4FFB    C1             C      	pop	bc
  4FFC    38 03          C      	jr	c,l505c
  4FFE    10 F5          C      	djnz	l5050
  5000    37             C      	scf
  5001                   C      l505c:
  5001    C9             C      	ret
  5002                   C      l505d:
  5002    7C             C      	ld	a,h
  5003    60             C      	ld	h,b
  5004    47             C      	ld	b,a
  5005    7D             C      	ld	a,l
  5006    69             C      	ld	l,c
  5007    4F             C      	ld	c,a
  5008    F1             C      	pop	af
  5009    BF             C      	cp	a
  500A    C9             C      	ret
  500B                   C      l5066:
  500B    79             C      	ld	a,c
  500C    1B             C      	dec	de
  500D    12             C      	ld	(de),a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-357


  500E    23             C      	inc	hl
  500F                   C      l506a:
  500F    4E             C      	ld	c,(hl)		; Get index
  5010    0A             C      	ld	a,(bc)		; .. get control
  5011    FE 57          C      	cp	57h
  5013    38 F6          C      	jr	c,l5066
  5015    FE 9B          C      	cp	9bh
  5017    D8             C      	ret	c
  5018    FE 9D          C      	cp	9dh
  501A    D0             C      	ret	nc
  501B    18 EE          C      	jr	l5066
  501D                   C      l5078:
  501D    79             C      	ld	a,c
  501E    1B             C      	dec	de
  501F    12             C      	ld	(de),a
  5020    23             C      	inc	hl
  5021                   C      l507c:
  5021    4E             C      	ld	c,(hl)		; Get index
  5022    0A             C      	ld	a,(bc)		; .. get control
  5023    FE 57          C      	cp	57h
  5025    D8             C      	ret	c
  5026    FE 9B          C      	cp	9bh
  5028    38 F3          C      	jr	c,l5078
  502A    C9             C      	ret
  502B                   C      l5086:
  502B    00 00 00       C      	db	0,0,0
  502E                   C      l5089:
  502E    CD 5598        C      	call	l55f3
  5031    CD 6325        C      	call	Ini$FO		; Init file mode
  5034    21 6406        C      	ld	hl,l6479
  5037    22 6847        C      	ld	(l68ba),hl
  503A                   C      l5095:
  503A    CD 510C        C      	call	l5167
  503D    B7             C      	or	a
  503E    F2 50EB        C      	jp	p,l5146
  5041    E6 7F          C      	and	7fh
  5043    D6 10          C      	sub	10h
  5045    38 2E          C      	jr	c,l50d0
  5047    D6 10          C      	sub	10h
  5049    38 32          C      	jr	c,l50d8
  504B    D6 10          C      	sub	10h
  504D    38 42          C      	jr	c,l50ec
  504F    D6 10          C      	sub	10h
  5051    38 75          C      	jr	c,l5123
  5053    D6 20          C      	sub	' '
  5055    38 16          C      	jr	c,IllConst	; .. error
  5057    FE 0B          C      	cp	0bh
  5059    30 0D          C      	jr	nc,l50c3
  505B    87             C      	add	a,a
  505C    4F             C      	ld	c,a
  505D    06 00          C      	ld	b,0
  505F    21 5127        C      	ld	hl,l5182
  5062    09             C      	add	hl,bc
  5063    5E             C      	ld	e,(hl)
  5064    23             C      	inc	hl
  5065    56             C      	ld	d,(hl)
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-358


  5066    EB             C      	ex	de,hl
  5067    E9             C      	jp	(hl)
  5068                   C      l50c3:
  5068    FE 1E          C      	cp	1eh
  506A    CA 51E3        C      	jp	z,l523e
                         C      ;
                         C      ; Invalid construct
                         C      ;
  506D                   C      IllConst:
  506D    0E 0A          C      	ld	c,10
  506F    CD 08F5        C      	call	.ERROR		; Give error
  5072    C3 0B87        C      	jp	EndOfASM	; Restart
  5075                   C      l50d0:
  5075    CD 52DE        C      	call	l5339
  5078    CD 51BF        C      	call	l521a
  507B    18 BD          C      	jr	l5095
  507D                   C      l50d8:
  507D    CD 52DE        C      	call	l5339
  5080    EB             C      	ex	de,hl
  5081    2A 6847        C      	ld	hl,(l68ba)
  5084    F6 90          C      	or	90h
  5086    77             C      	ld	(hl),a
  5087    23             C      	inc	hl
  5088    73             C      	ld	(hl),e
  5089    23             C      	inc	hl
  508A    72             C      	ld	(hl),d
  508B    23             C      	inc	hl
  508C    22 6847        C      	ld	(l68ba),hl
  508F    18 A9          C      	jr	l5095
  5091                   C      l50ec:
  5091    F5             C      	push	af
  5092    CD 3FE6        C      	call	l4041
  5095    CD 509F        C      	call	l50fa
  5098    F1             C      	pop	af
  5099    CD 52DE        C      	call	l5339
  509C    C3 6331        C      	jp	l63a4
  509F                   C      l50fa:
  509F    3A 679E        C      	ld	a,(l6811)
  50A2    B7             C      	or	a
  50A3    28 18          C      	jr	z,l5118
  50A5    FD E5          C      	push	iy
  50A7    E1             C      	pop	hl
  50A8    ED 5B 6613     C      	ld	de,(l6686)
  50AC    ED 52          C      	sbc	hl,de
  50AE    ED 5B 6610     C      	ld	de,(l6683)
  50B2    19             C      	add	hl,de
  50B3    22 67C5        C      	ld	(l6838),hl
  50B6    3A 660F        C      	ld	a,(l6682)
  50B9    32 67C7        C      	ld	(l683a),a
  50BC    C9             C      	ret
  50BD                   C      l5118:
  50BD    3A 67F1        C      	ld	a,($REL$)	; Get mode
  50C0    32 67C7        C      	ld	(l683a),a
  50C3    FD 22 67C5     C      	ld	(l6838),iy
  50C7    C9             C      	ret
  50C8                   C      l5123:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-359


  50C8    C6 C0          C      	add	a,0c0h
  50CA    FE BF          C      	cp	0bfh
  50CC    20 05          C      	jr	nz,l512e
  50CE    CD 510C        C      	call	l5167
  50D1    C6 BF          C      	add	a,0bfh
  50D3                   C      l512e:
  50D3    DD 22 50E9     C      	ld	(l5144),ix
  50D7    DD 2A 6847     C      	ld	ix,(l68ba)
  50DB    CD 37A5        C      	call	l3800
  50DE    DD 22 6847     C      	ld	(l68ba),ix
  50E2    DD 2A 50E9     C      	ld	ix,(l5144)
  50E6    C3 503A        C      	jp	l5095
  50E9                   C      l5144:
  50E9    0000           C      	dw	0
  50EB                   C      l5146:
  50EB    47             C      	ld	b,a
  50EC    04             C      	inc	b
  50ED    C3 633A        C      	jp	l63ad
                         C      ;
                         C      ;
                         C      ;
  50F0                   C      l514b:
  50F0    FD 23          C      	inc	iy
  50F2    D9             C      	exx
  50F3    ED A0          C      	ldi
  50F5    03             C      	inc	bc
  50F6    0D             C      	dec	c
  50F7    28 09          C      	jr	z,l515d
  50F9                   C      l5154:
  50F9    05             C      	dec	b
  50FA    28 0B          C      	jr	z,l5162
  50FC                   C      l5157:
  50FC    D9             C      	exx
  50FD    10 F1          C      	djnz	l514b
  50FF    C3 503A        C      	jp	l5095
  5102                   C      l515d:
  5102    CD 538E        C      	call	l53e9
  5105    18 F2          C      	jr	l5154
  5107                   C      l5162:
  5107    CD 632E        C      	call	l63a1
  510A    18 F0          C      	jr	l5157
  510C                   C      l5167:
  510C    D9             C      	exx
  510D    7E             C      	ld	a,(hl)
  510E    23             C      	inc	hl
  510F    0D             C      	dec	c
  5110    D9             C      	exx
  5111    C0             C      	ret	nz
  5112    D9             C      	exx
  5113    CD 538E        C      	call	l53e9
  5116    D9             C      	exx
  5117    C9             C      	ret
                         C      ;
                         C      ; Put constant byte to ABS and HEX file
                         C      ;
  5118                   C      Con$ABS:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-360


  5118    CD 634C        C      	call	l63bf
                         C      ;
                         C      ;
                         C      ;
  511B                   C      ABS.Const:
  511B    D9             C      	exx
  511C    12             C      	ld	(de),a		; Save byte
  511D    13             C      	inc	de
  511E    05             C      	dec	b		; .. count down
  511F    D9             C      	exx
  5120    C0             C      	ret	nz
  5121    D9             C      	exx
  5122    CD 632E        C      	call	l63a1		; .. write to file
  5125    D9             C      	exx
  5126    C9             C      	ret
  5127                   C      l5182:
  5127    98             C      	sbc	a,b
  5128    51             C      	ld	d,c
  5129    AC             C      	xor	h
  512A    51             C      	ld	d,c
  512B    E5             C      	push	hl
  512C    51             C      	ld	d,c
  512D    F4 0D37        C      	call	p,l0d51
  5130    52             C      	ld	d,d
  5131    C8             C      	ret	z
  5132    50             C      	ld	d,b
  5133    B6             C      	or	(hl)
  5134    51             C      	ld	d,c
  5135    B1             C      	or	c
  5136    51             C      	ld	d,c
  5137    12             C      	ld	(de),a
  5138    52             C      	ld	d,d
  5139    EA EF51        C      	jp	pe,lef51
  513C    51             C      	ld	d,c
  513D    11 6349        C      	ld	de,l63bc
  5140                   C      l519b:
  5140    21 503A        C      	ld	hl,l5095
  5143    E5             C      	push	hl
  5144    2A 6847        C      	ld	hl,(l68ba)
  5147    36 FF          C      	ld	(hl),0ffh
  5149    21 6406        C      	ld	hl,l6479
  514C    22 6847        C      	ld	(l68ba),hl
  514F    EB             C      	ex	de,hl
  5150    E9             C      	jp	(hl)
  5151                   C      l51ac:
  5151    11 3B96        C      	ld	de,l3bf1
  5154    18 EA          C      	jr	l519b
  5156                   C      l51b1:
  5156    11 5160        C      	ld	de,l51bb
  5159    18 E5          C      	jr	l519b
  515B                   C      l51b6:
  515B    11 5164        C      	ld	de,l51bf
  515E    18 E0          C      	jr	l519b
  5160                   C      l51bb:
  5160    0E FF          C      	ld	c,0ffh
  5162    18 02          C      	jr	l51c1
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-361


  5164                   C      l51bf:
  5164    0E 00          C      	ld	c,0
  5166                   C      l51c1:
  5166    CD 510C        C      	call	l5167
  5169    6F             C      	ld	l,a
  516A    CD 510C        C      	call	l5167
  516D    67             C      	ld	h,a
  516E    22 67D8        C      	ld	(l684b),hl
  5171    0C             C      	inc	c
  5172    20 07          C      	jr	nz,l51d6
  5174    CD 4302        C      	call	l435d
  5177    7E             C      	ld	a,(hl)
  5178    E6 70          C      	and	70h
  517A    77             C      	ld	(hl),a
  517B                   C      l51d6:
  517B    CD 3C44        C      	call	l3c9f
  517E    C4 54FC        C      	call	nz,l5557
  5181    22 67DB        C      	ld	(l684e),hl
  5184    32 67DA        C      	ld	(l684d),a
  5187    C3 07FD        C      	jp	l0817
  518A    11 3B83        C      	ld	de,l3bde
  518D    18 B1          C      	jr	l519b
  518F    11 3C11        C      	ld	de,l3c6c
  5192    18 AC          C      	jr	l519b
  5194    11 3BF2        C      	ld	de,l3c4d
  5197    18 A7          C      	jr	l519b
  5199    21 3B96        C      	ld	hl,l3bf1
  519C                   C      l51f7:
  519C    11 503A        C      	ld	de,l5095
  519F    D5             C      	push	de
  51A0    E5             C      	push	hl
  51A1    3E 0F          C      	ld	a,0fh
  51A3    CD 52E0        C      	call	l533b
  51A6    22 6407        C      	ld	(l647a),hl
  51A9    32 6406        C      	ld	(l6479),a
  51AC    3E FF          C      	ld	a,0ffh
  51AE    32 6409        C      	ld	(l647c),a
  51B1    C9             C      	ret
  51B2    21 3B83        C      	ld	hl,l3bde
  51B5    18 E5          C      	jr	l51f7
  51B7    CD 510C        C      	call	l5167
  51BA    11 3BC1        C      	ld	de,l3c1c
  51BD    18 81          C      	jr	l519b
  51BF                   C      l521a:
  51BF    FE 0F          C      	cp	0fh
  51C1    28 15          C      	jr	z,l5233
  51C3    30 0F          C      	jr	nc,l522f
  51C5    CD 634F        C      	call	l63c2
  51C8                   C      l5223:
  51C8    B7             C      	or	a
  51C9    C2 6337        C      	jp	nz,l63aa
  51CC    7D             C      	ld	a,l
  51CD    CD 632B        C      	call	l639e
  51D0    7C             C      	ld	a,h
  51D1    C3 632B        C      	jp	l639e
  51D4                   C      l522f:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-362


  51D4    3D             C      	dec	a
  51D5    C3 6337        C      	jp	l63aa
  51D8                   C      l5233:
  51D8    E5             C      	push	hl
  51D9    21 0000        C      	ld	hl,$-$
  51DA                   C      l5235	equ	$-2
  51DC    CD 634F        C      	call	l63c2
  51DF    E1             C      	pop	hl
  51E0    C3 6337        C      	jp	l63aa
  51E3                   C      l523e:
  51E3    CD 3FE6        C      	call	l4041
  51E6    3E 01          C      	ld	a,1
  51E8    CD 604A        C      	call	SelFile		; Get file
  51EB    C3 6334        C      	jp	l63a7
                         C      ;
                         C      ;
                         C      ;
  51EE                   C      l5249:
  51EE    D9             C      	exx
  51EF    3A 012B        C      	ld	a,($HEXOUT$)	; Get count
  51F2    B8             C      	cp	b		; Test end reached
  51F3    C4 53EC        C      	call	nz,l5447	; .. nope, so ???
  51F6    D9             C      	exx
  51F7    CD 53D7        C      	call	l5432
  51FA    C3 52D6        C      	jp	l5331
  51FD                   C      l5258:
  51FD    CD 5ADA        C      	call	l5b35
  5200                   C      l525b:
  5200    CD 5AF0        C      	call	l5b4b
  5203    28 6D          C      	jr	z,l52cd
  5205    FE F0          C      	cp	0f0h
  5207    20 09          C      	jr	nz,l526d
  5209    23             C      	inc	hl
  520A    5E             C      	ld	e,(hl)
  520B    23             C      	inc	hl
  520C    56             C      	ld	d,(hl)
  520D    EB             C      	ex	de,hl
  520E    7E             C      	ld	a,(hl)
  520F    B7             C      	or	a
  5210    28 EE          C      	jr	z,l525b
  5212                   C      l526d:
  5212    E6 0F          C      	and	0fh
  5214    FE 0F          C      	cp	0fh
  5216    20 31          C      	jr	nz,l52a4
  5218    AF             C      	xor	a
  5219    ED 6F          C      	rld
  521B    20 13          C      	jr	nz,l528b
  521D    23             C      	inc	hl
  521E    7E             C      	ld	a,(hl)
  521F    23             C      	inc	hl
  5220    B6             C      	or	(hl)
  5221    2B             C      	dec	hl
  5222    2B             C      	dec	hl
  5223    20 0A          C      	jr	nz,l528a
  5225    3A 0132        C      	ld	a,($EMP.CHN$)	; Test empty chain
  5228    B7             C      	or	a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-363


  5229    20 04          C      	jr	nz,l528a	; .. yeap
  522B    36 0F          C      	ld	(hl),0fh
  522D    18 D1          C      	jr	l525b
  522F                   C      l528a:
  522F    AF             C      	xor	a
  5230                   C      l528b:
  5230    77             C      	ld	(hl),a
  5231    FE 03          C      	cp	3
  5233    D4 5768        C      	call	nc,l57c3
  5236    3E 8C          C      	ld	a,10001100b
  5238    06 07          C      	ld	b,7
  523A    CD 57AE        C      	call	REL.bits	; Give CHAIN EXTERNAL
  523D    CD 5872        C      	call	AField		; Output address
  5240    CD 5824        C      	call	BField		; .. and symbol
  5243    3E 0F          C      	ld	a,0fh
  5245    ED 6F          C      	rld
  5247    18 B7          C      	jr	l525b
  5249                   C      l52a4:
  5249    7E             C      	ld	a,(hl)
  524A    B7             C      	or	a
  524B    FA 5258        C      	jp	m,l52b3
  524E    CD 5513        C      	call	l556e
  5251    3E 01          C      	ld	a,1
  5253    CD 604A        C      	call	SelFile		; Get file
  5256    18 A8          C      	jr	l525b
  5258                   C      l52b3:
  5258    CB 6F          C      	bit	5,a
  525A    28 A4          C      	jr	z,l525b
  525C    E6 0F          C      	and	0fh
  525E    FE 03          C      	cp	3
  5260    D4 5768        C      	call	nc,l57c3
  5263    3E 8E          C      	ld	a,10001110b
  5265    06 07          C      	ld	b,7
  5267    CD 57AE        C      	call	REL.bits	; Give DEFINE ENTRY
  526A    CD 5872        C      	call	AField		; Output address
  526D    CD 5824        C      	call	BField		; .. and symbol
  5270    18 8E          C      	jr	l525b
  5272                   C      l52cd:
  5272    2A 680E        C      	ld	hl,(l6881)
  5275                   C      l52d0:
  5275    7C             C      	ld	a,h
  5276    B5             C      	or	l
  5277    28 23          C      	jr	z,l52f7
  5279    23             C      	inc	hl
  527A    3E 86          C      	ld	a,10000110b
  527C    06 07          C      	ld	b,7
  527E    CD 57AE        C      	call	REL.bits	; Give REQUEST LIBRARY
  5281    3E E0          C      	ld	a,11100000b
  5283    06 03          C      	ld	b,3
  5285    CD 57AE        C      	call	REL.bits	; .. max length
  5288    06 07          C      	ld	b,7
  528A                   C      l52e5:
  528A    C5             C      	push	bc
  528B    7E             C      	ld	a,(hl)
  528C    23             C      	inc	hl
  528D    06 08          C      	ld	b,8
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-364


  528F    CD 57AE        C      	call	REL.bits	; Output library name
  5292    C1             C      	pop	bc
  5293    10 F5          C      	djnz	l52e5
  5295    23             C      	inc	hl
  5296    5E             C      	ld	e,(hl)
  5297    23             C      	inc	hl
  5298    56             C      	ld	d,(hl)
  5299    EB             C      	ex	de,hl
  529A    18 D9          C      	jr	l52d0
  529C                   C      l52f7:
  529C    3E 9C          C      	ld	a,10011100b
  529E    06 07          C      	ld	b,7
  52A0    CD 57AE        C      	call	REL.bits	; Give END OF MODULE
  52A3    3A 67BF        C      	ld	a,(l6832)	; Get mode
  52A6    2A 67C0        C      	ld	hl,(XFER)	; .. and transfer address
  52A9    CD 58A4        C      	call	REL.adr		; .. put to file
  52AC    CD 57A6        C      	call	Bit.Boundary	; Set bit boundary
  52AF    3E 9E          C      	ld	a,10011110b
  52B1    06 08          C      	ld	b,8
  52B3    CD 57AE        C      	call	REL.bits	; Give END OF FILE
  52B6    D9             C      	exx
  52B7    7B             C      	ld	a,e
  52B8    DD E5          C      	push	ix
  52BA    D1             C      	pop	de
  52BB    D9             C      	exx
  52BC                   C      l5317:
  52BC    B7             C      	or	a
  52BD    28 17          C      	jr	z,l5331
  52BF    2A 69EC        C      	ld	hl,(l6a5f)	; Get count
  52C2    5F             C      	ld	e,a
  52C3    16 FF          C      	ld	d,-1
  52C5    19             C      	add	hl,de		; .. bump down
  52C6    7D             C      	ld	a,l
  52C7    E6 80          C      	and	RecLng		; .. for record boundary
  52C9    6F             C      	ld	l,a
  52CA    22 69EC        C      	ld	(l6a5f),hl	; .. save
  52CD    7B             C      	ld	a,e
  52CE    D9             C      	exx
  52CF    47             C      	ld	b,a
  52D0    AF             C      	xor	a
  52D1                   C      l532c:
  52D1    12             C      	ld	(de),a
  52D2    13             C      	inc	de
  52D3    10 FC          C      	djnz	l532c
  52D5    D9             C      	exx
  52D6                   C      l5331:
  52D6    C3 5EBA        C      	jp	l5f15
  52D9                   C      l5334:
  52D9    D9             C      	exx
  52DA    78             C      	ld	a,b
  52DB    D9             C      	exx
  52DC    18 DE          C      	jr	l5317
  52DE                   C      l5339:
  52DE    C6 10          C      	add	a,16
  52E0                   C      l533b:
  52E0    47             C      	ld	b,a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-365


  52E1    CD 510C        C      	call	l5167
  52E4    6F             C      	ld	l,a
  52E5    CD 510C        C      	call	l5167
  52E8    67             C      	ld	h,a
  52E9    78             C      	ld	a,b
  52EA    FE 0F          C      	cp	0fh
  52EC    D8             C      	ret	c
  52ED    CD 4302        C      	call	l435d
  52F0                   C      l534b:
  52F0    E6 0F          C      	and	0fh
  52F2    FE 0F          C      	cp	0fh
  52F4    C8             C      	ret	z
  52F5    CB 7E          C      	bit	7,(hl)
  52F7    C3 54EE        C      	jp	l5549
  52FA    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  52FB                   C      l5356:
  52FB    ED 5B 67C5     C      	ld	de,(l6838)
  52FF    B7             C      	or	a
  5300    ED 52          C      	sbc	hl,de
  5302    28 1A          C      	jr	z,l5379
  5304    D9             C      	exx
  5305    CD 53EC        C      	call	l5447
  5308    D9             C      	exx
  5309    EB             C      	ex	de,hl
  530A    19             C      	add	hl,de
  530B    7C             C      	ld	a,h
  530C    65             C      	ld	h,l
  530D    6F             C      	ld	l,a
  530E    22 69AD        C      	ld	(l6a20),hl
  5311    CD 535C        C      	call	l53b7
  5314    18 08          C      	jr	l5379
  5316                   C      l5371:
  5316    CD 532E        C      	call	l5389
  5319    0E 0B          C      	ld	c,0bh
  531B    CD 5756        C      	call	l57b1
  531E                   C      l5379:
  531E    C3 503A        C      	jp	l5095
  5321                   C      l537c:
  5321    CD 532E        C      	call	l5389
  5324    F6 A0          C      	or	0a0h
  5326    CD 6322        C      	call	l6395
  5329    CD 3965        C      	call	l39c0
  532C    18 F0          C      	jr	l5379
  532E                   C      l5389:
  532E    47             C      	ld	b,a
  532F    3A 679E        C      	ld	a,(l6811)
  5332    B7             C      	or	a
  5333    20 14          C      	jr	nz,l53a4
  5335    3A 67C7        C      	ld	a,(l683a)
  5338    B8             C      	cp	b
  5339    28 0E          C      	jr	z,l53a4
  533B    E5             C      	push	hl
  533C    C5             C      	push	bc
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-366


  533D    CD 3FE6        C      	call	l4041
  5340    F1             C      	pop	af
  5341    E1             C      	pop	hl
  5342    32 67F1        C      	ld	($REL$),a	; Set mode
  5345    E5             C      	push	hl
  5346    FD E1          C      	pop	iy
  5348    C9             C      	ret
  5349                   C      l53a4:
  5349    ED 5B 67C5     C      	ld	de,(l6838)
  534D    B7             C      	or	a
  534E    ED 52          C      	sbc	hl,de
  5350    20 03          C      	jr	nz,l53b0
  5352    E1             C      	pop	hl
  5353    18 C9          C      	jr	l5379
  5355                   C      l53b0:
  5355    EB             C      	ex	de,hl
  5356    19             C      	add	hl,de
  5357    CD 535C        C      	call	l53b7
  535A    78             C      	ld	a,b
  535B    C9             C      	ret
  535C                   C      l53b7:
  535C    3A 6617        C      	ld	a,(Pass)
  535F    FE 03          C      	cp	3		; Test special pass
  5361    C0             C      	ret	nz		; .. nope
  5362    FD 19          C      	add	iy,de
  5364    C9             C      	ret
  5365                   C      l53c0:
  5365    ED 5B 67C5     C      	ld	de,(l6838)
  5369    B7             C      	or	a
  536A    ED 52          C      	sbc	hl,de
  536C    30 07          C      	jr	nc,l53d0
  536E    0E 07          C      	ld	c,7
  5370    CD 08F5        C      	call	.ERROR
  5373    18 A9          C      	jr	l5379
  5375                   C      l53d0:
  5375    28 A7          C      	jr	z,l5379
  5377    EB             C      	ex	de,hl
  5378    CD 535C        C      	call	l53b7
  537B    43             C      	ld	b,e
  537C    78             C      	ld	a,b
  537D    B7             C      	or	a
  537E    28 01          C      	jr	z,l53dc
  5380    14             C      	inc	d
  5381                   C      l53dc:
  5381    3A 0131        C      	ld	a,($FILL.0$)	; Get fill flag
  5384    CD 632B        C      	call	l639e
  5387    10 F8          C      	djnz	l53dc
  5389    15             C      	dec	d
  538A    20 F5          C      	jr	nz,l53dc
  538C    18 90          C      	jr	l5379
  538E                   C      l53e9:
  538E    F5             C      	push	af
  538F    3A 67CE        C      	ld	a,(l6841)
  5392    B7             C      	or	a
  5393    20 02          C      	jr	nz,l53f2
  5395                   C      l53f0:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-367


  5395    F1             C      	pop	af
  5396    C9             C      	ret
  5397                   C      l53f2:
  5397    3A 6800        C      	ld	a,(_rPage_+1)	; Count down pages
  539A    3D             C      	dec	a
  539B    32 6800        C      	ld	(_rPage_+1),a
  539E    20 F5          C      	jr	nz,l53f0	; .. still more
  53A0    D5             C      	push	de
  53A1    C5             C      	push	bc
  53A2    21 688B        C      	ld	hl,$$FCB$$	; Get temp FCB ????
  53A5    ED 5B 67CF     C      	ld	de,(l6842)
  53A9    CD 159A        C      	call	Rd$File		; Read from file
  53AC    C1             C      	pop	bc
  53AD    D1             C      	pop	de
  53AE    2A 67CF        C      	ld	hl,(l6842)
  53B1    20 E2          C      	jr	nz,l53f0
  53B3    D5             C      	push	de
  53B4    C5             C      	push	bc
  53B5    11 688B        C      	ld	de,$$FCB$$	; Get FCB
  53B8    D5             C      	push	de
  53B9    0E 10          C      	ld	c,.close
  53BB    CD 5EA9        C      	call	.BDOS		; Close file
  53BE    D1             C      	pop	de
  53BF    D5             C      	push	de
  53C0    0E 13          C      	ld	c,.delete
  53C2    CD 5EA9        C      	call	.BDOS		; .. delete it
  53C5    E1             C      	pop	hl
  53C6    36 FF          C      	ld	(hl),0ffh
  53C8    C1             C      	pop	bc
  53C9    D1             C      	pop	de
  53CA    2A 6624        C      	ld	hl,(l6697)
  53CD    AF             C      	xor	a
  53CE    32 67CE        C      	ld	(l6841),a
  53D1    4F             C      	ld	c,a
  53D2    F1             C      	pop	af
  53D3    C9             C      	ret
  53D4                   C      l542f:
  53D4    C1             C      	pop	bc
  53D5    E1             C      	pop	hl
  53D6    C9             C      	ret
  53D7                   C      l5432:
  53D7    ED 5B 67C0     C      	ld	de,(XFER)	; Get transfer address
  53DB    21 69AD        C      	ld	hl,l6a20
  53DE    72             C      	ld	(hl),d		; .. save
  53DF    23             C      	inc	hl
  53E0    73             C      	ld	(hl),e
  53E1    23             C      	inc	hl
  53E2    36 01          C      	ld	(hl),1
  53E4    23             C      	inc	hl
  53E5    EB             C      	ex	de,hl
  53E6    AF             C      	xor	a
  53E7    E5             C      	push	hl
  53E8    C5             C      	push	bc
  53E9    4F             C      	ld	c,a
  53EA    18 08          C      	jr	l544f
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-368


                         C      ; Write data to HEX file
                         C      ;
  53EC                   C      l5447:
  53EC    E5             C      	push	hl
  53ED    C5             C      	push	bc
  53EE    3A 012B        C      	ld	a,($HEXOUT$)	; Get count
  53F1    90             C      	sub	b		; Test end
  53F2    28 E0          C      	jr	z,l542f		; .. yeap
  53F4                   C      l544f:
  53F4    F5             C      	push	af
  53F5    32 69AC        C      	ld	(l6a1f),a
  53F8    C6 04          C      	add	a,4
  53FA    47             C      	ld	b,a
  53FB    21 69AC        C      	ld	hl,l6a1f
  53FE    AF             C      	xor	a
  53FF                   C      l545a:
  53FF    86             C      	add	a,(hl)
  5400    23             C      	inc	hl
  5401    10 FC          C      	djnz	l545a
  5403    ED 44          C      	neg
  5405    12             C      	ld	(de),a
  5406    3A 69AC        C      	ld	a,(l6a1f)
  5409    C6 05          C      	add	a,5
  540B    87             C      	add	a,a
  540C    11 6A36        C      	ld	de,l6aa9
  540F    2A 69AD        C      	ld	hl,(l6a20)
  5412    E5             C      	push	hl
  5413    F5             C      	push	af
  5414    21 69AC        C      	ld	hl,l6a1f
  5417    CD 33CD        C      	call	BCDtoASC	; Convert to ASCII
  541A    EB             C      	ex	de,hl
  541B    36 0D          C      	ld	(hl),cr
  541D    23             C      	inc	hl
  541E    36 0A          C      	ld	(hl),lf
  5420    23             C      	inc	hl
  5421    F1             C      	pop	af
  5422    FE 0A          C      	cp	lf
  5424    20 03          C      	jr	nz,l5484
  5426    36 1A          C      	ld	(hl),eof
  5428    23             C      	inc	hl
  5429                   C      l5484:
  5429    36 FF          C      	ld	(hl),-1
  542B    3E 01          C      	ld	a,1
  542D    CD 604A        C      	call	SelFile		; Get file
  5430    21 6A35        C      	ld	hl,l6aa8
  5433    36 3A          C      	ld	(hl),':'
  5435    CD 5FC1        C      	call	l601c
  5438    E1             C      	pop	hl
  5439    F1             C      	pop	af
  543A    84             C      	add	a,h
  543B    67             C      	ld	h,a
  543C    7D             C      	ld	a,l
  543D    CE 00          C      	adc	a,0
  543F    6F             C      	ld	l,a
  5440    22 69AD        C      	ld	(l6a20),hl
  5443    11 69B0        C      	ld	de,HEXbuf	; Init buffer
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-369


  5446    C1             C      	pop	bc
  5447    3A 012B        C      	ld	a,($HEXOUT$)	; .. and count
  544A    47             C      	ld	b,a
  544B    E1             C      	pop	hl
  544C    C9             C      	ret
                         C      ;
                         C      ; Write data to ABS or REL file
                         C      ;
  544D                   C      l54a8:
  544D    E5             C      	push	hl
  544E    D5             C      	push	de
  544F    C5             C      	push	bc
  5450    3E 01          C      	ld	a,1
  5452    CD 604A        C      	call	SelFile		; Get file
  5455    21 69ED        C      	ld	hl,l6a5f+1
  5458    35             C      	dec	(hl)
  5459    20 10          C      	jr	nz,l54c6
  545B    CD 5FE1        C      	call	WrToFile	; Write to disk
  545E    C1             C      	pop	bc
  545F    D1             C      	pop	de
  5460    E1             C      	pop	hl
  5461    ED 5B 69F0     C      	ld	de,(FilBuf)	; Get buffer as base
  5465    3E 04          C      	ld	a,4		; Set records
  5467    32 69ED        C      	ld	(l6a5f+1),a
  546A    C9             C      	ret
  546B                   C      l54c6:
  546B    C1             C      	pop	bc
  546C    D1             C      	pop	de
  546D    E1             C      	pop	hl
  546E    C9             C      	ret
  546F                   C      l54ca:
  546F    CD 54BF        C      	call	l551a
  5472    18 09          C      	jr	l54d8
                         C      ;
                         C      ; Put constant byte to SLR file
                         C      ;
  5474                   C      Con$SLR:
  5474    CD 634C        C      	call	l63bf
  5477                   C      SLR.Const:
  5477    D9             C      	exx
  5478    DD 35 00       C      	dec	(ix+0)		; .. count down
  547B    28 F2          C      	jr	z,l54ca		; .. write to file
  547D                   C      l54d8:
  547D    12             C      	ld	(de),a		; Save byte
  547E    13             C      	inc	de
  547F    04             C      	inc	b		; .. bump
  5480    D9             C      	exx
  5481    E0             C      	ret	po		; .. still 00..7F
  5482    D9             C      	exx
  5483    05             C      	dec	b
  5484    E5             C      	push	hl
  5485    2A 67C3        C      	ld	hl,(l6836)
  5488    70             C      	ld	(hl),b
  5489    DD 35 00       C      	dec	(ix+0)
  548C    CC 54BF        C      	call	z,l551a
  548F    E1             C      	pop	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-370


  5490    ED 53 67C3     C      	ld	(l6836),de
  5494    13             C      	inc	de
  5495    06 00          C      	ld	b,0
  5497    D9             C      	exx
  5498    C9             C      	ret
                         C      ;
                         C      ; Store byte ???????????????????????
                         C      ; ENTRY	Accu holds byte
                         C      ;	Reg B'  holds flag
                         C      ;	Reg DE' points to buffer
                         C      ;	Reg IX  points to page count
                         C      ;
  5499                   C      l54f4:
  5499    D9             C      	exx
  549A    04             C      	inc	b
  549B    05             C      	dec	b
  549C    E5             C      	push	hl
  549D    2A 67C3        C      	ld	hl,(l6836)	; Get base address
  54A0    28 0B          C      	jr	z,l5508		; .. flag is zero
  54A2    05             C      	dec	b
  54A3    70             C      	ld	(hl),b		; Store flag
  54A4    06 00          C      	ld	b,0		; .. clear it
  54A6    DD 35 00       C      	dec	(ix+0)		; Count down
  54A9    CC 54BF        C      	call	z,l551a		; .. write page to file
  54AC    EB             C      	ex	de,hl
  54AD                   C      l5508:
  54AD    77             C      	ld	(hl),a		; Store byte
  54AE    23             C      	inc	hl
  54AF    54             C      	ld	d,h		; .. copy buffer
  54B0    5D             C      	ld	e,l
  54B1    DD 35 00       C      	dec	(ix+0)		; Count down 2nd byte
  54B4    CC 54BF        C      	call	z,l551a		; .. write to file
  54B7    ED 53 67C3     C      	ld	(l6836),de	; Save address
  54BB    E1             C      	pop	hl
  54BC    13             C      	inc	de
  54BD    D9             C      	exx
  54BE    C9             C      	ret
                         C      ;
                         C      ; Write ?????????? to file
                         C      ;
  54BF                   C      l551a:
  54BF    DD 35 01       C      	dec	(ix+1)		; Count down number of pages
  54C2    C0             C      	ret	nz		; .. nope
  54C3    F5             C      	push	af
  54C4    E5             C      	push	hl
  54C5    C5             C      	push	bc
  54C6    3E 01          C      	ld	a,1
  54C8    CD 604A        C      	call	SelFile		; Get file
  54CB    CD 5FE1        C      	call	WrToFile	; Write to disk
  54CE    ED 5B 69F0     C      	ld	de,(FilBuf)	; Get buffer
  54D2    7A             C      	ld	a,d
  54D3    C6 04          C      	add	a,4		; .. add four pages
  54D5    67             C      	ld	h,a
  54D6    6B             C      	ld	l,e
  54D7    01 0100        C      	ld	bc,l0100
  54DA    ED B0          C      	ldir			; .. unpack one page
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-371


  54DC    3E 04          C      	ld	a,4
  54DE    32 54ED        C      	ld	(l5548),a	; Reset page count
  54E1    21 67C4        C      	ld	hl,l6837
  54E4    7E             C      	ld	a,(hl)
  54E5    D6 04          C      	sub	4		; .. fix
  54E7    77             C      	ld	(hl),a
  54E8    C1             C      	pop	bc
  54E9    E1             C      	pop	hl
  54EA    F1             C      	pop	af
  54EB    C9             C      	ret
  54EC                   C      l5547:
  54EC    00             C      	db	0		; \
  54ED                   C      l5548:				; |
  54ED    00             C      	db	0		; /
  54EE                   C      l5549:
  54EE    28 06          C      	jr	z,l5551
  54F0    23             C      	inc	hl
  54F1    5E             C      	ld	e,(hl)
  54F2    23             C      	inc	hl
  54F3    56             C      	ld	d,(hl)
  54F4    EB             C      	ex	de,hl
  54F5    C9             C      	ret
  54F6                   C      l5551:
  54F6    CD 3B68        C      	call	l3bc3
  54F9    C3 52F0        C      	jp	l534b
  54FC                   C      l5557:
  54FC    FE 0F          C      	cp	0fh
  54FE    D8             C      	ret	c
  54FF    C3 43E3        C      	jp	l443e
  5502    B7             C      	or	a
  5503    28 F7          C      	jr	z,l5557
  5505    FA 54FC        C      	jp	m,l5557
  5508    E6 1E          C      	and	1eh
  550A    FE 1E          C      	cp	1eh
  550C    28 EE          C      	jr	z,l5557
  550E    CD 5513        C      	call	l556e
  5511    18 E9          C      	jr	l5557
                         C      ;
                         C      ;
                         C      ;
  5513                   C      l556e:
  5513    3A 62C3        C      	ld	a,(_OPT_)	; Get option
  5516    E6 90          C      	and	@R.U@
  5518    FE 90          C      	cp	@R.U@		; Test undefined set ext
  551A    28 21          C      	jr	z,l5598
  551C                   C      l5577:
  551C    36 80          C      	ld	(hl),80h
  551E    23             C      	inc	hl
  551F    AF             C      	xor	a
  5520    77             C      	ld	(hl),a
  5521    23             C      	inc	hl
  5522    77             C      	ld	(hl),a
  5523    2B             C      	dec	hl
  5524    2B             C      	dec	hl
  5525    11 6A36        C      	ld	de,l6aa9
  5528    CD 5549        C      	call	l55a4
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-372


  552B    21 5572        C      	ld	hl,l55cd
  552E    CD 5E9C        C      	call	ldir.8		; Copy message
  5531    21 6A35        C      	ld	hl,l6aa8
  5534    EB             C      	ex	de,hl
  5535    37             C      	scf
  5536    ED 52          C      	sbc	hl,de
  5538    EB             C      	ex	de,hl
  5539    73             C      	ld	(hl),e		; Set length
  553A    C3 5D8E        C      	jp	ERROR?		; Process error on pass 2
  553D                   C      l5598:
  553D    CB 6E          C      	bit	5,(hl)
  553F    20 DB          C      	jr	nz,l5577
  5541    36 0F          C      	ld	(hl),0fh
  5543    23             C      	inc	hl
  5544    AF             C      	xor	a
  5545    77             C      	ld	(hl),a
  5546    23             C      	inc	hl
  5547    77             C      	ld	(hl),a
  5548    C9             C      	ret
  5549                   C      l55a4:
  5549    01 0004        C      	ld	bc,4
  554C    3A 6819        C      	ld	a,(l688c)
  554F    B7             C      	or	a
  5550    20 02          C      	jr	nz,l55af
  5552    0E 02          C      	ld	c,2
  5554                   C      l55af:
  5554    09             C      	add	hl,bc
  5555    CD 45E7        C      	call	l4642
  5558    20 10          C      	jr	nz,l55c5
  555A    3A 6819        C      	ld	a,(l688c)
  555D    B7             C      	or	a
  555E    20 02          C      	jr	nz,l55bd
  5560    09             C      	add	hl,bc
  5561    09             C      	add	hl,bc
  5562                   C      l55bd:
  5562    09             C      	add	hl,bc
  5563    7E             C      	ld	a,(hl)
  5564    2B             C      	dec	hl
  5565    6E             C      	ld	l,(hl)
  5566    67             C      	ld	h,a
  5567    09             C      	add	hl,bc
  5568    18 02          C      	jr	l55c7
  556A                   C      l55c5:
  556A    12             C      	ld	(de),a
  556B    13             C      	inc	de
  556C                   C      l55c7:
  556C    CD 45E7        C      	call	l4642
  556F    20 F9          C      	jr	nz,l55c5
  5571    C9             C      	ret
  5572                   C      l55cd:
  5572    0A 20 55 6E    C      	db	10,' Undefined'
  5576    64 65 66 69    C      
  557A    6E 65 64       C      
                         C      ;
                         C      ;
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-373


  557D                   C      l55d8:
  557D    CD 0A1D        C      	call	l0a37
                         C      	ld.hl	1,0
  5580    21 0100        C+     	ld	hl,1*256+0
  5583    28 01          C      	jr	z,l55e1
  5585    25             C      	dec	h
  5586                   C      l55e1:
  5586    22 6754        C      	ld	(l67c7),hl
  5589    21 6758        C      	ld	hl,l67cb
  558C    06 0E          C      	ld	b,14
  558E    AF             C      	xor	a
  558F                   C      l55ea:
  558F    77             C      	ld	(hl),a		; Clear 1st
  5590    23             C      	inc	hl
  5591    77             C      	ld	(hl),a
  5592    23             C      	inc	hl		; .. skip 2nd
  5593    23             C      	inc	hl
  5594    23             C      	inc	hl
  5595    10 F8          C      	djnz	l55ea
  5597    C9             C      	ret
  5598                   C      l55f3:
  5598    3A 67CE        C      	ld	a,(l6841)
  559B    B7             C      	or	a
  559C    28 15          C      	jr	z,l560e
  559E    3A 6844        C      	ld	a,(LogUsr.)	; Get logged user
  55A1    32 6801        C      	ld	(CurUsr),a	; .. save
  55A4    21 688B        C      	ld	hl,$$FCB$$	; Get temp FCB ????
  55A7    ED 5B 67CF     C      	ld	de,(l6842)
  55AB    CD 159A        C      	call	Rd$File		; Read from file
  55AE    2A 67CF        C      	ld	hl,(l6842)
  55B1    18 03          C      	jr	l5611
  55B3                   C      l560e:
  55B3    2A 6624        C      	ld	hl,(l6697)
  55B6                   C      l5611:
  55B6    0E 00          C      	ld	c,0
  55B8    D9             C      	exx
  55B9    C9             C      	ret
                         C      ;
                         C      ; Init .ABS file
                         C      ;
  55BA                   C      Ini$ABS:
  55BA    2A 6618        C      	ld	hl,(ABS.ORG)	; Get origin
  55BD    E5             C      	push	hl
  55BE    FD E1          C      	pop	iy		; .. copy
  55C0    11 0100        C      	ld	de,TPA
  55C3    B7             C      	or	a
  55C4    ED 52          C      	sbc	hl,de		; Test standard
  55C6    28 06          C      	jr	z,l5629
  55C8    21 55D7        C      	ld	hl,l5632
  55CB    CD 6134        C      	call	PutStr		; Tell not a standard file
  55CE                   C      l5629:
  55CE    D9             C      	exx
  55CF    06 00          C      	ld	b,0		; Clear a bit
  55D1    ED 5B 6740     C      	ld	de,(l67b3)
  55D5    D9             C      	exx
  55D6    C9             C      	ret
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-374


  55D7                   C      l5632:
  55D7    4E 6F 6E 2D    C      	db	'Non-Standard COM File',cr,lf,eot
  55DB    53 74 61 6E    C      
  55DF    64 61 72 64    C      
  55E3    20 43 4F 4D    C      
  55E7    20 46 69 6C    C      
  55EB    65 0D 0A FF    C      
                         C      ;
                         C      ; Init .HEX file
                         C      ;
  55EF                   C      Ini$HEX:
  55EF    FD 21 0100     C      	ld	iy,TPA		; Init TPA
  55F3    21 69AD        C      	ld	hl,l6a20
  55F6    36 01          C      	ld	(hl),1		; .. init control
  55F8    23             C      	inc	hl
  55F9    AF             C      	xor	a
  55FA    77             C      	ld	(hl),a
  55FB    23             C      	inc	hl
  55FC    77             C      	ld	(hl),a
  55FD    D9             C      	exx
  55FE    3A 012B        C      	ld	a,($HEXOUT$)	; Get length
  5601    47             C      	ld	b,a
  5602    11 69B0        C      	ld	de,HEXbuf	; .. and buffer
  5605    D9             C      	exx
  5606    C9             C      	ret
                         C      ;
                         C      ; Init .REL file
                         C      ;
  5607                   C      Ini$REL:
  5607    3E 01          C      	ld	a,1
  5609    CD 604A        C      	call	SelFile		; Get file
  560C    D9             C      	exx
  560D    06 08          C      	ld	b,8		; Get bit count
  560F    1E 00          C      	ld	e,0
  5611    DD 2A 69F0     C      	ld	ix,(FilBuf)	; Get buffer
  5615    D9             C      	exx
  5616    21 6832        C      	ld	hl,$$PRGN$$
  5619    7E             C      	ld	a,(hl)		; Test program name defined
  561A    3C             C      	inc	a
  561B    28 2C          C      	jr	z,l56a4		; .. nope
  561D    3E 84          C      	ld	a,10000100b
  561F    CD 5746        C      	call	REL.code	; Give PROGRAM NAME
  5622    21 6832        C      	ld	hl,$$PRGN$$
  5625    3E FF          C      	ld	a,eot
  5627    01 0000        C      	ld	bc,0
  562A    ED B1          C      	cpir			; Find end of name
  562C    2B             C      	dec	hl
  562D    36 00          C      	ld	(hl),0		; .. close
  562F    21 56C5        C      	ld	hl,l5720
  5632    22 5867        C      	ld	(l58c2),hl
  5635    21 682D        C      	ld	hl,l68a0
  5638    3A 6819        C      	ld	a,(l688c)
  563B    B7             C      	or	a
  563C    20 02          C      	jr	nz,l569b
  563E    23             C      	inc	hl
  563F    23             C      	inc	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-375


  5640                   C      l569b:
  5640    CD 5824        C      	call	BField		; Give symbol
  5643    21 45E7        C      	ld	hl,l4642
  5646    22 5867        C      	ld	(l58c2),hl
  5649                   C      l56a4:
  5649    CD 5ADA        C      	call	l5b35
  564C                   C      l56a7:
  564C    CD 56C8        C      	call	l5723
  564F    28 0A          C      	jr	z,l56b6
  5651    3E 80          C      	ld	a,10000000b
  5653    CD 5746        C      	call	REL.code	; Give ENTRY SYMBOL
  5656    CD 5824        C      	call	BField		; .. and symbol
  5659    18 F1          C      	jr	l56a7
  565B                   C      l56b6:
  565B    21 6819        C      	ld	hl,l688c
  565E    7E             C      	ld	a,(hl)
  565F    F5             C      	push	af
  5660    AF             C      	xor	a
  5661    77             C      	ld	(hl),a
  5662    21 67A0        C      	ld	hl,l6813
  5665    E5             C      	push	hl
  5666    21 6762        C      	ld	hl,l67d5
  5669    32 67DA        C      	ld	(l684d),a
  566C                   C      l56c7:
  566C    11 67DB        C      	ld	de,l684e
  566F    ED A0          C      	ldi
  5671    ED A0          C      	ldi
  5673    23             C      	inc	hl
  5674    23             C      	inc	hl
  5675    E3             C      	ex	(sp),hl
  5676    5E             C      	ld	e,(hl)
  5677    23             C      	inc	hl
  5678    56             C      	ld	d,(hl)
  5679    23             C      	inc	hl
  567A    7A             C      	ld	a,d
  567B    B3             C      	or	e
  567C    28 1C          C      	jr	z,l56f5
  567E    E3             C      	ex	(sp),hl
  567F    E5             C      	push	hl
  5680    EB             C      	ex	de,hl
  5681    11 67DD        C      	ld	de,l6850
  5684    01 0011        C      	ld	bc,l0011
  5687    ED B0          C      	ldir
  5689    21 67DA        C      	ld	hl,l684d
  568C    3E 8A          C      	ld	a,10001010b
  568E    CD 5746        C      	call	REL.code	; Give DEFINE COMMON
  5691    CD 5872        C      	call	AField		; Output address
  5694    CD 5824        C      	call	BField		; .. and symbol
  5697    E1             C      	pop	hl
  5698    18 D2          C      	jr	l56c7
  569A                   C      l56f5:
  569A    E1             C      	pop	hl
  569B    F1             C      	pop	af
  569C    32 6819        C      	ld	(l688c),a
  569F    2A 675E        C      	ld	hl,(DS.len)
  56A2    3E 94          C      	ld	a,10010100b
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-376


  56A4    CD 5746        C      	call	REL.code	; Give DEFINE DATA SIZE
  56A7    AF             C      	xor	a
  56A8    CD 58A4        C      	call	REL.adr		; Output size
  56AB    2A 675A        C      	ld	hl,(CS.len)
  56AE    3E 9A          C      	ld	a,10011010b
  56B0    CD 5746        C      	call	REL.code	; Give DEFINE PROGRAM SIZE
  56B3    3E 01          C      	ld	a,1
  56B5    CD 58A4        C      	call	REL.adr		; .. output size
  56B8    CD 557D        C      	call	l55d8
  56BB    FD 21 0000     C      	ld	iy,0
  56BF    3E 01          C      	ld	a,1
  56C1    32 67F1        C      	ld	($REL$),a	; Init mode
  56C4    C9             C      	ret
  56C5                   C      l5720:
  56C5    23             C      	inc	hl
  56C6    7E             C      	ld	a,(hl)
  56C7    C9             C      	ret
  56C8                   C      l5723:
  56C8    CD 5AF0        C      	call	l5b4b
  56CB    C8             C      	ret	z
  56CC    CD 4302        C      	call	l435d
  56CF    CB 6F          C      	bit	5,a
  56D1                   C      l572c:
  56D1    28 F5          C      	jr	z,l5723
  56D3    C9             C      	ret
  56D4                   C      l572f:
  56D4    F6 C0          C      	or	0c0h
  56D6                   C      l5731:
  56D6    CD 6322        C      	call	l6395
  56D9    C3 3965        C      	jp	l39c0
  56DC                   C      l5737:
  56DC    F6 D0          C      	or	0d0h
  56DE    18 F6          C      	jr	l5731
  56E0                   C      l573b:
  56E0    0E 09          C      	ld	c,9
  56E2    C3 5756        C      	jp	l57b1
  56E5                   C      l5740:
  56E5    0E 08          C      	ld	c,8
  56E7    C3 5756        C      	jp	l57b1
                         C      ;
  56EA                   C      l5745:
  56EA    08 07 09 0A    C      	db	8,7,9,0ah,0bh,10h,11h,12h,13h
  56EE    0B 10 11 12    C      
  56F2    13             C      
  56F3    14 05 06 03    C      	db	14h,5,6,3,4,0,19h,1ah,1bh,1ch
  56F7    04 00 19 1A    C      
  56FB    1B 1C          C      
  56FD    1D 1E 02 01    C      	db	1dh,1eh,2,1,1
  5701    01             C      
  5702                   C      l575d:
  5702    20 21 22       C      	db	' !"'
  5705                   C      l5760:
  5705    00 00 15 16    C      	db	0,0,15h,16h,17h,18h
  5709    17 18          C      
                         C      ;
                         C      ; Write special MS opcode
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-377


                         C      ; ENTRY	Accu holds opcode
                         C      ;
  570B                   C      WrSPC.opcode::
  570B    C5             C      	push	bc
  570C    21 563A        C      	ld	hl,l5745-00b0h
  570F    FE C5          C      	cp	0c5h
  5711    38 02          C      	jr	c,l5770
  5713    D6 1B          C      	sub	1bh		; Less offset
  5715                   C      l5770:
  5715    4F             C      	ld	c,a
  5716    06 00          C      	ld	b,0
  5718    09             C      	add	hl,bc
  5719    7E             C      	ld	a,(hl)
  571A    CD 5730        C      	call	SPC.opcode	; Give special opcode
  571D    7E             C      	ld	a,(hl)		; Get code
  571E    3D             C      	dec	a		; Test pop byte
  571F    28 09          C      	jr	z,l5785		; .. yeap
  5721    3D             C      	dec	a		; .. pop word
  5722    28 02          C      	jr	z,l5781		; .. yeap
  5724    C1             C      	pop	bc
  5725    C9             C      	ret
  5726                   C      l5781:
  5726    AF             C      	xor	a
  5727    CD 579C        C      	call	REL.Const	; Write zero
  572A                   C      l5785:
  572A    AF             C      	xor	a
  572B    CD 579C        C      	call	REL.Const	; Write zero
  572E    C1             C      	pop	bc
  572F    C9             C      	ret
                         C      ;
                         C      ; Print special MS opcode
                         C      ; ENTRY	Accu holds opcode
                         C      ;
  5730                   C      SPC.opcode:
  5730    4F             C      	ld	c,a
  5731    CD 5744        C      	call	REL.Ext		; Give special prefix
  5734    3E 40          C      	ld	a,01000000b
  5736    06 03          C      	ld	b,3
  5738    CD 57AE        C      	call	REL.bits	; Set length
  573B    3E 41          C      	ld	a,'A'
  573D    CD 58B6        C      	call	REL.byte	; Give ARITHMETIC PREFIX
  5740    79             C      	ld	a,c
  5741    C3 58B6        C      	jp	REL.byte	; Give OPCODE
                         C      ;
                         C      ; Give special REL-80 extension format
                         C      ;
  5744                   C      REL.Ext:
  5744    3E 88          C      	ld	a,10001000b	; Give EXTENDED TOKEN
  5746                   C      REL.code:
  5746    06 07          C      	ld	b,7
  5748    C3 57AE        C      	jp	REL.bits
  574B                   C      l57a6:
  574B    CD 510C        C      	call	l5167
  574E    CD 6328        C      	call	Con$Put		; Put to file
  5751    10 F8          C      	djnz	l57a6
  5753    C3 503A        C      	jp	l5095
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-378


  5756                   C      l57b1:
  5756    FE 03          C      	cp	3
  5758    D4 5768        C      	call	nc,l57c3
  575B    47             C      	ld	b,a
  575C    79             C      	ld	a,c
  575D    F6 40          C      	or	01000000b	; Insert bit
  575F    87             C      	add	a,a
  5760    48             C      	ld	c,b
  5761    CD 5746        C      	call	REL.code	; Give code
  5764    79             C      	ld	a,c
  5765    C3 58A4        C      	jp	REL.adr		; .. and address
                         C      ;
                         C      ;
                         C      ;
  5768                   C      l57c3:
  5768    E5             C      	push	hl
  5769    21 679F        C      	ld	hl,l6812
  576C    BE             C      	cp	(hl)
  576D    28 26          C      	jr	z,l57f0
  576F    77             C      	ld	(hl),a
  5770    D5             C      	push	de
  5771    C5             C      	push	bc
  5772    D6 03          C      	sub	3
  5774    87             C      	add	a,a
  5775    4F             C      	ld	c,a
  5776    06 00          C      	ld	b,0
  5778    21 67A0        C      	ld	hl,l6813
  577B    09             C      	add	hl,bc
  577C    5E             C      	ld	e,(hl)
  577D    23             C      	inc	hl
  577E    56             C      	ld	d,(hl)
  577F    21 FFFB        C      	ld	hl,-5
  5782    3A 6819        C      	ld	a,(l688c)	; Get COMMON flag
  5785    B7             C      	or	a
  5786    20 02          C      	jr	nz,l57e5	; .. ??
  5788    2E FD          C      	ld	l,-3
  578A                   C      l57e5:
  578A    19             C      	add	hl,de
  578B    3E 82          C      	ld	a,10000010b
  578D    CD 5746        C      	call	REL.code	; Give COMMON BLOCK
  5790    CD 5824        C      	call	BField		; .. and symbol
  5793    C1             C      	pop	bc
  5794    D1             C      	pop	de
  5795                   C      l57f0:
  5795    3E 03          C      	ld	a,3
  5797    E1             C      	pop	hl
  5798    C9             C      	ret
                         C      ;
                         C      ; Put constant byte to REL file
                         C      ;
  5799                   C      Con$REL:
  5799    CD 634C        C      	call	l63bf
                         C      ;
                         C      ; Write costant to file -> 9 bits 0.hhhhllll
                         C      ; ENTRY	Accu holds value
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-379


  579C                   C      REL.Const:
  579C    C5             C      	push	bc
  579D    B7             C      	or	a		; Clear carry
  579E    1F             C      	rra			; .. shift LSB in
  579F    06 09          C      	ld	b,1+8
  57A1    CD 57AE        C      	call	REL.bits	; Give bits
  57A4    C1             C      	pop	bc
  57A5    C9             C      	ret
                         C      ;
                         C      ; Set bit boundary
                         C      ;
  57A6                   C      Bit.Boundary:
  57A6    D9             C      	exx
  57A7    78             C      	ld	a,b		; Get remaining bits
  57A8    D9             C      	exx
  57A9    FE 08          C      	cp	8		; Test on boundary
  57AB    C8             C      	ret	z		; .. yeap
  57AC    47             C      	ld	b,a		; Get as count
  57AD    AF             C      	xor	a		; .. fill zeroes
                         C      ;
                         C      ; Write bits to .REL file
                         C      ; ENTRY	Accu  holds bit pattern
                         C      ;	Reg B holds number of bits
                         C      ;
  57AE                   C      REL.bits:
  57AE    D9             C      	exx
  57AF    17             C      	rla			; Get bit
  57B0    CB 12          C      	rl	d		; .. into byte
  57B2    10 0A          C      	djnz	l5819		; .. test free bits left
  57B4    DD 72 00       C      	ld	(ix+0),d	; Save byte
  57B7    DD 23          C      	inc	ix		; Bump buffer
  57B9    1D             C      	dec	e		; Test buffer free
  57BA    28 06          C      	jr	z,l581d		; .. nope
  57BC                   C      l5817:
  57BC    06 08          C      	ld	b,8		; Reset bit count
  57BE                   C      l5819:
  57BE    D9             C      	exx
  57BF    10 ED          C      	djnz	REL.bits	; Test ready
  57C1    C9             C      	ret
  57C2                   C      l581d:
  57C2    E5             C      	push	hl
  57C3    C5             C      	push	bc
  57C4    F5             C      	push	af
  57C5    3E 01          C      	ld	a,1
  57C7    CD 604A        C      	call	SelFile		; Get file
  57CA    21 69ED        C      	ld	hl,l6a5f+1	; Test total buffer filled
  57CD    35             C      	dec	(hl)
  57CE    20 09          C      	jr	nz,l5834	; .. nope
  57D0    36 04          C      	ld	(hl),4		; Reset count
  57D2    CD 5FE1        C      	call	WrToFile	; Write to disk
  57D5    DD 2A 69F0     C      	ld	ix,(FilBuf)	; Get back buffer
  57D9                   C      l5834:
  57D9    F1             C      	pop	af
  57DA    C1             C      	pop	bc
  57DB    E1             C      	pop	hl
  57DC    1E 00          C      	ld	e,0		; Clear buffer count
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-380


  57DE    18 DC          C      	jr	l5817
                         C      ;
                         C      ; Push 16 bit onto stack
                         C      ; ENTRY	Reg HL holds word
                         C      ;
  57E0                   C      SPC.push:
  57E0    C5             C      	push	bc
  57E1    FE 0F          C      	cp	0fh		; Test code
  57E3    28 1D          C      	jr	z,SPC.symbol	; .. write symbol
  57E5    FE 03          C      	cp	3
  57E7    D4 5768        C      	call	nc,l57c3
  57EA    4F             C      	ld	c,a
  57EB    CD 5744        C      	call	REL.Ext		; Give extension
  57EE    3E 80          C      	ld	a,10000000b
  57F0    06 03          C      	ld	b,3
  57F2    CD 57AE        C      	call	REL.bits	; Give length
  57F5    3E 43          C      	ld	a,'C'
  57F7    CD 58B6        C      	call	REL.byte	; Give code
  57FA    79             C      	ld	a,c
  57FB    06 08          C      	ld	b,8
  57FD    CD 58AE        C      	call	REL.word	; Output word
  5800    C1             C      	pop	bc
  5801    C9             C      	ret
  5802                   C      SPC.symbol:
  5802    D5             C      	push	de
  5803    CD 5744        C      	call	REL.Ext		; Give extension
  5806    3E 42          C      	ld	a,'B'		; Set code
  5808    32 5871        C      	ld	(l58cc),a
  580B    3E 01          C      	ld	a,1
  580D    32 5845        C      	ld	(l58a0),a
  5810    CD 5824        C      	call	BField		; Give symbol
  5813    D1             C      	pop	de
  5814    C1             C      	pop	bc
  5815    C9             C      	ret
  5816                   C      l5871:
  5816    11 0005        C      	ld	de,5
  5819    3A 6819        C      	ld	a,(l688c)	; Test COMMON
  581C    B7             C      	or	a
  581D    20 02          C      	jr	nz,l587c
  581F    1E 03          C      	ld	e,3
  5821                   C      l587c:
  5821    19             C      	add	hl,de
  5822    7E             C      	ld	a,(hl)		; Get flag
  5823    C9             C      	ret
                         C      ;
                         C      ; Out symbol
                         C      ; ENTRY	Reg HL points to symbol control
                         C      ;
  5824                   C      BField:
  5824    E5             C      	push	hl
  5825                   C      l5880:
  5825    CD 5816        C      	call	l5871		; Get flag
  5828    3C             C      	inc	a
  5829    20 0B          C      	jr	nz,l5891	; .. ok
  582B    3E 08          C      	ld	a,8
  582D    93             C      	sub	e
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-381


  582E    5F             C      	ld	e,a
  582F    19             C      	add	hl,de
  5830    5E             C      	ld	e,(hl)		; Get address
  5831    23             C      	inc	hl
  5832    56             C      	ld	d,(hl)
  5833    EB             C      	ex	de,hl
  5834    18 EF          C      	jr	l5880
  5836                   C      l5891:
  5836    E5             C      	push	hl
  5837    AF             C      	xor	a
  5838    4F             C      	ld	c,a
  5839    ED B1          C      	cpir
  583B    3D             C      	dec	a
  583C    E1             C      	pop	hl
  583D    91             C      	sub	c
  583E    FE 07          C      	cp	7		; Compare length
  583F                   C      @REL1@	equ	$-1
  5840    38 02          C      	jr	c,l589f
  5842    3E 07          C      	ld	a,7		; Get length
  5843                   C      @REL2@	equ	$-1
  5844                   C      l589f:
  5844    C6 00          C      	add	a,0
  5845                   C      l58a0	equ	$-1
  5846    F5             C      	push	af
  5847    0F             C      	rrca
  5848    0F             C      	rrca
  5849    0F             C      	rrca
  584A    06 03          C      	ld	b,3
  584C    CD 57AE        C      	call	REL.bits	; Output bits
  584F    F1             C      	pop	af
  5850    B7             C      	or	a
  5851    28 1C          C      	jr	z,l58ca
  5853    4F             C      	ld	c,a
  5854    2B             C      	dec	hl
  5855    3A 5871        C      	ld	a,(l58cc)
  5858    B7             C      	or	a
  5859    28 0B          C      	jr	z,l58c1
  585B    CD 58B6        C      	call	REL.byte	; Give byte
  585E    AF             C      	xor	a
  585F    32 5871        C      	ld	(l58cc),a
  5862    32 5845        C      	ld	(l58a0),a
  5865    0D             C      	dec	c
  5866                   C      l58c1:
  5866    CD 45E7        C      	call	l4642
  5867                   C      l58c2	equ	$-2
  5869    CD 58B6        C      	call	REL.byte	; Give byte
  586C    0D             C      	dec	c
  586D    20 F7          C      	jr	nz,l58c1
  586F                   C      l58ca:
  586F    E1             C      	pop	hl
  5870    C9             C      	ret
  5871                   C      l58cc:
  5871    00             C      	db	0
                         C      ;
                         C      ; Output address
                         C      ; ENTRY	Reg HL points to control field
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-382


                         C      ;
  5872                   C      AField:
  5872    E5             C      	push	hl
  5873    7E             C      	ld	a,(hl)		; Get mode
  5874    E6 0F          C      	and	0fh		; .. four bits
  5876    FE 04          C      	cp	4		; Test range
  5878    38 02          C      	jr	c,l58d7
  587A    3E 03          C      	ld	a,3		; Force COMMON
  587C                   C      l58d7:
  587C    23             C      	inc	hl
  587D    5E             C      	ld	e,(hl)		; Fetch address
  587E    23             C      	inc	hl
  587F    56             C      	ld	d,(hl)
  5880    EB             C      	ex	de,hl
  5881    CD 58A4        C      	call	REL.adr		; .. output
  5884    E1             C      	pop	hl
  5885    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  5886                   C      l58e1:
  5886    CD 634F        C      	call	l63c2
  5889                   C      l58e4:
  5889    B7             C      	or	a
  588A    28 10          C      	jr	z,l58f7
  588C    FE 0F          C      	cp	0fh
  588E    28 2B          C      	jr	z,l5916
  5890    FE 03          C      	cp	3
  5892    D4 5768        C      	call	nc,l57c3
  5895    F6 04          C      	or	4
  5897    06 03          C      	ld	b,3
  5899    0F             C      	rrca
  589A    18 10          C      	jr	l5907
  589C                   C      l58f7:
  589C    7D             C      	ld	a,l
  589D    CD 632B        C      	call	l639e
  58A0    7C             C      	ld	a,h
  58A1    C3 632B        C      	jp	l639e
                         C      ;
                         C      ; Output address field
                         C      ; ENTRY	Reg HL holds address
                         C      ;	Accu   holds mode bits
                         C      ;
  58A4                   C      REL.adr:
  58A4    06 02          C      	ld	b,2		; Set bit length
  58A6    FE 04          C      	cp	4		; Test max
  58A8    38 02          C      	jr	c,l5907
  58AA    3E 03          C      	ld	a,3
  58AC                   C      l5907:
  58AC    0F             C      	rrca
  58AD    0F             C      	rrca
  58AE                   C      REL.word:
  58AE    CD 57AE        C      	call	REL.bits	; Give address mode
  58B1    7D             C      	ld	a,l
  58B2    CD 58B6        C      	call	REL.byte	; Get low
  58B5    7C             C      	ld	a,h		; .. then high
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-383


  58B6                   C      REL.byte:
  58B6    06 08          C      	ld	b,8
  58B8    C3 57AE        C      	jp	REL.bits	; Give byte
  58BB                   C      l5916:
  58BB    23             C      	inc	hl
  58BC    5E             C      	ld	e,(hl)
  58BD    23             C      	inc	hl
  58BE    56             C      	ld	d,(hl)
  58BF    E5             C      	push	hl
  58C0    D5             C      	push	de
  58C1    CD 509F        C      	call	l50fa
  58C4    D1             C      	pop	de
  58C5    E1             C      	pop	hl
  58C6    ED 4B 67C5     C      	ld	bc,(l6838)
  58CA    0B             C      	dec	bc
  58CB    0B             C      	dec	bc
  58CC    70             C      	ld	(hl),b
  58CD    2B             C      	dec	hl
  58CE    71             C      	ld	(hl),c
  58CF    2B             C      	dec	hl
  58D0    3A 67C7        C      	ld	a,(l683a)
  58D3    87             C      	add	a,a
  58D4    87             C      	add	a,a
  58D5    87             C      	add	a,a
  58D6    87             C      	add	a,a
  58D7    C6 0F          C      	add	a,0fh
  58D9    4E             C      	ld	c,(hl)
  58DA    77             C      	ld	(hl),a
  58DB    79             C      	ld	a,c
  58DC    EB             C      	ex	de,hl
  58DD    0F             C      	rrca
  58DE    0F             C      	rrca
  58DF    0F             C      	rrca
  58E0    0F             C      	rrca
  58E1    E6 0F          C      	and	0fh
  58E3    C3 51C8        C      	jp	l5223
  58E6    B7             C      	or	a
  58E7    28 08          C      	jr	z,l594c
  58E9    F6 80          C      	or	80h
  58EB    CD 6322        C      	call	l6395
  58EE    C3 3965        C      	jp	l39c0
  58F1                   C      l594c:
  58F1    7D             C      	ld	a,l
  58F2    CD 632B        C      	call	l639e
  58F5    7C             C      	ld	a,h
  58F6    C3 632B        C      	jp	l639e
  58F9                   C      l5954:
  58F9    11 49 6C 6C    C      	db	17,'Illegal Construct'
  58FD    65 67 61 6C    C      
  5901    20 43 6F 6E    C      
  5905    73 74 72 75    C      
  5909    63 74          C      
  590B                   C      l5966:
  590B    0E 90          C      	ld	c,90h
  590D    18 0D          C      	jr	l5977
  590F                   C      l596a:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-384


  590F    B1             C      	or	c
  5910    18 02          C      	jr	l596f
  5912                   C      l596d:
  5912    F6 80          C      	or	80h
  5914                   C      l596f:
  5914    CD 6322        C      	call	l6395
  5917    C3 3965        C      	jp	l39c0
  591A                   C      l5975:
  591A    0E 80          C      	ld	c,80h
  591C                   C      l5977:
  591C    FE 0F          C      	cp	0fh
  591E    20 EF          C      	jr	nz,l596a
  5920    CD 4302        C      	call	l435d
  5923    CB 76          C      	bit	6,(hl)
  5925    20 20          C      	jr	nz,l59a2
  5927    CB F6          C      	set	6,(hl)
  5929    D5             C      	push	de
  592A    E5             C      	push	hl
  592B    3E FC          C      	ld	a,0fch
  592D    CD 6322        C      	call	l6395
  5930    CD 5816        C      	call	l5871
  5933    CD 59EE        C      	call	l5a49
  5936    E1             C      	pop	hl
  5937    23             C      	inc	hl
  5938    ED 5B 67BD     C      	ld	de,(l6830)
  593C    13             C      	inc	de
  593D    ED 53 67BD     C      	ld	(l6830),de
  5941    72             C      	ld	(hl),d
  5942    23             C      	inc	hl
  5943    73             C      	ld	(hl),e
  5944    2B             C      	dec	hl
  5945    2B             C      	dec	hl
  5946    D1             C      	pop	de
  5947                   C      l59a2:
  5947    3E 0F          C      	ld	a,0fh
  5949    B1             C      	or	c
  594A    CD 6322        C      	call	l6395
  594D    23             C      	inc	hl
  594E    7E             C      	ld	a,(hl)
  594F    B7             C      	or	a
  5950    20 05          C      	jr	nz,l59b2
  5952                   C      l59ad:
  5952    23             C      	inc	hl
  5953    7E             C      	ld	a,(hl)
  5954    C3 6322        C      	jp	l6395
  5957                   C      l59b2:
  5957    AF             C      	xor	a
  5958    CD 6322        C      	call	l6395
  595B    7E             C      	ld	a,(hl)
  595C    CD 6322        C      	call	l6395
  595F    18 F1          C      	jr	l59ad
  5961                   C      l59bc:
  5961    FE BF          C      	cp	0bfh
  5963    38 0E          C      	jr	c,l59ce
  5965    FE D0          C      	cp	0d0h
  5967    D2 5973        C      	jp	nc,l59ce
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-385


  596A    F5             C      	push	af
  596B    3E BF          C      	ld	a,0bfh
  596D    CD 6322        C      	call	l6395
  5970    F1             C      	pop	af
  5971    D6 BF          C      	sub	0bfh
  5973                   C      l59ce:
  5973    C3 6322        C      	jp	l6395
                         C      ;
                         C      ; Init .SLR output file
                         C      ;
  5976                   C      Ini$SLR:
                         C      	ld.hl	5,0
  5976    21 0500        C+     	ld	hl,5*256+0
  5979    22 54EC        C      	ld	(l5547),hl	; Init word
  597C    DD 21 54EC     C      	ld	ix,l5547	; Set pointer
  5980    D9             C      	exx
  5981    EB             C      	ex	de,hl
  5982    06 00          C      	ld	b,0		; Clear a bit
  5984    2A 6740        C      	ld	hl,(l67b3)
  5987    22 67C3        C      	ld	(l6836),hl	; .. init buffer
  598A    23             C      	inc	hl
  598B    EB             C      	ex	de,hl
  598C    D9             C      	exx
  598D    3E F9          C      	ld	a,0f9h
  598F    CD 5499        C      	call	l54f4
  5992    21 6832        C      	ld	hl,$$PRGN$$	; Get name
  5995    CD 5A1B        C      	call	l5a76
  5998    2A 675A        C      	ld	hl,(CS.len)	; Get code length
  599B    CD 3965        C      	call	l39c0
  599E    2A 675E        C      	ld	hl,(DS.len)	; Get data length
  59A1    CD 3965        C      	call	l39c0
  59A4    CD 5ADA        C      	call	l5b35
  59A7                   C      l5a02:
  59A7    CD 56C8        C      	call	l5723
  59AA    28 0B          C      	jr	z,l5a12
  59AC    17             C      	rla
  59AD    D4 5513        C      	call	nc,l556e
  59B0    3E FA          C      	ld	a,0fah
  59B2    CD 5ABA        C      	call	l5b15
  59B5    18 F0          C      	jr	l5a02
  59B7                   C      l5a12:
  59B7    21 6762        C      	ld	hl,l67d5
  59BA    E5             C      	push	hl
  59BB    21 67A0        C      	ld	hl,l6813
  59BE                   C      l5a19:
  59BE    5E             C      	ld	e,(hl)
  59BF    23             C      	inc	hl
  59C0    56             C      	ld	d,(hl)
  59C1    23             C      	inc	hl
  59C2    7A             C      	ld	a,d
  59C3    B3             C      	or	e
  59C4    28 1A          C      	jr	z,l5a3b
  59C6    EB             C      	ex	de,hl
  59C7    3E FB          C      	ld	a,0fbh
  59C9    CD 6322        C      	call	l6395
  59CC    CD 59EE        C      	call	l5a49
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-386


  59CF    E1             C      	pop	hl
  59D0    7E             C      	ld	a,(hl)
  59D1    CD 6322        C      	call	l6395
  59D4    23             C      	inc	hl
  59D5    7E             C      	ld	a,(hl)
  59D6    CD 6322        C      	call	l6395
  59D9    23             C      	inc	hl
  59DA    23             C      	inc	hl
  59DB    23             C      	inc	hl
  59DC    E5             C      	push	hl
  59DD    EB             C      	ex	de,hl
  59DE    18 DE          C      	jr	l5a19
  59E0                   C      l5a3b:
  59E0    E1             C      	pop	hl
  59E1    CD 557D        C      	call	l55d8
  59E4    FD 21 0000     C      	ld	iy,0
  59E8    3E 01          C      	ld	a,1
  59EA    32 67F1        C      	ld	($REL$),a	; Init mode
  59ED    C9             C      	ret
  59EE                   C      l5a49:
  59EE    7E             C      	ld	a,(hl)
  59EF    3C             C      	inc	a
  59F0    20 16          C      	jr	nz,l5a63
  59F2    23             C      	inc	hl
  59F3    23             C      	inc	hl
  59F4    23             C      	inc	hl
  59F5    3A 6819        C      	ld	a,(l688c)
  59F8    B7             C      	or	a
  59F9    20 02          C      	jr	nz,l5a58
  59FB    23             C      	inc	hl
  59FC    23             C      	inc	hl
  59FD                   C      l5a58:
  59FD    5E             C      	ld	e,(hl)
  59FE    23             C      	inc	hl
  59FF    56             C      	ld	d,(hl)
  5A00    21 0005        C      	ld	hl,5
  5A03    20 02          C      	jr	nz,l5a62	; .. COMMON
  5A05    2E 03          C      	ld	l,3
  5A07                   C      l5a62:
  5A07    19             C      	add	hl,de
  5A08                   C      l5a63:
  5A08    2B             C      	dec	hl
  5A09    18 03          C      	jr	l5a69
  5A0B                   C      l5a66:
  5A0B    CD 5499        C      	call	l54f4
  5A0E                   C      l5a69:
  5A0E    CD 45E7        C      	call	l4642
  5A11    20 F8          C      	jr	nz,l5a66
  5A13    3E FF          C      	ld	a,0ffh
  5A15    C3 5499        C      	jp	l54f4
  5A18                   C      l5a73:
  5A18    CD 5499        C      	call	l54f4
  5A1B                   C      l5a76:
  5A1B    7E             C      	ld	a,(hl)
  5A1C    23             C      	inc	hl
  5A1D    FE FF          C      	cp	0ffh
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-387


  5A1F    20 F7          C      	jr	nz,l5a73
  5A21    C3 5499        C      	jp	l54f4
  5A24                   C      l5a7f:
  5A24    2A 680E        C      	ld	hl,(l6881)
  5A27                   C      l5a82:
  5A27    7C             C      	ld	a,h
  5A28    B5             C      	or	l
  5A29    28 1B          C      	jr	z,l5aa1
  5A2B    3E FD          C      	ld	a,0fdh
  5A2D    CD 5499        C      	call	l54f4
  5A30    06 09          C      	ld	b,9
  5A32                   C      l5a8d:
  5A32    7E             C      	ld	a,(hl)
  5A33    23             C      	inc	hl
  5A34    FE 20          C      	cp	' '
  5A36    C4 5499        C      	call	nz,l54f4
  5A39    10 F7          C      	djnz	l5a8d
  5A3B    3E FF          C      	ld	a,0ffh
  5A3D    CD 5499        C      	call	l54f4
  5A40    5E             C      	ld	e,(hl)
  5A41    23             C      	inc	hl
  5A42    56             C      	ld	d,(hl)
  5A43    EB             C      	ex	de,hl
  5A44    18 E1          C      	jr	l5a82
  5A46                   C      l5aa1:
  5A46    2A 67BB        C      	ld	hl,(ErrCnt)	; Get error count
  5A49    7C             C      	ld	a,h
  5A4A    B5             C      	or	l
  5A4B    3E F6          C      	ld	a,0f6h
  5A4D    C4 5499        C      	call	nz,l54f4	; .. got any
  5A50    3A 0121        C      	ld	a,($TOD.ENA$)	; Test TOD enabled
  5A53    B7             C      	or	a
  5A54    28 24          C      	jr	z,l5ad5		; .. nope
  5A56    3A 0125        C      	ld	a,($TOD.FORM$)	; Get format
  5A59    B7             C      	or	a
  5A5A    28 1E          C      	jr	z,l5ad5		; .. set short
  5A5C    CD 61D1        C      	call	Get$TOD		; Get TOD string
  5A5F    2A 6A31        C      	ld	hl,(TOD.PB)	; Get date format
  5A62    7C             C      	ld	a,h
  5A63    B5             C      	or	l
  5A64    28 14          C      	jr	z,l5ad5		; .. skip zero
  5A66    3E F7          C      	ld	a,0f7h
  5A68    CD 5499        C      	call	l54f4
  5A6B    CD 6259        C      	call	GetTOD		; Get current date
  5A6E    21 6A31        C      	ld	hl,TOD.PB	; Get TOD base
  5A71    06 04          C      	ld	b,TODlen
  5A73                   C      l5ace:
  5A73    7E             C      	ld	a,(hl)		; Get TOD byte
  5A74    23             C      	inc	hl
  5A75    CD 5499        C      	call	l54f4
  5A78    10 F9          C      	djnz	l5ace
  5A7A                   C      l5ad5:
  5A7A    3E FE          C      	ld	a,0feh
  5A7C    CD 5499        C      	call	l54f4
  5A7F    3A 67BF        C      	ld	a,(l6832)
  5A82    2A 67C0        C      	ld	hl,(XFER)	; Get transfer address
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-388


  5A85    CD 5499        C      	call	l54f4
  5A88    CD 3965        C      	call	l39c0
  5A8B    3E FF          C      	ld	a,0ffh
  5A8D    CD 5499        C      	call	l54f4
  5A90    2A 69EC        C      	ld	hl,(l6a5f)	; Get count
  5A93    11 FF00        C      	ld	de,lff00
  5A96    19             C      	add	hl,de		; Less 1 page
  5A97    D9             C      	exx
  5A98    D4 54BF        C      	call	nc,l551a
  5A9B    D9             C      	exx
  5A9C    2A 67C3        C      	ld	hl,(l6836)
  5A9F    ED 5B 69F0     C      	ld	de,(FilBuf)	; Get buffer
  5AA3    B7             C      	or	a
  5AA4    ED 52          C      	sbc	hl,de
  5AA6    11 007F        C      	ld	de,RecLng-1
  5AA9    19             C      	add	hl,de
  5AAA    7D             C      	ld	a,l
  5AAB    E6 80          C      	and	80h
  5AAD    6F             C      	ld	l,a
  5AAE    EB             C      	ex	de,hl
  5AAF    21 03ED        C      	ld	hl,l0400
  5AB2    ED 52          C      	sbc	hl,de
  5AB4    22 69EC        C      	ld	(l6a5f),hl	; Save count
  5AB7    C3 5EBA        C      	jp	l5f15
  5ABA                   C      l5b15:
  5ABA    CD 5499        C      	call	l54f4
  5ABD    E5             C      	push	hl
  5ABE    CD 5816        C      	call	l5871
  5AC1    CD 59EE        C      	call	l5a49
  5AC4    E1             C      	pop	hl
  5AC5    CD 4302        C      	call	l435d
  5AC8    7E             C      	ld	a,(hl)
  5AC9    E6 0F          C      	and	0fh
  5ACB    CD 5499        C      	call	l54f4
  5ACE    23             C      	inc	hl
  5ACF    7E             C      	ld	a,(hl)
  5AD0    CD 5499        C      	call	l54f4
  5AD3    23             C      	inc	hl
  5AD4    7E             C      	ld	a,(hl)
  5AD5    2B             C      	dec	hl
  5AD6    2B             C      	dec	hl
  5AD7    C3 5499        C      	jp	l54f4
  5ADA                   C      l5b35:
  5ADA    2A 661D        C      	ld	hl,(l6690)
  5ADD    11 6BDB        C      	ld	de,l6c4d+1
  5AE0    ED 53 5AFB     C      	ld	(l5b56),de
  5AE4    B7             C      	or	a
  5AE5    ED 52          C      	sbc	hl,de
  5AE7    CB 3C          C      	srl	h
  5AE9    CB 1D          C      	rr	l
  5AEB    23             C      	inc	hl
  5AEC    22 5B07        C      	ld	(l5b62),hl
  5AEF    C9             C      	ret
  5AF0                   C      l5b4b:
  5AF0    2A 5B07        C      	ld	hl,(l5b62)
  5AF3    2B             C      	dec	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-389


  5AF4    22 5B07        C      	ld	(l5b62),hl
  5AF7    7C             C      	ld	a,h
  5AF8    B5             C      	or	l
  5AF9    C8             C      	ret	z
  5AFA    21 0000        C      	ld	hl,$-$
  5AFB                   C      l5b56	equ	$-2
  5AFD    5E             C      	ld	e,(hl)
  5AFE    23             C      	inc	hl
  5AFF    56             C      	ld	d,(hl)
  5B00    23             C      	inc	hl
  5B01    22 5AFB        C      	ld	(l5b56),hl
  5B04    EB             C      	ex	de,hl
  5B05    7E             C      	ld	a,(hl)
  5B06    C9             C      	ret
  5B07                   C      l5b62:
  5B07    0000           C      	dw	0
  5B09                   C      l5b64:
  5B09    3A 011F        C      	ld	a,($FF.SUM$)	; Test form feed before summary
  5B0C    B7             C      	or	a
  5B0D    C4 5D7E        C      	call	nz,l5dd9	; .. yeap
  5B10    3A 661C        C      	ld	a,(l668f)
  5B13    21 62C2        C      	ld	hl,_LST.PAG_	; Get page length
  5B16    C6 04          C      	add	a,4
  5B18    BE             C      	cp	(hl)
  5B19    D4 5D7E        C      	call	nc,l5dd9
  5B1C    11 68AC        C      	ld	de,l691f
  5B1F    2A 67BB        C      	ld	hl,(ErrCnt)	; Get error count
  5B22    01 5B6F        C      	ld	bc,l5bca
  5B25    CD 5BC4        C      	call	l5c1f
  5B28    2A 675A        C      	ld	hl,(CS.len)	; Get code length
  5B2B    01 5B82        C      	ld	bc,l5bdd
  5B2E    7C             C      	ld	a,h
  5B2F    B5             C      	or	l
  5B30    C4 5BC4        C      	call	nz,l5c1f
  5B33    2A 675E        C      	ld	hl,(DS.len)	; Get data length
  5B36    01 5B91        C      	ld	bc,l5bec
  5B39    7C             C      	ld	a,h
  5B3A    B5             C      	or	l
  5B3B    C4 5BC4        C      	call	nz,l5c1f
  5B3E    21 5BC1        C      	ld	hl,l5c1c
  5B41    CD 5E9C        C      	call	ldir.8		; Copy message
  5B44    2A 6756        C      	ld	hl,(l67c9)
  5B47    7C             C      	ld	a,h
  5B48    B5             C      	or	l
  5B49    28 0C          C      	jr	z,l5bb2
  5B4B    ED 4B 6618     C      	ld	bc,(ABS.ORG)	; Get origin
  5B4F    ED 42          C      	sbc	hl,bc
  5B51    01 5B9D        C      	ld	bc,l5bf8
  5B54    C4 5BC4        C      	call	nz,l5c1f
  5B57                   C      l5bb2:
  5B57    D5             C      	push	de
  5B58    CD 5ADA        C      	call	l5b35
  5B5B    2A 5B07        C      	ld	hl,(l5b62)
  5B5E    2B             C      	dec	hl
  5B5F    D1             C      	pop	de
  5B60    01 5BAD        C      	ld	bc,l5c08
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-390


  5B63    CD 5BC4        C      	call	l5c1f
  5B66    3E FF          C      	ld	a,0ffh
  5B68    12             C      	ld	(de),a
  5B69    21 68AC        C      	ld	hl,l691f
  5B6C    C3 5DDD        C      	jp	l5e38
  5B6F                   C      l5bca:
  5B6F    12 45 72 72    C      	db	18,'Error(s) Detected.'
  5B73    6F 72 28 73    C      
  5B77    29 20 44 65    C      
  5B7B    74 65 63 74    C      
  5B7F    65 64 2E       C      
  5B82                   C      l5bdd:
  5B82    0E 50 72 6F    C      	db	14,'Program Bytes.'
  5B86    67 72 61 6D    C      
  5B8A    20 42 79 74    C      
  5B8E    65 73 2E       C      
  5B91                   C      l5bec:
  5B91    0B 44 61 74    C      	db	11,'Data Bytes.'
  5B95    61 20 42 79    C      
  5B99    74 65 73 2E    C      
  5B9D                   C      l5bf8:
  5B9D    0F 41 62 73    C      	db	15,'Absolute Bytes.'
  5BA1    6F 6C 75 74    C      
  5BA5    65 20 42 79    C      
  5BA9    74 65 73 2E    C      
  5BAD                   C      l5c08:
  5BAD    13 53 79 6D    C      	db	19,'Symbols Detected.',cr,lf
  5BB1    62 6F 6C 73    C      
  5BB5    20 44 65 74    C      
  5BB9    65 63 74 65    C      
  5BBD    64 2E 0D 0A    C      
  5BC1                   C      l5c1c:
  5BC1    02 0D 0A       C      	db	2,cr,lf
  5BC4                   C      l5c1f:
  5BC4    C5             C      	push	bc
  5BC5    3E 20          C      	ld	a,' '
  5BC7    12             C      	ld	(de),a
  5BC8    13             C      	inc	de
  5BC9    3E 05          C      	ld	a,5
  5BCB    CD 34A2        C      	call	Out$DEC		; Get decimal
  5BCE    3E 20          C      	ld	a,' '
  5BD0    12             C      	ld	(de),a
  5BD1    13             C      	inc	de
  5BD2    E1             C      	pop	hl
  5BD3    C3 5E9C        C      	jp	ldir.8		; .. then copy message
  5BD6                   C      l5c31:
  5BD6    53 79 6D 62    C      	db	'Symbol Table:',eot
  5BDA    6F 6C 20 54    C      
  5BDE    61 62 6C 65    C      
  5BE2    3A FF          C      
  5BE4                   C      l5c3f:
  5BE4    21 5BD6        C      	ld	hl,l5c31
  5BE7    11 63C9        C      	ld	de,@MES@
  5BEA    01 000E        C      	ld	bc,l5c3f-l5c31
  5BED    ED B0          C      	ldir			; Unpack message
  5BEF    3A 62C1        C      	ld	a,(_CON.WID_)	; Get console width
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-391


  5BF2    6F             C      	ld	l,a
  5BF3    11 0017        C      	ld	de,l0017
  5BF6    62             C      	ld	h,d
  5BF7    CD 3A14        C      	call	l3a6f
  5BFA    7D             C      	ld	a,l
  5BFB    32 5C2F        C      	ld	(l5c8a),a
  5BFE    21 6314        C      	ld	hl,l6387
  5C01    36 00          C      	ld	(hl),0
  5C03    21 68AC        C      	ld	hl,l691f
  5C06    22 6317        C      	ld	(LinePtr),hl	; Init line pointer
  5C09    3E C9          C      	ld	a,_RET		; Set return
  5C0B    32 07D7        C      	ld	(l07f1),a
  5C0E    CD 5ADA        C      	call	l5b35
  5C11    CD 5AF0        C      	call	l5b4b
  5C14    C8             C      	ret	z
  5C15    CD 5D7E        C      	call	l5dd9
  5C18    3A 5C2F        C      	ld	a,(l5c8a)
  5C1B    47             C      	ld	b,a
  5C1C    18 05          C      	jr	l5c7e
  5C1E                   C      l5c79:
  5C1E    CD 5AF0        C      	call	l5b4b
  5C21    28 0A          C      	jr	z,l5c88
  5C23                   C      l5c7e:
  5C23    CD 5C4B        C      	call	l5ca6
  5C26    10 F6          C      	djnz	l5c79
  5C28    CD 5C31        C      	call	l5c8c
  5C2B    18 F1          C      	jr	l5c79
  5C2D                   C      l5c88:
  5C2D    78             C      	ld	a,b
  5C2E    FE 03          C      	cp	3
  5C2F                   C      l5c8a	equ	$-1
  5C30    D0             C      	ret	nc
  5C31                   C      l5c8c:
  5C31    2A 6317        C      	ld	hl,(LinePtr)	; Get line pointer
  5C34    3E 20          C      	ld	a,' '
  5C36                   C      l5c91:
  5C36    2B             C      	dec	hl
  5C37    BE             C      	cp	(hl)
  5C38    28 FC          C      	jr	z,l5c91
  5C3A    23             C      	inc	hl
  5C3B    36 FF          C      	ld	(hl),0ffh
  5C3D    CD 635B        C      	call	l63ce
  5C40    21 68AC        C      	ld	hl,l691f
  5C43    22 6317        C      	ld	(LinePtr),hl	; Set line pointer
  5C46    3A 5C2F        C      	ld	a,(l5c8a)
  5C49    47             C      	ld	b,a
  5C4A    C9             C      	ret
  5C4B                   C      l5ca6:
  5C4B    C5             C      	push	bc
  5C4C    CD 4302        C      	call	l435d
  5C4F    E6 0F          C      	and	0fh
  5C51    23             C      	inc	hl
  5C52    5E             C      	ld	e,(hl)
  5C53    23             C      	inc	hl
  5C54    56             C      	ld	d,(hl)
  5C55    EB             C      	ex	de,hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-392


  5C56    CD 0D1C        C      	call	l0d36
  5C59    21 6314        C      	ld	hl,l6387
  5C5C    36 00          C      	ld	(hl),0
  5C5E    EB             C      	ex	de,hl
  5C5F    3A 6819        C      	ld	a,(l688c)
  5C62    B7             C      	or	a
  5C63    4F             C      	ld	c,a
  5C64    28 02          C      	jr	z,l5cc3
  5C66    23             C      	inc	hl
  5C67    23             C      	inc	hl
  5C68                   C      l5cc3:
  5C68    23             C      	inc	hl
  5C69    7E             C      	ld	a,(hl)
  5C6A    3C             C      	inc	a
  5C6B    20 12          C      	jr	nz,l5cda
  5C6D    11 0003        C      	ld	de,3
  5C70    B1             C      	or	c
  5C71    20 02          C      	jr	nz,l5cd0
  5C73    1E 05          C      	ld	e,5
  5C75                   C      l5cd0:
  5C75    19             C      	add	hl,de
  5C76    7E             C      	ld	a,(hl)
  5C77    23             C      	inc	hl
  5C78    66             C      	ld	h,(hl)
  5C79    6F             C      	ld	l,a
  5C7A    3E 08          C      	ld	a,8
  5C7C    93             C      	sub	e
  5C7D    5F             C      	ld	e,a
  5C7E    19             C      	add	hl,de
  5C7F                   C      l5cda:
  5C7F    2B             C      	dec	hl
  5C80    ED 5B 6317     C      	ld	de,(LinePtr)	; Get line pointer
  5C84    06 10          C      	ld	b,16
  5C86                   C      l5ce1:
  5C86    CD 45E7        C      	call	l4642
  5C89    28 04          C      	jr	z,l5cea
  5C8B    12             C      	ld	(de),a
  5C8C    13             C      	inc	de
  5C8D    10 F7          C      	djnz	l5ce1
  5C8F                   C      l5cea:
  5C8F    04             C      	inc	b
  5C90    3E 20          C      	ld	a,' '
  5C92                   C      l5ced:
  5C92    12             C      	ld	(de),a
  5C93    13             C      	inc	de
  5C94    10 FC          C      	djnz	l5ced
  5C96    ED 53 6317     C      	ld	(LinePtr),de	; .. save line pointer
  5C9A    C1             C      	pop	bc
  5C9B    C9             C      	ret
  5C9C                   C      l5cf7:
  5C9C    CD 5ADA        C      	call	l5b35
  5C9F                   C      l5cfa:
  5C9F    CD 5AF0        C      	call	l5b4b
  5CA2    C8             C      	ret	z
  5CA3    23             C      	inc	hl
  5CA4    23             C      	inc	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-393


  5CA5    23             C      	inc	hl
  5CA6    5E             C      	ld	e,(hl)
  5CA7    23             C      	inc	hl
  5CA8    56             C      	ld	d,(hl)
  5CA9    E5             C      	push	hl
  5CAA    13             C      	inc	de
  5CAB    13             C      	inc	de
  5CAC    62             C      	ld	h,d
  5CAD    6B             C      	ld	l,e
  5CAE    29             C      	add	hl,hl
  5CAF    19             C      	add	hl,de
  5CB0    44             C      	ld	b,h		; Get amount
  5CB1    4D             C      	ld	c,l
  5CB2    CD 229A        C      	call	d.alloc_	; .. allocate
  5CB5    EB             C      	ex	de,hl
  5CB6    E1             C      	pop	hl
  5CB7    72             C      	ld	(hl),d
  5CB8    2B             C      	dec	hl
  5CB9    73             C      	ld	(hl),e
  5CBA    D5             C      	push	de
  5CBB    62             C      	ld	h,d
  5CBC    6B             C      	ld	l,e
  5CBD    13             C      	inc	de
  5CBE    36 00          C      	ld	(hl),0
  5CC0    0B             C      	dec	bc
  5CC1    0B             C      	dec	bc
  5CC2    ED B0          C      	ldir
  5CC4    D1             C      	pop	de
  5CC5    72             C      	ld	(hl),d
  5CC6    2B             C      	dec	hl
  5CC7    73             C      	ld	(hl),e
  5CC8    18 D5          C      	jr	l5cfa
  5CCA                   C      l5d25:
  5CCA    43 72 6F 73    C      	db	'Cross Reference:',eot
  5CCE    73 20 52 65    C      
  5CD2    66 65 72 65    C      
  5CD6    6E 63 65 3A    C      
  5CDA    FF             C      
  5CDB                   C      l5d36:
  5CDB    21 5CCA        C      	ld	hl,l5d25
  5CDE    11 63C9        C      	ld	de,@MES@
  5CE1    01 0011        C      	ld	bc,l5d36-l5d25
  5CE4    ED B0          C      	ldir			; Unpack message
  5CE6    3A 62C1        C      	ld	a,(_CON.WID_)	; Get console width
  5CE9    6F             C      	ld	l,a
  5CEA    26 00          C      	ld	h,0
  5CEC    11 FFE8        C      	ld	de,-24
  5CEF    19             C      	add	hl,de
  5CF0    11 0006        C      	ld	de,l0006
  5CF3    CD 3A14        C      	call	l3a6f
  5CF6    7D             C      	ld	a,l
  5CF7    32 5D72        C      	ld	(l5dcd),a
  5CFA    21 6314        C      	ld	hl,l6387
  5CFD    36 00          C      	ld	(hl),0
  5CFF    21 68AC        C      	ld	hl,l691f
  5D02    22 6317        C      	ld	(LinePtr),hl	; Init line pointer
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-394


  5D05    3E C9          C      	ld	a,_RET		; Set RET
  5D07    32 07D7        C      	ld	(l07f1),a
  5D0A    CD 5ADA        C      	call	l5b35
  5D0D    CD 5AF0        C      	call	l5b4b
  5D10    C8             C      	ret	z
  5D11    CD 5D7E        C      	call	l5dd9
  5D14    18 04          C      	jr	l5d75
  5D16                   C      l5d71:
  5D16    CD 5AF0        C      	call	l5b4b
  5D19    C8             C      	ret	z
  5D1A                   C      l5d75:
  5D1A    11 68AC        C      	ld	de,l691f
  5D1D    ED 53 6317     C      	ld	(LinePtr),de	; Init line pointer
  5D21    E5             C      	push	hl
  5D22    CD 5C4B        C      	call	l5ca6
  5D25    E1             C      	pop	hl
  5D26    23             C      	inc	hl
  5D27    23             C      	inc	hl
  5D28    23             C      	inc	hl
  5D29    5E             C      	ld	e,(hl)
  5D2A    23             C      	inc	hl
  5D2B    56             C      	ld	d,(hl)
  5D2C    EB             C      	ex	de,hl
  5D2D                   C      l5d88:
  5D2D    5E             C      	ld	e,(hl)
  5D2E    AF             C      	xor	a
  5D2F    77             C      	ld	(hl),a
  5D30    23             C      	inc	hl
  5D31    56             C      	ld	d,(hl)
  5D32    77             C      	ld	(hl),a
  5D33    23             C      	inc	hl
  5D34    77             C      	ld	(hl),a
  5D35    23             C      	inc	hl
  5D36    7A             C      	ld	a,d
  5D37    B3             C      	or	e
  5D38    28 F3          C      	jr	z,l5d88
  5D3A    2A 6317        C      	ld	hl,(LinePtr)	; Get line pointer
  5D3D    EB             C      	ex	de,hl
  5D3E                   C      l5d99:
  5D3E    3A 5D72        C      	ld	a,(l5dcd)
  5D41    47             C      	ld	b,a
  5D42                   C      l5d9d:
  5D42    7E             C      	ld	a,(hl)
  5D43    23             C      	inc	hl
  5D44    B6             C      	or	(hl)
  5D45    23             C      	inc	hl
  5D46    B6             C      	or	(hl)
  5D47    28 27          C      	jr	z,l5dcb
  5D49    2B             C      	dec	hl
  5D4A    2B             C      	dec	hl
  5D4B    C5             C      	push	bc
  5D4C    3E 05          C      	ld	a,5
  5D4E    CD 33A2        C      	call	BCDtoASC.	; Convert to ASCII
  5D51    3E 20          C      	ld	a,' '
  5D53    12             C      	ld	(de),a
  5D54    13             C      	inc	de
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-395


  5D55    C1             C      	pop	bc
  5D56    10 EA          C      	djnz	l5d9d
  5D58    E5             C      	push	hl
  5D59    1B             C      	dec	de
  5D5A    ED 53 6317     C      	ld	(LinePtr),de	; Set line pointer
  5D5E    CD 5C31        C      	call	l5c8c
  5D61    21 68AC        C      	ld	hl,l691f
  5D64    3E 09          C      	ld	a,9
  5D66    77             C      	ld	(hl),a
  5D67    23             C      	inc	hl
  5D68    77             C      	ld	(hl),a
  5D69    23             C      	inc	hl
  5D6A    77             C      	ld	(hl),a
  5D6B    23             C      	inc	hl
  5D6C    EB             C      	ex	de,hl
  5D6D    E1             C      	pop	hl
  5D6E    18 CE          C      	jr	l5d99
  5D70                   C      l5dcb:
  5D70    78             C      	ld	a,b
  5D71    FE 09          C      	cp	9
  5D72                   C      l5dcd	equ	$-1
  5D73    30 A1          C      	jr	nc,l5d71
  5D75    1B             C      	dec	de
  5D76    3E FF          C      	ld	a,0ffh
  5D78    12             C      	ld	(de),a
  5D79    CD 635B        C      	call	l63ce
  5D7C    18 98          C      	jr	l5d71
  5D7E                   C      l5dd9:
  5D7E    3A 62C2        C      	ld	a,(_LST.PAG_)	; Get page length
  5D81    32 661C        C      	ld	(l668f),a	; .. save
  5D84    C9             C      	ret
                         C      ;
                         C      ; Error entry - process error on pass 2 only and restart
                         C      ; ENTRY	Reg HL points to error message - start with length
                         C      ;
  5D85                   C      ERROR?RES:
  5D85    CD 5D8E        C      	call	ERROR?		; Process error on pass 2
  5D88    C3 0B87        C      	jp	EndOfASM	; Restart
                         C      ;
                         C      ; Error entry - bypass error counter
                         C      ; ENTRY	Reg HL points to error message - start with length
                         C      ;
  5D8B                   C      DO$ERROR:
  5D8B    E5             C      	push	hl		; .. save message
  5D8C    18 18          C      	jr	l5e01		; .. bypass
                         C      ;
                         C      ; Error entry - process error on pass 2 only
                         C      ; ENTRY	Reg HL points to error message - start with length
                         C      ;
  5D8E                   C      ERROR?:
  5D8E    3A 6617        C      	ld	a,(Pass)
  5D91    B7             C      	or	a
  5D92    C8             C      	ret	z		; .. exit on pass 1
                         C      ;
                         C      ; Error entry
                         C      ; ENTRY	Reg HL points to error message - start with length
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-396


                         C      ;
  5D93                   C      DO.ERROR::
  5D93    E5             C      	push	hl
  5D94    2A 67BB        C      	ld	hl,(ErrCnt)
  5D97    23             C      	inc	hl		; Bump error count
  5D98    22 67BB        C      	ld	(ErrCnt),hl
  5D9B    3A 0129        C      	ld	a,($NUMER$)	; Get error count
  5D9E    5F             C      	ld	e,a
  5D9F    AF             C      	xor	a
  5DA0    57             C      	ld	d,a
  5DA1    ED 52          C      	sbc	hl,de		; Test limit reached
  5DA3    CA 5F2B        C      	jp	z,l5f86		; .. yeap
  5DA6                   C      l5e01:
  5DA6    11 6B5D        C      	ld	de,$ERRLIN
  5DA9    CD 5E63        C      	call	CnvFCB$		; Put file name into line
  5DAC    EB             C      	ex	de,hl
  5DAD    36 20          C      	ld	(hl),' '
  5DAF    23             C      	inc	hl
  5DB0    36 2D          C      	ld	(hl),'-'
  5DB2    23             C      	inc	hl
  5DB3    36 20          C      	ld	(hl),' '
  5DB5    23             C      	inc	hl
  5DB6    EB             C      	ex	de,hl
  5DB7    E1             C      	pop	hl
  5DB8    CD 5E9C        C      	call	ldir.8		; .. copy message
  5DBB    3A 6617        C      	ld	a,(Pass)
  5DBE    FE 03          C      	cp	3		; Test special pass
  5DC0    CA 5E35        C      	jp	z,l5e90		; .. yeap
  5DC3    21 5E5C        C      	ld	hl,$LINE
  5DC6    CD 5E9C        C      	call	ldir.8		; .. copy line message
  5DC9    21 67FA        C      	ld	hl,CurLine
  5DCC    3E 05          C      	ld	a,5
  5DCE    CD 339E        C      	call	BCDtoASC.0	; Convert line number
  5DD1                   C      l5e2c:
  5DD1    EB             C      	ex	de,hl
  5DD2    36 0D          C      	ld	(hl),cr		; Close line
  5DD4    23             C      	inc	hl
  5DD5    36 0A          C      	ld	(hl),lf
  5DD7    23             C      	inc	hl
  5DD8    36 FF          C      	ld	(hl),-1
  5DDA    21 6B5D        C      	ld	hl,$ERRLIN	; Point to source
  5DDD                   C      l5e38:
  5DDD    E5             C      	push	hl
  5DDE    3A 5FA0        C      	ld	a,(l5ffb)
  5DE1    B7             C      	or	a
  5DE2    CC 0895        C      	call	z,l08af
  5DE5    21 60D0        C      	ld	hl,l6143
  5DE8    46             C      	ld	b,(hl)
  5DE9    AF             C      	xor	a
  5DEA    77             C      	ld	(hl),a
  5DEB    21 6077        C      	ld	hl,l60ea
  5DEE    4E             C      	ld	c,(hl)
  5DEF    77             C      	ld	(hl),a
  5DF0    E1             C      	pop	hl
  5DF1    C5             C      	push	bc
  5DF2    E5             C      	push	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-397


  5DF3    3A 5FA0        C      	ld	a,(l5ffb)
  5DF6    B7             C      	or	a
  5DF7    28 0F          C      	jr	z,l5e63
  5DF9    21 5FC0        C      	ld	hl,l601b
  5DFC    46             C      	ld	b,(hl)
  5DFD    36 C9          C      	ld	(hl),_RET	; Set return
  5DFF    21 60C4        C      	ld	hl,l6137
  5E02    4E             C      	ld	c,(hl)
  5E03    36 C9          C      	ld	(hl),_RET
  5E05    E1             C      	pop	hl
  5E06    C5             C      	push	bc
  5E07    E5             C      	push	hl
  5E08                   C      l5e63:
  5E08    E1             C      	pop	hl
  5E09    CD 5FA8        C      	call	PrStrg		; Print
  5E0C    21 026D        C      	ld	hl,$SRCline$	; Get line
  5E0F    7E             C      	ld	a,(hl)
  5E10    FE 1A          C      	cp	eof		; Test end of file
  5E12    28 08          C      	jr	z,l5e77		; .. yeap
  5E14    E5             C      	push	hl
  5E15    CD 0895        C      	call	l08af
  5E18    E1             C      	pop	hl
  5E19    CD 5FA8        C      	call	PrStrg		; Print error line
  5E1C                   C      l5e77:
  5E1C    3A 5FA0        C      	ld	a,(l5ffb)
  5E1F    B7             C      	or	a
  5E20    28 09          C      	jr	z,l5e86
  5E22    C1             C      	pop	bc
  5E23    78             C      	ld	a,b
  5E24    32 5FC0        C      	ld	(l601b),a
  5E27    79             C      	ld	a,c
  5E28    32 60C4        C      	ld	(l6137),a
  5E2B                   C      l5e86:
  5E2B    C1             C      	pop	bc
  5E2C    78             C      	ld	a,b
  5E2D    32 60D0        C      	ld	(l6143),a
  5E30    79             C      	ld	a,c
  5E31    32 6077        C      	ld	(l60ea),a
  5E34    C9             C      	ret
  5E35                   C      l5e90:
  5E35    21 5E55        C      	ld	hl,$ADDR
  5E38    CD 5E9C        C      	call	ldir.8		; Copy address message
  5E3B    21 6314        C      	ld	hl,l6387
  5E3E    34             C      	inc	(hl)
  5E3F    34             C      	inc	(hl)
  5E40    FD E5          C      	push	iy
  5E42    E1             C      	pop	hl
  5E43    2B             C      	dec	hl
  5E44    3A 67F1        C      	ld	a,($REL$)	; Get mode
  5E47    ED 53 6317     C      	ld	(LinePtr),de	; Save line pointer
  5E4B    CD 0D1C        C      	call	l0d36
  5E4E    ED 5B 6317     C      	ld	de,(LinePtr)	; Get back line pointer
  5E52    C3 5DD1        C      	jp	l5e2c
  5E55                   C      $ADDR:
  5E55    06 20 41 64    C      	db	6,' Addr '
  5E59    64 72 20       C      
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-398


  5E5C                   C      $LINE:
  5E5C    06 20 4C 69    C      	db	6,' Line '
  5E60    6E 65 20       C      
                         C      ;
                         C      ; Put file name into line
                         C      ; ENTRY	Reg DE points to buffer
                         C      ;
  5E63                   C      CnvFCB$:
  5E63    2A 67F4        C      	ld	hl,(l6867)	; Get FCB
  5E66    CB 7E          C      	bit	@MSB,(hl)	; Test defined
  5E68    20 25          C      	jr	nz,l5eea	; .. nope
  5E6A    23             C      	inc	hl
  5E6B    01 0008        C      	ld	bc,@nam
  5E6E                   C      l5ec9:
  5E6E    7E             C      	ld	a,(hl)		; Get file name
  5E6F    E6 7F          C      	and	NoMSB
  5E71    FE 20          C      	cp	' '
  5E73    28 08          C      	jr	z,l5ed8		; .. end on blank
  5E75    12             C      	ld	(de),a		; .. else unpack
  5E76    23             C      	inc	hl
  5E77    13             C      	inc	de
  5E78    0B             C      	dec	bc
  5E79    78             C      	ld	a,b
  5E7A    B1             C      	or	c
  5E7B    20 F1          C      	jr	nz,l5ec9
  5E7D                   C      l5ed8:
  5E7D    09             C      	add	hl,bc		; Point to end
  5E7E    BE             C      	cp	(hl)		; Test same
  5E7F    C8             C      	ret	z		; .. yeap
  5E80    3E 2E          C      	ld	a,'.'
  5E82    12             C      	ld	(de),a		; Set delimiter
  5E83    13             C      	inc	de
  5E84    06 03          C      	ld	b,@ext
  5E86                   C      l5ee1:
  5E86    7E             C      	ld	a,(hl)		; Copy extension
  5E87    E6 7F          C      	and	NoMSB
  5E89    12             C      	ld	(de),a
  5E8A    13             C      	inc	de
  5E8B    23             C      	inc	hl
  5E8C    10 F8          C      	djnz	l5ee1
  5E8E    C9             C      	ret
  5E8F                   C      l5eea:
  5E8F    23             C      	inc	hl		; .. skip
  5E90    7E             C      	ld	a,(hl)		; Fetch address
  5E91    23             C      	inc	hl
  5E92    66             C      	ld	h,(hl)
  5E93    6F             C      	ld	l,a
  5E94                   C      l5eef:
  5E94    CD 45E7        C      	call	l4642
  5E97    C8             C      	ret	z
  5E98    12             C      	ld	(de),a
  5E99    13             C      	inc	de
  5E9A    18 F8          C      	jr	l5eef
                         C      ;
                         C      ; Copy message
                         C      ; ENTRY	Reg HL points to source started with length
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-399


                         C      ;	Reg DE points to destination
                         C      ;
  5E9C                   C      ldir.8:
  5E9C    4E             C      	ld	c,(hl)		; Fetch length
  5E9D    23             C      	inc	hl
  5E9E    06 00          C      	ld	b,0		; .. expand
  5EA0    ED B0          C      	ldir			; .. unpack
  5EA2    C9             C      	ret
  5EA3                   C      l5efe:
  5EA3    21 6B5D        C      	ld	hl,$ERRLIN
  5EA6    C3 6134        C      	jp	PutStr		; .. print
                         C      ;
                         C      ; Do BDOS function
                         C      ; ENTRY	Reg C holds function
                         C      ;
  5EA9                   C      .BDOS:
  5EA9    CD 618F        C      	call	push.r		; Push regs
  5EAC    0C             C      	inc	c		; Test warm start
  5EAD    0D             C      	dec	c
  5EAE    CA 0000        C      	jp	z,OS		; .. yeap
  5EB1    CD 0005        C      	call	BDOS		; Do the function
  5EB4    CD 61AE        C      	call	pop.r		; Pop regs
  5EB7    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  5EB8                   C      l5f13:
  5EB8    1A FF          C      	db	eof,eot
  5EBA                   C      l5f15:
  5EBA    21 03ED        C      	ld	hl,l0400
  5EBD    ED 5B 69EC     C      	ld	de,(l6a5f)	; Get count
  5EC1    B7             C      	or	a
  5EC2    ED 52          C      	sbc	hl,de
  5EC4    28 3D          C      	jr	z,l5f5e
  5EC6    29             C      	add	hl,hl
  5EC7    E5             C      	push	hl
  5EC8    2C             C      	inc	l
  5EC9    2D             C      	dec	l
  5ECA    28 10          C      	jr	z,l5f37
  5ECC    21 5EB8        C      	ld	hl,l5f13
  5ECF    CD 5FC0        C      	call	l601b
  5ED2    3A 69ED        C      	ld	a,(l6a5f+1)
  5ED5    E1             C      	pop	hl
  5ED6    FE 04          C      	cp	4
  5ED8    28 29          C      	jr	z,l5f5e
  5EDA    24             C      	inc	h
  5EDB    E5             C      	push	hl
  5EDC                   C      l5f37:
  5EDC    2A 69F2        C      	ld	hl,(WrFCBc)	; Get current FCB
  5EDF    7C             C      	ld	a,h
  5EE0    B5             C      	or	l
  5EE1    28 31          C      	jr	z,l5f6f		; .. none
  5EE3    C1             C      	pop	bc
  5EE4    CD 618F        C      	call	push.r		; Push regs
  5EE7    C5             C      	push	bc
  5EE8    7E             C      	ld	a,(hl)		; Get disk
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-400


  5EE9    3D             C      	dec	a
  5EEA    CD 6180        C      	call	SetDsk		; .. log it
  5EED    C1             C      	pop	bc
  5EEE    3A 0126        C      	ld	a,($MULS$)	; Test multi sector enabled
  5EF1    B7             C      	or	a
  5EF2    20 22          C      	jr	nz,l5f71	; .. yeap
  5EF4    2A 69F0        C      	ld	hl,(FilBuf)	; Get buffer
  5EF7                   C      l5f52:
  5EF7    CD 601B        C      	call	WrLock		; .. write it
  5EFA    11 0080        C      	ld	de,RecLng
  5EFD    19             C      	add	hl,de
  5EFE    10 F7          C      	djnz	l5f52
  5F00                   C      l5f5b:
  5F00    CD 61AE        C      	call	pop.r		; Pop regs
  5F03                   C      l5f5e:
  5F03    ED 5B 69F2     C      	ld	de,(WrFCBc)	; Get current FCB
  5F07    7A             C      	ld	a,d
  5F08    B3             C      	or	e
  5F09    C8             C      	ret	z		; .. none
                         C      ;
                         C      ; Close file and diasable access
                         C      ; ENTRY	Reg DE points to FCB
                         C      ;
  5F0A                   C      FClose:
  5F0A    D5             C      	push	de
  5F0B    0E 10          C      	ld	c,.close
  5F0D    CD 5EA9        C      	call	.BDOS		; Close file
  5F10    E1             C      	pop	hl
  5F11    36 FF          C      	ld	(hl),-1		; .. disable
  5F13    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  5F14                   C      l5f6f:
  5F14    E1             C      	pop	hl
  5F15    C9             C      	ret
  5F16                   C      l5f71:
  5F16    58             C      	ld	e,b
  5F17    0E 2C          C      	ld	c,.mulsec
  5F19    CD 0005        C      	call	BDOS		; Set sectors
  5F1C    2A 69F0        C      	ld	hl,(FilBuf)	; Get buffer
  5F1F    CD 601B        C      	call	WrLock		; .. write
  5F22    1E 08          C      	ld	e,@SEC@
  5F24    0E 2C          C      	ld	c,.mulsec
  5F26    CD 0005        C      	call	BDOS		; .. reset to default
  5F29    18 D5          C      	jr	l5f5b
  5F2B                   C      l5f86:
  5F2B    3E C9          C      	ld	a,_RET		; Set return
  5F2D    32 5FC0        C      	ld	(l601b),a
  5F30    11 686A        C      	ld	de,LstFCB
  5F33    1A             C      	ld	a,(de)		; Get drive of list file
  5F34    FE 11          C      	cp	'P'-'A'+2
  5F36    DC 5F0A        C      	call	c,FClose	; Close file
  5F39                   C      l5f94:
  5F39    3E FF          C      	ld	a,0ffh
  5F3B    32 62BE        C      	ld	(l6331),a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-401


  5F3E    21 612D        C      	ld	hl,l61a0
  5F41    C3 5D85        C      	jp	ERROR?RES	; .. process error and abort
  5F44                   C      l5f9f:
  5F44    21 60D0        C      	ld	hl,l6143
  5F47                   C      l5fa2:
  5F47    7E             C      	ld	a,(hl)
  5F48    EE C9          C      	xor	0c9h
  5F4A    77             C      	ld	(hl),a
  5F4B    AF             C      	xor	a
  5F4C    32 6077        C      	ld	(l60ea),a
  5F4F    3A 60D0        C      	ld	a,(l6143)
  5F52    B7             C      	or	a
  5F53    C8             C      	ret	z
  5F54    3A 60C4        C      	ld	a,(l6137)
  5F57    32 6077        C      	ld	(l60ea),a
  5F5A    C9             C      	ret
                         C      ;
                         C      ; Test character available from keyboard
                         C      ;
  5F5B                   C      IsChar:
  5F5B    CD 618F        C      	call	push.r		; Push regs
  5F5E    CD 5F65        C      	call	IsChar.		; Process key
  5F61    CD 61AE        C      	call	pop.r		; Pop regs
  5F64    C9             C      	ret
                         C      ;
                         C      ; Test character available from keyboard
                         C      ;
  5F65                   C      IsChar.:
  5F65    3A 62BF        C      	ld	a,(CON.ena)	; Test console enabled
  5F68    B7             C      	or	a
  5F69    C0             C      	ret	nz		; .. nope
  5F6A    21 661B        C      	ld	hl,l668e
  5F6D    36 08          C      	ld	(hl),8
  5F6F    0E 0B          C      	ld	c,.consta
  5F71    CD 0005        C      	call	BDOS		; Test key
  5F74    B7             C      	or	a
  5F75    C8             C      	ret	z
                         C      ;
                         C      ; Get key
                         C      ;
  5F76                   C      Conin:
  5F76    0E 01          C      	ld	c,.conin
  5F78    CD 0005        C      	call	BDOS		; Get key
  5F7B    FE 03          C      	cp	'C'-'@'
  5F7D    28 AC          C      	jr	z,l5f86
  5F7F    FE 1A          C      	cp	'Z'-'@'
  5F81    28 C1          C      	jr	z,l5f9f
  5F83    FE 13          C      	cp	'S'-'@'
  5F85    28 EF          C      	jr	z,Conin
  5F87    FE 10          C      	cp	'P'-'@'
  5F89    28 16          C      	jr	z,l5ffc
  5F8B    FE 3F          C      	cp	'?'
  5F8D    C0             C      	ret	nz
  5F8E    21 5FA0        C      	ld	hl,l5ffb
  5F91    7E             C      	ld	a,(hl)
  5F92    B7             C      	or	a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-402


  5F93    C0             C      	ret	nz
  5F94    35             C      	dec	(hl)
  5F95    21 5FA6        C      	ld	hl,l6001
  5F98    CD 5D8B        C      	call	DO$ERROR	; Print question mark
  5F9B    AF             C      	xor	a
  5F9C    32 5FA0        C      	ld	(l5ffb),a
  5F9F    C9             C      	ret
  5FA0                   C      l5ffb:
  5FA0    00             C      	db	0
  5FA1                   C      l5ffc:
  5FA1    21 60C4        C      	ld	hl,l6137
  5FA4    18 A1          C      	jr	l5fa2
  5FA6                   C      l6001:
  5FA6    01 3F          C      	db	1,'?'
                         C      ;
                         C      ; Print string ?????????????????????
                         C      ; ENTRY	Reg HL points to string closed by -1
                         C      ;
  5FA8                   C      PrStrg:
                         C      	_GO
  5FA8    00             C+     	nop
  5FA9    E5             C      	push	hl
  5FAA    CD 6077        C      	call	l60ea		; Print string
  5FAD    21 661B        C      	ld	hl,l668e
  5FB0    35             C      	dec	(hl)
  5FB1    CC 5F5B        C      	call	z,IsChar	; Check character
  5FB4    3E 02          C      	ld	a,2
  5FB6    CD 604A        C      	call	SelFile		; Get file
  5FB9    E1             C      	pop	hl
  5FBA    E5             C      	push	hl
  5FBB    CD 5FC0        C      	call	l601b
  5FBE    E1             C      	pop	hl
  5FBF    C9             C      	ret
                         C      ;
                         C      ; String ?????
                         C      ; ENTRY	Reg HL points to string closed by -1
                         C      ;
  5FC0                   C      l601b:
  5FC0    C9             C      	ret
  5FC1                   C      l601c:
  5FC1    ED 5B 69EE     C      	ld	de,(l6a61)	; Get destination
  5FC5    ED 4B 69EC     C      	ld	bc,(l6a5f)	; .. and remainder
  5FC9                   C      l6024:
  5FC9    3E FF          C      	ld	a,-1		; Get end marker
  5FCB                   C      l6026:
  5FCB    BE             C      	cp	(hl)		; Test end
  5FCC    28 3B          C      	jr	z,l6064		; .. yeap
  5FCE    ED A0          C      	ldi			; Unpack
  5FD0    EA 5FCB        C      	jp	pe,l6026
  5FD3    E5             C      	push	hl
  5FD4    CD 5FE1        C      	call	WrToFile	; Write to disk
  5FD7    E1             C      	pop	hl
  5FD8    ED 5B 69F0     C      	ld	de,(FilBuf)	; Get buffer
  5FDC    01 03ED        C      	ld	bc,l0400	; .. and length
  5FDF    18 E8          C      	jr	l6024
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-403


                         C      ; Write data to disk
                         C      ;
  5FE1                   C      WrToFile:
  5FE1    2A 69F2        C      	ld	hl,(WrFCBc)	; Get current FCB
  5FE4    7C             C      	ld	a,h
  5FE5    B5             C      	or	l
  5FE6    C8             C      	ret	z		; .. none
  5FE7    CD 618F        C      	call	push.r		; Push regs
  5FEA    7E             C      	ld	a,(hl)		; .. get disk
  5FEB    3D             C      	dec	a
  5FEC    CD 6180        C      	call	SetDsk		; .. log it
  5FEF    2A 69F0        C      	ld	hl,(FilBuf)	; Get buffer
  5FF2    06 08          C      	ld	b,@SEC@
  5FF4    3A 0126        C      	ld	a,($MULS$)	; Test multi sector enabled
  5FF7    B7             C      	or	a
  5FF8    28 02          C      	jr	z,l6057		; .. nope
  5FFA    06 01          C      	ld	b,1
  5FFC                   C      l6057:
  5FFC    CD 601B        C      	call	WrLock		; Write buffer
  5FFF    11 0080        C      	ld	de,RecLng
  6002    19             C      	add	hl,de		; .. fix pointer
  6003    10 F7          C      	djnz	l6057
  6005    CD 61AE        C      	call	pop.r		; Pop regs
  6008    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  6009                   C      l6064:
  6009    ED 53 69EE     C      	ld	(l6a61),de	; Save current
  600D    ED 43 69EC     C      	ld	(l6a5f),bc	; .. and remainder
  6011    AF             C      	xor	a
  6012    C8             C      	ret	z
  6013                   C      l606e:
  6013    42             C      	ld	b,d
  6014    53             C      	ld	d,e
  6015    15             C      	dec	d
  6016    03             C      	inc	bc
  6017    21 B73E        C      	ld	hl,lb73e
  601A    C9             C      	ret
                         C      ;
                         C      ; Write buffer(s) to disk if serial number is correct
                         C      ;
  601B                   C      WrLock:
  601B    E5             C      	push	hl
  601C    C5             C      	push	bc
  601D    D5             C      	push	de
                         C      ;
                         C      ; !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
                         C      ; !!! The next code is dirty tricky. It checks the serial  !!!
                         C      ; !!! number of the assembler and suspends execution if    !!!
                         C      ; !!! no match found against expected one                  !!!
                         C      ; !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
                         C      ;
                         C      ;	ld	hl,SN$ / 2	; Nice, isn't it
                         C      ;	ld	a,0		; .. more nice
                         C      ;	or	a		; .. dtto.
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-404


                         C      ;	rra			; .. dtto.
                         C      ;	adc	hl,hl		; .. dtto.
                         C      ;	ld	b,_SNlen
                         C      ;l6084:
                         C      ;	add	a,(hl)
                         C      ;	inc	hl
                         C      ;	djnz	l6084
                         C      ;	ld	de,SN_-SN$-_SNlen
                         C      ;	add	hl,de		; .. dtto.
                         C      ;	cp	(hl)
                         C      ;
                         C      ; !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
                         C      ;
                         C      ;	pop	de
                         C      ;	pop	bc
                         C      ;	pop	hl
                         C      ;	ret	nz		; .. unexpected S/N, so break
                         C      ; remove above bullshit
  601E    E5             C      	push	hl
  601F    C5             C      	push	bc
  6020    EB             C      	ex	de,hl
  6021    CD 6161        C      	call	SetDMA		; Set disk buffer
  6024    ED 5B 69F2     C      	ld	de,(WrFCBc)	; Get current FCB
  6028    0E 15          C      	ld	c,.wrseq
  602A    CD 0005        C      	call	BDOS		; Write sector
  602D    B7             C      	or	a		; Test success
  602E    28 09          C      	jr	z,l60ac
  6030    21 603C        C      	ld	hl,l60af
  6033    CD 611F        C      	call	PutStr.		; Tell disk full
  6036    C3 5F2B        C      	jp	l5f86
  6039                   C      l60ac:
  6039    C1             C      	pop	bc
  603A    E1             C      	pop	hl
  603B    C9             C      	ret
  603C                   C      l60af:
  603C    44 69 73 6B    C      	db	'Disk Full!!',cr,lf,eot
  6040    20 46 75 6C    C      
  6044    6C 21 21 0D    C      
  6048    0A FF          C      
                         C      ;
                         C      ; Select file
                         C      ; ENTRY	Accu holds file number
                         C      ;
  604A                   C      SelFile:
  604A    21 6796        C      	ld	hl,FilNum
  604D    BE             C      	cp	(hl)		; Test already set
  604E    C8             C      	ret	z
  604F    F5             C      	push	af
  6050    7E             C      	ld	a,(hl)		; Get current code
  6051    87             C      	add	a,a		; * 8
  6052    87             C      	add	a,a
  6053    87             C      	add	a,a
  6054    21 6734        C      	ld	hl,FIB.arr
  6057    4F             C      	ld	c,a
  6058    06 00          C      	ld	b,0
  605A    09             C      	add	hl,bc		; Get index
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-405


  605B    EB             C      	ex	de,hl
  605C    21 69EC        C      	ld	hl,CurFIB	; Get address
  605F    0E 08          C      	ld	c,8
  6061    ED B0          C      	ldir			; .. save current FIB
  6063    F1             C      	pop	af		; Get back new set up
  6064    32 6796        C      	ld	(FilNum),a	; .. save
  6067    87             C      	add	a,a
  6068    87             C      	add	a,a
  6069    87             C      	add	a,a
  606A    21 6734        C      	ld	hl,FIB.arr
  606D    4F             C      	ld	c,a		; .. again for index
  606E    09             C      	add	hl,bc
  606F    11 69EC        C      	ld	de,CurFIB	; Get address
  6072    0E 08          C      	ld	c,8
  6074    ED B0          C      	ldir			; .. get new current FIB
  6076    C9             C      	ret
                         C      ;
                         C      ; String ??????????????????
                         C      ; ENTRY	Reg HL points to string closed by zero
                         C      ;
  6077                   C      l60ea:
  6077    C9             C      	ret
  6078                   C      l60eb:				; ????????????????
  6078    CD 618F        C      	call	push.r		; Push regs
  607B    ED 4B 62C0     C      	ld	bc,(_CON.COL_)	; Get count and limit
  607F                   C      l60f2:
  607F    7E             C      	ld	a,(hl)		; Get character
  6080    B7             C      	or	a
  6081    FA 60A1        C      	jp	m,l6114		; .. end
  6084    23             C      	inc	hl
  6085    FE 20          C      	cp	' '		; Test control
  6087    38 20          C      	jr	c,l611c		; .. yeap
  6089                   C      l60fc:
  6089    57             C      	ld	d,a		; Save character
  608A    0C             C      	inc	c		; Bump column
  608B    78             C      	ld	a,b
  608C    B9             C      	cp	c		; Test line filled
  608D    38 06          C      	jr	c,l6108		; .. nope
  608F    7A             C      	ld	a,d
  6090    CD 60C1        C      	call	l6134		; .. print
  6093    18 EA          C      	jr	l60f2
  6095                   C      l6108:
  6095    3E 0D          C      	ld	a,cr
  6097    CD 60C1        C      	call	l6134		; Close line
  609A    3E 0A          C      	ld	a,lf
  609C    CD 60C1        C      	call	l6134
  609F    0E 00          C      	ld	c,0		; Clear column
  60A1                   C      l6114:
  60A1    ED 43 62C0     C      	ld	(_CON.COL_),bc	; Save values
  60A5    CD 61AE        C      	call	pop.r		; Pop regs
  60A8    C9             C      	ret
  60A9                   C      l611c:
  60A9    FE 09          C      	cp	tab		; Test tabulator
  60AB    28 09          C      	jr	z,l6129		; .. yeap
  60AD    0D             C      	dec	c		; Fix count
  60AE    FE 0D          C      	cp	cr		; Test return
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-406


  60B0    20 D7          C      	jr	nz,l60fc
  60B2    0E FF          C      	ld	c,-1		; .. clear count
  60B4    18 D3          C      	jr	l60fc
  60B6                   C      l6129:
  60B6    79             C      	ld	a,c		; Get count
  60B7    3C             C      	inc	a
  60B8    E6 07          C      	and	7		; .. mask
  60BA    3E 20          C      	ld	a,' '
  60BC    28 CB          C      	jr	z,l60fc		; .. Set blank
  60BE    2B             C      	dec	hl		; .. fix pointer
  60BF    18 C8          C      	jr	l60fc
                         C      ;
                         C      ;
                         C      ;
  60C1                   C      l6134:
  60C1    CD 60D0        C      	call	l6143
  60C4                   C      l6137:
  60C4    C9             C      	ret
                         C      ;
                         C      ; Put character to list device
                         C      ; ENTRY	Accu holds character
                         C      ;
  60C5                   C      PutLst:
  60C5    E5             C      	push	hl
  60C6    C5             C      	push	bc
  60C7    5F             C      	ld	e,a
  60C8    0E 05          C      	ld	c,.lstout
  60CA    CD 0005        C      	call	BDOS		; Put to printer
  60CD    C1             C      	pop	bc
  60CE    E1             C      	pop	hl
  60CF    C9             C      	ret
                         C      ;
                         C      ;
                         C      ;
  60D0                   C      l6143:
  60D0    C9             C      	ret
                         C      ;
                         C      ; Print character on console
                         C      ; ENTRY	Accu holds character
                         C      ;
  60D1                   C      PutCon:
  60D1    5F             C      	ld	e,a
  60D2    F5             C      	push	af
  60D3    3A 62BF        C      	ld	a,(CON.ena)	; Test console enabled
  60D6    B7             C      	or	a
  60D7    20 36          C      	jr	nz,l6182	; .. nope
  60D9    E5             C      	push	hl
  60DA    C5             C      	push	bc
  60DB    7B             C      	ld	a,e
  60DC    0E 06          C      	ld	c,.dircon
  60DE    FE 0C          C      	cp	ff		; Test form feed
  60E0    F5             C      	push	af
  60E1    C4 0005        C      	call	nz,BDOS		; Put to console if not
  60E4    21 661B        C      	ld	hl,l668e
  60E7    35             C      	dec	(hl)
  60E8    CC 5F65        C      	call	z,IsChar.	; Check character
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-407


  60EB    F1             C      	pop	af
  60EC    FE 0A          C      	cp	lf
  60EE    20 1D          C      	jr	nz,l6180
  60F0    21 6795        C      	ld	hl,l6808
  60F3                   C      l6166:
  60F3    34             C      	inc	(hl)
  60F4    28 FD          C      	jr	z,l6166
  60F6    3A 012A        C      	ld	a,($CONPAG$)
  60F9    BE             C      	cp	(hl)		; Test page filled
  60FA    20 11          C      	jr	nz,l6180	; .. nope
  60FC    36 00          C      	ld	(hl),0
  60FE    21 6111        C      	ld	hl,l6184
  6101    CD 611F        C      	call	PutStr.		; Test awaiting key
  6104    CD 5F76        C      	call	Conin		; Get quit
  6107    21 611D        C      	ld	hl,l6190
  610A    CD 611F        C      	call	PutStr.		; .. close line
  610D                   C      l6180:
  610D    C1             C      	pop	bc
  610E    E1             C      	pop	hl
  610F                   C      l6182:
  610F    F1             C      	pop	af
  6110    C9             C      	ret
                         C      ;
  6111                   C      l6184:
  6111    48 69 74 20    C      	db	'Hit Any Key',eot
  6115    41 6E 79 20    C      
  6119    4B 65 79 FF    C      
  611D                   C      l6190:
  611D    0D FF          C      	db	cr,eot
                         C      ;
                         C      ; Print string
                         C      ; ENTRY	Reg HL points to string closed by -1
                         C      ;
  611F                   C      PutStr.:
  611F    E5             C      	push	hl		; Save reg
  6120    18 04          C      	jr	l6199
  6122                   C      l6195:
  6122    23             C      	inc	hl
  6123    CD 60D1        C      	call	PutCon		; Print character
  6124                   C      $$IOvec	equ	$-2
  6126                   C      l6199:
  6126    7E             C      	ld	a,(hl)		; Get character
  6127    B7             C      	or	a		; Test printable
  6128    F2 6122        C      	jp	p,l6195		; .. yeap
  612B    E1             C      	pop	hl
  612C    C9             C      	ret
                         C      ;
  612D                   C      l61a0:
  612D    06 41 62 6F    C      	db	6,'Abort!'
  6131    72 74 21       C      
                         C      ;
                         C      ; Print string
                         C      ; ENTRY	Reg HL points to string closed by -1
                         C      ;
  6134                   C      PutStr:
  6134    CD 618F        C      	call	push.r		; Push regs
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-408


  6137    CD 611F        C      	call	PutStr.		; Print string
  613A    CD 61AE        C      	call	pop.r		; Pop regs
  613D    C9             C      	ret
                         C      ;
                         C      ; Print control string to printer
                         C      ; ENTRY	Reg HL points to string closed by -1
                         C      ;
  613E                   C      LstCtrl:
  613E    3A 67F0        C      	ld	a,(LST.ena)	; Test LST: enabled
  6141    B7             C      	or	a
  6142    C8             C      	ret	z		; .. nope
  6143    11 60C5        C      	ld	de,PutLst	; Change vector
  6146    ED 53 6124     C      	ld	($$IOvec),de
  614A    E5             C      	push	hl
  614B    11 0008        C      	ld	de,l0008
  614E    19             C      	add	hl,de		; Set max for control
  614F    7E             C      	ld	a,(hl)
  6150    36 FF          C      	ld	(hl),-1		; .. force end
  6152    E3             C      	ex	(sp),hl
  6153    F5             C      	push	af
  6154    CD 6134        C      	call	PutStr		; Print on list device
  6157    F1             C      	pop	af
  6158    E1             C      	pop	hl
  6159    77             C      	ld	(hl),a
  615A    21 60D1        C      	ld	hl,PutCon	; Reset vector
  615D    22 6124        C      	ld	($$IOvec),hl
  6160    C9             C      	ret
                         C      ;
                         C      ; Set new disk buffer
                         C      ; ENTRY	Reg DE points to new buffer
                         C      ;
  6161                   C      SetDMA:
  6161    E5             C      	push	hl
  6162    2A 67D4        C      	ld	hl,(_DMA_)	; Get current buffer
  6165    B7             C      	or	a
  6166    ED 52          C      	sbc	hl,de		; Test new
  6168    28 0D          C      	jr	z,l61ea		; .. nope, so skip setting
  616A    ED 53 67D4     C      	ld	(_DMA_),de	; .. set new
  616E    D5             C      	push	de
  616F    C5             C      	push	bc
  6170    0E 1A          C      	ld	c,.setdma
  6172    CD 0005        C      	call	BDOS		; Set disk buffer
  6175    C1             C      	pop	bc
  6176    D1             C      	pop	de
  6177                   C      l61ea:
  6177    E1             C      	pop	hl
  6178    C9             C      	ret
                         C      ;
                         C      ; Log new user
                         C      ; ENTRY	Accu holds user to be logged
                         C      ;
  6179                   C      SetUsr:
  6179    21 69F5        C      	ld	hl,LogUsr	; Get current logged
  617C    0E 20          C      	ld	c,.usrcod
  617E    18 05          C      	jr	l61f8
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-409


                         C      ; Log new disk
                         C      ; ENTRY	Accu holds disk to be logged
                         C      ;
  6180                   C      SetDsk:
  6180    21 69F4        C      	ld	hl,LogDsk	; Get current logged
  6183    0E 0E          C      	ld	c,.setdsk
  6185                   C      l61f8:
  6185    BE             C      	cp	(hl)		; Test new
  6186    C8             C      	ret	z		; .. nope
  6187    D5             C      	push	de
  6188    77             C      	ld	(hl),a		; Set new
  6189    5F             C      	ld	e,a
  618A    CD 0005        C      	call	BDOS		; Log DU
  618D    D1             C      	pop	de
  618E    C9             C      	ret
                         C      ;
                         C      ; Push alternate regs
                         C      ;
  618F                   C      push.r:
  618F    D9             C      	exx
  6190    E3             C      	ex	(sp),hl
  6191    D5             C      	push	de		; .. save regs
  6192    C5             C      	push	bc
  6193    DD E5          C      	push	ix
  6195    FD E5          C      	push	iy
  6197    E5             C      	push	hl
  6198    3A 67C2        C      	ld	a,(OS.Flg)	; Test warm start swap
  619B    B7             C      	or	a
  619C    28 08          C      	jr	z,l6219		; .. nope
  619E    ED 5B 4D7C     C      	ld	de,(OS.sav)
  61A2    ED 53 0001     C      	ld	(OS+1),de	; Change vector
  61A6                   C      l6219:
  61A6    D9             C      	exx
  61A7    3A 011E        C      	ld	a,($EI$)	; Test interrupts
  61AA    B7             C      	or	a
  61AB    C8             C      	ret	z		; .. nope
  61AC    FB             C      	ei			; Enable
  61AD    C9             C      	ret
                         C      ;
                         C      ; Pop alternate regs
                         C      ;
  61AE                   C      pop.r:
  61AE    F5             C      	push	af
  61AF    3A 011E        C      	ld	a,($EI$)	; Test interrupts
  61B2    B7             C      	or	a
  61B3    28 01          C      	jr	z,l6229		; .. nope
  61B5    F3             C      	di			; .. disable
  61B6                   C      l6229:
  61B6    3A 67C2        C      	ld	a,(OS.Flg)	; Test warm start change
  61B9    B7             C      	or	a
  61BA    28 08          C      	jr	z,l6237		; .. nope
  61BC    E5             C      	push	hl
  61BD    21 4D7E        C      	ld	hl,SLR.OS
  61C0    22 0001        C      	ld	(OS+1),hl	; .. set vector
  61C3    E1             C      	pop	hl
  61C4                   C      l6237:
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-410


  61C4    F1             C      	pop	af
  61C5    D9             C      	exx
  61C6    E1             C      	pop	hl		; .. restore
  61C7    FD E1          C      	pop	iy
  61C9    DD E1          C      	pop	ix
  61CB    C1             C      	pop	bc
  61CC    D1             C      	pop	de
  61CD    E3             C      	ex	(sp),hl
  61CE    D9             C      	exx
  61CF    C9             C      	ret
                         C      ;
                         C      ; Jump via register
                         C      ; ENTRY	Reg HL holds address to be executed
                         C      ;
  61D0                   C      jp.r.2:
  61D0    E9             C      	jp	(hl)
                         C      ;
                         C      ; Get TOD and convert to ASCII
                         C      ;
  61D1                   C      Get$TOD:
  61D1    CD 6259        C      	call	GetTOD		; Get current date
  61D4    3A 0125        C      	ld	a,($TOD.FORM$)	; Get format
  61D7    B7             C      	or	a
  61D8    C0             C      	ret	nz		; .. long, exit
  61D9                   C      .Get$TOD:
  61D9    2A 6A31        C      	ld	hl,(TOD.PB)	; Get date value
  61DC    2B             C      	dec	hl
  61DD    0E 02          C      	ld	c,2		; Init year
  61DF                   C      l6252:
  61DF    11 FE93        C      	ld	de,-365
  61E2    79             C      	ld	a,c
  61E3    E6 03          C      	and	3		; Test leap year
  61E5    20 01          C      	jr	nz,l625b
  61E7    1B             C      	dec	de		; .. fix if so
  61E8                   C      l625b:
  61E8    0C             C      	inc	c		; Bump year
  61E9    19             C      	add	hl,de		; .. fix
  61EA    38 F3          C      	jr	c,l6252
  61EC    ED 52          C      	sbc	hl,de		; Set year > 0
  61EE    E5             C      	push	hl
  61EF    0D             C      	dec	c
  61F0    79             C      	ld	a,c		; Get year count
  61F1    E6 03          C      	and	3		; Test leap year
  61F3    20 05          C      	jr	nz,l626d
  61F5    3E E3          C      	ld	a,-29		; Change february
  61F7    32 6292        C      	ld	(l6305),a
  61FA                   C      l626d:
  61FA    79             C      	ld	a,c
  61FB    C6 4C          C      	add	a,78-2		; Add base year
  61FD    6F             C      	ld	l,a
  61FE    26 00          C      	ld	h,0
  6200    11 6A27        C      	ld	de,$TOD$+7	; Point to year field
  6203    CD 34A2        C      	call	Out$DEC		; Get decimal
  6206    3E 20          C      	ld	a,' '
  6208    12             C      	ld	(de),a
  6209    E1             C      	pop	hl
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-411


  620A    11 628E        C      	ld	de,l6301
  620D    06 FF          C      	ld	b,-1		; Set high part
  620F                   C      l6282:
  620F    1A             C      	ld	a,(de)		; Get month
  6210    13             C      	inc	de
  6211    4F             C      	ld	c,a
  6212    09             C      	add	hl,bc		; Subtract
  6213    30 05          C      	jr	nc,l628d	; .. till < 0
  6215    13             C      	inc	de		; Skip ASCII month
  6216    13             C      	inc	de
  6217    13             C      	inc	de
  6218    18 F5          C      	jr	l6282
  621A                   C      l628d:
  621A    ED 42          C      	sbc	hl,bc		; Make > 0
  621C    E5             C      	push	hl
  621D    EB             C      	ex	de,hl
  621E    11 6A22        C      	ld	de,$TOD$+2	; Point to month field
  6221    3E 20          C      	ld	a,' '
  6223    12             C      	ld	(de),a
  6224    13             C      	inc	de
  6225    ED A0          C      	ldi			; Unpack month
  6227    ED A0          C      	ldi
  6229    ED A0          C      	ldi
  622B    12             C      	ld	(de),a
  622C    E1             C      	pop	hl
  622D    23             C      	inc	hl
  622E    11 6A20        C      	ld	de,$TOD$	; Get time base
  6231    7D             C      	ld	a,l
  6232    FE 0A          C      	cp	10		; Test range of day
  6234    30 04          C      	jr	nc,l62ad
  6236    3E 20          C      	ld	a,' '
  6238    12             C      	ld	(de),a		; .. give blank
  6239    13             C      	inc	de
  623A                   C      l62ad:
  623A    CD 34A2        C      	call	Out$DEC		; Get decimal
  623D    11 6A2A        C      	ld	de,$TOD$+10	; Point to hour field
  6240    21 6A33        C      	ld	hl,TOD.PB+2	; .. in PB, too
  6243    3E 02          C      	ld	a,2
  6245    CD 339E        C      	call	BCDtoASC.0	; Get BCD hour
  6248    3E 3A          C      	ld	a,':'
  624A    12             C      	ld	(de),a		; .. set delimiter
  624B    13             C      	inc	de
  624C    3E 02          C      	ld	a,2
  624E    CD 339E        C      	call	BCDtoASC.0	; Get minute
  6251    3E 20          C      	ld	a,' '
  6253    12             C      	ld	(de),a		; Set delimiter
  6254    13             C      	inc	de
  6255    3E FF          C      	ld	a,eot
  6257    12             C      	ld	(de),a		; .. and end
  6258    C9             C      	ret
                         C      ;
                         C      ; Get current date
                         C      ;
  6259                   C      GetTOD:
  6259    3A 62D2        C      	ld	a,(OSver)	; Test OS version
  625C    B7             C      	or	a
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-412


  625D    20 27          C      	jr	nz,l62f9	; .. not simple CP/M
  625F    2A 0123        C      	ld	hl,($TOD.DATA$)	; Get data base or address
  6262    11 6A31        C      	ld	de,TOD.PB
  6265    01 0004        C      	ld	bc,TODlen
  6268    3A 0125        C      	ld	a,($TOD.FORM$)	; Test format
  626B    B7             C      	or	a
  626C    28 05          C      	jr	z,l62e6		; .. short
  626E    11 6A20        C      	ld	de,$TOD$
  6271    0E 11          C      	ld	c,$TODlen+1	; Change size
  6273                   C      l62e6:
  6273    3A 0122        C      	ld	a,($TOD.LOAD$)	; Test load
  6276    B7             C      	or	a
  6277    28 0A          C      	jr	z,l62f6		; .. yeap
  6279    CD 618F        C      	call	push.r		; Push regs
  627C    CD 61D0        C      	call	jp.r.2		; Execute address
  627F    CD 61AE        C      	call	pop.r		; Pop regs
  6282    C9             C      	ret
  6283                   C      l62f6:
  6283    ED B0          C      	ldir
  6285    C9             C      	ret
  6286                   C      l62f9:
  6286    0E 69          C      	ld	c,.getTOD
  6288    11 6A31        C      	ld	de,TOD.PB
  628B    C3 5EA9        C      	jp	.BDOS		; Get time and date
  628E                   C      l6301:
  628E    E1 4A 61 6E    C      	db	-31,'Jan'
  6292                   C      l6305:
  6292    E4 46 65 62    C      	db	-28,'Feb'
  6296    E1 4D 61 72    C      	db	-31,'Mar'
  629A    E2 41 70 72    C      	db	-30,'Apr'
  629E    E1 4D 61 79    C      	db	-31,'May'
  62A2    E2 4A 75 6E    C      	db	-30,'Jun'
  62A6    E1 4A 75 6C    C      	db	-31,'Jul'
  62AA    E1 41 75 67    C      	db	-31,'Aug'
  62AE    E2 53 65 70    C      	db	-30,'Sep'
  62B2    E1 4F 63 74    C      	db	-31,'Oct'
  62B6    E2 4E 6F 76    C      	db	-30,'Nov'
  62BA    E1 44 65 63    C      	db	-31,'Dec'
  62BE                   C      l6331:
  62BE    00             C      	db	0
  62BF                   C      CON.ena:
  62BF    00             C      	db	0		; 0 is CON: enabled
                         C      ;
                         C      ; Preset values
                         C      ;
  62C0                   C      _CON.COL_:
  62C0    00             C      	db	0		; Console column
  62C1                   C      _CON.WID_:
  62C1    50             C      	db	80		; Console width
  62C2                   C      _LST.PAG_:
  62C2    38             C      	db	56		; List page length
                         C      ;
                         C      ; Option mode
                         C      ;
                         C      ; b7b6	00	ABSOLUTE mode
                         C      ;	01	INTEL HEX mode
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-413


                         C      ;	11	MICROSOFT REL80
                         C      ;	10	SLR format
                         C      ;  b5	1	No conversion to UPPER case
                         C      ;  b4	1	Set all undefined as externals
                         C      ;  b3	1	Generate cross reference
                         C      ;  b2	1	Generate symbol file
                         C      ;  b1	1	Select one pass only
                         C      ;  b0	1	Select two passes, full listing
                         C      ;
  62C3                   C      _OPT_:
  62C3    00             C      	db	0
  62C4                   C      _FOUR_:
  62C4    00             C      	db	NO		; List more than four bytes
  62C5                   C      _FALSE_:
  62C5    00             C      	db	NO		; List lines during FALSE
  62C6                   C      _FF_:
  62C6    00             C      	db	NO		; Form feed at start
  62C7                   C      _MACRO_:
  62C7    02             C      	db	2		; Macro list option
  62C8                   C      _REL_:
  62C8    00             C      	db	NO		; Characters in symbol
  62C9                   C      _DIR_:
  62C9    00             C      	db	NO		; Direction of address printing
                         C      ;
                         C      ; End of preset
                         C      ;
  62CA                   C      IndFIB:
  62CA    0000           C      	dw	0
  62CC                   C      IndRec:
  62CC    00             C      	db	0
  62CD                   C      l6340:
  62CD    00             C      	db	0
  62CE                   C      IndUsr:
  62CE    00             C      	db	0
  62CF                   C      TotalErr:
  62CF    0000           C      	dw	0		; Total error count
  62D1                   C      Indirect:
  62D1    00             C      	db	0		; 0 is console, else file
  62D2                   C      OSver:
  62D2    00             C      	db	_CPM		; 0 Simple CP/M
                         C      				; 1 CP/M+
                         C      				; 2 MP/M
                         C      ;
                         C      ; Code table
                         C      ;
  62D3                   C      l6346:
  62D3    72 6A 73 69    C      	db	72h,6ah,73h,69h,null	; MEND
  62D7    00             C      
  62D8                   C      l634b:
  62D8    6A 73 69 72    C      	db	6ah,73h,69h,72h,null	; ENDM
  62DC    00             C      
  62DD                   C      l6350:
  62DD    72 66 68 77    C      	db	72h,66h,68h,77h,74h,null; MACRO
  62E1    74 00          C      
  62E3                   C      l6356:
  62E3    77 6A 75 79    C      	db	77h,6ah,75h,79h,null	; REPT
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-414


  62E7    00             C      
  62E8                   C      l635b:
  62E8    6E 77 75 00    C      	db	6eh,77h,75h,null	; IRP
  62EC                   C      l635f:
  62EC    6E 77 75 68    C      	db	6eh,77h,75h,68h,null	; IRPC
  62F0    00             C      
  62F1                   C      l6364:
  62F1    36             C      	db	36h
  62F2                   C      Empty:
  62F2    00             C      	db	0		; -1 if empty command line
  62F3                   C      Heap:
  62F3    0000           C      	dw	0
  62F5                   C      TokPtr:
  62F5    0000           C      	dw	0
  62F7                   C      CmdPtr:
  62F7    0000           C      	dw	0
  62F9                   C      l636c:
  62F9    00 00 00       C      	db	0,0,0
  62FC                   C      l636f:
  62FC    00             C      	db	0
  62FD                   C      l6370:
  62FD    0000           C      	dw	0
  62FF                   C      l6372:
  62FF    00             C      	db	0
  6300                   C      l6373:
  6300    0000           C      	dw	0
  6302                   C      l6375:
  6302    00             C      	db	0
  6303                   C      l6376:
  6303    0000           C      	dw	0
  6305                   C      l6378:
  6305    00             C      	db	0
  6306                   C      l6379::
  6306                   C      	ds	8
                         C      
  630E                   C      l6381	equ	$
  630F                   C      l6382	equ	l6381+1
  6311                   C      $PC$	equ	l6382+2
  6313                   C      l6386	equ	$PC$+2
  6314                   C      l6387	equ	l6386+1
  6315                   C      l6388	equ	l6387+1
  6316                   C      l6389	equ	l6388+1
  6317                   C      LinePtr	equ	l6389+1
  6319                   C      DynPtr1	equ	LinePtr+2
  631B                   C      DynPtr2	equ	DynPtr1+2
  631D                   C      SymPtr	equ	DynPtr2+2
                         C      ;
                         C      ; Jump table 1
                         C      ;
  631F                   C      l6392	equ	SymPtr+2
  6322                   C      l6395	equ	l6392+3
  6325                   C      Ini$FO	equ	l6395+3
  6328                   C      Con$Put	equ	Ini$FO+3
  6329                   C      l639c	equ	Con$Put+1
  632B                   C      l639e	equ	Con$Put+3
  632E                   C      l63a1	equ	l639e+3
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-415


  6331                   C      l63a4	equ	l63a1+3
  6334                   C      l63a7	equ	l63a4+3
  6337                   C      l63aa	equ	l63a7+3
  633A                   C      l63ad	equ	l63aa+3
  633D                   C      l63b0	equ	l63ad+3
  6340                   C      l63b3	equ	l63b0+3
  6343                   C      l63b6	equ	l63b3+3
  6346                   C      l63b9	equ	l63b6+3
  6349                   C      l63bc	equ	l63b9+3
                         C      ;
                         C      ; Jump table 2
                         C      ;
  634C                   C      l63bf	equ	l63bc+3
  634F                   C      l63c2	equ	l63bf+3
  6352                   C      l63c5	equ	l63c2+3
  6355                   C      l63c8	equ	l63c5+3
  6358                   C      l63cb	equ	l63c8+3
  635B                   C      l63ce	equ	l63cb+3
  635E                   C      l63d1	equ	l63ce+3
                         C      ;
                         C      ; Jump table save area
                         C      ;
  6361                   C      l63d4	equ	l63d1+3
                         C      ;
  6376                   C      TokStrt	equ	l63d4+3*7
  6378                   C      l63eb	equ	TokStrt+2
  63C9                   C      @MES@	equ	l63eb+81
  6406                   C      l6479	equ	@MES@+61
  6407                   C      l647a	equ	l6479+1
  6409                   C      l647c	equ	l647a+2
  64D3                   C      l6546	equ	l647c+202
  64E0                   C      l6553	equ	l6546+13
  650C                   C      l657f	equ	l6553+44
  660C                   C      l667f	equ	l657f+256
  660D                   C      l6680	equ	l667f+1
  660F                   C      l6682	equ	l6680+2
  6610                   C      l6683	equ	l6682+1
  6612                   C      l6685	equ	l6683+2
  6613                   C      l6686	equ	l6685+1
                         C      ;
                         C      ; >> Data preset by $INIDAT <<
                         C      ; ++++++++++++++++++++++++++++
                         C      ;
  6615                   C      Radix	equ	l6686+2		;  10
  6617                   C      Pass	equ	Radix+2		;  -1
  6618                   C      ABS.ORG	equ	Pass+1		;  -1
  661A                   C      l668d	equ	ABS.ORG+2	;  -1
  661B                   C      l668e	equ	l668d+1		;   4
  661C                   C      l668f	equ	l668e+1		; -16
  661D                   C      l6690	equ	l668f+1		; l6c4e
  661F                   C      l6692	equ	l6690+2		; l0200 CtrlArr ????
  6621                   C      l6694	equ	l6692+2		; 0,0,1
  6624                   C      l6697	equ	l6694+3		; l7050
  6626                   C      TopPtr	equ	l6697+2		; l7050
  6628                   C      l669b	equ	TopPtr+2	; l634b
                         C      ;
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-416


                         C      ; >> Data cleared to zero <<
                         C      ; ++++++++++++++++++++++++++
                         C      ;
  6634                   C      l66a7	equ	l669b+2*6
  6635                   C      l66a8	equ	l66a7+1
  6674                   C      l66e7	equ	l66a8+63
                         C      ;
  6734                   C      FIB.arr	equ	l66e7+192
                         C      ;
                         C      ; FIB 0
                         C      ;
  6734                   C      l67a7	equ	FIB.arr
                         C      ;
                         C      ; FIB 1
                         C      ;
  673C                   C      BufLen1	equ	l67a7+8
  673E                   C      l67b1	equ	BufLen1+2
  6740                   C      l67b3	equ	l67b1+2
  6742                   C      WrFCB1	equ	l67b3+2
                         C      ;
                         C      ; FIB 2
                         C      ;
  6744                   C      BufLen2	equ	BufLen1+8
  6746                   C      l67b9	equ	BufLen2+2
  6748                   C      l67bb	equ	l67b9+2
  674A                   C      WrFCB2	equ	l67bb+2
                         C      ;
                         C      ; FIB 3
                         C      ;
  674C                   C      l67bf	equ	BufLen2+8
                         C      ;
  6754                   C      l67c7	equ	l67bf+8
  6756                   C      l67c9	equ	l67c7+2
                         C      ;
                         C      ; Next will be cleared	1st word -> 0000
                         C      ;			2nd word -> unchanged
                         C      ;
  6758                   C      l67cb	equ	l67c9+2
  675A                   C      CS.len	equ	l67cb+2
  675C                   C      l67cf	equ	CS.len+2
  675E                   C      DS.len	equ	l67cf+2
  6762                   C      l67d5	equ	DS.len+4
                         C      ;
                         C      ; End of clear
                         C      ;
  6774                   C      l67e7	equ	l67cb+2*14
                         C      ;
  6790                   C      l6803	equ	l67d5+46
  6791                   C      l6804	equ	l6803+1
  6792                   C      l6805	equ	l6804+1
  6793                   C      l6806	equ	l6805+1
  6795                   C      l6808	equ	l6806+2
  6796                   C      FilNum	equ	l6808+1
  6797                   C      l680a	equ	FilNum+1
  6798                   C      l680b	equ	l680a+1
  679A                   C      l680d	equ	l680b+2
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-417


  679B                   C      ConPag	equ	l680d+1
  679C                   C      l680f	equ	ConPag+1
  679E                   C      l6811	equ	l680f+2
  679F                   C      l6812	equ	l6811+1
  67A0                   C      l6813	equ	l6812+1
  67B8                   C      l682b	equ	l6813+24
  67BA                   C      l682d	equ	l682b+2
  67BB                   C      ErrCnt	equ	l682d+1
  67BD                   C      l6830	equ	ErrCnt+2
  67BF                   C      l6832	equ	l6830+2
  67C0                   C      XFER	equ	l6832+1
  67C2                   C      OS.Flg	equ	XFER+2
  67C3                   C      l6836	equ	OS.Flg+1
  67C4                   C      l6837	equ	l6836+1
  67C5                   C      l6838	equ	l6837+1
  67C7                   C      l683a	equ	l6838+2
  67C8                   C      l683b	equ	l683a+1
  67CB                   C      l683e	equ	l683b+3
  67CD                   C      l6840	equ	l683e+2
  67CE                   C      l6841	equ	l6840+1
  67CF                   C      l6842	equ	l6841+1
  67D1                   C      l6844	equ	l6842+2
  67D3                   C      l6846	equ	l6844+2
  67D4                   C      _DMA_	equ	l6846+1
  67D8                   C      l684b	equ	_DMA_+4
  67DA                   C      l684d	equ	l684b+2
  67DB                   C      l684e	equ	l684d+1
  67DD                   C      l6850	equ	l684e+2
  67DF                   C      l6852	equ	l6850+2
  67F0                   C      LST.ena	equ	l6852+17
  67F1                   C      $REL$	equ	LST.ena+1
  67F2                   C      l6865	equ	$REL$+1
  67F4                   C      CurFCB	equ	l6865+2
  67F4                   C      l6867	equ	CurFCB
                         C      ;
                         C      ; >> End of clear <<
                         C      ; ++++++++++++++++++
                         C      ;
  67F7                   C      l686a	equ	CurFCB+3
  67F8                   C      l686b	equ	l686a+1
  67FA                   C      CurLine	equ	l686b+2
  67FD                   C      l6870	equ	CurLine+3
  67FF                   C      _rPage_	equ	l6870+2
  6801                   C      CurUsr	equ	_rPage_+2
  6802                   C      l6875	equ	CurUsr+1
  6804                   C      l6877	equ	l6875+2
  6805                   C      l6878	equ	l6877+1
  6806                   C      l6879	equ	l6877+2
  6807                   C      l687a	equ	l6879+1
  6809                   C      l687c	equ	l687a+2
  680A                   C      l687d	equ	l687c+1
  680C                   C      l687f	equ	l687d+2
  680E                   C      l6881	equ	l687f+2
  6810                   C      l6883	equ	l6881+2
  6817                   C      SetFlg	equ	l6883+7
  6818                   C      l688b	equ	SetFlg+1
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-418


  6819                   C      l688c	equ	l688b+1
  681A                   C      $LOTOK$	equ	l688c+1		; Requires 32 chars max
  6824                   C      l6897	equ	$LOTOK$+10
  682A                   C      l689d	equ	l6897+6
  682D                   C      l68a0	equ	l689d+3
  682F                   C      l68a2	equ	l68a0+2
  6831                   C      l68a4	equ	l68a2+2
  6832                   C      $$PRGN$$ equ	l68a4+1
  6843                   C      LogDsk.	equ	$$PRGN$$+17
  6844                   C      LogUsr.	equ	LogDsk.+1
  6845                   C      SRC.stk	equ	LogUsr.+1
  6847                   C      l68ba	equ	SRC.stk+2
                         C      
  6849                   C      DstFCB	equ	l68ba+2
                         C      
  686A                   C      LstFCB	equ	DstFCB+FCBlen
                         C      
  688B                   C      $$FCB$$	equ	LstFCB+FCBlen
  6894                   C      l6907	equ	$$FCB$$+@drv+@nam
                         C      
  68AC                   C      l691f	equ	l6907+24
                         C      
  69AC                   C      l6a1f	equ	l691f+256
  69AD                   C      l6a20	equ	l6a1f+1
  69B0                   C      HEXbuf	equ	l6a20+3
                         C      ;
                         C      ; Current FIB
                         C      ;
  69EC                   C      CurFIB	equ	HEXbuf+60
  69EC                   C      l6a5f	equ	CurFIB
  69EE                   C      l6a61	equ	l6a5f+2
  69F0                   C      FilBuf	equ	l6a61+2
  69F2                   C      WrFCBc	equ	FilBuf+2
                         C      ;
  69F4                   C      LogDsk	equ	WrFCBc+2
  69F5                   C      LogUsr	equ	LogDsk+1
  69F6                   C      l6a69	equ	LogUsr+1
  69F8                   C      l6a6b	equ	l6a69+2
  69FA                   C      l6a6d	equ	l6a6b+2
  69FB                   C      l6a6e	equ	l6a6d+1
  6A20                   C      $TOD$	equ	l6a6e+37
  6A31                   C      TOD.PB	equ	$TOD$+$TODlen+1
  6A35                   C      l6aa8	equ	TOD.PB+4
  6A36                   C      l6aa9	equ	l6aa8+1
                         C      
  6AB6                   C      SrcFCB	equ	l6aa9+128
  6AC3                   C      l6b36	equ	SrcFCB+13
  6AC4                   C      l6b37	equ	l6b36+1
  6ACA                   C      l6b3d	equ	l6b37+6
  6ACB                   C      l6b3e	equ	l6b3d+1
  6ACC                   C      l6b3f	equ	l6b3e+1
  6AD1                   C      l6b44	equ	l6b3f+5
  6AD3                   C      l6b46	equ	l6b44+2
                         C      
  6AD7                   C      l6b4a	equ	SrcFCB+FCBlen
  6ADC                   C      l6b4f	equ	l6b4a+5
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	1-419


  6ADD                   C      $TOKEN$	equ	l6b4f+1
                         C      
  6B5D                   C      $ERRLIN	equ	$TOKEN$+RecLng	;;6bd0h
                         C      
  6BDA                   C      l6c4d	equ	$ERRLIN+125	;;6c4dh
                         C      
  6FDD                   C      l7050	equ	l6c4d+1024+3	;l6bd0
                         C      
                         C      	end
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S


Macros:
_GO             LD.BC           LD.HL           VAL.ADR         

Symbols:
014C 	$$$$1           013D 	$$180           26C3 	$$A$$           
26C8 	$$C$$           0143 	$$COM           26D0 	$$D$$           
26D3 	$$E$$           26D6 	$$F$$           688B 	$$FCB$$         
26DB 	$$H$$           0146 	$$HEX           2854 	$$I$$           
6124 	$$IOVEC         26E0 	$$K$$           26F0 	$$L$$           
0149 	$$LST           26F6 	$$M$$           0152 	$$MAC           
26FB 	$$N$$           26FE 	$$P$$           6832 	$$PRGN$$        
28B3 	$$Q$$           2709 	$$R$$           0140 	$$REL           
270D 	$$S$$           014F 	$$SUB           2719 	$$T$$           
2710 	$$U$$           2713 	$$X$$           2716 	$$Y$$           
5E55 	$ADDR           0133 	$ASEG$          2975 	$BANNER         
012C 	$CLOSE$         0135 	$COMM.0$        0113 	$CON.COL$       
012E 	$COND$          012A 	$CONPAG$        290D 	$CRLF           
1464 	$CRSENA         1465 	$CRSVEC         011E 	$EI$            
013C 	$EIGHT$         0132 	$EMP.CHN$       0349 	$END.PASS       
0138 	$ERASE$         6B5D 	$ERRLIN         0667 	$FF             
0120 	$FF.EOL$        011F 	$FF.SUM$        0131 	$FILL.0$        
212F 	$FN.ERR         0117 	$FOUR$          0DE3 	$GETVEC         
012B 	$HEXOUT$        0130 	$IF.SPC$        2910 	$INIDAT         
012D 	$LABEL$         0155 	$LEAD$          0127 	$LIN.NR$        
5E5C 	$LINE           14C3 	$LINVEC         681A 	$LOTOK$         
0139 	$MS.DOS$        0126 	$MULS$          013B 	$NEST$          
213F 	$NO.FILE        012F 	$NO.IF1$        228A 	$NO.MAKE        
238E 	$NO.MEM         0129 	$NUMER$         0134 	$ORG.ABS$       
035A 	$PASS           6311 	$PC$            0128 	$PR.LINNR$      
67F1 	$REL$           026D 	$SRCLINE$       011D 	$SUPPR$         
013A 	$TAB.STR$       0136 	$TMP.DRV$       6A20 	$TOD$           
0123 	$TOD.DATA$      0121 	$TOD.ENA$       0125 	$TOD.FORM$      
0122 	$TOD.LOAD$      0010 	$TODLEN         6ADD 	$TOKEN$         
0E32 	$TOKVEC         015D 	$TRAIL$         5EA9 	.BDOS           
0010 	.CLOSE          1665I 	.CNVTOKEN       0001 	.CONIN          
0002 	.CONOUT         000B 	.CONSTA         0013 	.DELETE         
0093 	.DETCON         009F 	.DETLST         0006 	.DIRCON         
1FD6 	.ENDOFASM       08F5 	.ERROR          0DE5 	.FULLTOKEN      
61D9 	.GET$TOD        0069 	.GETTOD         0005 	.LSTOUT         
0016 	.MAKE           002C 	.MULSEC         0BC2 	.NEXTASM        
000F 	.OPEN           0DCB 	.PARTTOKEN      006C 	.PRGRET         
0681 	.PROCSRC        000A 	.RDCON          14C5 	.RDLINE         
0014 	.RDSEQ          0066 	.RDSTMP         214B 	.RESETF         
0019 	.RETDSK         001A 	.SETDMA         000E 	.SETDSK         
0020 	.USRCOD         000C 	.VERS           0015 	.WRSEQ          
00CD 	_CALL           62C0 	_CON.COL_       62C1 	_CON.WID_       
0000 	_CPM            0001 	_CPM_           0020 	_CR             
0003 	_CROSS          62C9 	_DIR_           67D4 	_DMA_           
FF00 	_ERR@           000C 	_EXT            62C5 	_FALSE_         
62C6 	_FF_            62C4 	_FOUR_          0000 	_FULL           
FFFF 	_GET            0006 	_HEX            00DD 	_IXPRFX         
00FD 	_IYPRFX         00C3 	_JP             0030 	_JR.NC          
62C2 	_LST.PAG_       62C7 	_MACRO_         0022 	_MBP            
0006 	_MEP            0002 	_MPM            0006 	_MPMOFF         
0000 	_NOER@          0005 	_NOUPP          62C3 	_OPT_           
0001 	_PASS           0007 	_REL            62C8 	_REL_           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-1


00C9 	_RET            67FF 	_RPAGE_         00C7 	_RST.0          
0002 	_SYM            0004 	_UNDEF          225F 	@ALLOC@         
0009 	@C.F@           000A 	@C.P@           0001 	@DRV            
14F2 	@EIGHT@         0003 	@EXT            1EB8 	@LABEL          
1752 	@LET.A          1799 	@LET.B          17B9 	@LET.C          
1862 	@LET.D          18DC 	@LET.E          1988 	@LET.G          
19A4 	@LET.H          19FA 	@LET.I          1ACE 	@LET.J          
1ADD 	@LET.L          1B41 	@LET.M          1BD2 	@LET.N          
1C1C 	@LET.O          1C80 	@LET.P          1CE0 	@LET.R          
1D92 	@LET.S          1DFA 	@LET.T          1E2A 	@LET.V          
1E2F 	@LET.X          1E48 	@LET.Z          22FE 	@MEMER@         
63C9 	@MES@           0007 	@MSB            0008 	@NAM            
0ECF 	@NUMB           0FF3 	@OPER.1         100D 	@OPER.2         
0003 	@P.F@           1021 	@PAREN          1E74 	@PC.REF         
1F07 	@PS.OP          1EBC 	@PS.OP.A        1EC5 	@PS.OP.C        
1EDF 	@PS.OP.D        1E4D 	@PS.OP.L        1EE7 	@PS.OP.P        
1F34 	@PS.OP.R        1F53 	@PS.OP.S        1F63 	@PS.OP.T        
1F6B 	@PS.OP.X        1E3E 	@PS.OP.Z        0090 	@R.U@           
583F 	@REL1@          5843 	@REL2@          FFFF 	@RUN@           
0008 	@SEC@           03E3 	@SERR           0D76 	@STRG.1         
0137 	@SYSUSR@        0EC3 	@ZERO           01A3 	@ZERR           
511B 	ABS.CONST       6618 	ABS.ORG         5872 	AFIELD          
00FF 	ALL             24E4 	ALL.EIGHT       22D9 	ALLOC_          
1FE6 	ASS..           1FD9 	ASSIGNF         33CD 	BCDTOASC        
33A2 	BCDTOASC.       339E 	BCDTOASC.0      0005 	BDOS            
5824 	BFIELD          57A6 	BIT.BOUNDARY    28B6 	BREAK           
673C 	BUFLEN1         6744 	BUFLEN2         0018 	C$ASTMP         
0080 	CCP             2A66 	CLOSE?          2757 	CMDDELFND       
0080 	CMDLEN          62F7 	CMDPTR          2567I 	CMDSCAN         
1F49 	CMPTOKEN        5E63 	CNVFCB$         1662 	CNVTOKEN        
0007 	COLMASK         0008 	COLTAB          5118 	CON$ABS         
6328 	CON$PUT         5799 	CON$REL         5474 	CON$SLR         
62BF 	CON.ENA         5F76 	CONIN           679B 	CONPAG          
24C4 	CPM             0030 	CPM3            24BF 	CPM_            
000D 	CR              675A 	CS.LEN          01ED 	CTRLARR         
67F4 	CURFCB          69EC 	CURFIB          67FA 	CURLINE         
6801 	CURUSR          229A 	D.ALLOC_        2401 	D.FREE_         
007F 	DEL             0969 	DISXXX?         34DC 	DIVCON          
3A1A 	DIVIDE          5D8B 	DO$ERROR        5D93I 	DO.ERROR        
0E46 	DOLOWTOKEN      0E34 	DOTOKEN         675E 	DS.LEN          
6849 	DSTFCB          6319 	DYNPTR1         631B 	DYNPTR2         
62F2 	EMPTY           0B4F 	ENAXXX?         2678 	ENDCMDDRIVE     
263E 	ENDCMDFILE      0B87I 	ENDOFASM        0991 	ENDOFFILE       
001A 	EOF             FFFF 	EOT             67BB 	ERRCNT          
0905 	ERROR           5D8E 	ERROR?          5D85 	ERROR?RES       
001B 	ESC             0000 	FALSE           005C 	FCB             
0021 	FCBLEN          0024 	FCBLENR         2232 	FCBTOSTR        
5F0A 	FCLOSE          000C 	FF              6734 	FIB.ARR         
69F0 	FILBUF          6796 	FILNUM          0F75 	GET$BIN         
0F20 	GET$DEC         0F5E 	GET$HEX         0FA3 	GET$NUM         
0F8C 	GET$OCT         61D1 	GET$TOD         3E06 	GETCC           
29B0I 	GETCMDCH        2688 	GETCMDOPT       0FBE 	GETLABEL        
14BC 	GETLINE         3D07 	GETREG          6259 	GETTOD          
0DE2 	GETTOKEN        0918I 	GO.SLR          2508 	GOT.CCP.CMD     
62F3 	HEAP            69B0 	HEXBUF          506D 	ILLCONST        
1FD0 	ILLDRV          1343 	IMRET           354C 	IN$BIN          
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-2


34EA 	IN$DEC          3513 	IN$HEX          3564 	IN$NUM          
3530 	IN$OCT          137A 	INC..Y          137C 	INC.Y           
0CAA 	INCBCD          62CA 	INDFIB          62D1 	INDIRECT        
62CC 	INDREC          62CE 	INDUSR          55BA 	INI$ABS         
6325 	INI$FO          55EF 	INI$HEX         5607 	INI$REL         
5976 	INI$SLR         001F 	INILEN          5F5B 	ISCHAR          
5F65 	ISCHAR.         30DF 	ISEOL?          2FE7 	IXPREFIX        
2FEF 	IYPREFIX        2AA0 	JP.IND.R        08F4 	JP.R.1          
61D0 	JP.R.2          0000 	L0000           0001 	L0001           
0002 	L0002           0003 	L0003           0004 	L0004           
0005 	L0005           0006 	L0006           0007 	L0007           
0008 	L0008           0009 	L0009           000A 	L000A           
000B 	L000B           000C 	L000C           000D 	L000D           
000E 	L000E           000F 	L000F           0011 	L0011           
0013 	L0013           0014 	L0014           0015 	L0015           
0016 	L0016           0017 	L0017           001C 	L001C           
001E 	L001E           0020 	L0020           0027 	L0027           
002B 	L002B           002D 	L002D           002F 	L002F           
0032 	L0032           0037 	L0037           003F 	L003F           
0040 	L0040           0043 	L0043           0044 	L0044           
0045 	L0045           0047 	L0047           004C 	L004C           
0050 	L0050           0076 	L0076           0077 	L0077           
007F 	L007F           00B2 	L00B2           00C2 	L00C2           
00D9 	L00D9           00F3 	L00F3           00FB 	L00FB           
0100 	L0100           0194 	L01A7           01A2 	L01B5           
01A5 	L01B8           01B1 	L01C4           01CF 	L01E2           
0200 	L0200           02ED 	L0300           037A 	L038D           
038D 	L03A0           039D 	L03B0           03AD 	L03C0           
03B8 	L03CB           03C9 	L03DC           03ED 	L0400           
04D4I 	L04E7           04E1 	L04F4           0500 	L0500           
04F3 	L0506           0508 	L051B           0519 	L052C           
0532 	L0545           0543 	L0556           0552 	L0565           
0561 	L0574           0572 	L0585           057F 	L0592           
058D 	L05A0           0598 	L05AB           05A6 	L05B9           
05B4 	L05C7           05C3 	L05D6           05D1 	L05E4           
05DE 	L05F1           05EB 	L05FE           05FA 	L060D           
0608 	L061B           062A 	L063D           0646 	L0659           
0652 	L0665           065D 	L0670           066A 	L067D           
066E 	L0681           0673 	L0686           0678I 	L068B           
06A4 	L06B7           06AB 	L06BE           06B5 	L06C8           
06BD 	L06D0           06DF 	L06F2           06E6 	L06F9           
06ED 	L0700           0715 	L072F           0748 	L0762           
074B 	L0765           074E 	L0768           0753 	L076D           
076E 	L0788           0775 	L078F           077A 	L0794           
0786 	L07A0           07A5 	L07BF           07AB 	L07C5           
07AD 	L07C7           07B6 	L07D0           07BA 	L07D4           
07C6 	L07E0           07D1 	L07EB           07D4 	L07EE           
07D7 	L07F1           07DA 	L07F4           07FD 	L0817           
0815 	L082F           0827 	L0841           0833 	L084D           
0842 	L085C           086A 	L0884           0875 	L088F           
087C 	L0896           0892 	L08AC           0895 	L08AF           
08AB 	L08C5           08B1 	L08CB           08CC 	L08E6           
08EF 	L0909           08F1 	L090B           0908 	L0922           
0926 	L0940           0948 	L0962           0958 	L0972           
097A 	L0994           09B7 	L09D1           09BA 	L09D4           
09C9 	L09E3           0A1B 	L0A35           0A1D 	L0A37           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-3


0A28 	L0A42           0ADE 	L0AF8           0B0C 	L0B26           
0B11 	L0B2B           0B16 	L0B30           0B1D 	L0B37           
0B2B 	L0B45           0B31 	L0B4B           0B77 	L0B91           
0B7A 	L0B94           0B85 	L0B9F           0B9F 	L0BB9           
0BC5 	L0BDF           0BDB 	L0BF5           0C11 	L0C2B           
0C25 	L0C3F           0C2A 	L0C44           0C2F 	L0C49           
0C43 	L0C5D           0C46 	L0C60           0C52 	L0C6C           
0C67 	L0C81           0C83 	L0C9D           0C9C 	L0CB6           
0CBA 	L0CD4           0CDC 	L0CF6           0CED 	L0D07           
0D01 	L0D1B           0D0A 	L0D24           0D13 	L0D2D           
0D18 	L0D32           0D1C 	L0D36           0D24 	L0D3E           
0D2D 	L0D47           0D37 	L0D51           0D39 	L0D53           
0D50 	L0D6A           0D5E 	L0D78           0D93 	L0DAD           
0D9F 	L0DB9           0DA2 	L0DBC           0DAA 	L0DC4           
0DB0 	L0DCA           0DBA 	L0DD4           0DC5 	L0DDF           
0DD0 	L0DEA           0DDB 	L0DF5           0DEF 	L0E09           
0DF8 	L0E12           0E04 	L0E1E           0E50 	L0E6A           
0E5B 	L0E75           0E61 	L0E7B           0E68 	L0E82           
0E71 	L0E8B           0E81 	L0E9B           0E90 	L0EAA           
0E97 	L0EB1           0EA6 	L0EC0           0EB2 	L0ECC           
0EC8 	L0EE2           0ED4 	L0EEE           0ED7 	L0EF1           
0EE8 	L0F02           0F03 	L0F1D           0F14 	L0F2E           
0F2E 	L0F48           0F30 	L0F4A           0F32 	L0F4C           
0F4F 	L0F69           0F54 	L0F6E           0F56 	L0F70           
0F5B 	L0F75           0F6E 	L0F88           0F85 	L0F9F           
0F9C 	L0FB6           0FB4 	L0FCE           0FC1 	L0FDB           
0FD8 	L0FF2           0FEE 	L1008           102C 	L1046           
1032 	L104C           1048 	L1062           1055 	L106F           
1058 	L1072           105F 	L1079           1064 	L107E           
1069 	L1083           1083 	L109D           108C 	L10A6           
1242 	L125C           126F 	L1289           129C 	L12B6           
12C9 	L12E3           12F6 	L1310           1323 	L133D           
1350 	L136A           1365 	L137F           137A 	L1394           
137F 	L1399           1384 	L139E           1389 	L13A3           
138B 	L13A5           138D 	L13A7           1390 	L13AA           
13AE 	L13C8           13D5 	L13EF           141A 	L1434           
142A 	L1444           143B 	L1455           143F 	L1459           
1454 	L146E           1456 	L1470           1467 	L1481           
146F 	L1489           1472 	L148C           1479 	L1493           
147F 	L1499           1483 	L149D           1488 	L14A2           
14AD 	L14C7           14B3 	L14CD           14DF 	L14F9           
14F1 	L150B           14F9 	L1513           14FA 	L1514           
1507 	L1521           150C 	L1526           1516 	L1530           
1554 	L156E           155E 	L1578           1565 	L157F           
157F 	L1599           15BD 	L15D7           15C6 	L15E0           
15D7 	L15F1           15DA 	L15F4           15E9 	L1603           
1600 	L161A           1620 	L163A           1624 	L163E           
164F 	L1669           166D 	L1687           166F 	L1689           
1672 	L168C           1690 	L16AA           1694 	L16AE           
169C 	L16B6           16AA 	L16C4           16AC 	L16C6           
16B4 	L16CE           16BD 	L16D7           16C2 	L16DC           
16D8 	L16F2           16E2 	L16FC           16EE 	L1708           
16F5 	L170F           16FA 	L1714           170E 	L1728           
1720 	L173A           172F 	L1749           173A 	L1754           
173F 	L1759           1747 	L1761           174A 	L1764           
1779 	L1793           177D 	L1797           1782 	L179C           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-4


1791 	L17AB           17D8 	L17F2           17E0 	L17FA           
17E4 	L17FE           17E6 	L1800           17E9 	L1803           
17EB 	L1805           17F9 	L1813           180A 	L1824           
1814 	L182E           182D 	L1847           182F 	L1849           
1838 	L1852           183D 	L1857           1845 	L185F           
184B 	L1865           1873 	L188D           1877 	L1891           
1882 	L189C           1886 	L18A0           1888 	L18A2           
188B 	L18A5           188D 	L18A7           1898 	L18B2           
189C 	L18B6           18CE 	L18E8           18D2 	L18EC           
18FD 	L1917           1906 	L1920           191B 	L1935           
1929 	L1943           192D 	L1947           192F 	L1949           
1932 	L194C           1934 	L194E           1950 	L196A           
1958 	L1972           196D 	L1987           199B 	L19B5           
19C0 	L19DA           19C8 	L19E2           19CC 	L19E6           
19CE 	L19E8           19D3 	L19ED           19EB 	L1A05           
19ED 	L1A07           19F6 	L1A10           1A1C 	L1A36           
1A35 	L1A4F           1A46 	L1A60           1A57 	L1A71           
1A70 	L1A8A           1A74 	L1A8E           1A76 	L1A90           
1A7B 	L1A95           1A95 	L1AAF           1AA0 	L1ABA           
1AAA 	L1AC4           1AB9 	L1AD3           1B07 	L1B21           
1B09 	L1B23           1B13 	L1B2D           1B24 	L1B3E           
1B2D 	L1B47           1B2F 	L1B49           1B36 	L1B50           
1B3A 	L1B54           1B3C 	L1B56           1B3F 	L1B59           
1B5F 	L1B79           1B64 	L1B7E           1B68 	L1B82           
1B6E 	L1B88           1B78 	L1B92           1B88 	L1BA2           
1B95 	L1BAF           1BA6 	L1BC0           1BB3 	L1BCD           
1BBB 	L1BD5           1BC6 	L1BE0           1BE7 	L1C01           
1BEB 	L1C05           1BED 	L1C07           1BF2 	L1C0C           
1BFD 	L1C17           1C01 	L1C1B           1C10 	L1C2A           
1C46 	L1C60           1C52 	L1C6C           1C67 	L1C81           
1C72 	L1C8C           1C9E 	L1CB8           1CA8 	L1CC2           
1CAC 	L1CC6           1CB7 	L1CD1           1CC3 	L1CDD           
1CC8 	L1CE2           1CD2 	L1CEC           1CD6 	L1CF0           
1CF6 	L1D10           1D15 	L1D2F           1D19 	L1D33           
1D1B 	L1D35           1D1E 	L1D38           1D20 	L1D3A           
1D28 	L1D42           1D30 	L1D4A           1D34 	L1D4E           
1D4A 	L1D64           1D56 	L1D70           1D6C 	L1D86           
1D71 	L1D8B           1D7D 	L1D97           1DC4 	L1DDE           
1DD3 	L1DED           1DD8 	L1DF2           1DDD 	L1DF7           
1DEC 	L1E06           1DEF 	L1E09           1DF3 	L1E0D           
1DF4 	L1E0E           1DF5 	L1E0F           1E20 	L1E3A           
1E68 	L1E82           1E6A 	L1E84           1E96 	L1EB0           
1ED4 	L1EEE           1EF8 	L1F12           1F00 	L1F1A           
1F80 	L1F9A           1F85 	L1F9F           1F8D 	L1FA7           
1F90 	L1FAA           1F93 	L1FAD           1F94 	L1FAE           
1F97 	L1FB1           1F9B 	L1FB5           1F9F 	L1FB9           
1FA2 	L1FBC           1FA5 	L1FBF           1FA8 	L1FC2           
1FA9 	L1FC3           1FAC 	L1FC6           1FAD 	L1FC7           
1FAF 	L1FC9           1FB2 	L1FCC           1FB5 	L1FCF           
1FBA 	L1FD4           1FBF 	L1FD9           1FC4 	L1FDE           
1FC8 	L1FE2           1FC9 	L1FE3           1FCD 	L1FE7           
2036 	L2050           2040 	L205A           2071 	L208B           
2087 	L20A1           2093 	L20AD           20A0 	L20BA           
2101 	L211B           211A 	L213F           2124 	L2149           
212B 	L2150           216C 	L2191           2185 	L21AA           
219C 	L21C1           21B2 	L21D7           21EA 	L220F           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-5


2207 	L222C           2208 	L222D           223B 	L2260           
225E 	L2283           227D 	L22A2           22A3 	L22C8           
22FD 	L2322           2300 	L2325           2329 	L234E           
2349 	L236E           23CB 	L23F0           23D5 	L23FA           
23EA 	L240F           23FE 	L2423           23FF 	L2424           
2434 	L2486           2657 	L26A9           266F 	L26C1           
2679 	L26CB           267F 	L26D1           26A7 	L26F9           
26B3 	L2705           26CC 	L271E           26F8 	L274A           
271E 	L2770           2733 	L2785           2736 	L2788           
273A 	L278C           2748 	L279A           2749 	L279B           
274A 	L279C           2763 	L27B5           276D 	L27BF           
277F 	L27D1           27BE 	L2810           27C8 	L281A           
27CD 	L281F           27D7I 	L2829           2825 	L2877           
2835 	L2887           283E 	L2890           28A9 	L28FB           
28D0 	L2922           28DC 	L292E           28E4 	L2936           
28F1 	L2943           292F 	L2981           295E 	L29B0           
2961 	L29B3           296F 	L29C1           29AE 	L2A09           
2A03 	L2A5E           2A43 	L2A9E           2A46 	L2AA1           
2AA6 	L2B01           2AAA 	L2B05           2AAF 	L2B0A           
2AB3 	L2B0E           2AC4 	L2B1F           2AD2 	L2B2D           
2AE6 	L2B41           2AF2 	L2B4D           2AF7 	L2B52           
2B14 	L2B6F           2B17 	L2B72           2B2C 	L2B87           
2B2F 	L2B8A           2B39 	L2B94           2B46 	L2BA1           
2B56 	L2BB1           2B59 	L2BB4           2B63 	L2BBE           
2B73 	L2BCE           2B7A 	L2BD5           2B8B 	L2BE6           
2B94 	L2BEF           2BA1 	L2BFC           2BA5 	L2C00           
2BC2 	L2C1D           2BD5 	L2C30           2BE8 	L2C43           
2BF8 	L2C53           2BFD 	L2C58           2C03 	L2C5E           
2C0F 	L2C6A           2C1C 	L2C77           2C21 	L2C7C           
2C33 	L2C8E           2C39 	L2C94           2C3E 	L2C99           
2C4F 	L2CAA           2C57 	L2CB2           2C5F 	L2CBA           
2C6B 	L2CC6           2C6E 	L2CC9           2C75 	L2CD0           
2C86 	L2CE1           2C8B 	L2CE6           2CAB 	L2D06           
2CB4 	L2D0F           2CE0 	L2D3B           2CF8 	L2D53           
2CFF 	L2D5A           2D17 	L2D72           2D1A 	L2D75           
2D27 	L2D82           2D2A 	L2D85           2D4D 	L2DA8           
2D5C 	L2DB7           2D62 	L2DBD           2D66 	L2DC1           
2D70 	L2DCB           2D75 	L2DD0           2D85 	L2DE0           
2D93 	L2DEE           2D99 	L2DF4           2DAA 	L2E05           
2DB6 	L2E11           2DD2 	L2E2D           2DE0 	L2E3B           
2DF6 	L2E51           2E11 	L2E6C           2E29 	L2E84           
2E46 	L2EA1           2E54 	L2EAF           2E56 	L2EB1           
2E59 	L2EB4           2E5D 	L2EB8           2E65 	L2EC0           
2E68 	L2EC3           2E72 	L2ECD           2E77 	L2ED2           
2E81 	L2EDC           2E8B 	L2EE6           2E9C 	L2EF7           
2EA9 	L2F04           2EBD 	L2F18           2EC9 	L2F24           
2ED7 	L2F32           2EEF 	L2F4A           2EFF 	L2F5A           
2F14 	L2F6F           2F29 	L2F84           2F36 	L2F91           
2F39 	L2F94           2F4A 	L2FA5           2F4F 	L2FAA           
2F55 	L2FB0           2F5A 	L2FB5           2F62 	L2FBD           
2F75 	L2FD0           2F88 	L2FE3           2F8E 	L2FE9           
2F91 	L2FEC           2F99 	L2FF4           2F9C 	L2FF7           
2FA4 	L2FFF           2FB1 	L300C           2FB8 	L3013           
2FC8 	L3023           2FC9 	L3024           2FD4 	L302F           
2FD7 	L3032           2FEA 	L3045           2FF4 	L304F           
2FF9 	L3054           2FFE 	L3059           3004 	L305F           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-6


3010 	L306B           301B 	L3076           3026 	L3081           
302E 	L3089           3034 	L308F           3038 	L3093           
303A 	L3095           303E 	L3099           3043 	L309E           
3074 	L30CF           309B 	L30F6           30A6 	L3101           
30C3 	L311E           30FA 	L3155           30FC 	L3157           
3108 	L3163           310A 	L3165           310C 	L3167           
310E 	L3169           3138 	L3193           313A 	L3195           
3143 	L319E           314E 	L31A9           3150 	L31AB           
3162 	L31BD           316E 	L31C9           3174 	L31CF           
3179 	L31D4           3182 	L31DD           3190 	L31EB           
31A0 	L31FB           31B8 	L3213           31B9 	L3214           
31BB 	L3216           31CD 	L3228           31E1I 	L323C           
31F9 	L3254           3210 	L326B           3218 	L3273           
3230 	L328B           323B 	L3296           323D 	L3298           
3240 	L329B           324D 	L32A8           3252 	L32AD           
3278 	L32D3           327D 	L32D8           3288 	L32E3           
328B 	L32E6           32B4 	L330F           32B8 	L3313           
32C2 	L331D           32D0 	L332B           32D5 	L3330           
32EA 	L3345           32EF 	L334A           32F4 	L334F           
32F6 	L3351           3304 	L335F           3308 	L3363           
3318 	L3373           331C 	L3377           3328 	L3383           
3343 	L339E           3345 	L33A0           3346 	L33A1           
3353 	L33AE           335A 	L33B5           335C 	L33B7           
3360 	L33BB           336E 	L33C9           3381 	L33DC           
338B 	L33E6           33A4 	L33FF           33B0 	L340B           
33B3 	L340E           33BC 	L3417           33C7 	L3422           
33D9 	L3434           33E2 	L343D           33E4 	L343F           
33ED 	L3448           33F3 	L344E           33FE 	L3459           
3408 	L3463           340B 	L3466           3411 	L346C           
3419 	L3474           342A 	L3485           343B 	L3496           
343D 	L3498           3443 	L349E           3452 	L34AD           
3459 	L34B4           3460 	L34BB           3469 	L34C4           
3477 	L34D2           348A 	L34E5           349F 	L34FA           
34B1 	L350C           34BD 	L3518           34C9 	L3524           
34D5 	L3530           34DD 	L3538           34F2 	L354D           
34F9 	L3554           3506 	L3561           350C 	L3567           
350F 	L356A           351C 	L3577           3521 	L357C           
3539 	L3594           353D 	L3598           3555 	L35B0           
3571 	L35CC           357C 	L35D7           3587 	L35E2           
358D 	L35E8           3590 	L35EB           35A4 	L35FF           
35B5 	L3610           35BC 	L3617           35C0 	L361B           
35C4 	L361F           35D9 	L3634           35E9 	L3644           
35FA 	L3655           3622 	L367D           3634 	L368F           
363B 	L3696           364A 	L36A5           3653 	L36AE           
365D 	L36B8           3666 	L36C1           366A 	L36C5           
3673 	L36CE           3676 	L36D1           367A 	L36D5           
3686 	L36E1           369D 	L36F8           36A0 	L36FB           
36B3 	L370E           36BA 	L3715           36BB 	L3716           
36D3 	L372E           36DD 	L3738           36F2 	L374D           
36F4 	L374F           3709 	L3764           370A 	L3765           
3711 	L376C           3727 	L3782           372B 	L3786           
372C 	L3787           3732 	L378D           3735 	L3790           
373B 	L3796           3740 	L379B           3760 	L37BB           
3766 	L37C1           3768 	L37C3           3774 	L37CF           
3778 	L37D3           3784 	L37DF           3787 	L37E2           
3790 	L37EB           3798 	L37F3           379B 	L37F6           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-7


379C 	L37F7           37A5 	L3800           37BC 	L3817           
37EC 	L3847           37ED 	L3848           37FE 	L3859           
3813 	L386E           3817 	L3872           381B 	L3876           
381E 	L3879           3824 	L387F           3830 	L388B           
383B 	L3896           3843 	L389E           3854 	L38AF           
3859 	L38B4           385E 	L38B9           3871 	L38CC           
3879 	L38D4           387E 	L38D9           3883 	L38DE           
3897 	L38F2           389A 	L38F5           389D 	L38F8           
38AD 	L3908           38BB 	L3916           38C0 	L391B           
38C7 	L3922           38CC 	L3927           38D4 	L392F           
38DC 	L3937           38E7 	L3942           38F5 	L3950           
3902 	L395D           390E 	L3969           3911 	L396C           
3918 	L3973           3921 	L397C           3940 	L399B           
394A 	L39A5           3957 	L39B2           3961 	L39BC           
3965 	L39C0           396D 	L39C8           3993 	L39EE           
3998 	L39F3           399B 	L39F6           399C 	L39F7           
39A0 	L39FB           39A7 	L3A02           39A8 	L3A03           
39AE 	L3A09           39AF 	L3A0A           39B6 	L3A11           
39BE 	L3A19           39C6 	L3A21           39D5 	L3A30           
39DA 	L3A35           39E3 	L3A3E           39EB 	L3A46           
39F7 	L3A52           39FF 	L3A5A           3A03 	L3A5E           
3A0F 	L3A6A           3A14 	L3A6F           3A25 	L3A80           
3A2C 	L3A87           3A35 	L3A90           3A50 	L3AAB           
3A60 	L3ABB           3A63 	L3ABE           3A66 	L3AC1           
3A8B 	L3AE6           3A95 	L3AF0           3AA0 	L3AFB           
3AA5 	L3B00           3AA8 	L3B03           3AAD 	L3B08           
3AB1 	L3B0C           3AD4 	L3B2F           3AD5 	L3B30           
3AE8 	L3B43           3AF2 	L3B4D           3AFA 	L3B55           
3B00 	L3B5B           3B03 	L3B5E           3B05 	L3B60           
3B11 	L3B6C           3B2C 	L3B87           3B2F 	L3B8A           
3B33 	L3B8E           3B37 	L3B92           3B5C 	L3BB7           
3B5D 	L3BB8           3B5F 	L3BBA           3B68 	L3BC3           
3B6F 	L3BCA           3B83 	L3BDE           3B93 	L3BEE           
3B96 	L3BF1           3BA4 	L3BFF           3BA9 	L3C04           
3BAB 	L3C06           3BB7 	L3C12           3BB9 	L3C14           
3BC1 	L3C1C           3BCE 	L3C29           3BD9 	L3C34           
3BEA 	L3C45           3BEE 	L3C49           3BF2 	L3C4D           
3BFE 	L3C59           3C0D 	L3C68           3C11 	L3C6C           
3C25 	L3C80           3C27 	L3C82           3C30 	L3C8B           
3C34 	L3C8F           3C44 	L3C9F           3C57 	L3CB2           
3C61 	L3CBC           3C85 	L3CE0           3C8A 	L3CE5           
3C90 	L3CEB           3C96 	L3CF1           3C9D 	L3CF8           
3CA0 	L3CFB           3CA5 	L3D00           3CAB 	L3D06           
3CC6 	L3D21           3CDA 	L3D35           3CE5 	L3D40           
3CFA 	L3D55           3CFF 	L3D5A           3D12 	L3D6D           
3D29 	L3D84           3D35 	L3D90           3D3A 	L3D95           
3D52 	L3DAD           3D55 	L3DB0           3D73 	L3DCE           
3D89 	L3DE4           3D96 	L3DF1           3DAA 	L3E05           
3DB1 	L3E0C           3DB3 	L3E0E           3DC5 	L3E20           
3DD0 	L3E2B           3DD5 	L3E30           3DE9 	L3E44           
3DF0 	L3E4B           3DF3 	L3E4E           3E02 	L3E5D           
3E09 	L3E64           3E19 	L3E74           3E1C 	L3E77           
3E1F 	L3E7A           3E2B 	L3E86           3E3A 	L3E95           
3E47 	L3EA2           3E4B 	L3EA6           3E4F 	L3EAA           
3E51 	L3EAC           3E55 	L3EB0           3E73 	L3ECE           
3EAA 	L3F05           3EAF 	L3F0A           3EEC 	L3F47           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-8


3F02 	L3F5D           3F0B 	L3F66           3F1B 	L3F76           
3F25 	L3F80           3F30 	L3F8B           3F3A 	L3F95           
3F44 	L3F9F           3F5D 	L3FB8           3F71 	L3FCC           
3F75 	L3FD0           3F8C 	L3FE7           3F91 	L3FEC           
3F92 	L3FED           3FA1 	L3FFC           3FBD 	L4018           
3FCF 	L402A           3FD8 	L4033           3FE6 	L4041           
4005 	L4060           4006 	L4061           4009 	L4064           
4013 	L406E           401A 	L4075           401E 	L4079           
401F 	L407A           4022 	L407D           403F 	L409A           
4044 	L409F           4051 	L40AC           405A 	L40B5           
4067 	L40C2           406F 	L40CA           40AC 	L4107           
40BE 	L4119           40C5 	L4120           40DC 	L4137           
40E2 	L413D           40EC 	L4147           40ED 	L4148           
40EF 	L414A           4102 	L415D           4108 	L4163           
4111 	L416C           4131 	L418C           4148 	L41A3           
4152 	L41AD           415D 	L41B8           415E 	L41B9           
4175 	L41D0           4182 	L41DD           4187 	L41E2           
418A 	L41E5           4196 	L41F1           41A9 	L4204           
41B1 	L420C           41B5 	L4210           41BA 	L4215           
41BD 	L4218           41CD 	L4228           41D8 	L4233           
41EB 	L4246           41F1 	L424C           41FF 	L425A           
4223 	L427E           4228 	L4283           423C 	L4297           
4249 	L42A4           4259 	L42B4           426C 	L42C7           
427D 	L42D8           427E 	L42D9           4280 	L42DB           
428B 	L42E6           4295 	L42F0           42A2 	L42FD           
42A7 	L4302           42AA 	L4305           42BF 	L431A           
42C9 	L4324           42CE 	L4329           42D3 	L432E           
42D6 	L4331           42DD 	L4338           42EF 	L434A           
4302 	L435D           430E 	L4369           4315 	L4370           
4319 	L4374           431A 	L4375           433B 	L4396           
4358 	L43B3           435B 	L43B6           4362 	L43BD           
436B 	L43C6           4371 	L43CC           4392 	L43ED           
439D 	L43F8           43A1 	L43FC           43A9 	L4404           
43AC 	L4407           43C1 	L441C           43CD 	L4428           
43DB 	L4436           43E3 	L443E           43F7 	L4452           
440C 	L4467           4424 	L447F           442D 	L4488           
443E 	L4499           4441 	L449C           4444 	L449F           
4462 	L44BD           446B 	L44C6           446E 	L44C9           
4479 	L44D4           447E 	L44D9           4483 	L44DE           
448D 	L44E8           4497 	L44F2           449B 	L44F6           
449E 	L44F9           44A0 	L44FB           44A6 	L4501           
44AE 	L4509           44B9 	L4514           44BD 	L4518           
44C8 	L4523           44CC 	L4527           44D6 	L4531           
44E6 	L4541           44F4 	L454F           44FB 	L4556           
4508 	L4563           450C 	L4567           4523 	L457E           
452A 	L4585           4535 	L4590           4546 	L45A1           
4554 	L45AF           4558 	L45B3           4562 	L45BD           
4567 	L45C2           4576 	L45D1           4596 	L45F1           
4599 	L45F4           45A8 	L4603           45AA 	L4605           
45AF 	L460A           45BA 	L4615           45C5 	L4620           
45C7 	L4622           45CB 	L4626           45CC 	L4627           
45D1 	L462C           45DD 	L4638           45E7 	L4642           
45F9 	L4654           4605 	L4660           4619 	L4674           
461B 	L4676           461E 	L4679           4621 	L467C           
4624 	L467F           4627 	L4682           462A 	L4685           
463B 	L4696           463E 	L4699           4667 	L46C2           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-9


466B 	L46C6           4671 	L46CC           46C7 	L4722           
46CC 	L4727           46D1 	L472C           46D4 	L472F           
46DB 	L4736           4707 	L4762           470E 	L4769           
473F 	L479A           4743 	L479E           4749 	L47A4           
4797 	L47F2           479B 	L47F6           479F 	L47FA           
47B7 	L4812           47BC 	L4817           47CE 	L4829           
47D1 	L482C           47EB 	L4846           4820 	L487B           
4827 	L4882           482B 	L4886           4836 	L4891           
4853 	L48AE           4865 	L48C0           4881 	L48DC           
4894 	L48EF           489D 	L48F8           48A6 	L4901           
48AF 	L490A           48B7 	L4912           48CB 	L4926           
48D2 	L492D           48E8 	L4943           48F4 	L494F           
4944 	L499F           494D 	L49A8           4958 	L49B3           
496F 	L49CA           4981 	L49DC           4984 	L49DF           
4996 	L49F1           499F 	L49FA           49B0 	L4A0B           
49C2 	L4A1D           49C5 	L4A20           49CA 	L4A25           
49D5 	L4A30           49E9 	L4A44           49FC 	L4A57           
4A04 	L4A5F           4A12 	L4A6D           4A19 	L4A74           
4A33 	L4A8E           4A5D 	L4AB8           4A6A 	L4AC5           
4A7A 	L4AD5           4A87 	L4AE2           4A88 	L4AE3           
4A8E 	L4AE9           4A96 	L4AF1           4AB3 	L4B0E           
4AC4 	L4B1F           4ACF 	L4B2A           4AE5 	L4B40           
4AFB 	L4B56           4AFF 	L4B5A           4B25 	L4B80           
4B32 	L4B8D           4B40 	L4B9B           4B51 	L4BAC           
4B6C 	L4BC7           4BA2 	L4BFD           4BAA 	L4C05           
4BC5 	L4C20           4BC9 	L4C24           4BFD 	L4C58           
4C09 	L4C64           4C0E 	L4C69           4C1B 	L4C76           
4C33 	L4C8E           4C46 	L4CA1           4C53 	L4CAE           
4C60 	L4CBB           4C79 	L4CD4           4C81 	L4CDC           
4C96 	L4CF1           4C9D 	L4CF8           4CA5 	L4D00           
4CB9 	L4D14           4CC1 	L4D1C           4CD6 	L4D31           
4CDA 	L4D35           4CE3 	L4D3E           4CF3 	L4D4E           
4CF7 	L4D52           4D07 	L4D62           4D24 	L4D7F           
4D33 	L4D8E           4D37 	L4D92           4D3B 	L4D96           
4D41 	L4D9C           4D75 	L4DD0           4DC3 	L4E1E           
4DCF 	L4E2A           4DE4 	L4E3F           4DFA 	L4E55           
4E0B 	L4E66           4E0E 	L4E69           4E27 	L4E82           
4E35 	L4E90           4E44 	L4E9F           4E46 	L4EA1           
4E4B 	L4EA6           4E50 	L4EAB           4E57 	L4EB2           
4E5A 	L4EB5           4E70 	L4ECB           4E7E 	L4ED9           
4E8D 	L4EE8           4E8F 	L4EEA           4E94 	L4EEF           
4E99 	L4EF4           4EA0 	L4EFB           4EA6 	L4F01           
4EAD 	L4F08           4EB4 	L4F0F           4EB7 	L4F12           
4ECD 	L4F28           4ED3 	L4F2E           4EDB 	L4F36           
4EDE 	L4F39           4EEA 	L4F45           4EF7 	L4F52           
4F1B 	L4F76           4F26 	L4F81           4F2B 	L4F86           
4F33 	L4F8E           4F3C 	L4F97           4F40 	L4F9B           
4F45 	L4FA0           4F49 	L4FA4           4F65 	L4FC0           
4F6C 	L4FC7           4F85 	L4FE0           4F88 	L4FE3           
4F8A 	L4FE5           4F8F 	L4FEA           4F90 	L4FEB           
4F9A 	L4FF5           4FA6 	L5001           4FAA 	L5005           
4FAC 	L5007           4FC3 	L501E           4FC9 	L5024           
4FD1 	L502C           4FDE 	L5039           4FE5 	L5040           
4FEA 	L5045           4FEF 	L504A           4FF5 	L5050           
5001 	L505C           5002 	L505D           500B 	L5066           
500F 	L506A           501D 	L5078           5021 	L507C           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-10


502B 	L5086           502E 	L5089           503A 	L5095           
5068 	L50C3           5075 	L50D0           507D 	L50D8           
5091 	L50EC           509F 	L50FA           50BD 	L5118           
50C8 	L5123           50D3 	L512E           50E9 	L5144           
50EB 	L5146           50F0 	L514B           50F9 	L5154           
50FC 	L5157           5102 	L515D           5107 	L5162           
510C 	L5167           5127 	L5182           5140 	L519B           
5151 	L51AC           5156 	L51B1           515B 	L51B6           
5160 	L51BB           5164 	L51BF           5166 	L51C1           
517B 	L51D6           519C 	L51F7           51BF 	L521A           
51C8 	L5223           51D4 	L522F           51D8 	L5233           
51DA 	L5235           51E3 	L523E           51EE 	L5249           
51FD 	L5258           5200 	L525B           5212 	L526D           
522F 	L528A           5230 	L528B           5249 	L52A4           
5258 	L52B3           5272 	L52CD           5275 	L52D0           
528A 	L52E5           529C 	L52F7           52BC 	L5317           
52D1 	L532C           52D6 	L5331           52D9 	L5334           
52DE 	L5339           52E0 	L533B           52F0 	L534B           
52FB 	L5356           5316 	L5371           531E 	L5379           
5321 	L537C           532E 	L5389           5349 	L53A4           
5355 	L53B0           535C 	L53B7           5365 	L53C0           
5375 	L53D0           5381 	L53DC           538E 	L53E9           
5395 	L53F0           5397 	L53F2           53D4 	L542F           
53D7 	L5432           53EC 	L5447           53F4 	L544F           
53FF 	L545A           5429 	L5484           544D 	L54A8           
546B 	L54C6           546F 	L54CA           547D 	L54D8           
5499 	L54F4           54AD 	L5508           54BF 	L551A           
54EC 	L5547           54ED 	L5548           54EE 	L5549           
54F6 	L5551           54FC 	L5557           5513 	L556E           
551C 	L5577           553D 	L5598           5549 	L55A4           
5554 	L55AF           5562 	L55BD           556A 	L55C5           
556C 	L55C7           5572 	L55CD           557D 	L55D8           
5586 	L55E1           558F 	L55EA           5598 	L55F3           
55B3 	L560E           55B6 	L5611           55CE 	L5629           
55D7 	L5632           5640 	L569B           5649 	L56A4           
564C 	L56A7           565B 	L56B6           566C 	L56C7           
569A 	L56F5           56C5 	L5720           56C8 	L5723           
56D1 	L572C           56D4 	L572F           56D6 	L5731           
56DC 	L5737           56E0 	L573B           56E5 	L5740           
56EA 	L5745           5702 	L575D           5705 	L5760           
5715 	L5770           5726 	L5781           572A 	L5785           
574B 	L57A6           5756 	L57B1           5768 	L57C3           
578A 	L57E5           5795 	L57F0           57BC 	L5817           
57BE 	L5819           57C2 	L581D           57D9 	L5834           
5816 	L5871           5821 	L587C           5825 	L5880           
5836 	L5891           5844 	L589F           5845 	L58A0           
5866 	L58C1           5867 	L58C2           586F 	L58CA           
5871 	L58CC           587C 	L58D7           5886 	L58E1           
5889 	L58E4           589C 	L58F7           58AC 	L5907           
58BB 	L5916           58F1 	L594C           58F9 	L5954           
590B 	L5966           590F 	L596A           5912 	L596D           
5914 	L596F           591A 	L5975           591C 	L5977           
5947 	L59A2           5952 	L59AD           5957 	L59B2           
5961 	L59BC           5973 	L59CE           59A7 	L5A02           
59B7 	L5A12           59BE 	L5A19           59E0 	L5A3B           
59EE 	L5A49           59FD 	L5A58           5A07 	L5A62           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-11


5A08 	L5A63           5A0B 	L5A66           5A0E 	L5A69           
5A18 	L5A73           5A1B 	L5A76           5A24 	L5A7F           
5A27 	L5A82           5A32 	L5A8D           5A46 	L5AA1           
5A73 	L5ACE           5A7A 	L5AD5           5ABA 	L5B15           
5ADA 	L5B35           5AF0 	L5B4B           5AFB 	L5B56           
5B07 	L5B62           5B09 	L5B64           5B57 	L5BB2           
5B6F 	L5BCA           5B82 	L5BDD           5B91 	L5BEC           
5B9D 	L5BF8           5BAD 	L5C08           5BC1 	L5C1C           
5BC4 	L5C1F           5BD6 	L5C31           5BE4 	L5C3F           
5C1E 	L5C79           5C23 	L5C7E           5C2D 	L5C88           
5C2F 	L5C8A           5C31 	L5C8C           5C36 	L5C91           
5C4B 	L5CA6           5C68 	L5CC3           5C75 	L5CD0           
5C7F 	L5CDA           5C86 	L5CE1           5C8F 	L5CEA           
5C92 	L5CED           5C9C 	L5CF7           5C9F 	L5CFA           
5CCA 	L5D25           5CDB 	L5D36           5D16 	L5D71           
5D1A 	L5D75           5D2D 	L5D88           5D3E 	L5D99           
5D42 	L5D9D           5D70 	L5DCB           5D72 	L5DCD           
5D7E 	L5DD9           5DA6 	L5E01           5DD1 	L5E2C           
5DDD 	L5E38           5E08 	L5E63           5E1C 	L5E77           
5E2B 	L5E86           5E35 	L5E90           5E6E 	L5EC9           
5E7D 	L5ED8           5E86 	L5EE1           5E8F 	L5EEA           
5E94 	L5EEF           5EA3 	L5EFE           5EB8 	L5F13           
5EBA 	L5F15           5EDC 	L5F37           5EF7 	L5F52           
5F00 	L5F5B           5F03 	L5F5E           5F14 	L5F6F           
5F16 	L5F71           5F2B 	L5F86           5F39 	L5F94           
5F44 	L5F9F           5F47 	L5FA2           5FA0 	L5FFB           
5FA1 	L5FFC           5FA6 	L6001           5FC0 	L601B           
5FC1 	L601C           5FC9 	L6024           5FCB 	L6026           
5FFC 	L6057           6009 	L6064           6013 	L606E           
6039 	L60AC           603C 	L60AF           6077 	L60EA           
6078 	L60EB           607F 	L60F2           6089 	L60FC           
6095 	L6108           60A1 	L6114           60A9 	L611C           
60B6 	L6129           60C1 	L6134           60C4 	L6137           
60D0 	L6143           60F3 	L6166           610D 	L6180           
610F 	L6182           6111 	L6184           611D 	L6190           
6122 	L6195           6126 	L6199           612D 	L61A0           
6177 	L61EA           6185 	L61F8           61A6 	L6219           
61B6 	L6229           61C4 	L6237           61DF 	L6252           
61E8 	L625B           61FA 	L626D           620F 	L6282           
621A 	L628D           623A 	L62AD           6273 	L62E6           
6283 	L62F6           6286 	L62F9           628E 	L6301           
6292 	L6305           62BE 	L6331           62CD 	L6340           
62D3 	L6346           62D8 	L634B           62DD 	L6350           
62E3 	L6356           62E8 	L635B           62EC 	L635F           
62F1 	L6364           62F9 	L636C           62FC 	L636F           
62FD 	L6370           62FF 	L6372           6300 	L6373           
6302 	L6375           6303 	L6376           6305 	L6378           
6306I 	L6379           630E 	L6381           630F 	L6382           
6313 	L6386           6314 	L6387           6315 	L6388           
6316 	L6389           631F 	L6392           6322 	L6395           
6329 	L639C           632B 	L639E           632E 	L63A1           
6331 	L63A4           6334 	L63A7           6337 	L63AA           
633A 	L63AD           633D 	L63B0           6340 	L63B3           
6343 	L63B6           6346 	L63B9           6349 	L63BC           
634C 	L63BF           634F 	L63C2           6352 	L63C5           
6355 	L63C8           6358 	L63CB           635B 	L63CE           
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-12


635E 	L63D1           6361 	L63D4           6378 	L63EB           
6406 	L6479           6407 	L647A           6409 	L647C           
64D3 	L6546           64E0 	L6553           650C 	L657F           
660C 	L667F           660D 	L6680           660F 	L6682           
6610 	L6683           6612 	L6685           6613 	L6686           
661A 	L668D           661B 	L668E           661C 	L668F           
661D 	L6690           661F 	L6692           6621 	L6694           
6624 	L6697           6628 	L669B           6634 	L66A7           
6635 	L66A8           6674 	L66E7           6734 	L67A7           
673E 	L67B1           6740 	L67B3           6746 	L67B9           
6748 	L67BB           674C 	L67BF           6754 	L67C7           
6756 	L67C9           6758 	L67CB           675C 	L67CF           
6762 	L67D5           6774 	L67E7           6790 	L6803           
6791 	L6804           6792 	L6805           6793 	L6806           
6795 	L6808           6797 	L680A           6798 	L680B           
679A 	L680D           679C 	L680F           679E 	L6811           
679F 	L6812           67A0 	L6813           67B8 	L682B           
67BA 	L682D           67BD 	L6830           67BF 	L6832           
67C3 	L6836           67C4 	L6837           67C5 	L6838           
67C7 	L683A           67C8 	L683B           67CB 	L683E           
67CD 	L6840           67CE 	L6841           67CF 	L6842           
67D1 	L6844           67D3 	L6846           67D8 	L684B           
67DA 	L684D           67DB 	L684E           67DD 	L6850           
67DF 	L6852           67F2 	L6865           67F4 	L6867           
67F7 	L686A           67F8 	L686B           67FD 	L6870           
6802 	L6875           6804 	L6877           6805 	L6878           
6806 	L6879           6807 	L687A           6809 	L687C           
680A 	L687D           680C 	L687F           680E 	L6881           
6810 	L6883           6818 	L688B           6819 	L688C           
6824 	L6897           682A 	L689D           682D 	L68A0           
682F 	L68A2           6831 	L68A4           6847 	L68BA           
6894 	L6907           68AC 	L691F           69AC 	L6A1F           
69AD 	L6A20           69EC 	L6A5F           69EE 	L6A61           
69F6 	L6A69           69F8 	L6A6B           69FA 	L6A6D           
69FB 	L6A6E           6A35 	L6AA8           6A36 	L6AA9           
6AC3 	L6B36           6AC4 	L6B37           6ACA 	L6B3D           
6ACB 	L6B3E           6ACC 	L6B3F           6AD1 	L6B44           
6AD3 	L6B46           6AD7 	L6B4A           6ADC 	L6B4F           
6BDA 	L6C4D           6FDD 	L7050           8E1E 	L8E1E           
94B0 	L94B0           AF5F 	LAF5F           B73E 	LB73E           
C34C 	LC34C           DD1E 	LDD1E           5E9C 	LDIR.8          
EB23 	LEB23           EF51 	LEF51           000A 	LF              
F105 	LF105           F403 	LF403           F71E 	LF71E           
FA1E 	LFA1E           FB00 	LFB00           FC18 	LFC18           
FE93 	LFE93           FF00 	LFF00           FFF2 	LFFF2           
FFF8 	LFFF8           FFFD 	LFFFD           FFFF 	LFFFF           
6317 	LINEPTR         69F4 	LOGDSK          6843 	LOGDSK.         
69F5 	LOGUSR          6844 	LOGUSR.         000F 	LOMASK          
67F0 	LST.ENA         613E 	LSTCTRL         686A 	LSTFCB          
2434 	MAIN            246F 	MAIN_           2247 	MALLOC_         
0050 	MAXWID          0014 	MINWID          24BB 	MPM             
0080 	MSB             39CE 	MULTIPLY        2535 	NEXTASM         
0000 	NO              2385 	NOMEMORY        007F 	NOMSB           
248E 	NOZENV          0000 	NULL            2620 	NXTCMDCHR       
1095 	OPCODTAB        035E 	OPEXTAB         26BE 	OPTGO           
2A6C 	OPTTAB          0000 	OS              67C2 	OS.FLG          
SLR Fast Z80 Assembler M80+ 3.44p    21.04.97          PAGE	S-13


4D7C 	OS.SAV          00FF 	OSERR           62D2 	OSVER           
3470 	OUT$BIN         34A2 	OUT$DEC         340F 	OUT$HEX         
3421 	OUT$HEXBYTE     344A 	OUT$OCT         6617 	PASS            
0100 	PC.ABS          0000 	PC.REL          61AE 	POP.R           
067D 	PROCSRC         0E31 	PROCTOKEN       5FA8 	PRSTRG          
618F 	PUSH.R          60D1 	PUTCON          60C5 	PUTLST          
6134 	PUTSTR          611F 	PUTSTR.         6615 	RADIX           
15B9 	RD$DMA$         15CA 	RD$FCB$         159A 	RD$FILE         
14C2 	RDLINE          0080 	RECLNG          0007 	RECMASK         
58A4 	REL.ADR         57AE 	REL.BITS        58B6 	REL.BYTE        
5746 	REL.CODE        579C 	REL.CONST       5744 	REL.EXT         
58AE 	REL.WORD        2148 	RESETF          2107 	REWRITE         
604A 	SELFILE         0100 	SERIAL          0B5F 	SET.JP.TAB      
6161 	SETDMA          6180 	SETDSK          0B68 	SETFILETAB      
6817 	SETFLG          4B71 	SETRADIX        6179 	SETUSR          
260BI 	SKPCMDSPC       2649 	SKPFILLFILE     5477 	SLR.CONST       
4D7E 	SLR.OS          5730 	SPC.OPCODE      57E0 	SPC.PUSH        
5802 	SPC.SYMBOL      2645 	SPCCMDFILE      6845 	SRC.STK         
6AB6 	SRCFCB          631D 	SYMPTR          0903 	SYNTAXERR       
0009 	TAB             6A31 	TOD.PB          0004 	TODLEN          
02ED 	TOKENTAB        62F5 	TOKPTR          6376 	TOKSTRT         
6626 	TOPPTR          62CF 	TOTALERR        0100 	TPA             
FFFF 	TRUE            2623 	TSTCMDCHR       22BA 	U.ALLOC_        
239E 	U.FREE_         001C 	UPSTMP          6742 	WRFCB1          
674A 	WRFCB2          69F2 	WRFCBC          601B 	WRLOCK          
570BI 	WRSPC.OPCODE    5FE1 	WRTOFILE        67C0 	XFER            
24C1 	XPM             FFFF 	YES             0109 	Z3ENV           
010F 	ZENV            



No Fatal error(s)


   62F5 	TOKPTR          6376 	TOKSTRT         
6626 